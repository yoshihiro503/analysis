
<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module mathcomp.reals.constructive_ereal</title>
<meta name="description" content="Documentation of Coq module mathcomp.reals.constructive_ereal" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init()">

  <main>
    <div class="sidebar">
      <h2>Files</h2>
      
    </div>

  <div class="coq">

    <div class="content">
      <p><a href="./index.html">Top</a></p>
      <h1 class="title">Module mathcomp.reals.constructive_ereal</h1>
<br/>
<span class="vernacular">From</span><span class="id"> HB</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> structures</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> all_ssreflect</span><span class="id"> all_algebra</span><span class="id"> finmap</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> mathcomp_extra</span><span class="id"> signed</span>.<br/>
<br/>
<div class="ssrdoc md">
# Extended real numbers $\overline{R}$

Given a type R for numbers, \bar R is the type R extended with symbols
-oo and +oo (notation scope: %E), suitable to represent extended real
numbers. When R is a numDomainType, \bar R is equipped with a canonical
porderType and operations for addition/opposite. When R is a
realDomainType, \bar R is equipped with a Canonical orderType.

Naming convention: in definition/lemma identifiers, "e" stands for an
extended number and "y" and "Ny" for +oo ad -oo respectively.
```
                 \bar R == coproduct of R and {+oo, -oo};
                           notation for extended (R:Type)
                   r%:E == injects real numbers into \bar R
          +%E, -%E, *%E == addition/opposite/multiplication for extended
                           reals
   er_map (f : T -&gt; T') == the \bar T -&gt; \bar T' lifting of f
                  sqrte == square root for extended reals
               `| x |%E == the absolute value of x
                 x ^+ n == iterated multiplication
                 x *+ n == iterated addition
      +%dE, (x *+ n)%dE == dual addition/dual iterated addition for
                           extended reals (-oo + +oo = +oo instead of -oo)
                           Import DualAddTheory for related lemmas
                 x +? y == the addition of the extended real numbers x and
                           and y is defined, i.e., it is neither +oo - oo
                           nor -oo + oo
                 x *? y == the multiplication of the extended real numbers
                           x and y is not of the form 0 * +oo or 0 * -oo
 (_ &lt;= _)%E, (_ &lt; _)%E, == comparison relations for extended reals
 (_ &gt;= _)%E, (_ &gt; _)%E
  (\sum_(i in A) f i)%E == bigop-like notation in scope %E
     maxe x y, mine x y == notation for the maximum/minimum of two
                           extended real numbers
```

## Signed extended real numbers
```
   {posnum \bar R} == interface type for elements in \bar R that are
                      positive, c.f., signed.v, notation in scope %E
   {nonneg \bar R} == interface types for elements in \bar R that are
                      non-negative, c.f. signed.v, notation in scope %E
            x%:pos == explicitly casts x to {posnum \bar R}, in scope %E
            x%:nng == explicitly casts x to {nonneg \bar R}, in scope %E
```

## Topology of extended real numbers
```
                      contract == order-preserving bijective function
                                  from extended real numbers to [-1; 1]
                        expand == function from real numbers to extended
                                  real numbers that cancels contract in
                                  [-1; 1]
```
</div>
<br/>
<span class="gallina-kwd">Set</span><span class="vernacular"> Implicit</span><span class="vernacular"> Arguments</span>.<br/>
<span class="vernacular">Unset</span><span class="vernacular"> Strict</span><span class="vernacular"> Implicit</span>.<br/>
<span class="vernacular">Unset</span><span class="vernacular"> Printing</span><span class="vernacular"> Implicit</span><span class="vernacular"> Defensive</span>.<br/>
<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;x %:E&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 2,</span><span class="id"> format</span> <span class="id">&quot;x %:E&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;x %:dE&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 2,</span><span class="id"> format</span> <span class="id">&quot;x %:dE&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;x +? y&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 50,</span><span class="id"> format</span> <span class="id">&quot;x  +?  y&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;x *? y&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 50,</span><span class="id"> format</span> <span class="id">&quot;x  *?  y&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;'\bar' x&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 2,</span><span class="id"> format</span> <span class="id">&quot;'\bar'  x&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;'\bar' '^d' x&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 2,</span><span class="id"> format</span> <span class="id">&quot;'\bar' '^d'  x&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;{ 'posnum' '\bar' R }&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 0,</span><br/>
&nbsp;&nbsp;<span class="id">format</span> <span class="id">&quot;{ 'posnum'  '\bar'  R }&quot;</span>).<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;{ 'nonneg' '\bar' R }&quot;</span> (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 0,</span><br/>
&nbsp;&nbsp;<span class="id">format</span> <span class="id">&quot;{ 'nonneg'  '\bar'  R }&quot;</span>).<br/>
<br/>
<span class="vernacular">Declare</span><span class="vernacular"> Scope</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Declare</span><span class="vernacular"> Scope</span><span class="id"> ereal_scope</span>.<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> Order</span>.<span class="id">TTheory</span><span class="id"> GRing</span>.<span class="id">Theory</span><span class="id"> Num</span>.<span class="id">Theory</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Variant</span><span class="id"> extended</span> (<span class="id">R</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>)<span class="id"> :=</span><span class="id"> EFin</span><span class="id"> of</span><span class="id"> R</span><span class="id"> |</span><span class="id"> EPInf</span><span class="id"> |</span><span class="id"> ENInf</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> EFin</span><span class="id"> {R}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> EFin_inj</span><span class="id"> T</span><span class="id"> :</span><span class="id"> injective</span> (<span class="id">@EFin</span><span class="id"> T</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a</span><span class="id"> b;</span><span class="id"> case</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> dual_extended</span><span class="id"> :=</span><span class="id"> extended</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> dEFin</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> {R},</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> dual_extended</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> @EFin</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;+oo&quot;</span><span class="id"> :=</span> (<span class="id">@EPInf</span><span class="id"> _</span><span class="id"> :</span><span class="id"> dual_extended</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;+oo&quot;</span><span class="id"> :=</span> (<span class="id">@EPInf</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;-oo&quot;</span><span class="id"> :=</span> (<span class="id">@ENInf</span><span class="id"> _</span><span class="id"> :</span><span class="id"> dual_extended</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;-oo&quot;</span><span class="id"> :=</span> (<span class="id">@ENInf</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;r %:dE&quot;</span><span class="id"> :=</span> (<span class="id">@EFin</span><span class="id"> _</span><span class="id"> r%R</span><span class="id"> :</span><span class="id"> dual_extended</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;r %:E&quot;</span><span class="id"> :=</span> (<span class="id">@EFin</span><span class="id"> _</span><span class="id"> r%R</span><span class="id"> :</span><span class="id"> dual_extended</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;r %:E&quot;</span><span class="id"> :=</span> (<span class="id">@EFin</span><span class="id"> _</span><span class="id"> r%R</span>).<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;'\bar' R&quot;</span><span class="id"> :=</span> (<span class="id">extended</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;'\bar' '^d' R&quot;</span><span class="id"> :=</span> (<span class="id">dual_extended</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;0&quot;</span><span class="id"> :=</span> (<span class="id">@GRing</span>.<span class="id">zero</span> (<span class="id">\bar^d</span><span class="id"> _</span>))<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;0&quot;</span><span class="id"> :=</span> (<span class="id">@GRing</span>.<span class="id">zero</span> (<span class="id">\bar</span><span class="id"> _</span>))<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;1&quot;</span><span class="id"> :=</span> (<span class="id">1%R%:E</span><span class="id"> :</span><span class="id"> dual_extended</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;1&quot;</span><span class="id"> :=</span> (<span class="id">1%R%:E</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<br/>
<span class="vernacular">Bind</span>   <span class="vernacular"> Scope</span><span class="id"> ereal_dual_scope</span><span class="gallina-kwd"> with</span><span class="id"> dual_extended</span>.<br/>
<span class="vernacular">Bind</span>   <span class="vernacular"> Scope</span><span class="id"> ereal_scope</span><span class="gallina-kwd"> with</span><span class="id"> extended</span>.<br/>
<span class="vernacular">Delimit</span><span class="vernacular"> Scope</span><span class="id"> ereal_dual_scope</span><span class="gallina-kwd"> with</span><span class="id"> dE</span>.<br/>
<span class="vernacular">Delimit</span><span class="vernacular"> Scope</span><span class="id"> ereal_scope</span><span class="gallina-kwd"> with</span><span class="id"> E</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> ereal_scope</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> er_map</span><span class="id"> T</span><span class="id"> T'</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> T'</span>) (<span class="id">x</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> T</span>)<span class="id"> :</span><span class="id"> \bar</span><span class="id"> T'</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> x</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> r%:E</span><span class="id"> =&gt;</span> (<span class="id">f</span><span class="id"> r</span>)<span class="id">%:E</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> +oo</span><span class="id"> =&gt;</span><span class="id"> +oo</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> -oo</span><span class="id"> =&gt;</span><span class="id"> -oo</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> er_map_idfun</span><span class="id"> T</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> T</span>)<span class="id"> :</span><span class="id"> er_map</span><span class="id"> idfun</span><span class="id"> x</span><span class="id"> =</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> fine</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> zmodType}</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R</span><span class="id"> :=</span><span class="gallina-kwd"> if</span><span class="id"> x</span><span class="id"> is</span><span class="id"> EFin</span><span class="id"> v</span><span class="gallina-kwd"> then</span><span class="id"> v</span><span class="gallina-kwd"> else</span><span class="id"> 0</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> EqEReal</span>.<br/>
<span class="vernacular">Variable</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> eqType</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> eq_ereal</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> x,</span><span class="id"> y</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span><span class="id"> x%:E,</span><span class="id"> y%:E</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span><span class="id"> +oo,</span><span class="id"> +oo</span><span class="id"> =&gt;</span><span class="id"> true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span><span class="id"> -oo,</span><span class="id"> -oo</span><span class="id"> =&gt;</span><span class="id"> true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|</span><span class="id"> _,</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> false</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ereal_eqP</span><span class="id"> :</span><span class="id"> Equality</span>.<span class="id">axiom</span><span class="id"> eq_ereal</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> [?||][?||];</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> [/eqP|[]]</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> hasDecEq</span>.<span class="id">Build</span> (<span class="id">\bar</span><span class="id"> R</span>)<span class="id"> ereal_eqP</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqe</span> (<span class="id">r1</span><span class="id"> r2</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span> (<span class="id">r1%:E</span><span class="id"> ==</span><span class="id"> r2%:E</span>)<span class="id"> =</span> (<span class="id">r1</span><span class="id"> ==</span><span class="id"> r2</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> EqEReal</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ERealChoice</span>.<br/>
<span class="vernacular">Variable</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> choiceType</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> code</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> x</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> r%:E</span><span class="id"> =&gt;</span><span class="id"> GenTree</span>.<span class="id">Node</span><span class="id"> 0</span><span class="id"> [::</span><span class="id"> GenTree</span>.<span class="id">Leaf</span><span class="id"> r]</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> +oo</span><span class="id"> =&gt;</span><span class="id"> GenTree</span>.<span class="id">Node</span><span class="id"> 1</span><span class="id"> [::]</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> -oo</span><span class="id"> =&gt;</span><span class="id"> GenTree</span>.<span class="id">Node</span><span class="id"> 2</span><span class="id"> [::]</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> decode</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> GenTree</span>.<span class="id">tree</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> option</span> (<span class="id">\bar</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> x</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> GenTree</span>.<span class="id">Node</span><span class="id"> 0</span><span class="id"> [::</span><span class="id"> GenTree</span>.<span class="id">Leaf</span><span class="id"> r]</span><span class="id"> =&gt;</span><span class="id"> Some</span><span class="id"> r%:E</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> GenTree</span>.<span class="id">Node</span><span class="id"> 1</span><span class="id"> [::]</span><span class="id"> =&gt;</span><span class="id"> Some</span><span class="id"> +oo</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> GenTree</span>.<span class="id">Node</span><span class="id"> 2</span><span class="id"> [::]</span><span class="id"> =&gt;</span><span class="id"> Some</span><span class="id"> -oo</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> None</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> codeK</span><span class="id"> :</span><span class="id"> pcancel</span><span class="id"> code</span><span class="id"> decode</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case</span>. Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Choice</span>.<span class="id">copy</span> (<span class="id">\bar</span><span class="id"> R</span>) (<span class="id">pcan_type</span><span class="id"> codeK</span>).<br/>
<br/>
<span class="vernacular">End</span><span class="id"> ERealChoice</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ERealCount</span>.<br/>
<span class="vernacular">Variable</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> countType</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> PCanIsCountable</span> (<span class="id">@codeK</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">End</span><span class="id"> ERealCount</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ERealOrder</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> numDomainType}</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> le_ereal</span><span class="id"> x1</span><span class="id"> x2</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> x1,</span><span class="id"> x2</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> -oo,</span><span class="id"> r%:E</span><span class="id"> |</span><span class="id"> r%:E,</span><span class="id"> +oo</span><span class="id"> =&gt;</span><span class="id"> r</span><span class="id"> \is</span><span class="id"> Num</span>.<span class="id">real</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> r1%:E,</span><span class="id"> r2%:E</span><span class="id"> =&gt;</span><span class="id"> r1</span><span class="id"> &lt;=</span><span class="id"> r2</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> -oo,</span><span class="id"> _</span>   <span class="id"> |</span><span class="id"> _,</span><span class="id"> +oo</span><span class="id"> =&gt;</span><span class="id"> true</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> +oo,</span><span class="id"> _</span>   <span class="id"> |</span><span class="id"> _,</span><span class="id"> -oo</span><span class="id"> =&gt;</span><span class="id"> false</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> lt_ereal</span><span class="id"> x1</span><span class="id"> x2</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> x1,</span><span class="id"> x2</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> -oo,</span><span class="id"> r%:E</span><span class="id"> |</span><span class="id"> r%:E,</span><span class="id"> +oo</span><span class="id"> =&gt;</span><span class="id"> r</span><span class="id"> \is</span><span class="id"> Num</span>.<span class="id">real</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> r1%:E,</span><span class="id"> r2%:E</span><span class="id"> =&gt;</span><span class="id"> r1</span><span class="id"> &lt;</span><span class="id"> r2</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> -oo,</span><span class="id"> -oo</span> <span class="id"> |</span><span class="id"> +oo,</span><span class="id"> +oo</span><span class="id"> =&gt;</span><span class="id"> false</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> +oo,</span><span class="id"> _</span>   <span class="id"> |</span><span class="id"> _</span> <span class="id"> ,</span><span class="id"> -oo</span><span class="id"> =&gt;</span><span class="id"> false</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> -oo,</span><span class="id"> _</span> <span class="id"> =&gt;</span><span class="id"> true</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lt_def_ereal</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> lt_ereal</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =</span> (<span class="id">y</span><span class="id"> !=</span><span class="id"> x</span>)<span class="id"> &amp;&amp;</span><span class="id"> le_ereal</span><span class="id"> x</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [?||][?||]</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> lt_def</span><span class="id"> eqe</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> le_refl_ereal</span><span class="id"> :</span><span class="id"> reflexive</span><span class="id"> le_ereal</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case</span><span class="id"> =&gt;</span><span class="id"> /=</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> le_anti_ereal</span><span class="id"> :</span><span class="id"> ssrbool</span>.<span class="id">antisymmetric</span><span class="id"> le_ereal</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> [?||][?||]/=;</span><span class="id"> rewrite</span><span class="id"> ?andbF</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> /le_anti</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> le_trans_ereal</span><span class="id"> :</span><span class="id"> ssrbool</span>.<span class="id">transitive</span><span class="id"> le_ereal</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case=&gt;</span><span class="id"> [?||][?||][?||]</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> -?comparabler0;</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> le_trans</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> /le_comparable</span><span class="id"> cmp</span><span class="id"> /</span>(<span class="id">comparabler_trans</span><span class="id"> cmp</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> cmp</span><span class="id"> /ge_comparable</span><span class="id"> /comparabler_trans;</span><span class="id"> apply</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> ereal_display</span><span class="id"> :</span><span class="id"> Order</span>.<span class="id">disp_t</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Order</span>.<span class="id">isPOrder</span>.<span class="id">Build</span><span class="id"> ereal_display</span> (<span class="id">\bar</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;<span class="id">lt_def_ereal</span><span class="id"> le_refl_ereal</span><span class="id"> le_anti_ereal</span><span class="id"> le_trans_ereal</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leEereal</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id">%O</span><span class="id"> =</span><span class="id"> le_ereal</span><span class="id"> x</span><span class="id"> y</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> ltEereal</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id">%O</span><span class="id"> =</span><span class="id"> lt_ereal</span><span class="id"> x</span><span class="id"> y</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> ERealOrder</span>.<br/>
<br/>
<span class="vernacular">Notation</span><span class="id"> lee</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">le</span><span class="id"> ereal_display</span><span class="id"> _</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;@ 'lee' R&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">@Order</span>.<span class="id">le</span><span class="id"> ereal_display</span><span class="id"> R</span>) (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 10,</span><span class="id"> R</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> lte</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">lt</span><span class="id"> ereal_display</span><span class="id"> _</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;@ 'lte' R&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">@Order</span>.<span class="id">lt</span><span class="id"> ereal_display</span><span class="id"> R</span>) (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 10,</span><span class="id"> R</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> gee</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">ge</span><span class="id"> ereal_display</span><span class="id"> _</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;@ 'gee' R&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">@Order</span>.<span class="id">ge</span><span class="id"> ereal_display</span><span class="id"> R</span>) (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 10,</span><span class="id"> R</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> gte</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">gt</span><span class="id"> ereal_display</span><span class="id"> _</span>) (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;@ 'gte' R&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">@Order</span>.<span class="id">gt</span><span class="id"> ereal_display</span><span class="id"> R</span>) (<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 10,</span><span class="id"> R</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt;= y&quot;</span><span class="id"> :=</span> (<span class="id">lee</span><span class="id"> x</span><span class="id"> y</span>) (<span class="id">only</span><span class="id"> printing</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt;= y&quot;</span><span class="id"> :=</span> (<span class="id">lee</span><span class="id"> x</span><span class="id"> y</span>) (<span class="id">only</span><span class="id"> printing</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt; y&quot;</span> <span class="id"> :=</span> (<span class="id">lte</span><span class="id"> x</span><span class="id"> y</span>) (<span class="id">only</span><span class="id"> printing</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt; y&quot;</span> <span class="id"> :=</span> (<span class="id">lte</span><span class="id"> x</span><span class="id"> y</span>) (<span class="id">only</span><span class="id"> printing</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt;= y &lt;= z&quot;</span><span class="id"> :=</span> ((<span class="id">lee</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> &amp;&amp;</span> (<span class="id">lee</span><span class="id"> y</span><span class="id"> z</span>)) (<span class="id">only</span><span class="id"> printing</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt;= y &lt;= z&quot;</span><span class="id"> :=</span> ((<span class="id">lee</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> &amp;&amp;</span> (<span class="id">lee</span><span class="id"> y</span><span class="id"> z</span>)) (<span class="id">only</span><span class="id"> printing</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt; y &lt;= z&quot;</span> <span class="id"> :=</span> ((<span class="id">lte</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> &amp;&amp;</span> (<span class="id">lee</span><span class="id"> y</span><span class="id"> z</span>)) (<span class="id">only</span><span class="id"> printing</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt; y &lt;= z&quot;</span> <span class="id"> :=</span> ((<span class="id">lte</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> &amp;&amp;</span> (<span class="id">lee</span><span class="id"> y</span><span class="id"> z</span>)) (<span class="id">only</span><span class="id"> printing</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt;= y &lt; z&quot;</span> <span class="id"> :=</span> ((<span class="id">lee</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> &amp;&amp;</span> (<span class="id">lte</span><span class="id"> y</span><span class="id"> z</span>)) (<span class="id">only</span><span class="id"> printing</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt;= y &lt; z&quot;</span> <span class="id"> :=</span> ((<span class="id">lee</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> &amp;&amp;</span> (<span class="id">lte</span><span class="id"> y</span><span class="id"> z</span>)) (<span class="id">only</span><span class="id"> printing</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt; y &lt; z&quot;</span>  <span class="id"> :=</span> ((<span class="id">lte</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> &amp;&amp;</span> (<span class="id">lte</span><span class="id"> y</span><span class="id"> z</span>)) (<span class="id">only</span><span class="id"> printing</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt; y &lt; z&quot;</span>  <span class="id"> :=</span> ((<span class="id">lte</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> &amp;&amp;</span> (<span class="id">lte</span><span class="id"> y</span><span class="id"> z</span>)) (<span class="id">only</span><span class="id"> printing</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt;= y&quot;</span><span class="id"> :=</span> (<span class="id">lee</span> (<span class="id">x%dE</span><span class="id"> :</span><span class="id"> dual_extended</span><span class="id"> _</span>) (<span class="id">y%dE</span><span class="id"> :</span><span class="id"> dual_extended</span><span class="id"> _</span>))<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt;= y&quot;</span><span class="id"> :=</span> (<span class="id">lee</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> extended</span><span class="id"> _</span>) (<span class="id">y</span><span class="id"> :</span><span class="id"> extended</span><span class="id"> _</span>))<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt; y&quot;</span> <span class="id"> :=</span> (<span class="id">lte</span> (<span class="id">x%dE</span><span class="id"> :</span><span class="id"> dual_extended</span><span class="id"> _</span>) (<span class="id">y%dE</span><span class="id"> :</span><span class="id"> dual_extended</span><span class="id"> _</span>))<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt; y&quot;</span> <span class="id"> :=</span> (<span class="id">lte</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> extended</span><span class="id"> _</span>) (<span class="id">y</span><span class="id"> :</span><span class="id"> extended</span><span class="id"> _</span>))<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &gt;= y&quot;</span><span class="id"> :=</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &gt;= y&quot;</span><span class="id"> :=</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &gt; y&quot;</span> <span class="id"> :=</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &gt; y&quot;</span> <span class="id"> :=</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt;= y &lt;= z&quot;</span><span class="id"> :=</span> ((<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> z</span>))<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt;= y &lt;= z&quot;</span><span class="id"> :=</span> ((<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> z</span>))<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt; y &lt;= z&quot;</span> <span class="id"> :=</span> ((<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> z</span>))<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt; y &lt;= z&quot;</span> <span class="id"> :=</span> ((<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> z</span>))<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt;= y &lt; z&quot;</span> <span class="id"> :=</span> ((<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> z</span>))<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt;= y &lt; z&quot;</span> <span class="id"> :=</span> ((<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> z</span>))<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt; y &lt; z&quot;</span>  <span class="id"> :=</span> ((<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> z</span>))<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt; y &lt; z&quot;</span>  <span class="id"> :=</span> ((<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> z</span>))<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt;= y :&gt; T&quot;</span><span class="id"> :=</span> ((<span class="id">x</span><span class="id"> :</span><span class="id"> T</span>)<span class="id"> &lt;=</span> (<span class="id">y</span><span class="id"> :</span><span class="id"> T</span>)) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x &lt; y :&gt; T&quot;</span><span class="id"> :=</span> ((<span class="id">x</span><span class="id"> :</span><span class="id"> T</span>)<span class="id"> &lt;</span> (<span class="id">y</span><span class="id"> :</span><span class="id"> T</span>)) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ERealZsemimodule</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> nmodType}</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> adde</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> x,</span><span class="id"> y</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> x%:E</span><span class="id"> ,</span><span class="id"> y%:E</span> <span class="id"> =&gt;</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id">%:E</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> -oo,</span><span class="id"> _</span>    <span class="id"> =&gt;</span><span class="id"> -oo</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> _</span>   <span class="id"> ,</span><span class="id"> -oo</span><span class="id"> =&gt;</span><span class="id"> -oo</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> +oo,</span><span class="id"> _</span>    <span class="id"> =&gt;</span><span class="id"> +oo</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> _</span>   <span class="id"> ,</span><span class="id"> +oo</span><span class="id"> =&gt;</span><span class="id"> +oo</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> adde</span><span class="id"> :</span><span class="id"> simpl</span><span class="id"> never</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> dual_adde</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> x,</span><span class="id"> y</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> x%:E</span><span class="id"> ,</span><span class="id"> y%:E</span> <span class="id"> =&gt;</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id">%R%:E</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> +oo,</span><span class="id"> _</span>    <span class="id"> =&gt;</span><span class="id"> +oo</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> _</span>   <span class="id"> ,</span><span class="id"> +oo</span><span class="id"> =&gt;</span><span class="id"> +oo</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> -oo,</span><span class="id"> _</span>    <span class="id"> =&gt;</span><span class="id"> -oo</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> _</span>   <span class="id"> ,</span><span class="id"> -oo</span><span class="id"> =&gt;</span><span class="id"> -oo</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> dual_adde</span><span class="id"> :</span><span class="id"> simpl</span><span class="id"> never</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addeA_subproof</span><span class="id"> :</span><span class="id"> associative</span> (<span class="id">S</span><span class="id"> :=</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> adde</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> [x||]</span><span class="id"> [y||]</span><span class="id"> [z||]</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> /adde</span><span class="id"> /=</span><span class="id"> addrA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addeC_subproof</span><span class="id"> :</span><span class="id"> commutative</span> (<span class="id">S</span><span class="id"> :=</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> adde</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> [x||]</span><span class="id"> [y||]</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> /adde</span><span class="id"> /=</span><span class="id"> addrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> add0e_subproof</span><span class="id"> :</span><span class="id"> left_id</span> (<span class="id">0%:E</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> adde</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> //</span><span class="id"> r;</span><span class="id"> rewrite</span><span class="id"> /adde</span><span class="id"> /=</span><span class="id"> add0r</span>. Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isNmodule</span>.<span class="id">Build</span> (<span class="id">\bar</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;<span class="id">addeA_subproof</span><span class="id"> addeC_subproof</span><span class="id"> add0e_subproof</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> daddeA_subproof</span><span class="id"> :</span><span class="id"> associative</span> (<span class="id">S</span><span class="id"> :=</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> dual_adde</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> [x||]</span><span class="id"> [y||]</span><span class="id"> [z||]</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> /dual_adde</span><span class="id"> /=</span><span class="id"> addrA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> daddeC_subproof</span><span class="id"> :</span><span class="id"> commutative</span> (<span class="id">S</span><span class="id"> :=</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> dual_adde</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> [x||]</span><span class="id"> [y||]</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> /dual_adde</span><span class="id"> /=</span><span class="id"> addrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dadd0e_subproof</span><span class="id"> :</span><span class="id"> left_id</span> (<span class="id">0%:dE%dE</span><span class="id"> :</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> dual_adde</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> //</span><span class="id"> r;</span><span class="id"> rewrite</span><span class="id"> /dual_adde</span><span class="id"> /=</span><span class="id"> add0r</span>. Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Choice</span>.<span class="id">on</span> (<span class="id">\bar^d</span><span class="id"> R</span>).<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isNmodule</span>.<span class="id">Build</span> (<span class="id">\bar^d</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;<span class="id">daddeA_subproof</span><span class="id"> daddeC_subproof</span><span class="id"> dadd0e_subproof</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> enatmul</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> iterop</span><span class="id"> n</span><span class="id"> +%R</span><span class="id"> x</span><span class="id"> 0</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> ednatmul</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> n</span><span class="id"> :</span><span class="id"> \bar^d</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> iterop</span><span class="id"> n</span><span class="id"> +%R</span><span class="id"> x</span><span class="id"> 0</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> ERealZsemimodule</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> adde</span><span class="id"> :</span><span class="id"> simpl</span><span class="id"> never</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> dual_adde</span><span class="id"> :</span><span class="id"> simpl</span><span class="id"> never</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ERealOrder_numDomainType</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> numDomainType}</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>) (<span class="id">r</span><span class="id"> :</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_fin</span> (<span class="id">r</span><span class="id"> s</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span> (<span class="id">r%:E</span><span class="id"> &lt;=</span><span class="id"> s%:E</span>)<span class="id"> =</span> (<span class="id">r</span><span class="id"> &lt;=</span><span class="id"> s</span>)<span class="id">%R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_fin</span> (<span class="id">r</span><span class="id"> s</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span> (<span class="id">r%:E</span><span class="id"> &lt;</span><span class="id"> s%:E</span>)<span class="id"> =</span> (<span class="id">r</span><span class="id"> &lt;</span><span class="id"> s</span>)<span class="id">%R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee01</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> \bar</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lee_fin</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte01</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> \bar</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lte_fin</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leeNy_eq</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> -oo</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> -oo</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leye_eq</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">+oo</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> +oo</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lt0y</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> &lt;</span><span class="id"> +oo</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltNy0</span><span class="id"> :</span><span class="id"> -oo</span><span class="id"> &lt;</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> le0y</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> &lt;=</span><span class="id"> +oo</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leNy0</span><span class="id"> :</span><span class="id"> -oo</span><span class="id"> &lt;=</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> real0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lt0e</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [r|</span><span class="id"> |]//;</span><span class="id"> rewrite</span><span class="id"> lte_fin</span><span class="id"> lee_fin</span><span class="id"> lt0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ereal_comparable</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">0%E</span><span class="id"> &gt;=&lt;</span><span class="id"> x</span>)<span class="id">%O</span><span class="id"> -&gt;</span> (<span class="id">0%E</span><span class="id"> &gt;=&lt;</span><span class="id"> y</span>)<span class="id">%O</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &gt;=&lt;</span><span class="id"> y</span>)<span class="id">%O</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x||]</span><span class="id"> [y||]</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> /Order</span>.<span class="id">comparable</span><span class="id"> !lee_fin</span><span class="id"> -!realE</span>.<br/>
<span class="id">-</span><span class="id"> exact:</span><span class="id"> real_comparable</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /lee/=</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /lee/=</span><span class="id"> =&gt;</span><span class="id"> _</span><span class="id"> -&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_ltry</span><span class="id"> r</span><span class="id"> :</span><span class="id"> r%:E</span><span class="id"> &lt;</span><span class="id"> +oo</span><span class="id"> =</span> (<span class="id">r</span><span class="id"> \is</span><span class="id"> Num</span>.<span class="id">real</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> real_ltNyr</span><span class="id"> r</span><span class="id"> :</span><span class="id"> -oo</span><span class="id"> &lt;</span><span class="id"> r%:E</span><span class="id"> =</span> (<span class="id">r</span><span class="id"> \is</span><span class="id"> Num</span>.<span class="id">real</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_leey</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> +oo</span>)<span class="id"> =</span> (<span class="id">fine</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> Num</span>.<span class="id">real</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> real0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_leNye</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">-oo</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">fine</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> Num</span>.<span class="id">real</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> real0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gee0P</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;-&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> +oo</span><span class="id"> \/</span><span class="gallina-kwd"> exists2</span><span class="id"> r,</span> (<span class="id">r</span><span class="id"> &gt;=</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> &amp;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> r%:E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split=&gt;</span><span class="id"> [|[-&gt;|[r</span><span class="id"> r0</span><span class="id"> -&gt;//]]];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> real_leey/=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [r</span><span class="id"> r0</span><span class="id"> |</span><span class="id"> _</span><span class="id"> |//];</span><span class="id"> [right;</span><span class="gallina-kwd"> exists</span><span class="id"> r|left]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fine0</span><span class="id"> :</span><span class="id"> fine</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0%R</span><span class="id"> :&gt;</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> fine1</span><span class="id"> :</span><span class="id"> fine</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> 1%R</span><span class="id"> :&gt;</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> ERealOrder_numDomainType</span>.<br/>
<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Resolve</span><span class="id"> lee01</span><span class="id"> lte01</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ERealOrder_realDomainType</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> realDomainType}</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>) (<span class="id">r</span><span class="id"> :</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltry</span><span class="id"> r</span><span class="id"> :</span><span class="id"> r%:E</span><span class="id"> &lt;</span><span class="id"> +oo</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> num_real</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltey</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> +oo</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> +oo</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> r;</span><span class="id"> rewrite</span><span class="id"> ltry</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltNyr</span><span class="id"> r</span><span class="id"> :</span><span class="id"> -oo</span><span class="id"> &lt;</span><span class="id"> r%:E</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> num_real</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltNye</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">-oo</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> -oo</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> r;</span><span class="id"> rewrite</span><span class="id"> ltNyr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leey</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> +oo</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> r;</span><span class="id"> exact:</span><span class="id"> num_real</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leNye</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -oo</span><span class="id"> &lt;=</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> r;</span><span class="id"> exact:</span><span class="id"> num_real</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lteey</span><span class="id"> :=</span> (<span class="id">ltey,</span><span class="id"> leey</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> lteNye</span><span class="id"> :=</span> (<span class="id">ltNye,</span><span class="id"> leNye</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> le_er_map</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> {homo</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id">%R}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{homo</span><span class="id"> er_map</span><span class="id"> f</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> ndf</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> [r|</span><span class="id"> |]</span><span class="id"> [l|</span><span class="id"> |]//=;</span><span class="id"> rewrite</span><span class="id"> ?leey</span><span class="id"> ?leNye//</span><span class="id"> !lee_fin;</span><span class="id"> exact:</span><span class="id"> ndf</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> le_total_ereal</span><span class="id"> :</span><span class="id"> total</span> (<span class="id">Order</span>.<span class="id">le</span><span class="id"> :</span><span class="id"> rel</span> (<span class="id">\bar</span><span class="id"> R</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> [?||][?||]//=;</span><span class="id"> rewrite</span> (<span class="id">ltEereal,</span><span class="id"> leEereal</span>)<span class="id">/=</span><span class="id"> ?num_real</span><span class="id"> ?le_total</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Order</span>.<span class="id">POrder_isTotal</span>.<span class="id">Build</span><span class="id"> ereal_display</span> (<span class="id">\bar</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;<span class="id">le_total_ereal</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Order</span>.<span class="id">hasBottom</span>.<span class="id">Build</span><span class="id"> ereal_display</span> (<span class="id">\bar</span><span class="id"> R</span>)<span class="id"> leNye</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Order</span>.<span class="id">hasTop</span>.<span class="id">Build</span><span class="id"> ereal_display</span> (<span class="id">\bar</span><span class="id"> R</span>)<span class="id"> leey</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> ERealOrder_realDomainType</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ERealZmodule</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> zmodType}</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> oppe</span><span class="id"> x</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> x</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> r%:E</span> <span class="id"> =&gt;</span> (<span class="id">-</span><span class="id"> r</span>)<span class="id">%:E</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> -oo</span><span class="id"> =&gt;</span><span class="id"> +oo</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> +oo</span><span class="id"> =&gt;</span><span class="id"> -oo</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> ERealZmodule</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ERealArith</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> numDomainType}</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> mule</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> x,</span><span class="id"> y</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> x%:E</span><span class="id"> ,</span><span class="id"> y%:E</span><span class="id"> =&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id">%:E</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> -oo,</span><span class="id"> y</span><span class="id"> |</span><span class="id"> y,</span><span class="id"> -oo</span><span class="id"> =&gt;</span><span class="gallina-kwd"> if</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> 0</span><span class="gallina-kwd"> then</span><span class="id"> 0</span><span class="gallina-kwd"> else</span><span class="gallina-kwd"> if</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="gallina-kwd"> then</span><span class="id"> -oo</span><span class="gallina-kwd"> else</span><span class="id"> +oo</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> +oo,</span><span class="id"> y</span><span class="id"> |</span><span class="id"> y,</span><span class="id"> +oo</span><span class="id"> =&gt;</span><span class="gallina-kwd"> if</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> 0</span><span class="gallina-kwd"> then</span><span class="id"> 0</span><span class="gallina-kwd"> else</span><span class="gallina-kwd"> if</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="gallina-kwd"> then</span><span class="id"> +oo</span><span class="gallina-kwd"> else</span><span class="id"> -oo</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> mule</span><span class="id"> :</span><span class="id"> simpl</span><span class="id"> never</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> abse</span><span class="id"> x</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span><span class="id"> :=</span><span class="gallina-kwd"> if</span><span class="id"> x</span><span class="id"> is</span><span class="id"> r%:E</span><span class="gallina-kwd"> then</span><span class="id"> `|r|%:E</span><span class="gallina-kwd"> else</span><span class="id"> +oo</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> expe</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> iterop</span><span class="id"> n</span><span class="id"> mule</span><span class="id"> x</span><span class="id"> 1</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> ERealArith</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> mule</span><span class="id"> :</span><span class="id"> simpl</span><span class="id"> never</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;+%dE&quot;</span> <span class="id"> :=</span> (<span class="id">@GRing</span>.<span class="id">add</span> (<span class="id">\bar^d</span><span class="id"> _</span>)).<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;+%E&quot;</span>  <span class="id"> :=</span> (<span class="id">@GRing</span>.<span class="id">add</span> (<span class="id">\bar</span><span class="id"> _</span>)).<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;-%E&quot;</span>  <span class="id"> :=</span><span class="id"> oppe</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x + y&quot;</span><span class="id"> :=</span> (<span class="id">GRing</span>.<span class="id">add</span> (<span class="id">x%dE</span><span class="id"> :</span><span class="id"> \bar^d</span><span class="id"> _</span>)<span class="id"> y%dE</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x + y&quot;</span><span class="id"> :=</span> (<span class="id">GRing</span>.<span class="id">add</span><span class="id"> x%E</span><span class="id"> y%E</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x - y&quot;</span><span class="id"> :=</span> ((<span class="id">x%dE</span><span class="id"> :</span><span class="id"> \bar^d</span><span class="id"> _</span>)<span class="id"> +</span><span class="id"> oppe</span><span class="id"> y%dE</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x - y&quot;</span><span class="id"> :=</span> (<span class="id">x%E</span><span class="id"> +</span> (<span class="id">oppe</span><span class="id"> y%E</span>))<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;- x&quot;</span>  <span class="id"> :=</span> (<span class="id">oppe</span><span class="id"> x%dE</span><span class="id"> :</span><span class="id"> \bar^d</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;- x&quot;</span>  <span class="id"> :=</span> (<span class="id">oppe</span><span class="id"> x%E</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;*%E&quot;</span>  <span class="id"> :=</span><span class="id"> mule</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x * y&quot;</span><span class="id"> :=</span> (<span class="id">mule</span><span class="id"> x%dE</span><span class="id"> y%dE</span><span class="id"> :</span><span class="id"> \bar^d</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x * y&quot;</span><span class="id"> :=</span> (<span class="id">mule</span><span class="id"> x%E</span><span class="id"> y%E</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;`| x |&quot;</span><span class="id"> :=</span> (<span class="id">abse</span><span class="id"> x%dE</span><span class="id"> :</span><span class="id"> \bar^d</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;`| x |&quot;</span><span class="id"> :=</span> (<span class="id">abse</span><span class="id"> x%E</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> abse</span><span class="id"> {R}</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x ^+ n&quot;</span><span class="id"> :=</span> (<span class="id">expe</span><span class="id"> x%dE</span><span class="id"> n</span><span class="id"> :</span><span class="id"> \bar^d</span><span class="id"> _</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x ^+ n&quot;</span><span class="id"> :=</span> (<span class="id">expe</span><span class="id"> x%E</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x *+ n&quot;</span><span class="id"> :=</span> (<span class="id">ednatmul</span><span class="id"> x%dE</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x *+ n&quot;</span><span class="id"> :=</span> (<span class="id">enatmul</span><span class="id"> x%E</span><span class="id"> n</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\- f&quot;</span><span class="id"> :=</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> -</span><span class="id"> f</span><span class="id"> x</span>)<span class="id">%dE</span><span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\- f&quot;</span><span class="id"> :=</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> -</span><span class="id"> f</span><span class="id"> x</span>)<span class="id">%E</span><span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;f \+ g&quot;</span><span class="id"> :=</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> f</span><span class="id"> x</span><span class="id"> +</span><span class="id"> g</span><span class="id"> x</span>)<span class="id">%dE</span><span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;f \+ g&quot;</span><span class="id"> :=</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> f</span><span class="id"> x</span><span class="id"> +</span><span class="id"> g</span><span class="id"> x</span>)<span class="id">%E</span><span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;f \* g&quot;</span><span class="id"> :=</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> f</span><span class="id"> x</span><span class="id"> *</span><span class="id"> g</span><span class="id"> x</span>)<span class="id">%dE</span><span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;f \* g&quot;</span><span class="id"> :=</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> f</span><span class="id"> x</span><span class="id"> *</span><span class="id"> g</span><span class="id"> x</span>)<span class="id">%E</span><span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;f \- g&quot;</span><span class="id"> :=</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> f</span><span class="id"> x</span><span class="id"> -</span><span class="id"> g</span><span class="id"> x</span>)<span class="id">%dE</span><span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;f \- g&quot;</span><span class="id"> :=</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> f</span><span class="id"> x</span><span class="id"> -</span><span class="id"> g</span><span class="id"> x</span>)<span class="id">%E</span><span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i &lt;- r | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%dE/0%dE]_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%dE</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i &lt;- r | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%E/0%E]_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%E</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i &lt;- r ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%dE/0%dE]_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span>)<span class="id"> F%dE</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i &lt;- r ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%E/0%E]_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span>)<span class="id"> F%E</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( m &lt;= i &lt; n | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%dE/0%dE]_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%dE</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( m &lt;= i &lt; n | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%E/0%E]_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%E</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( m &lt;= i &lt; n ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%dE/0%dE]_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> F%dE</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( m &lt;= i &lt; n ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%E/0%E]_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> F%E</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%dE/0%dE]_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%dE</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%E/0%E]_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%E</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ i F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%dE/0%dE]_i</span><span class="id"> F%dE</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ i F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%E/0%E]_i</span><span class="id"> F%E</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i : t | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%dE/0%dE]_</span>(<span class="id">i</span><span class="id"> :</span><span class="id"> t</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%dE</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i : t | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%E/0%E]_</span>(<span class="id">i</span><span class="id"> :</span><span class="id"> t</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%E</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i : t ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%dE/0%dE]_</span>(<span class="id">i</span><span class="id"> :</span><span class="id"> t</span>)<span class="id"> F%dE</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i : t ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%E/0%E]_</span>(<span class="id">i</span><span class="id"> :</span><span class="id"> t</span>)<span class="id"> F%E</span>) (<span class="id">only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i &lt; n | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%dE/0%dE]_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%dE</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i &lt; n | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%E/0%E]_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%E</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i &lt; n ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%dE/0%dE]_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> F%dE</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i &lt; n ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%E/0%E]_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> F%E</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i 'in' A | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%dE/0%dE]_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%dE</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i 'in' A | P ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%E/0%E]_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> |</span><span class="id"> P%B</span>)<span class="id"> F%E</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i 'in' A ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%dE/0%dE]_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> F%dE</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\sum_ ( i 'in' A ) F&quot;</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;(<span class="id">\big[+%E/0%E]_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> F%E</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ERealOrderTheory</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> numDomainType}</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Tactic</span><span class="vernacular"> Notation</span> <span class="id">&quot;elift&quot;</span><span class="id"> constr</span>(<span class="id">lm</span>) <span class="id">&quot;:&quot;</span><span class="id"> ident</span>(<span class="id">x</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [||?];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ?eqe;</span><span class="id"> apply:</span><span class="id"> lm</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Tactic</span><span class="vernacular"> Notation</span> <span class="id">&quot;elift&quot;</span><span class="id"> constr</span>(<span class="id">lm</span>) <span class="id">&quot;:&quot;</span><span class="id"> ident</span>(<span class="id">x</span>)<span class="id"> ident</span>(<span class="id">y</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [?||]</span><span class="id"> [?||];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ?eqe;</span><span class="id"> apply:</span><span class="id"> lm</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Tactic</span><span class="vernacular"> Notation</span> <span class="id">&quot;elift&quot;</span><span class="id"> constr</span>(<span class="id">lm</span>) <span class="id">&quot;:&quot;</span><span class="id"> ident</span>(<span class="id">x</span>)<span class="id"> ident</span>(<span class="id">y</span>)<span class="id"> ident</span>(<span class="id">z</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =&gt;</span><span class="id"> [?||]</span><span class="id"> [?||]</span><span class="id"> [?||];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ?eqe;</span><span class="id"> apply:</span><span class="id"> lm</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee0N1</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span> (<span class="id">-1</span>)<span class="id">%:E</span><span class="id"> :&gt;</span><span class="id"> \bar</span><span class="id"> R</span><span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> ler0N1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte0N1</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span> (<span class="id">-1</span>)<span class="id">%:E</span><span class="id"> :&gt;</span><span class="id"> \bar</span><span class="id"> R</span><span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lte_fin</span><span class="id"> ltr0N1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteN10</span><span class="id"> :</span><span class="id"> -</span><span class="id"> 1%E</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> \bar</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lte_fin</span><span class="id"> ltrN10</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leeN10</span><span class="id"> :</span><span class="id"> -</span><span class="id"> 1%E</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> \bar</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> lerN10</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte0n</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n%:R%:E</span><span class="id"> :&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lte_fin</span><span class="id"> ltr0n</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee0n</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> n%:R%:E</span><span class="id"> :&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> n</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> ler0n</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte1n</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">1</span><span class="id"> &lt;</span><span class="id"> n%:R%:E</span><span class="id"> :&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> =</span> (<span class="id">1</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lte_fin</span><span class="id"> ltr1n</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee1n</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">1</span><span class="id"> &lt;=</span><span class="id"> n%:R%:E</span><span class="id"> :&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> =</span> (<span class="id">1</span><span class="id"> &lt;=</span><span class="id"> n</span>)<span class="id">%N</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> ler1n</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fine_ge0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> fine</span><span class="id"> x</span>)<span class="id">%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fine_gt0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> +oo</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> fine</span><span class="id"> x</span>)<span class="id">%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?ltxx</span><span class="id"> ?andbF//</span><span class="id"> lte_fin</span><span class="id"> =&gt;</span><span class="id"> /andP[]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fine_lt0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -oo</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">fine</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id">%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> //=</span><span class="id"> /andP[_];</span><span class="id"> rewrite</span><span class="id"> lte_fin</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fine_le0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">fine</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id">%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_tofin</span> (<span class="id">r0</span><span class="id"> r1</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span> (<span class="id">r0</span><span class="id"> &lt;=</span><span class="id"> r1</span>)<span class="id">%R</span><span class="id"> -&gt;</span><span class="id"> r0%:E</span><span class="id"> &lt;=</span><span class="id"> r1%:E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_tofin</span> (<span class="id">r0</span><span class="id"> r1</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span> (<span class="id">r0</span><span class="id"> &lt;</span><span class="id"> r1</span>)<span class="id">%R</span><span class="id"> -&gt;</span><span class="id"> r0%:E</span><span class="id"> &lt;</span><span class="id"> r1%:E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> enatmul_pinfty</span><span class="id"> n</span><span class="id"> :</span><span class="id"> +oo</span><span class="id"> *+</span><span class="id"> n</span>.<span class="id">+1</span><span class="id"> =</span><span class="id"> +oo</span><span class="id"> :&gt;</span><span class="id"> \bar</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> n</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> enatmul_ninfty</span><span class="id"> n</span><span class="id"> :</span><span class="id"> -oo</span><span class="id"> *+</span><span class="id"> n</span>.<span class="id">+1</span><span class="id"> =</span><span class="id"> -oo</span><span class="id"> :&gt;</span><span class="id"> \bar</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> n</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> EFin_natmul</span> (<span class="id">r</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> n</span><span class="id"> :</span> (<span class="id">r</span><span class="id"> *+</span><span class="id"> n</span>.<span class="id">+1</span>)<span class="id">%:E</span><span class="id"> =</span><span class="id"> r%:E</span><span class="id"> *+</span><span class="id"> n</span>.<span class="id">+1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> n</span><span class="id"> &lt;-</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mule2n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> x</span><span class="id"> +</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expe2</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leeN2</span><span class="id"> :</span><span class="id"> {mono</span><span class="id"> @oppe</span><span class="id"> R</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [?||]</span><span class="id"> [?||]</span><span class="id"> //;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !lee_fin</span><span class="id"> !lerN2</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /Order</span>.<span class="id">le/=</span><span class="id"> realN</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /Order</span>.<span class="id">le/=</span><span class="id"> realN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteN2</span><span class="id"> :</span><span class="id"> {mono</span><span class="id"> @oppe</span><span class="id"> R</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [?||]</span><span class="id"> [?||]</span><span class="id"> //;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !lte_fin</span><span class="id"> !ltrN2</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /Order</span>.<span class="id">lt/=</span><span class="id"> realN</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /Order</span>.<span class="id">lt/=</span><span class="id"> realN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> ERealOrderTheory</span>.<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Resolve</span><span class="id"> leeN10</span><span class="id"> lteN10</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> finNumPred</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> numDomainType}</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> fin_num</span><span class="id"> :=</span><span class="id"> [qualify</span><span class="id"> a</span><span class="id"> x</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span><span class="id"> |</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> -oo</span>)<span class="id"> &amp;&amp;</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> +oo</span>)<span class="id">]</span>.<br/>
<span class="vernacular">Fact</span><span class="id"> fin_num_key</span><span class="id"> :</span><span class="id"> pred_key</span><span class="id"> fin_num</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fin_numE</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> -oo</span>)<span class="id"> &amp;&amp;</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> +oo</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fin_numP</span><span class="id"> x</span><span class="id"> :</span><span class="id"> reflect</span> ((<span class="id">x</span><span class="id"> !=</span><span class="id"> -oo</span>)<span class="id"> /\</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> +oo</span>)) (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/</span>(<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [/andP//|/andP]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fin_numEn</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> \isn't</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> -oo</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> +oo</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> fin_numE</span><span class="id"> negb_and</span><span class="id"> ?negbK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fin_numPn</span><span class="id"> x</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="id">x</span><span class="id"> =</span><span class="id"> -oo</span><span class="id"> \/</span><span class="id"> x</span><span class="id"> =</span><span class="id"> +oo</span>) (<span class="id">x</span><span class="id"> \isn't</span><span class="id"> a</span><span class="id"> fin_num</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> fin_numEn;</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> orP</span>)<span class="id"> =&gt;</span><span class="id"> -[]/eqP;</span><span class="gallina-kwd"> by</span><span class="id"> [left|right]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fin_real</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -oo</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> +oo</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /andP[oox</span><span class="id"> xoo];</span><span class="id"> rewrite</span><span class="id"> fin_numE</span><span class="id"> gt_eqF</span><span class="id"> ?lt_eqF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fin_num_abs</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> =</span> (<span class="id">`|</span><span class="id"> x</span><span class="id"> |</span><span class="id"> &lt;</span><span class="id"> +oo</span>)<span class="id">%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> fin_numE;</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> r;</span><span class="id"> rewrite</span><span class="id"> real_ltry</span><span class="id"> normr_real</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> finNumPred</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ERealArithTh_numDomainType</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> numDomainType}</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>) (<span class="id">r</span><span class="id"> :</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fine_le</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> fin_num</span><span class="id"> &amp;,</span><span class="id"> {homo</span><span class="id"> @fine</span><span class="id"> R</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id">%R}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> [?</span><span class="id"> [?|</span><span class="id"> |]|</span><span class="id"> |]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fine_lt</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> fin_num</span><span class="id"> &amp;,</span><span class="id"> {homo</span><span class="id"> @fine</span><span class="id"> R</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id">%R}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> [?</span><span class="id"> [?|</span><span class="id"> |]|</span><span class="id"> |]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fine_abse</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> fin_num,</span><span class="id"> {morph</span><span class="id"> @fine</span><span class="id"> R</span><span class="id"> :</span><span class="id"> x</span><span class="id"> /</span><span class="id"> `|x|</span><span class="id"> &gt;-&gt;</span><span class="id"> `|x|%R}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> abse_fin_num</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">`|x|</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fine_eq0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">fine</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 0%R</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [//|</span><span class="id"> |]</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> fin_numE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> EFinN</span><span class="id"> r</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> r</span>)<span class="id">%:E</span><span class="id"> =</span> (<span class="id">-</span><span class="id"> r%:E</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fineN</span><span class="id"> x</span><span class="id"> :</span><span class="id"> fine</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">-</span><span class="id"> fine</span><span class="id"> x</span>)<span class="id">%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> oppr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> EFinD</span><span class="id"> r</span><span class="id"> r'</span><span class="id"> :</span> (<span class="id">r</span><span class="id"> +</span><span class="id"> r'</span>)<span class="id">%:E</span><span class="id"> =</span><span class="id"> r%:E</span><span class="id"> +</span><span class="id"> r'%:E</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> EFin_semi_additive</span><span class="id"> :</span><span class="id"> @semi_additive</span><span class="id"> _</span> (<span class="id">\bar</span><span class="id"> R</span>)<span class="id"> EFin</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split</span>. Qed.</div></details>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isSemiAdditive</span>.<span class="id">Build</span><span class="id"> R</span> (<span class="id">\bar</span><span class="id"> R</span>)<span class="id"> EFin</span><br/>
&nbsp;&nbsp;<span class="id">EFin_semi_additive</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> EFinB</span><span class="id"> r</span><span class="id"> r'</span><span class="id"> :</span> (<span class="id">r</span><span class="id"> -</span><span class="id"> r'</span>)<span class="id">%:E</span><span class="id"> =</span><span class="id"> r%:E</span><span class="id"> -</span><span class="id"> r'%:E</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> EFinM</span><span class="id"> r</span><span class="id"> r'</span><span class="id"> :</span> (<span class="id">r</span><span class="id"> *</span><span class="id"> r'</span>)<span class="id">%:E</span><span class="id"> =</span><span class="id"> r%:E</span><span class="id"> *</span><span class="id"> r'%:E</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sumEFin</span><span class="id"> I</span><span class="id"> s</span><span class="id"> P</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">F</span><span class="id"> i</span>)<span class="id">%:E</span><span class="id"> =</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>)<span class="id">%:E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">big_morph</span><span class="id"> _</span><span class="id"> EFinD</span><span class="id"> erefl</span>). Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> adde_def</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">~~</span> ((<span class="id">x</span><span class="id"> ==</span><span class="id"> +oo</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> -oo</span>))<span class="id"> &amp;&amp;</span><span class="id"> ~~</span> ((<span class="id">x</span><span class="id"> ==</span><span class="id"> -oo</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> +oo</span>)).<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x +? y&quot;</span><span class="id"> :=</span> (<span class="id">adde_def</span><span class="id"> x</span><span class="id"> y</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> adde_defC</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> +?</span><span class="id"> y</span><span class="id"> =</span><span class="id"> y</span><span class="id"> +?</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /adde_def</span><span class="id"> andbC</span> (<span class="id">andbC</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> -oo</span>)) (<span class="id">andbC</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> +oo</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fin_num_adde_defr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> +?</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y</span><span class="id"> |</span><span class="id"> |]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fin_num_adde_defl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> +?</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> adde_defC;</span><span class="id"> exact:</span><span class="id"> fin_num_adde_defr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> adde_defN</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> +?</span><span class="id"> -</span><span class="id"> y</span><span class="id"> =</span><span class="id"> -</span><span class="id"> x</span><span class="id"> +?</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> adde_defDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> +?</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> +?</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> +?</span> (<span class="id">y</span><span class="id"> +</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =&gt;</span><span class="id"> [x||]</span><span class="id"> [y||]</span><span class="id"> [z||]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> adde_defEninfty</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> +?</span><span class="id"> -oo</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> +oo</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ge0_adde_def</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> [pred</span><span class="id"> x</span><span class="id"> |</span><span class="id"> x</span><span class="id"> &gt;=</span><span class="id"> 0]</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> x</span><span class="id"> +?</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addeC</span><span class="id"> :</span><span class="id"> commutative</span> (<span class="id">S</span><span class="id"> :=</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> +%E</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> adde0</span><span class="id"> :</span><span class="id"> right_id</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> +%E</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> add0e</span><span class="id"> :</span><span class="id"> left_id</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> +%E</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> add0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addeA</span><span class="id"> :</span><span class="id"> associative</span> (<span class="id">S</span><span class="id"> :=</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> +%E</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addrA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> adde_def_sum</span><span class="id"> I</span><span class="id"> h</span><span class="id"> t</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">{in</span><span class="id"> P,</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> :</span><span class="id"> I,</span><span class="id"> f</span><span class="id"> h</span><span class="id"> +?</span><span class="id"> f</span><span class="id"> i}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">f</span><span class="id"> h</span><span class="id"> +?</span><span class="id"> \sum_</span>(<span class="id">j</span><span class="id"> &lt;-</span><span class="id"> t</span><span class="id"> |</span><span class="id"> P</span><span class="id"> j</span>)<span class="id"> f</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> fhi;</span><span class="id"> elim/big_rec</span><span class="id"> :</span><span class="id"> _;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> fin_num_adde_defl</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> i</span><span class="id"> x</span><span class="id"> Pi</span><span class="id"> fhx;</span><span class="id"> rewrite</span><span class="id"> adde_defDr//</span><span class="id"> fhi</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addeAC</span><span class="id"> :</span><span class="id"> @right_commutative</span> (<span class="id">\bar</span><span class="id"> R</span>)<span class="id"> _</span><span class="id"> +%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> Monoid</span>.<span class="id">mulmAC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addeCA</span><span class="id"> :</span><span class="id"> @left_commutative</span> (<span class="id">\bar</span><span class="id"> R</span>)<span class="id"> _</span><span class="id"> +%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> Monoid</span>.<span class="id">mulmCA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addeACA</span><span class="id"> :</span><span class="id"> @interchange</span> (<span class="id">\bar</span><span class="id"> R</span>)<span class="id"> +%E</span><span class="id"> +%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> Monoid</span>.<span class="id">mulmACA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> adde_gt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> !lte_fin;</span><span class="id"> exact:</span><span class="id"> addr_gt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> padde_eq0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]//;</span><span class="id"> rewrite</span><span class="id"> !lee_fin;</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> paddr_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x0</span><span class="id"> _</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> andbF</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nadde_eq0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]//;</span><span class="id"> rewrite</span><span class="id"> !lee_fin;</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> naddr_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x0</span><span class="id"> _</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> andbF</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> realDe</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">0%E</span><span class="id"> &gt;=&lt;</span><span class="id"> x</span>)<span class="id">%O</span><span class="id"> -&gt;</span> (<span class="id">0%E</span><span class="id"> &gt;=&lt;</span><span class="id"> y</span>)<span class="id">%O</span><span class="id"> -&gt;</span> (<span class="id">0%E</span><span class="id"> &gt;=&lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id">%O</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> case:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x||]</span><span class="id"> [y||]</span><span class="id"> //;</span><span class="id"> exact:</span><span class="id"> realD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> oppe0</span><span class="id"> :</span><span class="id"> -</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> \bar</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> oppr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> oppeK</span><span class="id"> :</span><span class="id"> involutive</span> (<span class="id">A</span><span class="id"> :=</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> -%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> [x||]</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> opprK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> oppe_inj</span><span class="id"> :</span><span class="id"> @injective</span> (<span class="id">\bar</span><span class="id"> R</span>)<span class="id"> _</span><span class="id"> -%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> inv_inj</span><span class="id"> oppeK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> adde_defNN</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> -</span><span class="id"> x</span><span class="id"> +?</span><span class="id"> -</span><span class="id"> y</span><span class="id"> =</span><span class="id"> x</span><span class="id"> +?</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> adde_defN</span><span class="id"> oppeK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> oppe_eq0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">%E</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">can_eq</span><span class="id"> oppeK</span>)<span class="id"> oppe0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> oppeD</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> +?</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> -</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //=</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> opprD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fin_num_oppeD</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> -</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> finy;</span><span class="id"> rewrite</span><span class="id"> oppeD//</span><span class="id"> fin_num_adde_defl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sube0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> -</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> -EFinB</span><span class="id"> subr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sub0e</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> -</span><span class="id"> x</span><span class="id"> =</span><span class="id"> -</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> -EFinB</span><span class="id"> sub0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> muleC</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> =</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [r||]</span><span class="id"> [s||]//=;</span><span class="id"> rewrite</span><span class="id"> -EFinM</span><span class="id"> mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> onee_neq0</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> \bar</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> oner_neq0</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> onee_eq0</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> ==</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> \bar</span><span class="id"> R</span><span class="id"> =</span><span class="id"> false</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> oner_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mule1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x=&gt;</span><span class="id"> [r||]/=;</span><span class="id"> rewrite</span><span class="id"> /mule/=</span><span class="id"> ?mulr1</span><span class="id"> ?</span>(<span class="id">negbTE</span><span class="id"> onee_neq0</span>)<span class="id"> ?lte_tofin</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul1e</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> mule1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mule0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [r|</span><span class="id"> |]</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> /mule/=</span><span class="id"> ?mulr0//</span><span class="id"> eqxx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mul0e</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [r|</span><span class="id"> |]/=;</span><span class="id"> rewrite</span><span class="id"> /mule/=</span><span class="id"> ?mul0r//</span><span class="id"> eqxx</span>. Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Monoid</span>.<span class="id">isMulLaw</span>.<span class="id">Build</span> (<span class="id">\bar</span><span class="id"> R</span>)<span class="id"> 0</span><span class="id"> mule</span><span class="id"> mul0e</span><span class="id"> mule0</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expeS</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<span class="id">+1</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> mule1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> EFin_expe</span><span class="id"> r</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">r</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id">%:E</span><span class="id"> =</span><span class="id"> r%:E</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [//|n</span><span class="id"> IHn];</span><span class="id"> rewrite</span><span class="id"> exprS</span><span class="id"> EFinM</span><span class="id"> IHn</span><span class="id"> expeS</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> mule_def</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">~~</span> (((<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">`|</span><span class="id"> y</span><span class="id"> |</span><span class="id"> ==</span><span class="id"> +oo</span>))<span class="id"> ||</span> ((<span class="id">y</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">`|</span><span class="id"> x</span><span class="id"> |</span><span class="id"> ==</span><span class="id"> +oo</span>))).<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x *? y&quot;</span><span class="id"> :=</span> (<span class="id">mule_def</span><span class="id"> x</span><span class="id"> y</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mule_defC</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *?</span><span class="id"> y</span><span class="id"> =</span><span class="id"> y</span><span class="id"> *?</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [in</span><span class="id"> LHS]/mule_def</span><span class="id"> orbC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mule_def_fin</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *?</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> finx</span><span class="id"> finy//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /mule_def</span><span class="id"> negb_or</span><span class="id"> 2!negb_and/=</span><span class="id"> 2!orbT</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mule_def_neq0_infty</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> \isn't</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *?</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]//</span><span class="id"> x0</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> /mule_def</span> (<span class="id">negbTE</span><span class="id"> x0</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mule_def_infty_neq0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \isn't</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> y!=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *?</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]//</span><span class="id"> _</span><span class="id"> y0;</span><span class="id"> rewrite</span><span class="id"> /mule_def</span> (<span class="id">negbTE</span><span class="id"> y0</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> neq0_mule_def</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> <span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *?</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mule_def_fin</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> have</span><span class="id"> [-&gt;|?]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> x</span><span class="id"> 0%R;</span><span class="id"> rewrite</span><span class="id"> ?mul0e</span><span class="id"> ?eqxx//</span><span class="id"> mule_def_neq0_infty</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> have</span><span class="id"> [-&gt;|?]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> x</span><span class="id"> 0%R;</span><span class="id"> rewrite</span><span class="id"> ?mul0e</span><span class="id"> ?eqxx//</span><span class="id"> mule_def_neq0_infty</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> have</span><span class="id"> [-&gt;|?]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> y</span><span class="id"> 0%R;</span><span class="id"> rewrite</span><span class="id"> ?mule0</span><span class="id"> ?eqxx//</span><span class="id"> mule_def_infty_neq0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> have</span><span class="id"> [-&gt;|?]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> y</span><span class="id"> 0%R;</span><span class="id"> rewrite</span><span class="id"> ?mule0</span><span class="id"> ?eqxx//</span><span class="id"> mule_def_infty_neq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltpinfty_adde_def</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> [pred</span><span class="id"> x</span><span class="id"> |</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> +oo]</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> x</span><span class="id"> +?</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltninfty_adde_def</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> [pred</span><span class="id"> x</span><span class="id"> |</span><span class="id"> -oo</span><span class="id"> &lt;</span><span class="id"> x]</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> x</span><span class="id"> +?</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> abse_eq0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">`|x|</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [|</span><span class="id"> |]</span><span class="id"> //=</span><span class="id"> r;</span><span class="id"> rewrite</span><span class="id"> !eqe</span><span class="id"> normr_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> abse0</span><span class="id"> :</span><span class="id"> `|0|</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> \bar</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /abse/=</span><span class="id"> normr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> abse1</span><span class="id"> :</span><span class="id"> `|1|</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> \bar</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /abse</span><span class="id"> normr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> abseN</span><span class="id"> x</span><span class="id"> :</span><span class="id"> `|-</span><span class="id"> x|</span><span class="id"> =</span><span class="id"> `|x|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [r||];</span><span class="id"> rewrite</span><span class="id"> //=</span><span class="id"> normrN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqe_opp</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [r|</span><span class="id"> |]</span><span class="id"> [r'|</span><span class="id"> |]</span><span class="id"> //=;</span><span class="id"> apply/idP/idP</span><span class="id"> =&gt;</span><span class="id"> [|/eqP[-&gt;]//]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move/eqP</span><span class="id"> =&gt;</span><span class="id"> -[]</span><span class="id"> /eqP;</span><span class="id"> rewrite</span><span class="id"> eqr_opp</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> -&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqe_oppP</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> =</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> &lt;-&gt;</span> (<span class="id">x</span><span class="id"> =</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split=&gt;</span><span class="id"> [/eqP</span><span class="id"> |</span><span class="id"> -&gt;</span><span class="id"> //];</span><span class="id"> rewrite</span><span class="id"> eqe_opp</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqe_oppLR</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> -</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [r0|</span><span class="id"> |]</span><span class="id"> [r1|</span><span class="id"> |]</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> !eqe</span><span class="id"> eqr_oppLR</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqe_oppLRP</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> =</span><span class="id"> y</span>)<span class="id"> &lt;-&gt;</span> (<span class="id">x</span><span class="id"> =</span><span class="id"> -</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split=&gt;</span><span class="id"> /eqP;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqe_oppLR</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -eqe_oppLR</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fin_numN</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !fin_num_abs</span><span class="id"> abseN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> oppeB</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> +?</span><span class="id"> -</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> -</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> xy;</span><span class="id"> rewrite</span><span class="id"> oppeD//</span><span class="id"> oppeK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fin_num_oppeB</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> -</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> oppeB//</span><span class="id"> adde_defN</span><span class="id"> fin_num_adde_defl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fin_numD</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sum_fin_num</span> (<span class="id">T</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> T</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> T</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">all</span><span class="id"> [pred</span><span class="id"> x</span><span class="id"> |</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num]</span><span class="id"> [seq</span><span class="id"> f</span><span class="id"> i</span><span class="id"> |</span><span class="id"> i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> &amp;</span><span class="id"> P</span><span class="id"> i]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -big_all</span><span class="id"> big_map</span><span class="id"> big_filter;</span><span class="id"> exact:</span> (<span class="id">big_morph</span><span class="id"> _</span><span class="id"> fin_numD</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sum_fin_numP</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> eqType</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> T</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> T</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> i</span><span class="id"> \in</span><span class="id"> s</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> sum_fin_num;</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> allP</span>)<span class="id"> =&gt;</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> +</span><span class="id"> x</span><span class="id"> xs</span><span class="id"> Px;</span><span class="id"> apply;</span><span class="id"> rewrite</span><span class="id"> map_f//</span><span class="id"> mem_filter</span><span class="id"> Px</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> +</span><span class="id"> _</span><span class="id"> /mapP[x</span><span class="id"> /[!mem_filter]/andP[Px</span><span class="id"> xs]</span><span class="id"> -&gt;];</span><span class="id"> apply</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fin_numB</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fin_numM</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fin_numX</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> n</span><span class="id"> ih</span><span class="id"> x</span><span class="id"> finx;</span><span class="id"> rewrite</span><span class="id"> expeS</span><span class="id"> fin_numM//</span><span class="id"> ih</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fineD</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> @fin_num</span><span class="id"> R</span><span class="id"> &amp;,</span><span class="id"> {morph</span><span class="id"> fine</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id">%R}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> [r|</span><span class="id"> |]</span><span class="id"> [s|</span><span class="id"> |]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fineB</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> @fin_num</span><span class="id"> R</span><span class="id"> &amp;,</span><span class="id"> {morph</span><span class="id"> fine</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>)<span class="id">%R}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> [r|</span><span class="id"> |]</span><span class="id"> [s|</span><span class="id"> |]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fineM</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> @fin_num</span><span class="id"> R</span><span class="id"> &amp;,</span><span class="id"> {morph</span><span class="id"> fine</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id">%R}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fineK</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">fine</span><span class="id"> x</span>)<span class="id">%:E</span><span class="id"> =</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> EFin_sum_fine</span> (<span class="id">I</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>)<span class="id"> s</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> fine</span> (<span class="id">f</span><span class="id"> i</span>))<span class="id">%:E</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> h;</span><span class="id"> rewrite</span><span class="id"> -sumEFin;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> Pi;</span><span class="id"> rewrite</span><span class="id"> fineK//</span><span class="id"> h</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sum_fine</span> (<span class="id">I</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>)<span class="id"> s</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> F</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> fine</span> (<span class="id">F</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> fine</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>))<span class="id">%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> h;</span><span class="id"> rewrite</span><span class="id"> -EFin_sum_fine</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sumeN</span><span class="id"> I</span><span class="id"> s</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">{in</span><span class="id"> P</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> f</span><span class="id"> i</span><span class="id"> +?</span><span class="id"> f</span><span class="id"> j}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> -</span><span class="id"> f</span><span class="id"> i</span><span class="id"> =</span><span class="id"> -</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> s</span><span class="id"> =&gt;</span><span class="id"> [|a</span><span class="id"> b</span><span class="id"> ih</span><span class="id"> h];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !big_nil</span><span class="id"> oppe0</span>.<br/>
<span class="id">rewrite</span><span class="id"> !big_cons;</span><span class="id"> case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> Pa;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ih</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> oppeD</span><span class="id"> ?ih//</span><span class="id"> adde_def_sum//</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> Pi;</span><span class="id"> rewrite</span><span class="id"> h</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fin_num_sumeN</span><span class="id"> I</span><span class="id"> s</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> -</span><span class="id"> f</span><span class="id"> i</span><span class="id"> =</span><span class="id"> -</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> h;</span><span class="id"> rewrite</span><span class="id"> sumeN//</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> j</span><span class="id"> Pi</span><span class="id"> Pj;</span><span class="id"> rewrite</span><span class="id"> fin_num_adde_defl//</span><span class="id"> h</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> telescope_sume</span><span class="id"> n</span><span class="id"> m</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span> (<span class="id">n</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> m</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> -&gt;</span> (<span class="id">n</span><span class="id"> &lt;=</span><span class="id"> m</span>)<span class="id">%N</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">n</span><span class="id"> &lt;=</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> m</span>) (<span class="id">f</span><span class="id"> k</span>.<span class="id">+1</span><span class="id"> -</span><span class="id"> f</span><span class="id"> k</span>)<span class="id"> =</span><span class="id"> f</span><span class="id"> m</span><span class="id"> -</span><span class="id"> f</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> nmf</span><span class="id"> nm;</span><span class="id"> under</span><span class="id"> eq_big_nat</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> /andP[ni</span><span class="id"> im]</span><span class="id"> do</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -[f</span><span class="id"> i</span>.<span class="id">+1]fineK</span><span class="id"> -1?[f</span><span class="id"> i]fineK</span><span class="id"> ?</span>(<span class="id">nmf,</span><span class="id"> ni,</span><span class="id"> im</span>)<span class="id"> 1?ltnW//=</span><span class="id"> -EFinD</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> sumEFin</span><span class="id"> telescope_sumr//</span><span class="id"> EFinB</span><span class="id"> !fineK</span><span class="id"> ?nmf</span><span class="id"> ?nm</span><span class="id"> ?leqnn</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addeK</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> x</span><span class="id"> -</span><span class="id"> x</span><span class="id"> =</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> -EFinD</span><span class="id"> -EFinB</span><span class="id"> addrK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subeK</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> +</span><span class="id"> y</span><span class="id"> =</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> -EFinD</span><span class="id"> subrK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subee</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> -</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [r</span><span class="id"> _|</span><span class="id"> |]</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> -EFinB</span><span class="id"> subrr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sube_eq</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> +?</span><span class="id"> z</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">x</span><span class="id"> -</span><span class="id"> z</span><span class="id"> ==</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span><span class="id"> +</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> [z|</span><span class="id"> |]</span><span class="id"> //</span><span class="id"> _</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> !eqe</span><span class="id"> subr_eq</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> adde_eq_ninfty</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> -oo</span>)<span class="id"> =</span> ((<span class="id">x</span><span class="id"> ==</span><span class="id"> -oo</span>)<span class="id"> ||</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> -oo</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [?|</span><span class="id"> |]</span><span class="id"> [?|</span><span class="id"> |]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addye</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> -oo</span><span class="id"> -&gt;</span><span class="id"> +oo</span><span class="id"> +</span><span class="id"> x</span><span class="id"> =</span><span class="id"> +oo</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addey</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> -oo</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> +oo</span><span class="id"> =</span><span class="id"> +oo</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addNye</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -oo</span><span class="id"> +</span><span class="id"> x</span><span class="id"> =</span><span class="id"> -oo</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> addeNy</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> +</span><span class="id"> -oo</span><span class="id"> =</span><span class="id"> -oo</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> adde_Neq_pinfty</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> -oo</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> !=</span><span class="id"> -oo</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> !=</span><span class="id"> +oo</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> +oo</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> !=</span><span class="id"> +oo</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> adde_Neq_ninfty</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> +oo</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> !=</span><span class="id"> +oo</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> !=</span><span class="id"> -oo</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> -oo</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> !=</span><span class="id"> -oo</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> adde_ss_eq0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> &amp;&amp;</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> 0</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /orP[|]</span><span class="id"> /andP[];</span><span class="id"> [exact:</span><span class="id"> padde_eq0|exact:</span><span class="id"> nadde_eq0]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> esum_eqNyP</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> eqType</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> T</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> T</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> =</span><span class="id"> -oo</span><span class="id"> &lt;-&gt;</span><span class="gallina-kwd"> exists</span><span class="id"> i,</span><span class="id"> [/\</span><span class="id"> i</span><span class="id"> \in</span><span class="id"> s,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> &amp;</span><span class="id"> f</span><span class="id"> i</span><span class="id"> =</span><span class="id"> -oo]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split=&gt;</span><span class="id"> [|[i</span><span class="id"> [si</span><span class="id"> Pi</span><span class="id"> fi]]]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> big_seq_cond;</span><span class="id"> elim/big_ind:</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> [[?|</span><span class="id"> |]</span><span class="id"> [?|</span><span class="id"> |]//|]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> i</span><span class="id"> /andP[si</span><span class="id"> Pi]</span><span class="id"> fioo;</span><span class="gallina-kwd"> exists</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> si</span><span class="id"> Pi</span><span class="id"> fioo</span>.<br/>
<span class="id">rewrite</span><span class="id"> big_mkcond</span> (<span class="id">bigID</span> (<span class="id">xpred1</span><span class="id"> i</span>))<span class="id">/=</span> (<span class="id">eq_bigr</span> (<span class="gallina-kwd">fun</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> -oo</span>))<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> j</span><span class="id"> /eqP</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> Pi</span>.<br/>
<span class="id">rewrite</span><span class="id"> big_const_seq/=</span><span class="id"> [X</span><span class="gallina-kwd"> in</span><span class="id"> X</span><span class="id"> +</span><span class="id"> _]</span>(_<span class="id"> :</span><span class="id"> _</span><span class="id"> =</span><span class="id"> -oo</span>)<span class="id">//</span>.<br/>
<span class="id">elim:</span><span class="id"> s</span><span class="id"> i</span><span class="id"> Pi</span><span class="id"> fi</span><span class="id"> si</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> h</span><span class="id"> t</span><span class="id"> ih</span><span class="id"> i</span><span class="id"> Pi</span><span class="id"> fi</span>.<br/>
<span class="id">rewrite</span><span class="id"> inE</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-/=|it];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqxx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> iterD</span><span class="id"> ih//=;</span><span class="id"> case:</span> (_<span class="id"> ==</span><span class="id"> _</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> esum_eqNy</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> I}</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> -oo</span>)<span class="id"> =</span><span class="id"> [exists</span><span class="id"> i</span><span class="gallina-kwd"> in</span><span class="id"> P,</span><span class="id"> f</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> -oo]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/idP/idP</span><span class="id"> =&gt;</span><span class="id"> [/eqP/esum_eqNyP|/existsP[i</span><span class="id"> /andP[Pi</span><span class="id"> /eqP</span><span class="id"> fi]]]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> -[i</span><span class="id"> [_</span><span class="id"> Pi</span><span class="id"> fi]];</span><span class="id"> apply/existsP;</span><span class="gallina-kwd"> exists</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> fi</span><span class="id"> eqxx</span><span class="id"> andbT</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/eqP/esum_eqNyP;</span><span class="gallina-kwd"> exists</span><span class="id"> i</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> esum_eqyP</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> eqType</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> T</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> T</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> i</span><span class="id"> !=</span><span class="id"> -oo</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> =</span><span class="id"> +oo</span><span class="id"> &lt;-&gt;</span><span class="gallina-kwd"> exists</span><span class="id"> i,</span><span class="id"> [/\</span><span class="id"> i</span><span class="id"> \in</span><span class="id"> s,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> &amp;</span><span class="id"> f</span><span class="id"> i</span><span class="id"> =</span><span class="id"> +oo]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> finoo;</span><span class="id"> split=&gt;</span><span class="id"> [|[i</span><span class="id"> [si</span><span class="id"> Pi</span><span class="id"> fi]]]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> big_seq_cond;</span><span class="id"> elim/big_ind:</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> [[?|</span><span class="id"> |]</span><span class="id"> [?|</span><span class="id"> |]//|]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> i</span><span class="id"> /andP[si</span><span class="id"> Pi]</span><span class="id"> fioo;</span><span class="gallina-kwd"> exists</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> si</span><span class="id"> Pi</span><span class="id"> fioo</span>.<br/>
<span class="id">elim:</span><span class="id"> s</span><span class="id"> i</span><span class="id"> Pi</span><span class="id"> fi</span><span class="id"> si</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> h</span><span class="id"> t</span><span class="id"> ih</span><span class="id"> i</span><span class="id"> Pi</span><span class="id"> fi</span>.<br/>
<span class="id">rewrite</span><span class="id"> inE</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-/=|it]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> big_cons</span><span class="id"> Pi</span><span class="id"> fi</span><span class="id"> addye//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/eqP</span><span class="id"> =&gt;</span><span class="id"> /esum_eqNyP[j</span><span class="id"> [jt</span><span class="id"> /finoo/negbTE/eqP]]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> big_cons;</span><span class="id"> case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> Ph;</span><span class="id"> rewrite</span> (<span class="id">ih</span><span class="id"> i</span>)<span class="id">//</span><span class="id"> addey//</span><span class="id"> finoo</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> esum_eqy</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> I}</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> i</span><span class="id"> !=</span><span class="id"> -oo</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> +oo</span>)<span class="id"> =</span><span class="id"> [exists</span><span class="id"> i</span><span class="gallina-kwd"> in</span><span class="id"> P,</span><span class="id"> f</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> +oo]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> fio;</span><span class="id"> apply/idP/existsP</span><span class="id"> =&gt;</span><span class="id"> [/eqP</span><span class="id"> /=|[/=</span><span class="id"> i</span><span class="id"> /andP[Pi</span><span class="id"> /eqP</span><span class="id"> fi]]]</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> {}fio</span><span class="id"> :</span> (<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> i</span><span class="id"> !=</span><span class="id"> -oo</span>)<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> i</span><span class="id"> Pi;</span><span class="id"> exact:</span><span class="id"> fio</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> /</span>(<span class="id">esum_eqyP</span><span class="id"> _</span><span class="id"> fio</span>)<span class="id">[i</span><span class="id"> [_</span><span class="id"> Pi</span><span class="id"> fi]];</span><span class="gallina-kwd"> exists</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> fi</span><span class="id"> eqxx</span><span class="id"> andbT</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/eqP/esum_eqyP</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="gallina-kwd"> exists</span><span class="id"> i</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 0.6.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `esum_eqNyP`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> esum_ninftyP</span><span class="id"> :=</span><span class="id"> esum_eqNyP</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 0.6.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `esum_eqNy`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> esum_ninfty</span><span class="id"> :=</span><span class="id"> esum_eqNy</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 0.6.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `esum_eqyP`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> esum_pinftyP</span><span class="id"> :=</span><span class="id"> esum_eqyP</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 0.6.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `esum_eqy`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> esum_pinfty</span><span class="id"> :=</span><span class="id"> esum_eqy</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> adde_ge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [r0|</span><span class="id"> |]</span><span class="id"> [r1|</span><span class="id"> |]</span><span class="id"> //</span><span class="id"> ?</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !lee_fin</span><span class="id"> addr_ge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> adde_le0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [r0||]</span><span class="id"> [r1||]//</span><span class="id"> ?</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !lee_fin</span><span class="id"> -</span>(<span class="id">addr0</span><span class="id"> 0%R</span>)<span class="id">;</span><span class="id"> exact:</span><span class="id"> lerD</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> oppe_gt0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x||]</span><span class="id"> //;</span><span class="id"> exact:</span><span class="id"> oppr_gt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> oppe_lt0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x||]</span><span class="id"> //;</span><span class="id"> exact:</span><span class="id"> oppr_lt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> oppe_ge0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x||]</span><span class="id"> //;</span><span class="id"> exact:</span><span class="id"> oppr_ge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> oppe_le0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x||]</span><span class="id"> //;</span><span class="id"> exact:</span><span class="id"> oppr_le0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sume_ge0</span><span class="id"> T</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> T</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> t,</span><span class="id"> P</span><span class="id"> t</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> f</span><span class="id"> t</span>)<span class="id"> -&gt;</span><span class="gallina-kwd"> forall</span><span class="id"> l,</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> l</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f0</span><span class="id"> l;</span><span class="id"> elim/big_rec</span><span class="id"> :</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> t</span><span class="id"> x</span><span class="id"> Pt;</span><span class="id"> apply/adde_ge0/f0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sume_le0</span><span class="id"> T</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> T</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> t,</span><span class="id"> P</span><span class="id"> t</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> t</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><span class="gallina-kwd"> forall</span><span class="id"> l,</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> l</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f0</span><span class="id"> l;</span><span class="id"> elim/big_rec</span><span class="id"> :</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> t</span><span class="id"> x</span><span class="id"> Pt;</span><span class="id"> apply/adde_le0/f0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulNyy</span><span class="id"> :</span><span class="id"> -oo</span><span class="id"> *</span><span class="id"> +oo</span><span class="id"> =</span><span class="id"> -oo</span><span class="id"> :&gt;</span><span class="id"> \bar</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /mule</span><span class="id"> /=</span><span class="id"> lt0y</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulyNy</span><span class="id"> :</span><span class="id"> +oo</span><span class="id"> *</span><span class="id"> -oo</span><span class="id"> =</span><span class="id"> -oo</span><span class="id"> :&gt;</span><span class="id"> \bar</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> mulNyy</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulyy</span><span class="id"> :</span><span class="id"> +oo</span><span class="id"> *</span><span class="id"> +oo</span><span class="id"> =</span><span class="id"> +oo</span><span class="id"> :&gt;</span><span class="id"> \bar</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /mule</span><span class="id"> /=</span><span class="id"> lt0y</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulNyNy</span><span class="id"> :</span><span class="id"> -oo</span><span class="id"> *</span><span class="id"> -oo</span><span class="id"> =</span><span class="id"> +oo</span><span class="id"> :&gt;</span><span class="id"> \bar</span><span class="id"> R</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_mulry</span><span class="id"> r</span><span class="id"> :</span><span class="id"> r</span><span class="id"> \is</span><span class="id"> Num</span>.<span class="id">real</span><span class="id"> -&gt;</span><span class="id"> r%:E</span><span class="id"> *</span><span class="id"> +oo</span><span class="id"> =</span> (<span class="id">Num</span>.<span class="id">sg</span><span class="id"> r</span>)<span class="id">%:E</span><span class="id"> *</span><span class="id"> +oo</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> rreal;</span><span class="id"> rewrite</span><span class="id"> /mule/=</span><span class="id"> !eqe</span><span class="id"> sgr_eq0;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> [//|rn0]</span>.<br/>
<span class="id">move:</span><span class="id"> rreal</span><span class="id"> =&gt;</span><span class="id"> /orP[|];</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> eq_sym</span><span class="id"> rn0/=</span><span class="id"> =&gt;</span><span class="id"> rgt0;</span><span class="id"> rewrite</span><span class="id"> lte_fin</span><span class="id"> rgt0</span><span class="id"> gtr0_sg//</span><span class="id"> lte01</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> rn0/=</span><span class="id"> =&gt;</span><span class="id"> rlt0;</span><span class="id"> rewrite</span><span class="id"> lt_def</span><span class="id"> lt_geF//</span><span class="id"> andbF</span><span class="id"> ltr0_sg//</span><span class="id"> lte0N1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_mulyr</span><span class="id"> r</span><span class="id"> :</span><span class="id"> r</span><span class="id"> \is</span><span class="id"> Num</span>.<span class="id">real</span><span class="id"> -&gt;</span><span class="id"> +oo</span><span class="id"> *</span><span class="id"> r%:E</span><span class="id"> =</span> (<span class="id">Num</span>.<span class="id">sg</span><span class="id"> r</span>)<span class="id">%:E</span><span class="id"> *</span><span class="id"> +oo</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> rreal;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> real_mulry</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_mulrNy</span><span class="id"> r</span><span class="id"> :</span><span class="id"> r</span><span class="id"> \is</span><span class="id"> Num</span>.<span class="id">real</span><span class="id"> -&gt;</span><span class="id"> r%:E</span><span class="id"> *</span><span class="id"> -oo</span><span class="id"> =</span> (<span class="id">Num</span>.<span class="id">sg</span><span class="id"> r</span>)<span class="id">%:E</span><span class="id"> *</span><span class="id"> -oo</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> rreal;</span><span class="id"> rewrite</span><span class="id"> /mule/=</span><span class="id"> !eqe</span><span class="id"> sgr_eq0;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> [//|rn0]</span>.<br/>
<span class="id">move:</span><span class="id"> rreal</span><span class="id"> =&gt;</span><span class="id"> /orP[|];</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> eq_sym</span><span class="id"> rn0/=</span><span class="id"> =&gt;</span><span class="id"> rgt0;</span><span class="id"> rewrite</span><span class="id"> lte_fin</span><span class="id"> rgt0</span><span class="id"> gtr0_sg//</span><span class="id"> lte01</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> rn0/=</span><span class="id"> =&gt;</span><span class="id"> rlt0;</span><span class="id"> rewrite</span><span class="id"> lt_def</span><span class="id"> lt_geF//</span><span class="id"> andbF</span><span class="id"> ltr0_sg//</span><span class="id"> lte0N1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> real_mulNyr</span><span class="id"> r</span><span class="id"> :</span><span class="id"> r</span><span class="id"> \is</span><span class="id"> Num</span>.<span class="id">real</span><span class="id"> -&gt;</span><span class="id"> -oo</span><span class="id"> *</span><span class="id"> r%:E</span><span class="id"> =</span> (<span class="id">Num</span>.<span class="id">sg</span><span class="id"> r</span>)<span class="id">%:E</span><span class="id"> *</span><span class="id"> -oo</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> rreal;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> real_mulrNy</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> real_mulr_infty</span><span class="id"> :=</span> (<span class="id">real_mulry,</span><span class="id"> real_mulyr,</span><span class="id"> real_mulrNy,</span><span class="id"> real_mulNyr</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulN1e</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -</span><span class="id"> 1%E</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> -</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -EFinN</span><span class="id"> /mule/=;</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x||];</span><br/>
&nbsp;&nbsp;<span class="id">do</span><span class="id"> ?[by</span><span class="id"> rewrite</span><span class="id"> mulN1r|by</span><span class="id"> rewrite</span><span class="id"> eqe</span><span class="id"> oppr_eq0</span><span class="id"> oner_eq0</span><span class="id"> lte_fin</span><span class="id"> ltr0N1]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> muleN1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *</span><span class="id"> -</span><span class="id"> 1%E</span><span class="id"> =</span><span class="id"> -</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> mulN1e</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mule_neq0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> !=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x||]</span><span class="id"> [y||]</span><span class="id"> x0</span><span class="id"> y0</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> /mule/=</span><span class="id"> ?</span>(<span class="id">lt0y,mulf_neq0</span>)<span class="id">//;</span><br/>
&nbsp;&nbsp;<span class="id">try</span><span class="gallina-kwd"> by</span> (<span class="id">rewrite</span> (<span class="id">negbTE</span><span class="id"> x0</span>)<span class="id">;</span><span class="id"> case:</span><span class="id"> ifPn</span>)<span class="id"> ||</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span> (<span class="id">rewrite</span> (<span class="id">negbTE</span><span class="id"> y0</span>)<span class="id">;</span><span class="id"> case:</span><span class="id"> ifPn</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mule_eq0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> ||</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/idP/idP</span><span class="id"> =&gt;</span><span class="id"> [|/orP[]</span><span class="id"> /eqP-&gt;];</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">mule0,</span><span class="id"> mul0e</span>)<span class="id">//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> contraTT</span><span class="id"> =&gt;</span><span class="id"> /norP[];</span><span class="id"> apply:</span><span class="id"> mule_neq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mule_ge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x||]</span><span class="id"> [y||]//=;</span><span class="id"> rewrite</span><span class="id"> /mule/=</span><span class="id"> ?</span>(<span class="id">lee_fin,</span><span class="id"> eqe,</span><span class="id"> lte_fin,</span><span class="id"> lt0y</span>)<span class="id">//</span>.<br/>
<span class="id">-</span><span class="id"> exact:</span><span class="id"> mulr_ge0</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-</span><span class="id"> _|x0</span><span class="id"> _];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqxx</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> gt_eqF</span><span class="id"> //</span><span class="id"> x0</span><span class="id"> le0y</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-|y0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqxx</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> gt_eqF</span><span class="id"> //</span><span class="id"> y0</span><span class="id"> le0y</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mule_gt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !lt_def</span><span class="id"> =&gt;</span><span class="id"> /andP[?</span><span class="id"> ?]</span><span class="id"> /andP[?</span><span class="id"> ?];</span><span class="id"> rewrite</span><span class="id"> mule_neq0</span><span class="id"> ?mule_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mule_le0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x||]</span><span class="id"> [y||]//=;</span><span class="id"> rewrite</span><span class="id"> /mule/=</span><span class="id"> ?</span>(<span class="id">lee_fin,</span><span class="id"> eqe,</span><span class="id"> lte_fin</span>)<span class="id">//</span>.<br/>
<span class="id">-</span><span class="id"> exact:</span><span class="id"> mulr_le0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lt_leAnge</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span><span class="id"> _;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> _</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> andbF</span><span class="id"> le0y</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lt_leAnge</span><span class="id"> =&gt;</span><span class="id"> _</span><span class="id"> -&gt;;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> _</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> andbF</span><span class="id"> le0y</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mule_le0_ge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> /mule/=</span><span class="id"> ?</span>(<span class="id">lee_fin,</span><span class="id"> lte_fin</span>).<br/>
<span class="id">-</span><span class="id"> exact:</span><span class="id"> mulr_le0_ge0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x0</span><span class="id"> _;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> _</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> lt_leAnge</span><span class="id"> /=</span><span class="id"> x0</span><span class="id"> andbF</span><span class="id"> leNy0</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-|-&gt;];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqxx</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> _</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> leNy0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lt0y</span><span class="id"> leNy0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mule_ge0_le0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x0</span><span class="id"> y0;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> mule_le0_ge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mule_lt0_lt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !lt_neqAle</span><span class="id"> =&gt;</span><span class="id"> /andP[?</span><span class="id"> ?]/andP[*];</span><span class="id"> rewrite</span><span class="id"> eq_sym</span><span class="id"> mule_neq0</span><span class="id"> ?mule_le0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mule_gt0_lt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> lt_def</span><span class="id"> !lt_neqAle</span><span class="id"> =&gt;</span><span class="id"> /andP[?</span><span class="id"> ?]/andP[?</span><span class="id"> ?]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mule_neq0</span><span class="id"> ?mule_ge0_le0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mule_lt0_gt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x0</span><span class="id"> y0;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> mule_gt0_lt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gteN</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> -</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> r;</span><span class="id"> rewrite</span><span class="id"> !lte_fin;</span><span class="id"> apply:</span><span class="id"> gtrN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> realMe</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">0%E</span><span class="id"> &gt;=&lt;</span><span class="id"> x</span>)<span class="id">%O</span><span class="id"> -&gt;</span> (<span class="id">0%E</span><span class="id"> &gt;=&lt;</span><span class="id"> y</span>)<span class="id">%O</span><span class="id"> -&gt;</span> (<span class="id">0%E</span><span class="id"> &gt;=&lt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id">%O</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x||]</span><span class="id"> [y||]//</span><span class="id"> rx</span><span class="id"> ry;</span><br/>
&nbsp;&nbsp;<span class="id">do</span><span class="id"> ?[exact:</span><span class="id"> realM</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|by</span><span class="id"> rewrite</span><span class="id"> /mule/=</span><span class="id"> lt0y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|by</span><span class="id"> rewrite</span><span class="id"> real_mulr_infty</span><span class="id"> ?realE</span><span class="id"> -?lee_fin//</span><span class="id"> /Num</span>.<span class="id">sg;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case:</span><span class="id"> ifP;</span><span class="id"> [|case:</span><span class="id"> ifP];</span><span class="id"> rewrite</span><span class="id"> ?mul0e</span><span class="id"> /Order</span>.<span class="id">comparable</span><span class="id"> ?lexx;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> ?mulN1e</span><span class="id"> ?leNy0</span><span class="id"> ?mul1e</span><span class="id"> ?le0y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|by</span><span class="id"> rewrite</span><span class="id"> mulNyNy</span><span class="id"> /Order</span>.<span class="id">comparable</span><span class="id"> le0y]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqreD</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> +</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> *+</span><span class="id"> 2</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x||]</span><span class="id"> [y||]</span><span class="id"> //</span><span class="id"> _</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -EFinM</span><span class="id"> -EFin_natmul</span><span class="id"> -!EFin_expe</span><span class="id"> -!EFinD</span><span class="id"> sqrrD</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> abse_ge0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> `|x|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> ?le0y</span><span class="id"> ?lee_fin</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gee0_abs</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> `|x|</span><span class="id"> =</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]//;</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> =&gt;</span><span class="id"> x0;</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eqe</span><span class="id"> ger0_norm</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gte0_abs</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> `|x|</span><span class="id"> =</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /ltW/gee0_abs</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee0_abs</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> `|x|</span><span class="id"> =</span><span class="id"> -</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]//;</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> =&gt;</span><span class="id"> x0;</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eqe</span><span class="id"> ler0_norm</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte0_abs</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> `|x|</span><span class="id"> =</span><span class="id"> -</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /ltW/lee0_abs</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> ERealArithTh_numDomainType</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x +? y&quot;</span><span class="id"> :=</span> (<span class="id">adde_def</span><span class="id"> x%dE</span><span class="id"> y%dE</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x +? y&quot;</span><span class="id"> :=</span> (<span class="id">adde_def</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x *? y&quot;</span><span class="id"> :=</span> (<span class="id">mule_def</span><span class="id"> x%dE</span><span class="id"> y%dE</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x *? y&quot;</span><span class="id"> :=</span> (<span class="id">mule_def</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span><span class="id"> maxe</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">max</span><span class="id"> ereal_display</span><span class="id"> _</span>).<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;@ 'maxe' R&quot;</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">max</span><span class="id"> ereal_display</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 10,</span><span class="id"> R</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span><span class="id"> mine</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">min</span><span class="id"> ereal_display</span><span class="id"> _</span>).<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;@ 'mine' R&quot;</span><span class="id"> :=</span> (<span class="id">@Order</span>.<span class="id">min</span><span class="id"> ereal_display</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 10,</span><span class="id"> R</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 8,</span><span class="id"> only</span><span class="id"> parsing</span>)<span class="id"> :</span><span class="id"> function_scope</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> DualAddTheoryNumDomain</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> DualERealArithTh_numDomainType</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> ereal_dual_scope</span>.<br/>
<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> numDomainType}</span>.<br/>
<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> \bar^d</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dual_addeE</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id">%dE</span><span class="id"> =</span><span class="id"> -</span> ((<span class="id">-</span><span class="id"> x</span>)<span class="id"> +</span> (<span class="id">-</span><span class="id"> y</span>))<span class="id">%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |];</span><span class="id"> case:</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> opprD</span><span class="id"> !opprK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dual_sumeE</span><span class="id"> I</span> (<span class="id">r</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>)<span class="id">%dE</span><span class="id"> =</span><span class="id"> -</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">-</span><span class="id"> F</span><span class="id"> i</span>)<span class="id">%E</span>)<span class="id">%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">big_ind2</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> -</span><span class="id"> y</span>)<span class="id">%E</span>)<span class="id"> =&gt;</span><span class="id"> [|_</span><span class="id"> x</span><span class="id"> _</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> -&gt;|i</span><span class="id"> _]</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> oppe0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> dual_addeE</span><span class="id"> !oppeK</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> oppeK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dual_addeE_def</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> +?</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id">%dE</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id">%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |];</span><span class="id"> case:</span><span class="id"> y</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dEFinD</span> (<span class="id">r</span><span class="id"> r'</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span> (<span class="id">r</span><span class="id"> +</span><span class="id"> r'</span>)<span class="id">%R%:E</span><span class="id"> =</span><span class="id"> r%:E</span><span class="id"> +</span><span class="id"> r'%:E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dEFinE</span> (<span class="id">r</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> dEFin</span><span class="id"> r</span><span class="id"> =</span><span class="id"> r%:E</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dEFin_semi_additive</span><span class="id"> :</span><span class="id"> @semi_additive</span><span class="id"> _</span> (<span class="id">\bar^d</span><span class="id"> R</span>)<span class="id"> dEFin</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split</span>. Qed.</div></details>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> GRing</span>.<span class="id">isSemiAdditive</span>.<span class="id">Build</span><span class="id"> R</span> (<span class="id">\bar^d</span><span class="id"> R</span>)<span class="id"> dEFin</span><br/>
&nbsp;&nbsp;<span class="id">dEFin_semi_additive</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dEFinB</span> (<span class="id">r</span><span class="id"> r'</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span> (<span class="id">r</span><span class="id"> -</span><span class="id"> r'</span>)<span class="id">%R%:E</span><span class="id"> =</span><span class="id"> r%:E</span><span class="id"> -</span><span class="id"> r'%:E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dsumEFin</span><span class="id"> I</span><span class="id"> r</span><span class="id"> P</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">F</span><span class="id"> i</span>)<span class="id">%:E</span><span class="id"> =</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>)<span class="id">%R%:E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> dual_sumeE</span><span class="id"> fin_num_sumeN//</span><span class="id"> oppeK</span><span class="id"> sumEFin</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> daddeC</span><span class="id"> :</span><span class="id"> commutative</span> (<span class="id">S</span><span class="id"> :=</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> +%dE</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dadde0</span><span class="id"> :</span><span class="id"> right_id</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> +%dE</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dadd0e</span><span class="id"> :</span><span class="id"> left_id</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> +%dE</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> add0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> daddeA</span><span class="id"> :</span><span class="id"> associative</span> (<span class="id">S</span><span class="id"> :=</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> +%dE</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> addrA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> daddeAC</span><span class="id"> :</span><span class="id"> right_commutative</span> (<span class="id">S</span><span class="id"> :=</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> +%dE</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> Monoid</span>.<span class="id">mulmAC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> daddeCA</span><span class="id"> :</span><span class="id"> left_commutative</span> (<span class="id">S</span><span class="id"> :=</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> +%dE</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> Monoid</span>.<span class="id">mulmCA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> daddeACA</span><span class="id"> :</span><span class="id"> @interchange</span> (<span class="id">\bar^d</span><span class="id"> R</span>)<span class="id"> +%dE</span><span class="id"> +%dE</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> Monoid</span>.<span class="id">mulmACA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> realDed</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">0%dE</span><span class="id"> &gt;=&lt;</span><span class="id"> x</span>)<span class="id">%O</span><span class="id"> -&gt;</span> (<span class="id">0%dE</span><span class="id"> &gt;=&lt;</span><span class="id"> y</span>)<span class="id">%O</span><span class="id"> -&gt;</span> (<span class="id">0%dE</span><span class="id"> &gt;=&lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id">%O</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> case:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x||]</span><span class="id"> [y||]</span><span class="id"> //;</span><span class="id"> exact:</span><span class="id"> realD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> doppeD</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> +?</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> -</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //=</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> opprD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fin_num_doppeD</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> -</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> finy;</span><span class="id"> rewrite</span><span class="id"> doppeD//</span><span class="id"> fin_num_adde_defl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dsube0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> -</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> -dEFinB</span><span class="id"> subr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dsub0e</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> -</span><span class="id"> x</span><span class="id"> =</span><span class="id"> -</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> -dEFinB</span><span class="id"> sub0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> doppeB</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> +?</span><span class="id"> -</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> -</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> xy;</span><span class="id"> rewrite</span><span class="id"> doppeD//</span><span class="id"> oppeK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fin_num_doppeB</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> -</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> doppeB//</span><span class="id"> fin_num_adde_defl//</span><span class="id"> fin_numN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dfin_numD</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dfineD</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{in</span> (<span class="id">@fin_num</span><span class="id"> R</span>)<span class="id"> &amp;,</span><span class="id"> {morph</span><span class="id"> fine</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id">%R}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> [r|</span><span class="id"> |]</span><span class="id"> [s|</span><span class="id"> |]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dfineB</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> @fin_num</span><span class="id"> R</span><span class="id"> &amp;,</span><span class="id"> {morph</span><span class="id"> fine</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>)<span class="id">%R}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> [r|</span><span class="id"> |]</span><span class="id"> [s|</span><span class="id"> |]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> daddeK</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> x</span><span class="id"> -</span><span class="id"> x</span><span class="id"> =</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> fx;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> oppeK</span><span class="id"> addeK</span><span class="id"> ?oppeK;</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> fx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dsubeK</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> +</span><span class="id"> y</span><span class="id"> =</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> fy;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> oppeK</span><span class="id"> subeK</span><span class="id"> ?oppeK;</span><span class="id"> case:</span><span class="id"> y</span><span class="id"> fy</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dsubee</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> -</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> fx;</span><span class="id"> rewrite</span><span class="id"> dual_addeE</span><span class="id"> subee</span><span class="id"> ?oppe0;</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> fx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dsube_eq</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> +?</span><span class="id"> z</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">x</span><span class="id"> -</span><span class="id"> z</span><span class="id"> ==</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span><span class="id"> +</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> [z|</span><span class="id"> |]</span><span class="id"> //</span><span class="id"> _</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> !eqe</span><span class="id"> subr_eq</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dadde_eq_pinfty</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> +oo</span>)<span class="id"> =</span> ((<span class="id">x</span><span class="id"> ==</span><span class="id"> +oo</span>)<span class="id"> ||</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> +oo</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [?|</span><span class="id"> |]</span><span class="id"> [?|</span><span class="id"> |]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> daddye</span><span class="id"> x</span><span class="id"> :</span><span class="id"> +oo</span><span class="id"> +</span><span class="id"> x</span><span class="id"> =</span><span class="id"> +oo</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> daddey</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> +</span><span class="id"> +oo</span><span class="id"> =</span><span class="id"> +oo</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> daddNye</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> +oo</span><span class="id"> -&gt;</span><span class="id"> -oo</span><span class="id"> +</span><span class="id"> x</span><span class="id"> =</span><span class="id"> -oo</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> daddeNy</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> +oo</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> -oo</span><span class="id"> =</span><span class="id"> -oo</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dadde_Neq_pinfty</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> -oo</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> !=</span><span class="id"> -oo</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> !=</span><span class="id"> +oo</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> +oo</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> !=</span><span class="id"> +oo</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dadde_Neq_ninfty</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> +oo</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> !=</span><span class="id"> +oo</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> !=</span><span class="id"> -oo</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> -oo</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> !=</span><span class="id"> -oo</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ndadde_eq0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> 0</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x||]</span><span class="id"> [y||]</span><span class="id"> //</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !lee_fin</span><span class="id"> -dEFinD</span><span class="id"> !eqe;</span><span class="id"> exact:</span><span class="id"> naddr_eq0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /adde/=</span> (_<span class="id"> :</span><span class="id"> -oo</span><span class="id"> ==</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> false</span>)<span class="id">//</span><span class="id"> andbF</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pdadde_eq0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> 0</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x||]</span><span class="id"> [y||]</span><span class="id"> //</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !lee_fin</span><span class="id"> -dEFinD</span><span class="id"> !eqe;</span><span class="id"> exact:</span><span class="id"> paddr_eq0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /adde/=</span> (_<span class="id"> :</span><span class="id"> +oo</span><span class="id"> ==</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> false</span>)<span class="id">//</span><span class="id"> andbF</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dadde_ss_eq0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> &amp;&amp;</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> 0</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> move=&gt;</span><span class="id"> /orP[|]</span><span class="id"> /andP[];</span><span class="id"> [exact:</span><span class="id"> pdadde_eq0|exact:</span><span class="id"> ndadde_eq0]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> desum_eqyP</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> eqType</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> T</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> T</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> =</span><span class="id"> +oo</span><span class="id"> &lt;-&gt;</span><span class="gallina-kwd"> exists</span><span class="id"> i,</span><span class="id"> [/\</span><span class="id"> i</span><span class="id"> \in</span><span class="id"> s,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> &amp;</span><span class="id"> f</span><span class="id"> i</span><span class="id"> =</span><span class="id"> +oo]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> dual_sumeE</span><span class="id"> eqe_oppLRP</span><span class="id"> /=</span><span class="id"> esum_eqNyP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> split=&gt;</span><span class="id"> -[i</span><span class="id"> +</span><span class="id"> /ltac:</span>(<span class="gallina-kwd">exists</span><span class="id"> i</span>)<span class="id">]</span><span class="id"> =&gt;</span><span class="id"> [|]</span><span class="id"> [];</span><span class="id"> [|split];</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> eqe_oppLRP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> desum_eqy</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> I}</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> +oo</span>)<span class="id"> =</span><span class="id"> [exists</span><span class="id"> i</span><span class="gallina-kwd"> in</span><span class="id"> P,</span><span class="id"> f</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> +oo]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> dual_sumeE</span><span class="id"> eqe_oppLR</span><span class="id"> esum_eqNy</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> under</span><span class="id"> eq_existsb</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> eqe_oppLR</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> desum_eqNyP</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">T</span><span class="id"> :</span><span class="id"> eqType</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> T</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> T</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> i</span><span class="id"> !=</span><span class="id"> +oo</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> =</span><span class="id"> -oo</span><span class="id"> &lt;-&gt;</span><span class="gallina-kwd"> exists</span><span class="id"> i,</span><span class="id"> [/\</span><span class="id"> i</span><span class="id"> \in</span><span class="id"> s,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> &amp;</span><span class="id"> f</span><span class="id"> i</span><span class="id"> =</span><span class="id"> -oo]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> fioo</span>.<br/>
<span class="id">rewrite</span><span class="id"> dual_sumeE</span><span class="id"> eqe_oppLRP</span><span class="id"> /=</span><span class="id"> esum_eqyP</span><span class="id"> =&gt;</span><span class="id"> [|i</span><span class="id"> Pi];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> eqe_oppLR</span><span class="id"> fioo</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> split=&gt;</span><span class="id"> -[i</span><span class="id"> +</span><span class="id"> /ltac:</span>(<span class="gallina-kwd">exists</span><span class="id"> i</span>)<span class="id">]</span><span class="id"> =&gt;</span><span class="id"> [|]</span><span class="id"> [];</span><span class="id"> [|split];</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> eqe_oppLRP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> desum_eqNy</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> I}</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> f</span><span class="id"> i</span><span class="id"> !=</span><span class="id"> +oo</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> -oo</span>)<span class="id"> =</span><span class="id"> [exists</span><span class="id"> i</span><span class="gallina-kwd"> in</span><span class="id"> P,</span><span class="id"> f</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> -oo]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> finoo</span>.<br/>
<span class="id">rewrite</span><span class="id"> dual_sumeE</span><span class="id"> eqe_oppLR</span><span class="id"> /=</span><span class="id"> esum_eqy</span><span class="id"> =&gt;</span><span class="id"> [|i];</span><span class="id"> rewrite</span><span class="id"> ?eqe_oppLR</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> under</span><span class="id"> eq_existsb</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> eqe_oppLR</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dadde_ge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> rewrite</span><span class="id"> dual_addeE</span><span class="id"> oppe_ge0</span><span class="id"> -!oppe_le0;</span><span class="id"> exact:</span><span class="id"> adde_le0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dadde_le0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> rewrite</span><span class="id"> dual_addeE</span><span class="id"> oppe_le0</span><span class="id"> -!oppe_ge0;</span><span class="id"> exact:</span><span class="id"> adde_ge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dsume_ge0</span><span class="id"> T</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> T</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> n,</span><span class="id"> P</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> f</span><span class="id"> n</span>)<span class="id"> -&gt;</span><span class="gallina-kwd"> forall</span><span class="id"> l,</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> l</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> u0</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> dual_sumeE</span><span class="id"> oppe_ge0</span><span class="id"> sume_le0</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> t</span><span class="id"> Pt</span>.<br/>
<span class="id">rewrite</span><span class="id"> oppe_le0;</span><span class="id"> exact:</span><span class="id"> u0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dsume_le0</span><span class="id"> T</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> T</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> n,</span><span class="id"> P</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><span class="gallina-kwd"> forall</span><span class="id"> l,</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> l</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> u0</span><span class="id"> l;</span><span class="id"> rewrite</span><span class="id"> dual_sumeE</span><span class="id"> oppe_le0</span><span class="id"> sume_ge0</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> t</span><span class="id"> Pt</span>.<br/>
<span class="id">rewrite</span><span class="id"> oppe_ge0;</span><span class="id"> exact:</span><span class="id"> u0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gte_dN</span> (<span class="id">r</span><span class="id"> :</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> r</span>)<span class="id">%E</span><span class="id"> -&gt;</span> (<span class="id">-</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> r</span>)<span class="id">%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> r</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> r;</span><span class="id"> rewrite</span><span class="id"> !lte_fin;</span><span class="id"> apply:</span><span class="id"> gtrN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ednatmul_pinfty</span><span class="id"> n</span><span class="id"> :</span><span class="id"> +oo</span><span class="id"> *+</span><span class="id"> n</span>.<span class="id">+1</span><span class="id"> =</span><span class="id"> +oo</span><span class="id"> :&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> n</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ednatmul_ninfty</span><span class="id"> n</span><span class="id"> :</span><span class="id"> -oo</span><span class="id"> *+</span><span class="id"> n</span>.<span class="id">+1</span><span class="id"> =</span><span class="id"> -oo</span><span class="id"> :&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> n</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> EFin_dnatmul</span> (<span class="id">r</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> n</span><span class="id"> :</span> (<span class="id">r</span><span class="id"> *+</span><span class="id"> n</span>.<span class="id">+1</span>)<span class="id">%:E</span><span class="id"> =</span><span class="id"> r%:E</span><span class="id"> *+</span><span class="id"> n</span>.<span class="id">+1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> n</span><span class="id"> &lt;-</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ednatmulE</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> *+</span><span class="id"> n</span>)<span class="id">%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |];</span><span class="id"> case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [//|n]</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -EFin_natmul</span><span class="id"> -EFin_dnatmul</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> enatmul_pinfty</span><span class="id"> ednatmul_pinfty</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> enatmul_ninfty</span><span class="id"> ednatmul_ninfty</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dmule2n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> x</span><span class="id"> +</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqredD</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> +</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> *+</span><span class="id"> 2</span><span class="id"> +</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x||]</span><span class="id"> [y||]</span><span class="id"> //</span><span class="id"> _</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -EFinM</span><span class="id"> -EFin_dnatmul</span><span class="id"> -!EFin_expe</span><span class="id"> -!dEFinD</span><span class="id"> sqrrD</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> DualERealArithTh_numDomainType</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `gte_dN`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> gte_dopp</span><span class="id"> :=</span><span class="id"> gte_dN</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">End</span><span class="id"> DualAddTheoryNumDomain</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ERealArithTh_realDomainType</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> realDomainType}</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> u</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>) (<span class="id">r</span><span class="id"> :</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fin_numElt</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> =</span> (<span class="id">-oo</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> +oo</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> fin_numE</span><span class="id"> -leye_eq</span><span class="id"> -leeNy_eq</span><span class="id"> -2!ltNge</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fin_numPlt</span><span class="id"> x</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="id">-oo</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> +oo</span>) (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> fin_numElt;</span><span class="id"> exact:</span><span class="id"> idP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltey_eq</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> +oo</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> -oo</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> x</span><span class="id"> //=;</span><span class="id"> exact:</span><span class="id"> ltry</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltNye_eq</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">-oo</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> +oo</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> x</span><span class="id"> //=;</span><span class="id"> exact:</span><span class="id"> ltNyr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ge0_fin_numE</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> +oo</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> x0;</span><span class="id"> rewrite</span><span class="id"> fin_numElt</span><span class="id"> ltNyr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gt0_fin_numE</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> +oo</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/ltW;</span><span class="id"> exact:</span><span class="id"> ge0_fin_numE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> le0_fin_numE</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> =</span> (<span class="id">-oo</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]//=;</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> =&gt;</span><span class="id"> x0;</span><span class="id"> rewrite</span><span class="id"> ltNyr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lt0_fin_numE</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> =</span> (<span class="id">-oo</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/ltW;</span><span class="id"> exact:</span><span class="id"> le0_fin_numE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqyP</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> =</span><span class="id"> +oo</span><span class="id"> &lt;-&gt;</span> (<span class="gallina-kwd">forall</span><span class="id"> A,</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> A</span>)<span class="id">%R</span><span class="id"> -&gt;</span><span class="id"> A%:E</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split=&gt;</span><span class="id"> [-&gt;</span><span class="id"> //</span><span class="id"> A</span><span class="id"> A0|Ax];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> leey</span>.<br/>
<span class="id">apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eq_le</span><span class="id"> leey</span><span class="id"> /=</span><span class="id"> leNgt;</span><span class="id"> apply/negP</span>.<br/>
<span class="id">case:</span><span class="id"> x</span><span class="id"> Ax</span><span class="id"> =&gt;</span><span class="id"> [x</span><span class="id"> Ax</span><span class="id"> _|//|/</span>(_<span class="id"> _</span><span class="id"> ltr01</span>)<span class="id">//]</span>.<br/>
<span class="id">suff:</span><span class="id"> ~</span><span class="id"> x%:E</span><span class="id"> &lt;</span> (<span class="id">Order</span>.<span class="id">max</span><span class="id"> 0</span><span class="id"> x</span><span class="id"> +</span><span class="id"> 1</span>)<span class="id">%:E</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply;</span><span class="id"> rewrite</span><span class="id"> lte_fin</span><span class="id"> ltr_pwDr//</span><span class="id"> le_max</span><span class="id"> lexx</span><span class="id"> orbT</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/negP;</span><span class="id"> rewrite</span><span class="id"> -leNgt;</span><span class="id"> apply/Ax/ltr_pwDr;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> le_max</span><span class="id"> lexx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> seq_psume_eq0</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> choiceType</span>) (<span class="id">r</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span> (<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> F</span><span class="id"> i</span>)<span class="id">%E</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">%E</span><span class="id"> =</span><span class="id"> all</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> P</span><span class="id"> i</span><span class="id"> ==&gt;</span> (<span class="id">F</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> 0%E</span>))<span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> F0;</span><span class="id"> apply/eqP/allP</span><span class="id"> =&gt;</span><span class="id"> PF0;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> big_seq_cond</span><span class="id"> big1//</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> /andP[ir</span><span class="id"> Pi]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> PF0</span><span class="id"> _</span><span class="id"> ir;</span><span class="id"> rewrite</span><span class="id"> Pi</span><span class="id"> implyTb</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> i</span><span class="id"> ir;</span><span class="id"> apply/implyP</span><span class="id"> =&gt;</span><span class="id"> Pi;</span><span class="id"> apply/eqP</span>.<br/>
<span class="id">have</span><span class="id"> rPF</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> r,</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> ==&gt;</span> (<span class="id">F</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id">}</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> j</span><span class="id"> jr;</span><span class="id"> apply/implyP</span><span class="id"> =&gt;</span><span class="id"> Pj;</span><span class="id"> rewrite</span><span class="id"> fin_numElt;</span><span class="id"> apply/andP;</span><span class="id"> split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">lt_le_trans</span><span class="id"> _</span> (<span class="id">F0</span><span class="id"> _</span><span class="id"> Pj</span>))<span class="id">//</span><span class="id"> ltNyr</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> ltNge;</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> leye_eq;</span><span class="id"> apply/eqP/negP</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> Fjoo</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> PFninfty</span><span class="id"> k</span><span class="id"> :</span><span class="id"> P</span><span class="id"> k</span><span class="id"> -&gt;</span><span class="id"> F</span><span class="id"> k</span><span class="id"> !=</span><span class="id"> -oo%E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> Pk;</span><span class="id"> rewrite</span><span class="id"> gt_eqF//</span> (<span class="id">lt_le_trans</span><span class="id"> _</span> (<span class="id">F0</span><span class="id"> _</span><span class="id"> Pk</span>))<span class="id">//</span><span class="id"> ltNyr</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> /esum_eqyP</span><span class="id"> :</span><span class="gallina-kwd"> exists</span><span class="id"> i,</span><span class="id"> [/\</span><span class="id"> i</span><span class="id"> \in</span><span class="id"> r,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> &amp;</span><span class="id"> F</span><span class="id"> i</span><span class="id"> =</span><span class="id"> +oo%E]</span><span class="gallina-kwd"> by</span><span class="gallina-kwd"> exists</span><span class="id"> j</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> /</span>(_<span class="id"> PFninfty</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> PF0</span>.<br/>
<span class="id">have</span><span class="id"> ?</span><span class="id"> :</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">fine</span><span class="id"> \o</span><span class="id"> F</span>)<span class="id"> i</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">%R</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/eqP/EFin_inj;</span><span class="id"> rewrite</span><span class="id"> big_seq_cond</span><span class="id"> -sumEFin</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">eq_bigr</span> (<span class="gallina-kwd">fun</span><span class="id"> i0</span><span class="id"> =&gt;</span><span class="id"> F</span><span class="id"> i0</span>))<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> j</span><span class="id"> /andP[jr</span><span class="id"> Pj]</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> fineK//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> rPF</span><span class="id"> _</span><span class="id"> jr;</span><span class="id"> rewrite</span><span class="id"> Pj</span><span class="id"> implyTb</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -big_seq_cond</span><span class="id"> PF0</span>.<br/>
<span class="id">have</span><span class="id"> /allP/</span>(_<span class="id"> _</span><span class="id"> ir</span>)<span class="id"> :</span><span class="id"> all</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> P</span><span class="id"> i</span><span class="id"> ==&gt;</span> ((<span class="id">fine</span><span class="id"> \o</span><span class="id"> F</span>)<span class="id"> i</span><span class="id"> ==</span><span class="id"> 0</span>))<span class="id">%R</span><span class="id"> r</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -psumr_eq0//</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> Pj/=;</span><span class="id"> apply/fine_ge0/F0</span>.<br/>
<span class="id">rewrite</span><span class="id"> Pi</span><span class="id"> implyTb</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> Fi0</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">@fineK</span><span class="id"> _</span> (<span class="id">F</span><span class="id"> i</span>))<span class="id">//;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> rPF</span><span class="id"> _</span><span class="id"> ir;</span><span class="id"> rewrite</span><span class="id"> Pi</span><span class="id"> implyTb</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> Fi0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_add_pinfty</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> +oo</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> +oo</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> +oo</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> -[r</span><span class="id"> [r'|</span><span class="id"> |]|</span><span class="id"> |]</span><span class="id"> //</span><span class="id"> ?</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> -EFinD</span><span class="id"> ltry</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_sum_pinfty</span><span class="id"> I</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> +oo</span>)<span class="id"> -&gt;</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> +oo</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim/big_ind</span><span class="id"> :</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> [_|x</span><span class="id"> y</span><span class="id"> xoo</span><span class="id"> yoo</span><span class="id"> foo|i</span><span class="id"> ?];</span><span class="id"> [exact:</span><span class="id"> ltry|</span><span class="id"> |exact]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> lte_add_pinfty;</span><span class="id"> [exact:</span><span class="id"> xoo|</span><span class="id"> exact:</span><span class="id"> yoo]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sube_gt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [r</span><span class="id"> |</span><span class="id"> |]</span><span class="id"> [r'|</span><span class="id"> |]</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">ltry,</span><span class="id"> ltNyr</span>)<span class="id">//</span><span class="id"> !lte_fin</span><span class="id"> subr_gt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sube_le0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !leNgt</span><span class="id"> sube_gt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> suber_ge0</span><span class="id"> y</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //=</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">leey,</span><span class="id"> lee_fin,</span><span class="id"> subr_ge0</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subre_ge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">leey,</span><span class="id"> leNye,</span><span class="id"> lee_fin</span>)<span class="id"> //=</span><span class="id"> subr_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sube_ge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> ||</span> (<span class="id">y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /orP[?|?];</span><span class="id"> [rewrite</span><span class="id"> suber_ge0|rewrite</span><span class="id"> subre_ge0]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteNl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">-</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [r|</span><span class="id"> |]</span><span class="id"> [r'|</span><span class="id"> |]</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">ltry,</span><span class="id"> ltNyr</span>)<span class="id">//</span><span class="id"> !lte_fin</span><span class="id"> ltrNl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteNr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> -</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [r|</span><span class="id"> |]</span><span class="id"> [r'|</span><span class="id"> |]</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">ltry,</span><span class="id"> ltNyr</span>)<span class="id">//</span><span class="id"> !lte_fin</span><span class="id"> ltrNr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leeNr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> -</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [r0|</span><span class="id"> |]</span><span class="id"> [r1|</span><span class="id"> |]</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">leey,</span><span class="id"> leNye</span>)<span class="id">//</span><span class="id"> !lee_fin</span><span class="id"> lerNr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leeNl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">-</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [r0|</span><span class="id"> |]</span><span class="id"> [r1|</span><span class="id"> |]</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">leey,</span><span class="id"> leNye</span>)<span class="id">//</span><span class="id"> !lee_fin</span><span class="id"> lerNl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> muleN</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> *</span><span class="id"> -</span><span class="id"> y</span><span class="id"> =</span><span class="id"> -</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> /mule/=;</span><span class="id"> try</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltry</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrN</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !eqe</span><span class="id"> !lte_fin;</span><span class="id"> case:</span><span class="id"> ltrgtP</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> oppe0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !eqe</span><span class="id"> !lte_fin;</span><span class="id"> case:</span><span class="id"> ltrgtP</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> oppe0</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> !eqe</span><span class="id"> oppr_eq0</span><span class="id"> eq_sym;</span><span class="id"> case:</span><span class="id"> ifP;</span><span class="id"> rewrite</span><span class="id"> ?oppe0//</span><span class="id"> =&gt;</span><span class="id"> y0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [RHS]fun_if</span><span class="id"> ltNge</span><span class="id"> if_neg</span><span class="id"> EFinN</span><span class="id"> leeNl</span><span class="id"> oppe0</span><span class="id"> le_eqVlt</span><span class="id"> eqe</span><span class="id"> y0</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> !eqe</span><span class="id"> oppr_eq0</span><span class="id"> eq_sym;</span><span class="id"> case:</span><span class="id"> ifP;</span><span class="id"> rewrite</span><span class="id"> ?oppe0//</span><span class="id"> =&gt;</span><span class="id"> y0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [RHS]fun_if</span><span class="id"> ltNge</span><span class="id"> if_neg</span><span class="id"> EFinN</span><span class="id"> leeNl</span><span class="id"> oppe0</span><span class="id"> le_eqVlt</span><span class="id"> eqe</span><span class="id"> y0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulNe</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> -</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> =</span><span class="id"> -</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> muleN</span><span class="id"> muleC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> muleNN</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> -</span><span class="id"> x</span><span class="id"> *</span><span class="id"> -</span><span class="id"> y</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulNe</span><span class="id"> muleN</span><span class="id"> oppeK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulry</span><span class="id"> r</span><span class="id"> :</span><span class="id"> r%:E</span><span class="id"> *</span><span class="id"> +oo%E</span><span class="id"> =</span> (<span class="id">Num</span>.<span class="id">sg</span><span class="id"> r</span>)<span class="id">%:E</span><span class="id"> *</span><span class="id"> +oo%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [LHS]real_mulry//</span><span class="id"> num_real</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulyr</span><span class="id"> r</span><span class="id"> :</span><span class="id"> +oo%E</span><span class="id"> *</span><span class="id"> r%:E</span><span class="id"> =</span> (<span class="id">Num</span>.<span class="id">sg</span><span class="id"> r</span>)<span class="id">%:E</span><span class="id"> *</span><span class="id"> +oo%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> mulry</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulrNy</span><span class="id"> r</span><span class="id"> :</span><span class="id"> r%:E</span><span class="id"> *</span><span class="id"> -oo%E</span><span class="id"> =</span> (<span class="id">Num</span>.<span class="id">sg</span><span class="id"> r</span>)<span class="id">%:E</span><span class="id"> *</span><span class="id"> -oo%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [LHS]real_mulrNy//</span><span class="id"> num_real</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulNyr</span><span class="id"> r</span><span class="id"> :</span><span class="id"> -oo%E</span><span class="id"> *</span><span class="id"> r%:E</span><span class="id"> =</span> (<span class="id">Num</span>.<span class="id">sg</span><span class="id"> r</span>)<span class="id">%:E</span><span class="id"> *</span><span class="id"> -oo%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> mulrNy</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> mulr_infty</span><span class="id"> :=</span> (<span class="id">mulry,</span><span class="id"> mulyr,</span><span class="id"> mulrNy,</span><span class="id"> mulNyr</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_mul_pinfty</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> +oo</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> +oo</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //</span><span class="id"> x0</span><span class="id"> xfin</span><span class="id"> _;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -EFinM</span><span class="id"> ltry</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulr_infty;</span><span class="id"> move:</span><span class="id"> x0;</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-|x0]</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> sgr0</span><span class="id"> mul0e</span><span class="id"> ltry</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> gtr0_sg</span><span class="id"> //</span><span class="id"> mul1e</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mule_ge0_gt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> &amp;&amp;</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> ?lee_fin</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x0</span><span class="id"> y0;</span><span class="id"> rewrite</span><span class="id"> !lte_fin;</span><span class="id"> exact:</span><span class="id"> mulr_ge0_gt0</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-|x0]</span><span class="id"> _;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul0e</span><span class="id"> ltxx</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltry</span><span class="id"> andbT</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> lte_fin</span><span class="id"> x0</span><span class="id"> ltry</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-|x0]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mule0</span><span class="id"> ltxx</span><span class="id"> andbC</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltry/=</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> lte_fin</span><span class="id"> x0</span><span class="id"> ltry</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> _</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mulyy</span><span class="id"> ltry</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gt0_mulye</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> +oo</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> +oo</span>)<span class="id">%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|_|//];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulyy</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lte_fin</span><span class="id"> =&gt;</span><span class="id"> x0;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lt0_mulye</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> +oo</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> -oo</span>)<span class="id">%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|//|_];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulyNy</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lte_fin</span><span class="id"> =&gt;</span><span class="id"> x0;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> mulr_infty</span><span class="id"> ltr0_sg//</span><span class="id"> mulN1e</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gt0_mulNye</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> -oo</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> -oo</span>)<span class="id">%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|_|//];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulNyy</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lte_fin</span><span class="id"> =&gt;</span><span class="id"> x0;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lt0_mulNye</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> -oo</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> +oo</span>)<span class="id">%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|//|_];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulNyNy</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lte_fin</span><span class="id"> =&gt;</span><span class="id"> x0;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> mulr_infty</span><span class="id"> ltr0_sg//</span><span class="id"> mulN1e</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gt0_muley</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> +oo</span><span class="id"> =</span><span class="id"> +oo</span>)<span class="id">%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /gt0_mulye;</span><span class="id"> rewrite</span><span class="id"> muleC;</span><span class="id"> apply</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lt0_muley</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> +oo</span><span class="id"> =</span><span class="id"> -oo</span>)<span class="id">%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /lt0_mulye;</span><span class="id"> rewrite</span><span class="id"> muleC;</span><span class="id"> apply</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gt0_muleNy</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> -oo</span><span class="id"> =</span><span class="id"> -oo</span>)<span class="id">%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /gt0_mulNye;</span><span class="id"> rewrite</span><span class="id"> muleC;</span><span class="id"> apply</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lt0_muleNy</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> -oo</span><span class="id"> =</span><span class="id"> +oo</span>)<span class="id">%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /lt0_mulNye;</span><span class="id"> rewrite</span><span class="id"> muleC;</span><span class="id"> apply</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mule_eq_pinfty</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> +oo</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">[||</span> (<span class="id">x</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> +oo</span>)<span class="id">,</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> -oo</span>)<span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span><span class="id"> ==</span><span class="id"> +oo</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id"> |</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> -oo</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id">]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |];</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">lte_fin,andbF,andbT,orbF,eqxx,andbT</span>)<span class="id">//=</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty;</span><span class="id"> have</span><span class="id"> [/ltr0_sg|/gtr0_sg|]</span><span class="id"> :=</span><span class="id"> ltgtP</span><span class="id"> x</span><span class="id"> 0%R;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">mulN1e,mul1e,sgr0,mul0e</span>).<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty;</span><span class="id"> have</span><span class="id"> [/ltr0_sg|/gtr0_sg|]</span><span class="id"> :=</span><span class="id"> ltgtP</span><span class="id"> x</span><span class="id"> 0%R;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">mulN1e,mul1e,sgr0,mul0e</span>).<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty;</span><span class="id"> have</span><span class="id"> [/ltr0_sg|/gtr0_sg|]</span><span class="id"> :=</span><span class="id"> ltgtP</span><span class="id"> y</span><span class="id"> 0%R;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">mulN1e,mul1e,sgr0,mul0e</span>).<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulyy</span><span class="id"> ltry</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulyNy</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty;</span><span class="id"> have</span><span class="id"> [/ltr0_sg|/gtr0_sg|]</span><span class="id"> :=</span><span class="id"> ltgtP</span><span class="id"> y</span><span class="id"> 0%R;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">mulN1e,mul1e,sgr0,mul0e</span>).<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulNyy</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltNyr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mule_eq_ninfty</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> -oo</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">[||</span> (<span class="id">x</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> -oo</span>)<span class="id">,</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> +oo</span>)<span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span><span class="id"> ==</span><span class="id"> -oo</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id"> |</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> +oo</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id">]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> :=</span><span class="id"> mule_eq_pinfty</span><span class="id"> x</span> (<span class="id">-</span><span class="id"> y</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> muleN</span><span class="id"> eqe_oppLR</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !eqe_oppLR</span><span class="id"> lteNr</span><span class="id"> lteNl</span><span class="id"> oppe0</span> (<span class="id">orbC</span><span class="id"> _</span> ((<span class="id">x</span><span class="id"> ==</span><span class="id"> -oo</span>)<span class="id"> &amp;&amp;</span><span class="id"> _</span>)).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteD</span><span class="id"> a</span><span class="id"> b</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> a</span><span class="id"> &lt;</span><span class="id"> b</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> b</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> a</span><span class="id"> b</span><span class="id"> x</span><span class="id"> y=&gt;</span><span class="id"> [a|</span><span class="id"> |]</span><span class="id"> [b|</span><span class="id"> |]</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |];</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">ltry,ltNyr</span>)<span class="id">//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !lte_fin;</span><span class="id"> exact:</span><span class="id"> ltrD</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leeDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> -[</span><span class="id"> x</span><span class="id"> [y|</span><span class="id"> |]//=</span><span class="id"> |</span><span class="id"> [|</span><span class="id"> |]//</span><span class="id"> |</span><span class="id"> [|</span><span class="id"> |</span><span class="id"> ]//];</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> [rewrite</span><span class="id"> !lee_fin</span><span class="id"> lerDl</span><span class="id"> |</span><span class="id"> move=&gt;</span><span class="id"> _;</span><span class="id"> exact:</span><span class="id"> leey]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leeDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> +</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> addeC;</span><span class="id"> exact:</span><span class="id"> leeDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> geeDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> -[</span><span class="id"> x</span><span class="id"> [y|</span><span class="id"> |]//=</span><span class="id"> |</span><span class="id"> [|</span><span class="id"> |]//</span><span class="id"> |</span><span class="id"> [|</span><span class="id"> |</span><span class="id"> ]//];</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> [rewrite</span><span class="id"> !lee_fin</span><span class="id"> gerDl</span><span class="id"> |</span><span class="id"> move=&gt;</span><span class="id"> _;</span><span class="id"> exact:</span><span class="id"> leNye]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> geeDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> rewrite</span><span class="id"> addeC;</span><span class="id"> exact:</span><span class="id"> geeDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteDl</span><span class="id"> y</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> _</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> ?ltry</span><span class="id"> ?ltNyr</span><span class="id"> //</span><span class="id"> !lte_fin</span><span class="id"> ltrDl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteDr</span><span class="id"> y</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> rewrite</span><span class="id"> addeC;</span><span class="id"> exact:</span><span class="id"> lteDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gte_subl</span><span class="id"> y</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> y</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> _</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> addeC</span><span class="id"> /=</span><span class="id"> ?ltNyr</span><span class="id"> ?ltry//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !lte_fin</span><span class="id"> gtrDr</span><span class="id"> ltrNl</span><span class="id"> oppr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gte_subr</span><span class="id"> y</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> addeC;</span><span class="id"> exact:</span><span class="id"> gte_subl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gteDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [r|</span><span class="id"> |]</span><span class="id"> [s|</span><span class="id"> |]//</span><span class="id"> _;</span><span class="id"> [rewrite</span><span class="id"> !lte_fin</span><span class="id"> gtrDl|rewrite</span><span class="id"> !ltNyr]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gteDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> addeC;</span><span class="id"> exact:</span><span class="id"> gteDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteD2lE</span><span class="id"> x</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> a</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> b</span>)<span class="id"> =</span> (<span class="id">a</span><span class="id"> &lt;</span><span class="id"> b</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> a</span><span class="id"> b</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [a|</span><span class="id"> |]</span><span class="id"> [b|</span><span class="id"> |]</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> _</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">ltry,</span><span class="id"> ltNyr</span>)<span class="id">//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !lte_fin</span><span class="id"> ltrD2l</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteD2rE</span><span class="id"> x</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">a</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> b</span><span class="id"> +</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">a</span><span class="id"> &lt;</span><span class="id"> b</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -!</span>(<span class="id">addeC</span><span class="id"> x</span>)<span class="id">;</span><span class="id"> exact:</span><span class="id"> lteD2lE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leeD2l</span><span class="id"> x</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> +</span><span class="id"> b</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> a</span><span class="id"> b</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> -[a</span><span class="id"> [b</span><span class="id"> [x</span><span class="id"> /=|//|//]</span><span class="id"> |</span><span class="id"> []//</span><span class="id"> |//]</span><span class="id"> |</span><span class="id"> []//</span><span class="id"> |</span><span class="id"> ]</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !lee_fin</span><span class="id"> lerD2l</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> r</span><span class="id"> _;</span><span class="id"> exact:</span><span class="id"> leey</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> -[b</span><span class="id"> [|</span> <span class="id"> |]//</span><span class="id"> |</span><span class="id"> []//</span><span class="id"> |</span><span class="id"> //]</span><span class="id"> r</span><span class="id"> oob;</span><span class="id"> exact:</span><span class="id"> leNye</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leeD2lE</span><span class="id"> x</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> +</span><span class="id"> b</span>)<span class="id"> =</span> (<span class="id">a</span><span class="id"> &lt;=</span><span class="id"> b</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> a</span><span class="id"> b</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [a|</span><span class="id"> |]</span><span class="id"> [b|</span><span class="id"> |]</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> _</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">leey,</span><span class="id"> leNye</span>)<span class="id">//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !lee_fin</span><span class="id"> lerD2l</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leeD2rE</span><span class="id"> x</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">a</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> +</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">a</span><span class="id"> &lt;=</span><span class="id"> b</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -!</span>(<span class="id">addeC</span><span class="id"> x</span>)<span class="id">;</span><span class="id"> exact:</span><span class="id"> leeD2lE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leeD2r</span><span class="id"> x</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> +</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> rewrite</span><span class="id"> addeC</span> (<span class="id">addeC</span><span class="id"> b</span>)<span class="id">;</span><span class="id"> exact:</span><span class="id"> leeD2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leeD</span><span class="id"> a</span><span class="id"> b</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> a</span><span class="id"> b</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [a|</span><span class="id"> |]</span><span class="id"> [b|</span><span class="id"> |]</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |];</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">leey,</span><span class="id"> leNye</span>)<span class="id">//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !lee_fin;</span><span class="id"> exact:</span><span class="id"> lerD</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_leD</span><span class="id"> a</span><span class="id"> b</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> b</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> b</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> +</span><span class="id"> b</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> a</span><span class="id"> b</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> [a|</span><span class="id"> |]</span><span class="id"> [b|</span><span class="id"> |]</span><span class="id"> _</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">ltry,</span><span class="id"> ltNyr</span>)<span class="id">//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !lte_fin;</span><span class="id"> exact:</span><span class="id"> ltr_leD</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_ltD</span><span class="id"> a</span><span class="id"> b</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> a</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> b</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> +</span><span class="id"> b</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> afin</span><span class="id"> xa</span><span class="id"> yb;</span><span class="id"> rewrite</span> (<span class="id">addeC</span><span class="id"> a</span>) (<span class="id">addeC</span><span class="id"> x</span>)<span class="id"> lte_leD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leeB</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> u</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> u</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> -</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -</span><span class="id"> u</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> u</span><span class="id"> =&gt;</span><span class="id"> -[x|</span><span class="id"> |]</span><span class="id"> -[y|</span><span class="id"> |]</span><span class="id"> -[z|</span><span class="id"> |]</span><span class="id"> -[u|</span><span class="id"> |]</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">leey,leNye</span>)<span class="id">//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !lee_fin;</span><span class="id"> exact:</span><span class="id"> lerB</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_leB</span><span class="id"> z</span><span class="id"> u</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> u</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> u</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -</span><span class="id"> u</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> z</span><span class="id"> u</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [z|</span><span class="id"> |]</span><span class="id"> [u|</span><span class="id"> |]</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> _</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">ltry,</span><span class="id"> ltNyr</span>)<span class="id">//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !lte_fin</span><span class="id"> =&gt;</span><span class="id"> xltr</span><span class="id"> tley;</span><span class="id"> apply:</span><span class="id"> ltr_leD;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> lerNl</span><span class="id"> opprK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_pmul2r</span><span class="id"> z</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> {mono</span><span class="id"> *%E^~</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> z</span><span class="id"> =&gt;</span><span class="id"> [z|</span><span class="id"> |]</span><span class="id"> _</span><span class="id"> //</span><span class="id"> z0</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !lte_fin</span><span class="id"> ltr_pM2r</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> 2!ltry</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> ltNge</span><span class="id"> leNye</span><span class="id"> ltNge</span><span class="id"> leNye</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> ltNge</span><span class="id"> leey</span><span class="id"> ltNge</span><span class="id"> leey</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> 2!ltNyr</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_pmul2l</span><span class="id"> z</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> {mono</span><span class="id"> *%E</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> zfin</span><span class="id"> z0</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> 2!</span>(<span class="id">muleC</span><span class="id"> z</span>)<span class="id"> lte_pmul2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_nmul2l</span><span class="id"> z</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> {mono</span><span class="id"> *%E</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -oppe0</span><span class="id"> lteNr</span><span class="id"> =&gt;</span><span class="id"> zfin</span><span class="id"> z0</span><span class="id"> x</span><span class="id"> y</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">oppeK</span><span class="id"> z</span>)<span class="id"> !mulNe</span><span class="id"> lteNl</span><span class="id"> oppeK</span><span class="id"> -2!mulNe</span><span class="id"> lte_pmul2l</span><span class="id"> ?fin_numN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_nmul2r</span><span class="id"> z</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> {mono</span><span class="id"> *%E^~</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> zfin</span><span class="id"> z0</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> -!</span>(<span class="id">muleC</span><span class="id"> z</span>)<span class="id"> lte_nmul2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_pmulr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">1</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> yfin</span><span class="id"> y0;</span><span class="id"> rewrite</span><span class="id"> -[X</span><span class="gallina-kwd"> in</span><span class="id"> X</span><span class="id"> &lt;</span><span class="id"> _</span><span class="id"> =</span><span class="id"> _]mule1</span><span class="id"> lte_pmul2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_pmull</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">1</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> yfin</span><span class="id"> y0;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> lte_pmulr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_nmulr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> yfin</span><span class="id"> y0;</span><span class="id"> rewrite</span><span class="id"> -[X</span><span class="gallina-kwd"> in</span><span class="id"> X</span><span class="id"> &lt;</span><span class="id"> _</span><span class="id"> =</span><span class="id"> _]mule1</span><span class="id"> lte_nmul2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_nmull</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> yfin</span><span class="id"> y0;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> lte_nmulr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_sum</span><span class="id"> I</span> (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> s</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> g</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> g</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> Pfg;</span><span class="id"> elim/big_ind2</span><span class="id"> :</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> *;</span><span class="id"> exact:</span><span class="id"> leeD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_sum_nneg_subset</span><span class="id"> I</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> I}</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{subset</span><span class="id"> Q</span><span class="id"> &lt;=</span><span class="id"> P}</span><span class="id"> -&gt;</span><span class="id"> {in</span><span class="id"> [predD</span><span class="id"> P</span><span class="id"> &amp;</span><span class="id"> Q],</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> f</span><span class="id"> i}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> Q</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> QP</span><span class="id"> PQf;</span><span class="id"> rewrite</span><span class="id"> big_mkcond</span><span class="id"> [leRHS]big_mkcond</span><span class="id"> lee_sum//</span><span class="id"> =&gt;</span><span class="id"> i</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move/implyP:</span> (<span class="id">QP</span><span class="id"> i</span>)<span class="id">;</span><span class="id"> move:</span> (<span class="id">PQf</span><span class="id"> i</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> !inE</span><span class="id"> -!topredE/=;</span><span class="id"> do</span><span class="id"> !case:</span><span class="id"> ifP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_sum_npos_subset</span><span class="id"> I</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> I}</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{subset</span><span class="id"> Q</span><span class="id"> &lt;=</span><span class="id"> P}</span><span class="id"> -&gt;</span><span class="id"> {in</span><span class="id"> [predD</span><span class="id"> P</span><span class="id"> &amp;</span><span class="id"> Q],</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> 0}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> Q</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> QP</span><span class="id"> PQf;</span><span class="id"> rewrite</span><span class="id"> big_mkcond</span><span class="id"> [leRHS]big_mkcond</span><span class="id"> lee_sum//</span><span class="id"> =&gt;</span><span class="id"> i</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move/implyP:</span> (<span class="id">QP</span><span class="id"> i</span>)<span class="id">;</span><span class="id"> move:</span> (<span class="id">PQf</span><span class="id"> i</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> !inE</span><span class="id"> -!topredE/=;</span><span class="id"> do</span><span class="id"> !case:</span><span class="id"> ifP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_sum_nneg</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> eqType</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<br/>
&nbsp;&nbsp;(<span class="id">f</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span> (<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> ~~</span><span class="id"> Q</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> f</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span><span class="id"> &amp;&amp;</span><span class="id"> Q</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> PQf;</span><span class="id"> rewrite</span><span class="id"> [leRHS]</span>(<span class="id">bigID</span><span class="id"> Q</span>)<span class="id"> /=</span><span class="id"> -[leLHS]adde0</span><span class="id"> leeD</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> sume_ge0//</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> /andP[];</span><span class="id"> exact:</span><span class="id"> PQf</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_sum_npos</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> eqType</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<br/>
&nbsp;&nbsp;(<span class="id">f</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span> (<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> ~~</span><span class="id"> Q</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span><span class="id"> &amp;&amp;</span><span class="id"> Q</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> PQf;</span><span class="id"> rewrite</span><span class="id"> [leLHS]</span>(<span class="id">bigID</span><span class="id"> Q</span>)<span class="id"> /=</span><span class="id"> -[leRHS]adde0</span><span class="id"> leeD</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> sume_le0//</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> /andP[];</span><span class="id"> exact:</span><span class="id"> PQf</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_sum_nneg_ord</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> nat</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> n,</span><span class="id"> P</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> f</span><span class="id"> n</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{homo</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">f</span><span class="id"> i</span>))<span class="id"> :</span><span class="id"> i</span><span class="id"> j</span><span class="id"> /</span> (<span class="id">i</span><span class="id"> &lt;=</span><span class="id"> j</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> j}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> f0</span><span class="id"> i</span><span class="id"> j</span><span class="id"> le_ij;</span><span class="id"> rewrite</span> (<span class="id">big_ord_widen_cond</span><span class="id"> j</span>)<span class="id"> //</span><span class="id"> big_mkcondr</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lee_sum</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> ?;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> _;</span><span class="id"> exact:</span><span class="id"> f0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_sum_npos_ord</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> nat</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> n,</span><span class="id"> P</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{homo</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">f</span><span class="id"> i</span>))<span class="id"> :</span><span class="id"> i</span><span class="id"> j</span><span class="id"> /</span> (<span class="id">i</span><span class="id"> &lt;=</span><span class="id"> j</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> j</span><span class="id"> &lt;=</span><span class="id"> i}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> f0</span><span class="id"> m</span><span class="id"> n</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> [leRHS]</span>(<span class="id">big_ord_widen_cond</span><span class="id"> n</span>)<span class="id"> //</span><span class="id"> big_mkcondr</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lee_sum</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> ?;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> _;</span><span class="id"> exact:</span><span class="id"> f0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_sum_nneg_natr</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> nat</span>)<span class="id"> m</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> n,</span> (<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> f</span><span class="id"> n</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{homo</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> \sum_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">f</span><span class="id"> i</span>))<span class="id"> :</span><span class="id"> i</span><span class="id"> j</span><span class="id"> /</span> (<span class="id">i</span><span class="id"> &lt;=</span><span class="id"> j</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> j}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> f0</span><span class="id"> i</span><span class="id"> j</span><span class="id"> le_ij;</span><span class="id"> rewrite</span><span class="id"> -[m]add0n</span><span class="id"> !big_addn</span><span class="id"> !big_mkord</span>.<br/>
<span class="id">apply:</span> (<span class="id">@lee_sum_nneg_ord</span> (<span class="gallina-kwd">fun</span><span class="id"> k</span><span class="id"> =&gt;</span><span class="id"> f</span> (<span class="id">k</span><span class="id"> +</span><span class="id"> m</span>)<span class="id">%N</span>) (<span class="gallina-kwd">fun</span><span class="id"> k</span><span class="id"> =&gt;</span><span class="id"> P</span> (<span class="id">k</span><span class="id"> +</span><span class="id"> m</span>)<span class="id">%N</span>))<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> [move=&gt;</span><span class="id"> n</span><span class="id"> /f0;</span><span class="id"> apply;</span><span class="id"> rewrite</span><span class="id"> leq_addl</span><span class="id"> |</span><span class="id"> rewrite</span><span class="id"> leq_sub2r]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_sum_npos_natr</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> nat</span>)<span class="id"> m</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> n,</span> (<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{homo</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> \sum_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">f</span><span class="id"> i</span>))<span class="id"> :</span><span class="id"> i</span><span class="id"> j</span><span class="id"> /</span> (<span class="id">i</span><span class="id"> &lt;=</span><span class="id"> j</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> j</span><span class="id"> &lt;=</span><span class="id"> i}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> f0</span><span class="id"> i</span><span class="id"> j</span><span class="id"> le_ij;</span><span class="id"> rewrite</span><span class="id"> -[m]add0n</span><span class="id"> !big_addn</span><span class="id"> !big_mkord</span>.<br/>
<span class="id">apply:</span> (<span class="id">@lee_sum_npos_ord</span> (<span class="gallina-kwd">fun</span><span class="id"> k</span><span class="id"> =&gt;</span><span class="id"> f</span> (<span class="id">k</span><span class="id"> +</span><span class="id"> m</span>)<span class="id">%N</span>) (<span class="gallina-kwd">fun</span><span class="id"> k</span><span class="id"> =&gt;</span><span class="id"> P</span> (<span class="id">k</span><span class="id"> +</span><span class="id"> m</span>)<span class="id">%N</span>))<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> [move=&gt;</span><span class="id"> n</span><span class="id"> /f0;</span><span class="id"> apply;</span><span class="id"> rewrite</span><span class="id"> leq_addl</span><span class="id"> |</span><span class="id"> rewrite</span><span class="id"> leq_sub2r]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_sum_nneg_natl</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> nat</span>)<span class="id"> n</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> m,</span> (<span class="id">m</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> f</span><span class="id"> m</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{homo</span> (<span class="gallina-kwd">fun</span><span class="id"> m</span><span class="id"> =&gt;</span><span class="id"> \sum_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">f</span><span class="id"> i</span>))<span class="id"> :</span><span class="id"> i</span><span class="id"> j</span><span class="id"> /</span> (<span class="id">i</span><span class="id"> &lt;=</span><span class="id"> j</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> j</span><span class="id"> &lt;=</span><span class="id"> i}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> f0</span><span class="id"> i</span><span class="id"> j</span><span class="id"> le_ij;</span><span class="id"> rewrite</span><span class="id"> !big_geq_mkord/=</span>.<br/>
<span class="id">rewrite</span><span class="id"> lee_sum_nneg_subset//</span><span class="id"> =&gt;</span><span class="id"> [k</span><span class="id"> |</span><span class="id"> k</span><span class="id"> /and3P[_</span><span class="id"> /f0-&gt;//]]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ?inE</span><span class="id"> -!topredE/=</span><span class="id"> =&gt;</span><span class="id"> /andP[-&gt;</span><span class="id"> /</span>(<span class="id">leq_trans</span><span class="id"> le_ij</span>)<span class="id">-&gt;]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_sum_npos_natl</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> nat</span>)<span class="id"> n</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> m,</span> (<span class="id">m</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> m</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{homo</span> (<span class="gallina-kwd">fun</span><span class="id"> m</span><span class="id"> =&gt;</span><span class="id"> \sum_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">f</span><span class="id"> i</span>))<span class="id"> :</span><span class="id"> i</span><span class="id"> j</span><span class="id"> /</span> (<span class="id">i</span><span class="id"> &lt;=</span><span class="id"> j</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> j}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> f0</span><span class="id"> i</span><span class="id"> j</span><span class="id"> le_ij;</span><span class="id"> rewrite</span><span class="id"> !big_geq_mkord/=</span>.<br/>
<span class="id">rewrite</span><span class="id"> lee_sum_npos_subset//</span><span class="id"> =&gt;</span><span class="id"> [k</span><span class="id"> |</span><span class="id"> k</span><span class="id"> /and3P[_</span><span class="id"> /f0-&gt;//]]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ?inE</span><span class="id"> -!topredE/=</span><span class="id"> =&gt;</span><span class="id"> /andP[-&gt;</span><span class="id"> /</span>(<span class="id">leq_trans</span><span class="id"> le_ij</span>)<span class="id">-&gt;]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_sum_nneg_subfset</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> choiceType</span>) (<span class="id">A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> {fset</span><span class="id"> T}%fset</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> T</span>)<br/>
&nbsp;&nbsp;(<span class="id">f</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> {subset</span><span class="id"> A</span><span class="id"> &lt;=</span><span class="id"> B}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> [predD</span><span class="id"> B</span><span class="id"> &amp;</span><span class="id"> A],</span><span class="gallina-kwd"> forall</span><span class="id"> t,</span><span class="id"> P</span><span class="id"> t</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> f</span><span class="id"> t}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">t</span><span class="id"> &lt;-</span><span class="id"> A</span><span class="id"> |</span><span class="id"> P</span><span class="id"> t</span>)<span class="id"> f</span><span class="id"> t</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">t</span><span class="id"> &lt;-</span><span class="id"> B</span><span class="id"> |</span><span class="id"> P</span><span class="id"> t</span>)<span class="id"> f</span><span class="id"> t</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> AB</span><span class="id"> f0;</span><span class="id"> rewrite</span><span class="id"> [leRHS]big_mkcond</span> (<span class="id">big_fsetID</span><span class="id"> _</span> (<span class="id">mem</span><span class="id"> A</span>)<span class="id"> B</span>)<span class="id"> /=</span>.<br/>
<span class="id">rewrite</span><span class="id"> -[leLHS]adde0</span><span class="id"> leeD</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -big_mkcond</span><span class="id"> /=</span><span class="id"> {1}</span>(_<span class="id"> :</span><span class="id"> A</span><span class="id"> =</span><span class="id"> [fset</span><span class="id"> x</span><span class="gallina-kwd"> in</span><span class="id"> B</span><span class="id"> |</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> A]%fset</span>)<span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/fsetP=&gt;</span><span class="id"> t;</span><span class="id"> rewrite</span><span class="id"> !inE</span><span class="id"> /=</span><span class="id"> andbC;</span><span class="id"> case:</span> (<span class="id">boolP</span> (_<span class="id"> \in</span><span class="id"> _</span>))<span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> /AB</span>.<br/>
<span class="id">rewrite</span><span class="id"> big_fset</span><span class="id"> /=</span><span class="id"> big_seq_cond</span><span class="id"> sume_ge0</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> t</span><span class="id"> /andP[tB</span><span class="id"> tA]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> Pt;</span><span class="id"> rewrite</span><span class="id"> f0</span><span class="id"> //</span><span class="id"> !inE</span><span class="id"> tA</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_sum_npos_subfset</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> choiceType</span>) (<span class="id">A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> {fset</span><span class="id"> T}%fset</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> T</span>)<br/>
&nbsp;&nbsp;(<span class="id">f</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> {subset</span><span class="id"> A</span><span class="id"> &lt;=</span><span class="id"> B}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> [predD</span><span class="id"> B</span><span class="id"> &amp;</span><span class="id"> A],</span><span class="gallina-kwd"> forall</span><span class="id"> t,</span><span class="id"> P</span><span class="id"> t</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> t</span><span class="id"> &lt;=</span><span class="id"> 0}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">t</span><span class="id"> &lt;-</span><span class="id"> B</span><span class="id"> |</span><span class="id"> P</span><span class="id"> t</span>)<span class="id"> f</span><span class="id"> t</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">t</span><span class="id"> &lt;-</span><span class="id"> A</span><span class="id"> |</span><span class="id"> P</span><span class="id"> t</span>)<span class="id"> f</span><span class="id"> t</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> AB</span><span class="id"> f0;</span><span class="id"> rewrite</span><span class="id"> big_mkcond</span> (<span class="id">big_fsetID</span><span class="id"> _</span> (<span class="id">mem</span><span class="id"> A</span>)<span class="id"> B</span>)<span class="id"> /=</span>.<br/>
<span class="id">rewrite</span><span class="id"> -[leRHS]adde0</span><span class="id"> leeD</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -big_mkcond</span><span class="id"> /=</span><span class="id"> {3}</span>(_<span class="id"> :</span><span class="id"> A</span><span class="id"> =</span><span class="id"> [fset</span><span class="id"> x</span><span class="gallina-kwd"> in</span><span class="id"> B</span><span class="id"> |</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> A]%fset</span>)<span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/fsetP=&gt;</span><span class="id"> t;</span><span class="id"> rewrite</span><span class="id"> !inE</span><span class="id"> /=</span><span class="id"> andbC;</span><span class="id"> case:</span> (<span class="id">boolP</span> (_<span class="id"> \in</span><span class="id"> _</span>))<span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> /AB</span>.<br/>
<span class="id">rewrite</span><span class="id"> big_fset</span><span class="id"> /=</span><span class="id"> big_seq_cond</span><span class="id"> sume_le0</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> t</span><span class="id"> /andP[tB</span><span class="id"> tA]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> Pt;</span><span class="id"> rewrite</span><span class="id"> f0</span><span class="id"> //</span><span class="id"> !inE</span><span class="id"> tA</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteBlDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> +</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> [z|</span><span class="id"> |]</span><span class="id"> _</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?ltry</span><span class="id"> ?ltNyr</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !lte_fin</span><span class="id"> ltrBlDr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteBlDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> lteBlDr//</span><span class="id"> addeC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteBrDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> [z|</span><span class="id"> |]</span><span class="id"> _</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?ltNyr</span><span class="id"> ?ltry</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !lte_fin</span><span class="id"> ltrBrDr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lteBrDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">z</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> lteBrDr//</span><span class="id"> addeC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_subel_addr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> +</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> [z|</span><span class="id"> |]</span><span class="id"> _</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?ltNyr</span><span class="id"> ?ltry</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !lte_fin</span><span class="id"> ltrBlDr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_subel_addl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> lte_subel_addr//</span><span class="id"> addeC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_suber_addr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> [z|</span><span class="id"> |]</span><span class="id"> _</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?ltNyr</span><span class="id"> ?ltry</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !lte_fin</span><span class="id"> ltrBrDr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_suber_addl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">z</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> lte_suber_addr//</span><span class="id"> addeC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leeBlDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> +</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> [z|</span><span class="id"> |]</span><span class="id"> _</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?leey</span><span class="id"> ?leNye</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !lee_fin</span><span class="id"> lerBlDr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leeBlDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> +</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> leeBlDr//</span><span class="id"> addeC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leeBrDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> =&gt;</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [z|</span><span class="id"> |]</span><span class="id"> _</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?leNye</span><span class="id"> ?leey</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !lee_fin</span><span class="id"> lerBrDr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> leeBrDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">z</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> leeBrDr//</span><span class="id"> addeC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_subel_addr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> +</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> [z|</span><span class="id"> |]</span><span class="id"> _</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?leey</span><span class="id"> ?leNye</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !lee_fin</span><span class="id"> lerBlDr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_subel_addl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> +</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> lee_subel_addr//</span><span class="id"> addeC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_suber_addr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> =&gt;</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [z|</span><span class="id"> |]</span><span class="id"> _</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?leNye</span><span class="id"> ?leey</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !lee_fin</span><span class="id"> lerBrDr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_suber_addl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">z</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> lee_suber_addr//</span><span class="id"> addeC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> subre_lt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> lte_subel_addr//</span><span class="id"> add0e</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> suber_lt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> lteBlDl//</span><span class="id"> adde0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sube_lt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> ||</span> (<span class="id">y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /orP[?|?];</span><span class="id"> [rewrite</span><span class="id"> subre_lt0|rewrite</span><span class="id"> suber_lt0]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmule_rge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &gt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &gt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x_gt0;</span><span class="id"> apply/idP/idP;</span><span class="id"> last</span><span class="id"> exact/mule_ge0/ltW</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> contra_le;</span><span class="id"> apply:</span><span class="id"> mule_gt0_lt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmule_lge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &gt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &gt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> muleC;</span><span class="id"> apply:</span><span class="id"> pmule_rge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmule_rlt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /pmule_rge0;</span><span class="id"> rewrite</span><span class="id"> !ltNge</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmule_llt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> muleC;</span><span class="id"> apply:</span><span class="id"> pmule_rlt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmule_rle0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> xgt0;</span><span class="id"> rewrite</span><span class="id"> -oppe_ge0</span><span class="id"> -muleN</span><span class="id"> pmule_rge0</span><span class="id"> ?oppe_ge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmule_lle0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> muleC;</span><span class="id"> apply:</span><span class="id"> pmule_rle0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmule_rgt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &gt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> xgt0;</span><span class="id"> rewrite</span><span class="id"> -oppe_lt0</span><span class="id"> -muleN</span><span class="id"> pmule_rlt0</span><span class="id"> ?oppe_lt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pmule_lgt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &gt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> muleC;</span><span class="id"> apply:</span><span class="id"> pmule_rgt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nmule_rge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &gt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -oppe_gt0</span><span class="id"> =&gt;</span><span class="id"> /pmule_rle0&lt;-;</span><span class="id"> rewrite</span><span class="id"> mulNe</span><span class="id"> oppe_le0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nmule_lge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &gt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> muleC;</span><span class="id"> apply:</span><span class="id"> nmule_rge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nmule_rle0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &gt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -oppe_gt0</span><span class="id"> =&gt;</span><span class="id"> /pmule_rge0&lt;-;</span><span class="id"> rewrite</span><span class="id"> mulNe</span><span class="id"> oppe_ge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nmule_lle0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &gt;=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> muleC;</span><span class="id"> apply:</span><span class="id"> nmule_rle0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nmule_rgt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -oppe_gt0</span><span class="id"> =&gt;</span><span class="id"> /pmule_rlt0&lt;-;</span><span class="id"> rewrite</span><span class="id"> mulNe</span><span class="id"> oppe_lt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nmule_lgt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> muleC;</span><span class="id"> apply:</span><span class="id"> nmule_rgt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nmule_rlt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &gt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -oppe_gt0</span><span class="id"> =&gt;</span><span class="id"> /pmule_rgt0&lt;-;</span><span class="id"> rewrite</span><span class="id"> mulNe</span><span class="id"> oppe_gt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nmule_llt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &gt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> muleC;</span><span class="id"> apply:</span><span class="id"> nmule_rlt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mule_lt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span><span class="id"> [&amp;&amp;</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0,</span><span class="id"> y</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> &amp;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>) (<span class="id">+</span>) (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id">]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [xlt0|xgt0|-&gt;]</span><span class="id"> :=</span><span class="id"> ltgtP</span><span class="id"> x</span><span class="id"> 0;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul0e</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> nmule_rlt0//=</span><span class="id"> -leNgt</span><span class="id"> lt_def</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> pmule_rlt0//=</span><span class="id"> !lt_neqAle</span><span class="id"> andbA</span><span class="id"> andbb</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> muleA</span><span class="id"> :</span><span class="id"> associative</span> (<span class="id"> *%E</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span> ).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span>.<br/>
<span class="id">wlog</span><span class="id"> x0</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> /</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [hwlog|]</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [x0|</span><span class="id"> |-&gt;]</span><span class="id"> :=</span><span class="id"> ltgtP</span><span class="id"> x</span><span class="id"> 0;</span><span class="id"> [</span><span class="id"> |exact:</span><span class="id"> hwlog|by</span><span class="id"> rewrite</span><span class="id"> !mul0e]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> oppe_inj;</span><span class="id"> rewrite</span><span class="id"> -!mulNe</span><span class="id"> hwlog</span><span class="id"> ?oppe_gt0</span>.<br/>
<span class="id">wlog</span><span class="id"> y0</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> x0</span><span class="id"> /</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [hwlog|]</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [y0|</span><span class="id"> |-&gt;]</span><span class="id"> :=</span><span class="id"> ltgtP</span><span class="id"> y</span><span class="id"> 0;</span><span class="id"> [</span><span class="id"> |exact:</span><span class="id"> hwlog|by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">mul0e,</span><span class="id"> mule0</span>)<span class="id">]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> oppe_inj;</span><span class="id"> rewrite</span><span class="id"> -muleN</span><span class="id"> -2!mulNe</span><span class="id"> -muleN</span><span class="id"> hwlog</span><span class="id"> ?oppe_gt0</span>.<br/>
<span class="id">wlog</span><span class="id"> z0</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> x0</span><span class="id"> y0</span><span class="id"> /</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> =&gt;</span><span class="id"> [hwlog|]</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [z0|</span><span class="id"> |-&gt;]</span><span class="id"> :=</span><span class="id"> ltgtP</span><span class="id"> z</span><span class="id"> 0;</span><span class="id"> [</span><span class="id"> |exact:</span><span class="id"> hwlog|by</span><span class="id"> rewrite</span><span class="id"> !mule0]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> oppe_inj;</span><span class="id"> rewrite</span><span class="id"> -!muleN</span><span class="id"> hwlog</span><span class="id"> ?oppe_gt0</span>.<br/>
<span class="id">case:</span><span class="id"> x</span><span class="id"> x0</span><span class="id"> =&gt;</span><span class="id"> [x</span><span class="id"> x0|</span><span class="id"> |//];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !gt0_mulye</span><span class="id"> ?mule_gt0</span>.<br/>
<span class="id">case:</span><span class="id"> y</span><span class="id"> y0</span><span class="id"> =&gt;</span><span class="id"> [y</span><span class="id"> y0|</span><span class="id"> |//];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> gt0_mulye</span><span class="id"> //</span><span class="id"> muleC</span><span class="id"> !gt0_mulye</span>.<br/>
<span class="id">case:</span><span class="id"> z</span><span class="id"> z0</span><span class="id"> =&gt;</span><span class="id"> [z</span><span class="id"> z0|</span><span class="id"> |//];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !gt0_muley</span><span class="id"> ?mule_gt0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /mule/=</span><span class="id"> mulrA</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> ereal_scope</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Monoid</span>.<span class="id">isComLaw</span>.<span class="id">Build</span> (<span class="id">\bar</span><span class="id"> R</span>)<span class="id"> 1%E</span><span class="id"> mule</span><br/>
&nbsp;&nbsp;<span class="id">muleA</span><span class="id"> muleC</span><span class="id"> mul1e</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> muleCA</span><span class="id"> :</span><span class="id"> left_commutative</span> (<span class="id"> *%E</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span> ).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> Monoid</span>.<span class="id">mulmCA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> muleAC</span><span class="id"> :</span><span class="id"> right_commutative</span> (<span class="id"> *%E</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span> ).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> Monoid</span>.<span class="id">mulmAC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> muleACA</span><span class="id"> :</span><span class="id"> interchange</span> (<span class="id">@mule</span><span class="id"> R</span>) (<span class="id">@mule</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> Monoid</span>.<span class="id">mulmACA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> muleDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> +?</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span> (<span class="id">y</span><span class="id"> +</span><span class="id"> z</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> +</span><span class="id"> x</span><span class="id"> *</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /mule/=;</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> [z|</span><span class="id"> |]</span><span class="id"> //=</span><span class="id"> _;</span><span class="id"> try</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> ltgtP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> -[]</span><span class="id"> &lt;-;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">mul0r,add0r,adde0</span>))<br/>
&nbsp;&nbsp;<span class="id">||</span> (<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> ltgtP</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> adde0</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrDr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> muleDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> +?</span><span class="id"> z</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> +</span><span class="id"> z</span>)<span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> +</span><span class="id"> z</span><span class="id"> *</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> -!</span>(<span class="id">muleC</span><span class="id"> x</span>)<span class="id"> muleDr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> muleBr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> +?</span><span class="id"> -</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> -</span><span class="id"> x</span><span class="id"> *</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?</span><span class="id"> yz;</span><span class="id"> rewrite</span><span class="id"> muleDr</span><span class="id"> ?muleN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> muleBl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> +?</span><span class="id"> -</span><span class="id"> z</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> -</span><span class="id"> z</span><span class="id"> *</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?</span><span class="id"> yz;</span><span class="id"> rewrite</span><span class="id"> muleDl//</span><span class="id"> mulNe</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ge0_muleDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> +</span><span class="id"> z</span>)<span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> +</span><span class="id"> z</span><span class="id"> *</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /mule/=;</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =&gt;</span><span class="id"> [r|</span><span class="id"> |]</span><span class="id"> [s|</span><span class="id"> |]</span><span class="id"> [t|</span><span class="id"> |]</span><span class="id"> //=</span><span class="id"> s0</span><span class="id"> t0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrDl</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> ltgtP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> -[]</span><span class="id"> &lt;-;</span><span class="id"> rewrite</span><span class="id"> mulr0</span><span class="id"> adde0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> ltgtP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> -[]</span><span class="id"> &lt;-;</span><span class="id"> rewrite</span><span class="id"> mulr0</span><span class="id"> adde0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> ltgtP</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> adde0</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> !eqe</span><span class="id"> paddr_eq0</span><span class="id"> //;</span><span class="id"> move:</span><span class="id"> s0;</span><span class="id"> rewrite</span><span class="id"> lee_fin</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span> (<span class="id">ltgtP</span><span class="id"> s</span>)<span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> [s0|-&gt;{s}]</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> ?add0e</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="id"> rewrite</span><span class="id"> lte_fin</span><span class="id"> -[in</span><span class="id"> LHS]</span>(<span class="id">addr0</span><span class="id"> 0%R</span>)<span class="id"> ltr_leD</span><span class="id"> //</span><span class="id"> lte_fin</span><span class="id"> s0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> ltgtP</span><span class="id"> t0</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> [t0|[&lt;-{t}]]</span><span class="id"> _;</span><span class="id"> [rewrite</span><span class="id"> gt_eqF|rewrite</span><span class="id"> eqxx]</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> t0;</span><span class="id"> rewrite</span><span class="id"> lee_fin;</span><span class="id"> case:</span> (<span class="id">ltgtP</span><span class="id"> t</span>).<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltry;</span><span class="id"> case:</span><span class="id"> ltgtP</span><span class="id"> s0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltry;</span><span class="id"> case:</span><span class="id"> ltgtP</span><span class="id"> t0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltry</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> !eqe</span><span class="id"> paddr_eq0</span><span class="id"> //;</span><span class="id"> move:</span><span class="id"> s0;</span><span class="id"> rewrite</span><span class="id"> lee_fin</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span> (<span class="id">ltgtP</span><span class="id"> s</span>)<span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> [s0|-&gt;{s}]</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> ?add0e</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="id"> rewrite</span><span class="id"> lte_fin</span><span class="id"> -[in</span><span class="id"> LHS]</span>(<span class="id">addr0</span><span class="id"> 0%R</span>)<span class="id"> ltr_leD</span><span class="id"> //</span><span class="id"> lte_fin</span><span class="id"> s0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> ltgtP</span><span class="id"> t0</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> [t0|[&lt;-{t}]]</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> t0;</span><span class="id"> rewrite</span><span class="id"> lee_fin;</span><span class="id"> case:</span> (<span class="id">ltgtP</span><span class="id"> t</span>).<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltry;</span><span class="id"> case:</span><span class="id"> ltgtP</span><span class="id"> s0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltry;</span><span class="id"> case:</span><span class="id"> ltgtP</span><span class="id"> s0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltry;</span><span class="id"> case:</span><span class="id"> ltgtP</span><span class="id"> s0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ge0_muleDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span> (<span class="id">y</span><span class="id"> +</span><span class="id"> z</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> +</span><span class="id"> x</span><span class="id"> *</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> y0</span><span class="id"> z0;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">muleC</span><span class="id"> x</span>)<span class="id"> ge0_muleDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> le0_muleDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> +</span><span class="id"> z</span>)<span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> +</span><span class="id"> z</span><span class="id"> *</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /mule/=;</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =&gt;</span><span class="id"> [r|</span><span class="id"> |]</span><span class="id"> [s|</span><span class="id"> |]</span><span class="id"> [t|</span><span class="id"> |]</span><span class="id"> //=</span><span class="id"> s0</span><span class="id"> t0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrDl</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> ltgtP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> -[]</span><span class="id"> &lt;-;</span><span class="id"> rewrite</span><span class="id"> mulr0</span><span class="id"> adde0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> ltgtP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> -[]</span><span class="id"> &lt;-;</span><span class="id"> rewrite</span><span class="id"> mulr0</span><span class="id"> adde0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> ltgtP</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> adde0</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> !eqe</span><span class="id"> naddr_eq0</span><span class="id"> //;</span><span class="id"> move:</span><span class="id"> s0;</span><span class="id"> rewrite</span><span class="id"> lee_fin</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span> (<span class="id">ltgtP</span><span class="id"> s</span>)<span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> [s0|-&gt;{s}]</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> ?add0e</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="id"> rewrite</span><span class="id"> !lte_fin</span><span class="id"> -[in</span><span class="id"> LHS]</span>(<span class="id">addr0</span><span class="id"> 0%R</span>)<span class="id"> ltNge</span><span class="id"> lerD</span><span class="id"> //</span><span class="id"> ?ltW</span><span class="id"> //=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !ltNge</span><span class="id"> ltW</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> case:</span> (<span class="id">ltgtP</span><span class="id"> t</span>).<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltry;</span><span class="id"> case:</span><span class="id"> ltgtP</span><span class="id"> s0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltry;</span><span class="id"> case:</span><span class="id"> ltgtP</span><span class="id"> t0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltry</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> !eqe</span><span class="id"> naddr_eq0</span><span class="id"> //;</span><span class="id"> move:</span><span class="id"> s0;</span><span class="id"> rewrite</span><span class="id"> lee_fin</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span> (<span class="id">ltgtP</span><span class="id"> s</span>)<span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> [s0|-&gt;{s}]</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> ?add0e</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="id"> rewrite</span><span class="id"> !lte_fin</span><span class="id"> -[in</span><span class="id"> LHS]</span>(<span class="id">addr0</span><span class="id"> 0%R</span>)<span class="id"> ltNge</span><span class="id"> lerD</span><span class="id"> //</span><span class="id"> ?ltW</span><span class="id"> //=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !ltNge</span><span class="id"> ltW</span><span class="id"> //</span><span class="id"> -lee_fin</span><span class="id"> t0;</span><span class="id"> case:</span><span class="id"> eqP</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> case:</span> (<span class="id">ltgtP</span><span class="id"> t</span>).<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltNge</span><span class="id"> s0</span><span class="id"> /=;</span><span class="id"> case:</span><span class="id"> eqP</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltNge</span><span class="id"> t0</span><span class="id"> /=;</span><span class="id"> case:</span><span class="id"> eqP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> le0_muleDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span> (<span class="id">y</span><span class="id"> +</span><span class="id"> z</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> +</span><span class="id"> x</span><span class="id"> *</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> y0</span><span class="id"> z0;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">muleC</span><span class="id"> x</span>)<span class="id"> le0_muleDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gee_pMl</span><span class="id"> y</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> yfin;</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-|];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mule0</span>.<br/>
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> yfin</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //=</span><span class="id"> _</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lte_fin</span><span class="id"> =&gt;</span><span class="id"> x0</span><span class="id"> y1;</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> ger_pMl</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> /mule/=</span><span class="id"> eqe</span><span class="id"> =&gt;</span><span class="id"> r1;</span><span class="id"> rewrite</span><span class="id"> leey</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_wpmul2r</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> {homo</span><span class="id"> *%E^~</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> z</span><span class="id"> /</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|_|//]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> lee_fin</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-</span><span class="id"> y</span><span class="id"> z|x0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> 2!mule0</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> [z|</span><span class="id"> |]//;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !lee_fin//</span><span class="id"> ler_pM2r</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> leey</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> leNye</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> 2!mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> 2!mul1e</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> [z|</span><span class="id"> |]//</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> =&gt;</span><span class="id"> yz</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [z0|z0|]</span><span class="id"> :=</span><span class="id"> ltgtP</span><span class="id"> 0%R</span><span class="id"> z</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [leRHS]mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> leey</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> ltr0_sg//</span><span class="id"> ?</span>(<span class="id">le_lt_trans</span><span class="id"> yz</span>)<span class="id">//</span><span class="id"> [leRHS]mulr_infty</span><span class="id"> ltr0_sg</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="id"> move=&gt;</span><span class="id"> z0;</span><span class="id"> move:</span><span class="id"> yz;</span><span class="id"> rewrite</span><span class="id"> -z0</span><span class="id"> mul0e</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[-&gt;|y0]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mul0e</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> ltr0_sg//</span><span class="id"> mulN1e</span><span class="id"> leNye</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mulyy</span><span class="id"> leey</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mulNyy</span><span class="id"> leNye</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mulNyy</span><span class="id"> leNye</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_wpmul2l</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> {homo</span><span class="id"> *%E</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> z</span><span class="id"> /</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x0</span><span class="id"> y</span><span class="id"> z</span><span class="id"> yz;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">muleC</span><span class="id"> x</span>)<span class="id"> lee_wpmul2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ge0_sume_distrl</span> (<span class="id">I</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>)<span class="id"> x</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> F</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>)<span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">F</span><span class="id"> i</span><span class="id"> *</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> s</span><span class="id"> x</span><span class="id"> P</span><span class="id"> F</span><span class="id"> =&gt;</span><span class="id"> [x</span><span class="id"> P</span><span class="id"> F</span><span class="id"> F0|h</span><span class="id"> t</span><span class="id"> ih</span><span class="id"> x</span><span class="id"> P</span><span class="id"> F</span><span class="id"> F0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> 2!big_nil</span><span class="id"> mul0e</span>.<br/>
<span class="id">rewrite</span><span class="id"> big_cons;</span><span class="id"> case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> Ph;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> big_cons</span> (<span class="id">negbTE</span><span class="id"> Ph</span>)<span class="id"> ih</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ge0_muleDl</span><span class="id"> ?sume_ge0//</span><span class="id"> ?F0//</span><span class="id"> ih//</span><span class="id"> big_cons</span><span class="id"> Ph</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ge0_sume_distrr</span> (<span class="id">I</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>)<span class="id"> x</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> F</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> *</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">x</span><span class="id"> *</span><span class="id"> F</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> F0;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> ge0_sume_distrl//;</span><span class="id"> under</span><span class="id"> eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> muleC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> le0_sume_distrl</span> (<span class="id">I</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>)<span class="id"> x</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> F</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>)<span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">F</span><span class="id"> i</span><span class="id"> *</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> s</span><span class="id"> x</span><span class="id"> P</span><span class="id"> F</span><span class="id"> =&gt;</span><span class="id"> [x</span><span class="id"> P</span><span class="id"> F</span><span class="id"> F0|h</span><span class="id"> t</span><span class="id"> ih</span><span class="id"> x</span><span class="id"> P</span><span class="id"> F</span><span class="id"> F0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> 2!big_nil</span><span class="id"> mul0e</span>.<br/>
<span class="id">rewrite</span><span class="id"> big_cons;</span><span class="id"> case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> Ph;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> big_cons</span> (<span class="id">negbTE</span><span class="id"> Ph</span>)<span class="id"> ih</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> le0_muleDl</span><span class="id"> ?sume_le0//</span><span class="id"> ?F0//</span><span class="id"> ih//</span><span class="id"> big_cons</span><span class="id"> Ph</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> le0_sume_distrr</span> (<span class="id">I</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>)<span class="id"> x</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> F</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> *</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">x</span><span class="id"> *</span><span class="id"> F</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> F0;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> le0_sume_distrl//;</span><span class="id"> under</span><span class="id"> eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> muleC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fin_num_sume_distrr</span> (<span class="id">I</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>)<span class="id"> x</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> {in</span><span class="id"> P</span><span class="id"> &amp;,</span><span class="gallina-kwd"> forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> F</span><span class="id"> i</span><span class="id"> +?</span><span class="id"> F</span><span class="id"> j}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">x</span><span class="id"> *</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> x</span><span class="id"> *</span><span class="id"> F</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xfin</span><span class="id"> PF;</span><span class="id"> elim:</span><span class="id"> s</span><span class="id"> =&gt;</span><span class="id"> [|h</span><span class="id"> t</span><span class="id"> ih];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !big_nil</span><span class="id"> mule0</span>.<br/>
<span class="id">rewrite</span><span class="id"> !big_cons;</span><span class="id"> case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> Ph</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> muleDr//</span><span class="id"> ?ih//</span><span class="id"> adde_def_sum//</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> Pi;</span><span class="id"> rewrite</span><span class="id"> PF</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_infty</span><span class="id"> x</span><span class="id"> :</span> (<span class="gallina-kwd">forall</span><span class="id"> r,</span><span class="id"> r%:E</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> +oo</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x</span><span class="id"> /</span>(_ (<span class="id">x</span><span class="id"> +</span><span class="id"> 1</span>)<span class="id">%R</span>)<span class="id">|//|/</span>(_<span class="id"> 0%R</span>)<span class="id">//]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> EFinD</span><span class="id"> addeC</span><span class="id"> -leeBrDr//</span><span class="id"> subee//</span><span class="id"> lee_fin</span><span class="id"> ler10</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_ninfty</span><span class="id"> x</span><span class="id"> :</span> (<span class="gallina-kwd">forall</span><span class="id"> r,</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> r%:E</span>)<span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> -oo</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> *;</span><span class="id"> apply:</span> (<span class="id">can_inj</span><span class="id"> oppeK</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> eq_infty</span><span class="id"> =&gt;</span><span class="id"> r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> leeNr</span><span class="id"> -EFinN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_abs</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> `|x|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]//=;</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> ler_norm</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> abse_id</span><span class="id"> x</span><span class="id"> :</span><span class="id"> `|</span><span class="id"> `|x|</span><span class="id"> |</span><span class="id"> =</span><span class="id"> `|x|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> normr_id</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_absl</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span> (<span class="id">`|x|</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id">%E</span><span class="id"> =</span> (<span class="id">-</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id">%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?lte_fin</span><span class="id"> ?ltry</span><span class="id"> ?ltNyr//</span><span class="id"> ltr_norml</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqe_absl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">`|x|</span><span class="id"> ==</span><span class="id"> y</span>)<span class="id"> =</span> ((<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span>)<span class="id"> ||</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> -</span><span class="id"> y</span>))<span class="id"> &amp;&amp;</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //=;</span><span class="id"> rewrite?</span><span class="id"> leey//</span><span class="id"> !eqe</span><span class="id"> eqr_norml</span><span class="id"> lee_fin</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_abs_add</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> `|x</span><span class="id"> +</span><span class="id"> y|</span><span class="id"> &lt;=</span><span class="id"> `|x|</span><span class="id"> +</span><span class="id"> `|y|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> /abse</span><span class="id"> -EFinD</span><span class="id"> lee_fin</span><span class="id"> ler_normD</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_abs_sum</span> (<span class="id">I</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">`|\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i|</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> `|F</span><span class="id"> i|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim/big_ind2</span><span class="id"> :</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> abse0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> exact/</span>(<span class="id">le_trans</span> (<span class="id">lee_abs_add</span><span class="id"> _</span><span class="id"> _</span>) (<span class="id">leeD</span><span class="id"> _</span><span class="id"> _</span>)).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_abs_sub</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> `|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;=</span><span class="id"> `|x|</span><span class="id"> +</span><span class="id"> `|y|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> /abse</span><span class="id"> -EFinD</span><span class="id"> lee_fin</span><span class="id"> ler_normB</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> abseM</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> @abse</span><span class="id"> R</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> xoo</span><span class="id"> r</span><span class="id"> :</span><span class="id"> `|r%:E</span><span class="id"> *</span><span class="id"> +oo|</span><span class="id"> =</span><span class="id"> `|r|%:E</span><span class="id"> *</span><span class="id"> +oo</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [r0|r0]</span><span class="id"> :=</span><span class="id"> leP</span><span class="id"> 0%R</span><span class="id"> r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">ger0_norm</span><span class="id"> r0</span>)<span class="id">//</span><span class="id"> gee0_abs//</span><span class="id"> mule_ge0//</span><span class="id"> leey</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">ltr0_norm</span><span class="id"> r0</span>)<span class="id">//</span><span class="id"> lte0_abs//</span><span class="id"> ?EFinN</span><span class="id"> ?mulNe//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mule_lt0</span><span class="id"> /=</span><span class="id"> eqe</span><span class="id"> lt_eqF//=</span><span class="id"> lte_fin</span><span class="id"> r0</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //=;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> normrM</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -abseN</span><span class="id"> -muleNN</span><span class="id"> abseN</span><span class="id"> -EFinN</span><span class="id"> xoo</span><span class="id"> normrN</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> xoo</span><span class="id"> muleC</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulyy</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulyy</span><span class="id"> mulyNy</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -abseN</span><span class="id"> -muleNN</span><span class="id"> abseN</span><span class="id"> -EFinN</span><span class="id"> xoo</span><span class="id"> normrN</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulyy</span><span class="id"> mulNyy</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulyy</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fine_max</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> fin_num</span><span class="id"> &amp;,</span><span class="id"> {mono</span><span class="id"> @fine</span><span class="id"> R</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> maxe</span><span class="id"> x</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span> (<span class="id">Num</span>.<span class="id">max</span><span class="id"> x</span><span class="id"> y</span>)<span class="id">%:E}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]//=</span><span class="id"> _</span><span class="id"> _;</span><span class="id"> apply/esym;</span><span class="id"> have</span><span class="id"> [ab|ba]</span><span class="id"> :=</span><span class="id"> leP</span><span class="id"> x</span><span class="id"> y;</span><br/>
&nbsp;&nbsp;<span class="id">[apply/max_idPr;</span><span class="id"> rewrite</span><span class="id"> lee_fin|apply/max_idPl;</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> ltW]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> EFin_max</span><span class="id"> :</span><span class="id"> {morph</span> (<span class="id">@EFin</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> r</span><span class="id"> s</span><span class="id"> /</span><span class="id"> Num</span>.<span class="id">max</span><span class="id"> r</span><span class="id"> s</span><span class="id"> &gt;-&gt;</span><span class="id"> maxe</span><span class="id"> r</span><span class="id"> s}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a</span><span class="id"> b</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> -fine_max</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fine_min</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> fin_num</span><span class="id"> &amp;,</span><span class="id"> {mono</span><span class="id"> @fine</span><span class="id"> R</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> mine</span><span class="id"> x</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span> (<span class="id">Num</span>.<span class="id">min</span><span class="id"> x</span><span class="id"> y</span>)<span class="id">%:E}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]//=</span><span class="id"> _</span><span class="id"> _;</span><span class="id"> apply/esym;</span><span class="id"> have</span><span class="id"> [ab|ba]</span><span class="id"> :=</span><span class="id"> leP</span><span class="id"> x</span><span class="id"> y;</span><br/>
&nbsp;&nbsp;<span class="id">[apply/min_idPl;</span><span class="id"> rewrite</span><span class="id"> lee_fin|apply/min_idPr;</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> ltW]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> EFin_min</span><span class="id"> :</span><span class="id"> {morph</span> (<span class="id">@EFin</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> r</span><span class="id"> s</span><span class="id"> /</span><span class="id"> Num</span>.<span class="id">min</span><span class="id"> r</span><span class="id"> s</span><span class="id"> &gt;-&gt;</span><span class="id"> mine</span><span class="id"> r</span><span class="id"> s}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a</span><span class="id"> b</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> -fine_min</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> adde_maxl</span><span class="id"> :</span><span class="id"> left_distributive</span> (<span class="id">@GRing</span>.<span class="id">add</span> (<span class="id">\bar</span><span class="id"> R</span>))<span class="id"> maxe</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z;</span><span class="id"> have</span><span class="id"> [xy|yx]</span><span class="id"> :=</span><span class="id"> leP</span><span class="id"> x</span><span class="id"> y</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/esym/max_idPr;</span><span class="id"> rewrite</span><span class="id"> leeD2r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/esym/max_idPl;</span><span class="id"> rewrite</span><span class="id"> leeD2r//</span><span class="id"> ltW</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> adde_maxr</span><span class="id"> :</span><span class="id"> right_distributive</span> (<span class="id">@GRing</span>.<span class="id">add</span> (<span class="id">\bar</span><span class="id"> R</span>))<span class="id"> maxe</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z;</span><span class="id"> have</span><span class="id"> [yz|zy]</span><span class="id"> :=</span><span class="id"> leP</span><span class="id"> y</span><span class="id"> z</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/esym/max_idPr;</span><span class="id"> rewrite</span><span class="id"> leeD2l</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/esym/max_idPl;</span><span class="id"> rewrite</span><span class="id"> leeD2l//</span><span class="id"> ltW</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> maxye</span><span class="id"> :</span><span class="id"> left_zero</span> (<span class="id">+oo</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> maxe</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> have</span><span class="id"> [|//]</span><span class="id"> :=</span><span class="id"> leP</span><span class="id"> +oo</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> leye_eq</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> maxey</span><span class="id"> :</span><span class="id"> right_zero</span> (<span class="id">+oo</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> maxe</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> maxC</span><span class="id"> maxye</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> maxNye</span><span class="id"> :</span><span class="id"> left_id</span> (<span class="id">-oo</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> maxe</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> have</span><span class="id"> [//|]</span><span class="id"> :=</span><span class="id"> leP</span><span class="id"> -oo</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> ltNge</span><span class="id"> leNye</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> maxeNy</span><span class="id"> :</span><span class="id"> right_id</span> (<span class="id">-oo</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> maxe</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> maxC</span><span class="id"> maxNye</span>. Qed.</div></details>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Monoid</span>.<span class="id">isLaw</span>.<span class="id">Build</span> (<span class="id">\bar</span><span class="id"> R</span>)<span class="id"> -oo</span><span class="id"> maxe</span><span class="id"> maxA</span><span class="id"> maxNye</span><span class="id"> maxeNy</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> minNye</span><span class="id"> :</span><span class="id"> left_zero</span> (<span class="id">-oo</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> mine</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> have</span><span class="id"> [|//]</span><span class="id"> :=</span><span class="id"> leP</span><span class="id"> x</span><span class="id"> -oo;</span><span class="id"> rewrite</span><span class="id"> leeNy_eq</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mineNy</span><span class="id"> :</span><span class="id"> right_zero</span> (<span class="id">-oo</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> mine</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> minC</span><span class="id"> minNye</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> minye</span><span class="id"> :</span><span class="id"> left_id</span> (<span class="id">+oo</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> mine</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> have</span><span class="id"> [//|]</span><span class="id"> :=</span><span class="id"> leP</span><span class="id"> x</span><span class="id"> +oo;</span><span class="id"> rewrite</span><span class="id"> ltNge</span><span class="id"> leey</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> miney</span><span class="id"> :</span><span class="id"> right_id</span> (<span class="id">+oo</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> mine</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> minC</span><span class="id"> minye</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> oppe_max</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> -%E</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> maxe</span><span class="id"> x</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span><span class="id"> mine</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //=</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -fine_max//=</span><span class="id"> -fine_min//=</span><span class="id"> oppr_max</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> maxey</span><span class="id"> mineNy</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> miney</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> minNye</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> maxNye</span><span class="id"> minye</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> oppe_min</span><span class="id"> :</span><span class="id"> {morph</span><span class="id"> -%E</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> mine</span><span class="id"> x</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span><span class="id"> maxe</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> -[RHS]oppeK</span><span class="id"> oppe_max</span><span class="id"> !oppeK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> maxeMr</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">z</span><span class="id"> *</span><span class="id"> maxe</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =</span><span class="id"> maxe</span> (<span class="id">z</span><span class="id"> *</span><span class="id"> x</span>) (<span class="id">z</span><span class="id"> *</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /[swap];</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-</span><span class="id"> _|z0]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mul0e</span><span class="id"> maxxx</span>.<br/>
<span class="id">have</span><span class="id"> [xy|yx|-&gt;]</span><span class="id"> :=</span><span class="id"> ltgtP</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> maxxx</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> zfin;</span><span class="id"> rewrite</span><span class="id"> /maxe</span><span class="id"> lte_pmul2l</span><span class="id"> //</span><span class="id"> xy</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> zfin;</span><span class="id"> rewrite</span><span class="id"> maxC</span><span class="id"> /maxe</span><span class="id"> lte_pmul2l//</span><span class="id"> yx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> maxeMl</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">maxe</span><span class="id"> x</span><span class="id"> y</span><span class="id"> *</span><span class="id"> z</span><span class="id"> =</span><span class="id"> maxe</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> z</span>) (<span class="id">y</span><span class="id"> *</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> zfin</span><span class="id"> z0;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> maxeMr//</span><span class="id"> !</span>(<span class="id">muleC</span><span class="id"> z</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mineMr</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">z</span><span class="id"> *</span><span class="id"> mine</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =</span><span class="id"> mine</span> (<span class="id">z</span><span class="id"> *</span><span class="id"> x</span>) (<span class="id">z</span><span class="id"> *</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> fz</span><span class="id"> zge0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -eqe_oppP</span><span class="id"> -muleN</span><span class="id"> [in</span><span class="id"> LHS]oppe_min</span><span class="id"> maxeMr//</span><span class="id"> !muleN</span><span class="id"> -oppe_min</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mineMl</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">mine</span><span class="id"> x</span><span class="id"> y</span><span class="id"> *</span><span class="id"> z</span><span class="id"> =</span><span class="id"> mine</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> z</span>) (<span class="id">y</span><span class="id"> *</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> zfin</span><span class="id"> z0;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> mineMr//</span><span class="id"> !</span>(<span class="id">muleC</span><span class="id"> z</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> bigmaxe_fin_num</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> R</span>)<span class="id"> r</span><span class="id"> :</span><span class="id"> r</span><span class="id"> \in</span><span class="id"> s</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\big[maxe/-oo%E]_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span>)<span class="id"> i%:E</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> rs;</span><span class="id"> have</span><span class="id"> {rs}</span><span class="id"> :</span><span class="id"> s</span><span class="id"> !=</span><span class="id"> [::]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -size_eq0</span><span class="id"> -lt0n</span><span class="id"> -has_predT;</span><span class="id"> apply/hasP;</span><span class="gallina-kwd"> exists</span><span class="id"> r</span>.<br/>
<span class="id">elim:</span><span class="id"> s</span><span class="id"> =&gt;</span><span class="id"> [//|a</span><span class="id"> l];</span><span class="id"> have</span><span class="id"> [-&gt;</span><span class="id"> _</span><span class="id"> _|_</span><span class="id"> /</span>(_<span class="id"> isT</span>)<span class="id"> ih</span><span class="id"> _]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> l</span><span class="id"> [::]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> big_seq1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> big_cons</span><span class="id"> {1}/maxe;</span> <span class="id"> case:</span> (_<span class="id"> &lt;</span><span class="id"> _</span>)<span class="id">%E</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_pemull</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulyy</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -EFinM</span><span class="id"> 3!lee_fin;</span><span class="id"> exact:</span><span class="id"> ler_peMl</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> =&gt;</span><span class="id"> x1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg</span><span class="id"> ?mul1e//</span> (<span class="id">lt_le_trans</span><span class="id"> _</span><span class="id"> x1</span>).<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-</span><span class="id"> _|y0</span><span class="id"> _];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mule0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> leey</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_nemull</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulyNy</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -EFinM</span><span class="id"> 3!lee_fin;</span><span class="id"> exact:</span><span class="id"> ler_neMl</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> =&gt;</span><span class="id"> x1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg</span><span class="id"> ?mul1e//</span> (<span class="id">lt_le_trans</span><span class="id"> _</span><span class="id"> x1</span>).<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[-&gt;</span><span class="id"> _|y0</span><span class="id"> _];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mule0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> ltr0_sg//</span><span class="id"> mulN1e</span><span class="id"> leNye</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_pemulr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> y0</span><span class="id"> x1;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> lee_pemull</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_nemulr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> y0</span><span class="id"> x1;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> lee_nemull</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mule_natl</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> n%:R%:E</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul0e</span>.<br/>
<span class="id">move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> ih</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -EFinM</span><span class="id"> mulr_natl</span><span class="id"> EFin_natmul</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulry</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> enatmul_pinfty</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrNy</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> enatmul_ninfty</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_pmul</span><span class="id"> x1</span><span class="id"> y1</span><span class="id"> x2</span><span class="id"> y2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x1</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x2</span><span class="id"> -&gt;</span><span class="id"> x1</span><span class="id"> &lt;</span><span class="id"> y1</span><span class="id"> -&gt;</span><span class="id"> x2</span><span class="id"> &lt;</span><span class="id"> y2</span><span class="id"> -&gt;</span><span class="id"> x1</span><span class="id"> *</span><span class="id"> x2</span><span class="id"> &lt;</span><span class="id"> y1</span><span class="id"> *</span><span class="id"> y2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x1</span><span class="id"> y1</span><span class="id"> x2</span><span class="id"> y2</span><span class="id"> =&gt;</span><span class="id"> [x1|</span><span class="id"> |]</span><span class="id"> [y1|</span><span class="id"> |]</span><span class="id"> [x2|</span><span class="id"> |]</span><span class="id"> [y2|</span><span class="id"> |]</span><span class="id"> //;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !</span>(<span class="id">lte_fin,lee_fin</span>).<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> ltr_pM</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> x10</span><span class="id"> x20</span><span class="id"> xy1</span><span class="id"> xy2</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulry</span><span class="id"> gtr0_sg</span><span class="id"> ?mul1e</span><span class="id"> -?EFinM</span><span class="id"> ?ltry//</span> (<span class="id">le_lt_trans</span><span class="id"> _</span><span class="id"> xy1</span>).<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> x10</span><span class="id"> x20</span><span class="id"> xy1</span><span class="id"> xy2</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulyr</span><span class="id"> gtr0_sg</span><span class="id"> ?mul1e</span><span class="id"> -?EFinM</span><span class="id"> ?ltry//</span> (<span class="id">le_lt_trans</span><span class="id"> _</span><span class="id"> xy2</span>).<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> mulyy</span><span class="id"> -EFinM</span><span class="id"> ltry</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_pmul</span><span class="id"> x1</span><span class="id"> y1</span><span class="id"> x2</span><span class="id"> y2</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x1</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x2</span><span class="id"> -&gt;</span><span class="id"> x1</span><span class="id"> &lt;=</span><span class="id"> y1</span><span class="id"> -&gt;</span><span class="id"> x2</span><span class="id"> &lt;=</span><span class="id"> y2</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">x1</span><span class="id"> *</span><span class="id"> x2</span><span class="id"> &lt;=</span><span class="id"> y1</span><span class="id"> *</span><span class="id"> y2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x1</span><span class="id"> y1</span><span class="id"> x2</span><span class="id"> y2</span><span class="id"> =&gt;</span><span class="id"> [x1|</span><span class="id"> |]</span><span class="id"> [y1|</span><span class="id"> |]</span><span class="id"> [x2|</span><span class="id"> |]</span><span class="id"> [y2|</span><span class="id"> |]</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> !lee_fin</span>.<br/>
<span class="id">-</span><span class="id"> exact:</span><span class="id"> ler_pM</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-</span><span class="id"> x20</span><span class="id"> y10</span><span class="id"> _|x10</span><span class="id"> x20</span><span class="id"> xy1</span><span class="id"> _]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mul0e</span><span class="id"> mule_ge0//</span><span class="id"> leey</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> ?mul1e</span><span class="id"> ?leey//</span> (<span class="id">lt_le_trans</span><span class="id"> x10</span>).<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-</span><span class="id"> _</span><span class="id"> y10</span><span class="id"> _|x10</span><span class="id"> _</span><span class="id"> xy1</span><span class="id"> _]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mul0e</span><span class="id"> mule_ge0//</span><span class="id"> leey</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> ?mul1e//</span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span> (<span class="id">lt_le_trans</span><span class="id"> x10</span>).<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> x10;</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-</span><span class="id"> _</span><span class="id"> y20|x20</span><span class="id"> _</span><span class="id"> xy2]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mule0</span><span class="id"> mulr_infty</span><span class="id"> mule_ge0//</span><span class="id"> ?leey//</span><span class="id"> lee_fin</span><span class="id"> sgr_ge0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg</span><span class="id"> ?mul1e</span><span class="id"> ?leey//</span> (<span class="id">lt_le_trans</span><span class="id"> x20</span>).<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x10</span><span class="id"> x20</span><span class="id"> _</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> mulyy</span><span class="id"> leey</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _|x10</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulyy</span><span class="id"> mul0e</span><span class="id"> leey</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulyy</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-</span><span class="id"> _</span><span class="id"> y20|x20</span><span class="id"> _</span><span class="id"> xy2]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mule0</span><span class="id"> mulr_infty</span><span class="id"> mule_ge0//</span><span class="id"> ?leey//</span><span class="id"> lee_fin</span><span class="id"> sgr_ge0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg</span><span class="id"> ?mul1e//</span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span> (<span class="id">lt_le_trans</span><span class="id"> x20</span>).<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-</span><span class="id"> _</span><span class="id"> _|x20</span><span class="id"> _</span><span class="id"> _]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mule0</span><span class="id"> mulyy</span><span class="id"> leey</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e//</span><span class="id"> mulyy</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_pmul2l</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> {mono</span><span class="id"> *%E</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x</span><span class="id"> _|//|//]</span><span class="id"> /[!</span>(<span class="id">@lte_fin</span><span class="id"> R</span>)<span class="id">]</span><span class="id"> x0</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> [z|</span><span class="id"> |]</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -2!EFinM</span><span class="id"> 2!lee_fin</span><span class="id"> ler_pM2l</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulry</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> 2!leey</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrNy</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> 2!leeNy_eq</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulry</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> 2!leye_eq</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulry</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulry</span><span class="id"> mulrNy</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> mul1e</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrNy</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> 2!leNye</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrNy</span><span class="id"> mulry</span><span class="id"> gtr0_sg//</span><span class="id"> 2!mul1e</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrNy</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_pmul2r</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> {mono</span><span class="id"> *%E^~</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> xfin</span><span class="id"> x0</span><span class="id"> y</span><span class="id"> z;</span><span class="id"> rewrite</span><span class="id"> -2!</span>(<span class="id">muleC</span><span class="id"> x</span>)<span class="id"> lee_pmul2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_sqr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> 2</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xge0</span><span class="id"> yge0;</span><span class="id"> apply/idP/idP;</span><span class="id"> rewrite</span><span class="id"> !expe2</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> contra_le</span><span class="id"> =&gt;</span><span class="id"> yltx;</span><span class="id"> apply:</span><span class="id"> lte_pmul</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> xley;</span><span class="id"> apply:</span><span class="id"> lee_pmul</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_sqr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> 2</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xge0</span><span class="id"> yge0;</span><span class="id"> apply/idP/idP;</span><span class="id"> rewrite</span><span class="id"> !expe2</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> contra_lt</span><span class="id"> =&gt;</span><span class="id"> yltx;</span><span class="id"> apply:</span><span class="id"> lee_pmul</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> xley;</span><span class="id"> apply:</span><span class="id"> lte_pmul</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_sqrE</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> yge0;</span><span class="id"> have</span><span class="id"> [xge0|xlt0</span><span class="id"> x2ley2]</span><span class="id"> :=</span><span class="id"> leP</span><span class="id"> 0</span><span class="id"> x;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lee_sqr</span>.<br/>
<span class="id">exact:</span><span class="id"> le_trans</span> (<span class="id">ltW</span><span class="id"> xlt0</span>)<span class="id"> _</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_sqrE</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> yge0;</span><span class="id"> have</span><span class="id"> [xge0|xlt0</span><span class="id"> x2ley2]</span><span class="id"> :=</span><span class="id"> leP</span><span class="id"> 0</span><span class="id"> x;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lte_sqr</span>.<br/>
<span class="id">exact:</span><span class="id"> lt_le_trans</span><span class="id"> xlt0</span><span class="id"> _</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqre_ge0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x||];</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> ?mulyy</span><span class="id"> ?mulNyNy</span><span class="id"> ?le0y//;</span><span class="id"> apply:</span><span class="id"> sqr_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_paddl</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> +</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> -[y]add0e</span><span class="id"> leeD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_paddl</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x0</span><span class="id"> /lt_le_trans;</span><span class="id"> apply;</span><span class="id"> rewrite</span><span class="id"> lee_paddl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_paddr</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> +</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> addeC</span><span class="id"> lee_paddl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_paddr</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> +</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> addeC</span><span class="id"> lte_paddl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_spaddre</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> z</span><span class="id"> y</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [z|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> _</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">lte_fin,ltry</span>)<span class="id">//</span>.<br/>
<span class="id">exact:</span><span class="id"> ltr_pwDr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_spadder</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> z</span><span class="id"> y</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [z|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> _</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">lte_fin,ltry,ltNyr</span>)<span class="id">//</span>.<br/>
<span class="id">exact:</span><span class="id"> ltr_pwDr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> ERealArithTh_realDomainType</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> lee_sum_nneg_ord</span><span class="id"> {R}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> lee_sum_npos_ord</span><span class="id"> {R}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> lee_sum_nneg_natr</span><span class="id"> {R}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> lee_sum_npos_natr</span><span class="id"> {R}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> lee_sum_nneg_natl</span><span class="id"> {R}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> lee_sum_npos_natl</span><span class="id"> {R}</span>.<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> `|</span><span class="id"> _</span><span class="id"> |</span>)<span class="id">%E</span>)<span class="id"> =&gt;</span><span class="id"> solve</span><span class="id"> [apply:</span><span class="id"> abse_ge0]</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 0.6.5&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use leeN2 instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_opp</span><span class="id"> :=</span><span class="id"> leeN2</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 0.6.5&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use lteN2 instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_opp</span><span class="id"> :=</span><span class="id"> lteN2</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.1.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use leeDl instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_addl</span><span class="id"> :=</span><span class="id"> leeDl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.1.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use leeDr instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_addr</span><span class="id"> :=</span><span class="id"> leeDr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.1.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use leeD2l instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_add2l</span><span class="id"> :=</span><span class="id"> leeD2l</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.1.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use leeD2r instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_add2r</span><span class="id"> :=</span><span class="id"> leeD2r</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.1.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use leeD instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_add</span><span class="id"> :=</span><span class="id"> leeD</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.1.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use leeB instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_sub</span><span class="id"> :=</span><span class="id"> leeB</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.1.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use leeD2lE instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_add2lE</span><span class="id"> :=</span><span class="id"> leeD2lE</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.1.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use leeNl instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_oppl</span><span class="id"> :=</span><span class="id"> leeNl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.1.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use leeNr instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_oppr</span><span class="id"> :=</span><span class="id"> leeNr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.1.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use lteNl instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_oppl</span><span class="id"> :=</span><span class="id"> lteNl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.1.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use lteNr instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_oppr</span><span class="id"> :=</span><span class="id"> lteNr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.1.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use lteD instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_add</span><span class="id"> :=</span><span class="id"> lteD</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.1.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use lteD2lE instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_add2lE</span><span class="id"> :=</span><span class="id"> lteD2lE</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.1.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use lteDl instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_addl</span><span class="id"> :=</span><span class="id"> lteDl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.1.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use lteDr instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_addr</span><span class="id"> :=</span><span class="id"> lteDr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.2.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use gee_pMl instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> gee_pmull</span><span class="id"> :=</span><span class="id"> gee_pMl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.2.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use geeDl instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> gee_addl</span><span class="id"> :=</span><span class="id"> geeDl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.2.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use geeDr instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> gee_addr</span><span class="id"> :=</span><span class="id"> geeDr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.2.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use gteDr instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> gte_addr</span><span class="id"> :=</span><span class="id"> gteDr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.2.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use gteDl instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> gte_addl</span><span class="id"> :=</span><span class="id"> gteDl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.2.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use lteBlDr instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_subl_addr</span><span class="id"> :=</span><span class="id"> lteBlDr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.2.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use lteBlDl instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_subl_addl</span><span class="id"> :=</span><span class="id"> lteBlDl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.2.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use lteBrDr instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_subr_addr</span><span class="id"> :=</span><span class="id"> lteBrDr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.2.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use lteBrDl instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_subr_addl</span><span class="id"> :=</span><span class="id"> lteBrDl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.2.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use leeBlDr instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_subl_addr</span><span class="id"> :=</span><span class="id"> leeBlDr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.2.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use leeBlDl instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_subl_addl</span><span class="id"> :=</span><span class="id"> leeBlDl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.2.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use leeBrDr instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_subr_addr</span><span class="id"> :=</span><span class="id"> leeBrDr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.2.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use leeBrDl instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_subr_addl</span><span class="id"> :=</span><span class="id"> leeBrDl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use `lte_leD` instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_le_add</span><span class="id"> :=</span><span class="id"> lte_leD</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use `lee_ltD` instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_lt_add</span><span class="id"> :=</span><span class="id"> lee_ltD</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use `lte_leB` instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_le_sub</span><span class="id"> :=</span><span class="id"> lte_leB</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use leeN2 instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_opp2</span><span class="id"> :=</span><span class="id"> leeN2</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;Use lteN2 instead.&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_opp2</span><span class="id"> :=</span><span class="id"> lteN2</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> DualAddTheoryRealDomain</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> DualERealArithTh_realDomainType</span>.<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> DualAddTheoryNumDomain</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> ereal_dual_scope</span>.<br/>
<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> realDomainType}</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> \bar^d</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dsube_lt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> dual_addeE</span><span class="id"> oppe_lt0</span><span class="id"> sube_gt0</span><span class="id"> lteN2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dsube_ge0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> dual_addeE</span><span class="id"> oppe_ge0</span><span class="id"> sube_le0</span><span class="id"> leeN2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dsuber_le0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> dual_addeE</span><span class="id"> oppe_le0</span><span class="id"> suber_ge0</span><span class="id"> ?fin_numN//</span><span class="id"> leeN2</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dsubre_le0</span><span class="id"> y</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> dual_addeE</span><span class="id"> oppe_le0</span><span class="id"> subre_ge0</span><span class="id"> ?fin_numN//</span><span class="id"> leeN2</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dsube_le0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> ||</span> (<span class="id">y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">y</span><span class="id"> -</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /orP[?|?];</span><span class="id"> [rewrite</span><span class="id"> dsuber_le0|rewrite</span><span class="id"> dsubre_le0]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_dD</span><span class="id"> a</span><span class="id"> b</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> a</span><span class="id"> &lt;</span><span class="id"> b</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> b</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> lteN2</span><span class="id"> -lteN2</span><span class="id"> -</span>(<span class="id">lteN2</span><span class="id"> y</span>)<span class="id">;</span><span class="id"> exact:</span><span class="id"> lteD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> rewrite</span><span class="id"> dual_addeE</span><span class="id"> leeNr</span><span class="id"> -oppe_le0;</span><span class="id"> exact:</span><span class="id"> geeDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> +</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> rewrite</span><span class="id"> dual_addeE</span><span class="id"> leeNr</span><span class="id"> -oppe_le0;</span><span class="id"> exact:</span><span class="id"> geeDr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gee_dDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> rewrite</span><span class="id"> dual_addeE</span><span class="id"> leeNl</span><span class="id"> -oppe_ge0;</span><span class="id"> exact:</span><span class="id"> leeDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gee_dDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> rewrite</span><span class="id"> dual_addeE</span><span class="id"> leeNl</span><span class="id"> -oppe_ge0;</span><span class="id"> exact:</span><span class="id"> leeDr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_dDl</span><span class="id"> y</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -fin_numN</span><span class="id"> dual_addeE</span><span class="id"> lteNr;</span><span class="id"> exact:</span><span class="id"> gte_subl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_dDr</span><span class="id"> y</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -fin_numN</span><span class="id"> dual_addeE</span><span class="id"> lteNr</span><span class="id"> addeC;</span><span class="id"> exact:</span><span class="id"> gte_subl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gte_dBl</span><span class="id"> y</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> -</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -fin_numN</span><span class="id"> dual_addeE</span><span class="id"> lteNl</span><span class="id"> oppeK;</span><span class="id"> exact:</span><span class="id"> lteDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gte_dBr</span><span class="id"> y</span><span class="id"> x</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">-</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -fin_numN</span><span class="id"> dual_addeE</span><span class="id"> lteNl</span><span class="id"> oppeK;</span><span class="id"> exact:</span><span class="id"> lteDr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gte_dDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -fin_numN</span><span class="id"> dual_addeE</span><span class="id"> lteNl</span><span class="id"> -[0]oppe0</span><span class="id"> lteNr;</span><span class="id"> exact:</span><span class="id"> lteDl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gte_dDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> daddeC;</span><span class="id"> exact:</span><span class="id"> gte_dDl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_dD2lE</span><span class="id"> x</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> a</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> b</span>)<span class="id"> =</span> (<span class="id">a</span><span class="id"> &lt;</span><span class="id"> b</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> lteN2</span><span class="id"> lteD2lE</span><span class="id"> ?fin_numN//</span><span class="id"> lteN2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_dD2rE</span><span class="id"> x</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">a</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> b</span><span class="id"> +</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">a</span><span class="id"> &lt;</span><span class="id"> b</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> lteN2</span><span class="id"> -[RHS]lteN2</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[RHS]</span>(<span class="id">@lteD2rE</span><span class="id"> _</span> (<span class="id">-</span><span class="id"> x</span>))<span class="id">//</span><span class="id"> fin_numN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dD2rE</span><span class="id"> x</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">a</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> +</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">a</span><span class="id"> &lt;=</span><span class="id"> b</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> leeN2</span><span class="id"> -[RHS]leeN2</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[RHS]</span>(<span class="id">@leeD2rE</span><span class="id"> _</span> (<span class="id">-</span><span class="id"> x</span>))<span class="id">//</span><span class="id"> fin_numN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dD2l</span><span class="id"> x</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> +</span><span class="id"> b</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> leeN2</span><span class="id"> -leeN2;</span><span class="id"> exact:</span><span class="id"> leeD2l</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dD2lE</span><span class="id"> x</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> +</span><span class="id"> b</span>)<span class="id"> =</span> (<span class="id">a</span><span class="id"> &lt;=</span><span class="id"> b</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> leeN2</span><span class="id"> leeD2lE</span><span class="id"> ?fin_numN//</span><span class="id"> leeN2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dD2r</span><span class="id"> x</span><span class="id"> a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> +</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> leeN2</span><span class="id"> -leeN2;</span><span class="id"> exact:</span><span class="id"> leeD2r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dD</span><span class="id"> a</span><span class="id"> b</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> leeN2</span><span class="id"> -leeN2</span><span class="id"> -</span>(<span class="id">leeN2</span><span class="id"> y</span>)<span class="id">;</span><span class="id"> exact:</span><span class="id"> leeD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_le_dD</span><span class="id"> a</span><span class="id"> b</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> b</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> b</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> +</span><span class="id"> b</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> lteN2</span><span class="id"> -lteN2;</span><span class="id"> exact:</span><span class="id"> lte_leB</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_lt_dD</span><span class="id"> a</span><span class="id"> b</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> a</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> b</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> +</span><span class="id"> b</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> afin</span><span class="id"> xa</span><span class="id"> yb;</span><span class="id"> rewrite</span> (<span class="id">daddeC</span><span class="id"> a</span>) (<span class="id">daddeC</span><span class="id"> x</span>)<span class="id"> lte_le_dD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dB</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> t</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> t</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> -</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -</span><span class="id"> t</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> leeNl</span><span class="id"> oppeK</span><span class="id"> -leeN2</span><span class="id"> !oppeK;</span><span class="id"> exact:</span><span class="id"> leeD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_le_dB</span><span class="id"> z</span><span class="id"> u</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> u</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> u</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -</span><span class="id"> u</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> lteN2</span><span class="id"> !oppeK</span><span class="id"> -lteN2;</span><span class="id"> exact:</span><span class="id"> lte_leD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dsum</span><span class="id"> I</span> (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> s</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> g</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> g</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Pfg;</span><span class="id"> rewrite</span><span class="id"> !dual_sumeE</span><span class="id"> leeN2</span>.<br/>
<span class="id">apply:</span><span class="id"> lee_sum</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> Pi;</span><span class="id"> rewrite</span><span class="id"> leeN2;</span><span class="id"> exact:</span><span class="id"> Pfg</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dsum_nneg_subset</span><span class="id"> I</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> I}</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{subset</span><span class="id"> Q</span><span class="id"> &lt;=</span><span class="id"> P}</span><span class="id"> -&gt;</span><span class="id"> {in</span><span class="id"> [predD</span><span class="id"> P</span><span class="id"> &amp;</span><span class="id"> Q],</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> f</span><span class="id"> i}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> Q</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> QP</span><span class="id"> PQf;</span><span class="id"> rewrite</span><span class="id"> !dual_sumeE</span><span class="id"> leeN2</span>.<br/>
<span class="id">apply:</span><span class="id"> lee_sum_npos_subset</span><span class="id"> =&gt;</span><span class="id"> [//|i</span><span class="id"> iPQ];</span><span class="id"> rewrite</span><span class="id"> oppe_le0;</span><span class="id"> exact:</span><span class="id"> PQf</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dsum_npos_subset</span><span class="id"> I</span> (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> {pred</span><span class="id"> I}</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">{subset</span><span class="id"> Q</span><span class="id"> &lt;=</span><span class="id"> P}</span><span class="id"> -&gt;</span><span class="id"> {in</span><span class="id"> [predD</span><span class="id"> P</span><span class="id"> &amp;</span><span class="id"> Q],</span><span class="gallina-kwd"> forall</span><span class="id"> i,</span><span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> 0}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> Q</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> QP</span><span class="id"> PQf;</span><span class="id"> rewrite</span><span class="id"> !dual_sumeE</span><span class="id"> leeN2</span>.<br/>
<span class="id">apply:</span><span class="id"> lee_sum_nneg_subset</span><span class="id"> =&gt;</span><span class="id"> [//|i</span><span class="id"> iPQ];</span><span class="id"> rewrite</span><span class="id"> oppe_ge0;</span><span class="id"> exact:</span><span class="id"> PQf</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dsum_nneg</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> eqType</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<br/>
&nbsp;&nbsp;(<span class="id">f</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> :</span> (<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> ~~</span><span class="id"> Q</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> f</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span><span class="id"> &amp;&amp;</span><span class="id"> Q</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> PQf;</span><span class="id"> rewrite</span><span class="id"> !dual_sumeE</span><span class="id"> leeN2</span>.<br/>
<span class="id">apply:</span><span class="id"> lee_sum_npos</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> Pi</span><span class="id"> nQi;</span><span class="id"> rewrite</span><span class="id"> oppe_le0;</span><span class="id"> exact:</span><span class="id"> PQf</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dsum_npos</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> eqType</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<br/>
&nbsp;&nbsp;(<span class="id">f</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> :</span> (<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> ~~</span><span class="id"> Q</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span><span class="id"> &amp;&amp;</span><span class="id"> Q</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> PQf;</span><span class="id"> rewrite</span><span class="id"> !dual_sumeE</span><span class="id"> leeN2</span>.<br/>
<span class="id">apply:</span><span class="id"> lee_sum_nneg</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> Pi</span><span class="id"> nQi;</span><span class="id"> rewrite</span><span class="id"> oppe_ge0;</span><span class="id"> exact:</span><span class="id"> PQf</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dsum_nneg_ord</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> nat</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> n,</span><span class="id"> P</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> f</span><span class="id"> n</span>)<span class="id">%E</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{homo</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">f</span><span class="id"> i</span>))<span class="id"> :</span><span class="id"> i</span><span class="id"> j</span><span class="id"> /</span> (<span class="id">i</span><span class="id"> &lt;=</span><span class="id"> j</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> j}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> f0</span><span class="id"> m</span><span class="id"> n</span><span class="id"> mlen;</span><span class="id"> rewrite</span><span class="id"> !dual_sumeE</span><span class="id"> leeN2</span>.<br/>
<span class="id">apply:</span> (<span class="id">lee_sum_npos_ord</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> -</span><span class="id"> f</span><span class="id"> i</span>)<span class="id">%E</span>)<span class="id"> =&gt;</span><span class="id"> [i</span><span class="id"> Pi|//]</span>.<br/>
<span class="id">rewrite</span><span class="id"> oppe_le0;</span><span class="id"> exact:</span><span class="id"> f0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dsum_npos_ord</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> nat</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> n,</span><span class="id"> P</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id">%E</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{homo</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">f</span><span class="id"> i</span>))<span class="id"> :</span><span class="id"> i</span><span class="id"> j</span><span class="id"> /</span> (<span class="id">i</span><span class="id"> &lt;=</span><span class="id"> j</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> j</span><span class="id"> &lt;=</span><span class="id"> i}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> f0</span><span class="id"> m</span><span class="id"> n</span><span class="id"> mlen;</span><span class="id"> rewrite</span><span class="id"> !dual_sumeE</span><span class="id"> leeN2</span>.<br/>
<span class="id">apply:</span> (<span class="id">lee_sum_nneg_ord</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> -</span><span class="id"> f</span><span class="id"> i</span>)<span class="id">%E</span>)<span class="id"> =&gt;</span><span class="id"> [i</span><span class="id"> Pi|//]</span>.<br/>
<span class="id">rewrite</span><span class="id"> oppe_ge0;</span><span class="id"> exact:</span><span class="id"> f0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dsum_nneg_natr</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> nat</span>)<span class="id"> m</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> n,</span> (<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> f</span><span class="id"> n</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{homo</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> \sum_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">f</span><span class="id"> i</span>))<span class="id"> :</span><span class="id"> i</span><span class="id"> j</span><span class="id"> /</span> (<span class="id">i</span><span class="id"> &lt;=</span><span class="id"> j</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> j}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> f0</span><span class="id"> i</span><span class="id"> j</span><span class="id"> le_ij;</span><span class="id"> rewrite</span><span class="id"> !dual_sumeE</span><span class="id"> leeN2</span>.<br/>
<span class="id">apply:</span><span class="id"> lee_sum_npos_natr</span><span class="id"> =&gt;</span><span class="id"> [n</span><span class="id"> ?</span><span class="id"> ?|//];</span><span class="id"> rewrite</span><span class="id"> oppe_le0;</span><span class="id"> exact:</span><span class="id"> f0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dsum_npos_natr</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> nat</span>)<span class="id"> m</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> n,</span> (<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{homo</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> \sum_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">f</span><span class="id"> i</span>))<span class="id"> :</span><span class="id"> i</span><span class="id"> j</span><span class="id"> /</span> (<span class="id">i</span><span class="id"> &lt;=</span><span class="id"> j</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> j</span><span class="id"> &lt;=</span><span class="id"> i}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> f0</span><span class="id"> i</span><span class="id"> j</span><span class="id"> le_ij;</span><span class="id"> rewrite</span><span class="id"> !dual_sumeE</span><span class="id"> leeN2</span>.<br/>
<span class="id">apply:</span><span class="id"> lee_sum_nneg_natr</span><span class="id"> =&gt;</span><span class="id"> [n</span><span class="id"> ?</span><span class="id"> ?|//];</span><span class="id"> rewrite</span><span class="id"> oppe_ge0;</span><span class="id"> exact:</span><span class="id"> f0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dsum_nneg_natl</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> nat</span>)<span class="id"> n</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> m,</span> (<span class="id">m</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> f</span><span class="id"> m</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{homo</span> (<span class="gallina-kwd">fun</span><span class="id"> m</span><span class="id"> =&gt;</span><span class="id"> \sum_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">f</span><span class="id"> i</span>))<span class="id"> :</span><span class="id"> i</span><span class="id"> j</span><span class="id"> /</span> (<span class="id">i</span><span class="id"> &lt;=</span><span class="id"> j</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> j</span><span class="id"> &lt;=</span><span class="id"> i}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> f0</span><span class="id"> i</span><span class="id"> j</span><span class="id"> le_ij;</span><span class="id"> rewrite</span><span class="id"> !dual_sumeE</span><span class="id"> leeN2</span>.<br/>
<span class="id">apply:</span><span class="id"> lee_sum_npos_natl</span><span class="id"> =&gt;</span><span class="id"> [m</span><span class="id"> ?</span><span class="id"> ?|//];</span><span class="id"> rewrite</span><span class="id"> oppe_le0;</span><span class="id"> exact:</span><span class="id"> f0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dsum_npos_natl</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> nat</span>)<span class="id"> n</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> m,</span> (<span class="id">m</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%N</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> m</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> m</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{homo</span> (<span class="gallina-kwd">fun</span><span class="id"> m</span><span class="id"> =&gt;</span><span class="id"> \sum_</span>(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">f</span><span class="id"> i</span>))<span class="id"> :</span><span class="id"> i</span><span class="id"> j</span><span class="id"> /</span> (<span class="id">i</span><span class="id"> &lt;=</span><span class="id"> j</span>)<span class="id">%N</span><span class="id"> &gt;-&gt;</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> j}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> f0</span><span class="id"> i</span><span class="id"> j</span><span class="id"> le_ij;</span><span class="id"> rewrite</span><span class="id"> !dual_sumeE</span><span class="id"> leeN2</span>.<br/>
<span class="id">apply:</span><span class="id"> lee_sum_nneg_natl</span><span class="id"> =&gt;</span><span class="id"> [m</span><span class="id"> ?</span><span class="id"> ?|//];</span><span class="id"> rewrite</span><span class="id"> oppe_ge0;</span><span class="id"> exact:</span><span class="id"> f0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dsum_nneg_subfset</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> choiceType</span>) (<span class="id">A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> {fset</span><span class="id"> T}%fset</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> T</span>)<br/>
&nbsp;&nbsp;(<span class="id">f</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> {subset</span><span class="id"> A</span><span class="id"> &lt;=</span><span class="id"> B}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> [predD</span><span class="id"> B</span><span class="id"> &amp;</span><span class="id"> A],</span><span class="gallina-kwd"> forall</span><span class="id"> t,</span><span class="id"> P</span><span class="id"> t</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> f</span><span class="id"> t}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">t</span><span class="id"> &lt;-</span><span class="id"> A</span><span class="id"> |</span><span class="id"> P</span><span class="id"> t</span>)<span class="id"> f</span><span class="id"> t</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">t</span><span class="id"> &lt;-</span><span class="id"> B</span><span class="id"> |</span><span class="id"> P</span><span class="id"> t</span>)<span class="id"> f</span><span class="id"> t</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> AB</span><span class="id"> f0;</span><span class="id"> rewrite</span><span class="id"> !dual_sumeE</span><span class="id"> leeN2</span>.<br/>
<span class="id">apply:</span><span class="id"> lee_sum_npos_subfset</span><span class="id"> =&gt;</span><span class="id"> [//|?</span><span class="id"> ?</span><span class="id"> ?];</span><span class="id"> rewrite</span><span class="id"> oppe_le0;</span><span class="id"> exact:</span><span class="id"> f0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dsum_npos_subfset</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> choiceType</span>) (<span class="id">A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> {fset</span><span class="id"> T}%fset</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> T</span>)<br/>
&nbsp;&nbsp;(<span class="id">f</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> {subset</span><span class="id"> A</span><span class="id"> &lt;=</span><span class="id"> B}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> [predD</span><span class="id"> B</span><span class="id"> &amp;</span><span class="id"> A],</span><span class="gallina-kwd"> forall</span><span class="id"> t,</span><span class="id"> P</span><span class="id"> t</span><span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> t</span><span class="id"> &lt;=</span><span class="id"> 0}</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">t</span><span class="id"> &lt;-</span><span class="id"> B</span><span class="id"> |</span><span class="id"> P</span><span class="id"> t</span>)<span class="id"> f</span><span class="id"> t</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">t</span><span class="id"> &lt;-</span><span class="id"> A</span><span class="id"> |</span><span class="id"> P</span><span class="id"> t</span>)<span class="id"> f</span><span class="id"> t</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> AB</span><span class="id"> f0;</span><span class="id"> rewrite</span><span class="id"> !dual_sumeE</span><span class="id"> leeN2</span>.<br/>
<span class="id">apply:</span><span class="id"> lee_sum_nneg_subfset</span><span class="id"> =&gt;</span><span class="id"> [//|?</span><span class="id"> ?</span><span class="id"> ?];</span><span class="id"> rewrite</span><span class="id"> oppe_ge0;</span><span class="id"> exact:</span><span class="id"> f0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_dBlDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> +</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> lteNl</span><span class="id"> lteNr</span><span class="id"> oppeK</span><span class="id"> lteBlDr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_dBlDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> lteNl</span><span class="id"> lteNr</span><span class="id"> lteBrDl</span><span class="id"> ?fin_numN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_dBrDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> lteNl</span><span class="id"> lteNr</span><span class="id"> lteBlDr</span><span class="id"> ?fin_numN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_dBrDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">z</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> lteNl</span><span class="id"> lteNr</span><span class="id"> lteBlDl</span><span class="id"> ?fin_numN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_dsuber_addr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> lteNl</span><span class="id"> lteNr</span><span class="id"> lte_subel_addr</span><span class="id"> ?fin_numN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_dsuber_addl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">z</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> lteNl</span><span class="id"> lteNr</span><span class="id"> lte_subel_addl</span><span class="id"> ?fin_numN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_dsubel_addr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> +</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> lteNl</span><span class="id"> lteNr</span><span class="id"> lte_suber_addr</span><span class="id"> ?fin_numN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_dsubel_addl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> +</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> lteNl</span><span class="id"> lteNr</span><span class="id"> lte_suber_addl</span><span class="id"> ?fin_numN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dsubl_addr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> +</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> leeNl</span><span class="id"> leeNr</span><span class="id"> leeBrDr</span><span class="id"> ?fin_numN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dsubl_addl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> +</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> leeNl</span><span class="id"> leeNr</span><span class="id"> leeBrDl</span><span class="id"> ?fin_numN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dsubr_addr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> leeNl</span><span class="id"> leeNr</span><span class="id"> leeBlDr</span><span class="id"> ?fin_numN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dsubr_addl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">z</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> leeNl</span><span class="id"> leeNr</span><span class="id"> leeBlDl</span><span class="id"> ?fin_numN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dsubel_addr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> +</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> leeNl</span><span class="id"> leeNr</span><span class="id"> lee_suber_addr</span><span class="id"> ?fin_numN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dsubel_addl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> +</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> leeNl</span><span class="id"> leeNr</span><span class="id"> lee_suber_addl</span><span class="id"> ?fin_numN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dsuber_addr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> leeNl</span><span class="id"> leeNr</span><span class="id"> lee_subel_addr</span><span class="id"> ?fin_numN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_dsuber_addl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">z</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> leeNl</span><span class="id"> leeNr</span><span class="id"> lee_subel_addl</span><span class="id"> ?fin_numN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dsuber_gt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> lte_dBrDl//</span><span class="id"> dadde0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dsubre_gt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> lte_dsuber_addl//</span><span class="id"> dadde0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dsube_gt0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> ||</span> (<span class="id">y</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /orP[?|?];</span><span class="id"> [rewrite</span><span class="id"> dsuber_gt0|rewrite</span><span class="id"> dsubre_gt0]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dmuleDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> +?</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span> (<span class="id">y</span><span class="id"> +</span><span class="id"> z</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> +</span><span class="id"> x</span><span class="id"> *</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE/=</span><span class="id"> muleN</span><span class="id"> muleDr</span><span class="id"> ?adde_defNN//</span><span class="id"> !muleN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dmuleDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> +?</span><span class="id"> z</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> +</span><span class="id"> z</span>)<span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> +</span><span class="id"> z</span><span class="id"> *</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> -!</span>(<span class="id">muleC</span><span class="id"> x</span>)<span class="id"> dmuleDr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dge0_muleDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> +</span><span class="id"> z</span>)<span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> +</span><span class="id"> z</span><span class="id"> *</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> mulNe</span><span class="id"> le0_muleDl</span><span class="id"> ?oppe_le0</span><span class="id"> ?mulNe</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dge0_muleDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span> (<span class="id">y</span><span class="id"> +</span><span class="id"> z</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> +</span><span class="id"> x</span><span class="id"> *</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> muleN</span><span class="id"> le0_muleDr</span><span class="id"> ?oppe_le0</span><span class="id"> ?muleN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dle0_muleDl</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> +</span><span class="id"> z</span>)<span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> y</span><span class="id"> *</span><span class="id"> x</span><span class="id"> +</span><span class="id"> z</span><span class="id"> *</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> mulNe</span><span class="id"> ge0_muleDl</span><span class="id"> ?oppe_ge0</span><span class="id"> ?mulNe</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dle0_muleDr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span> (<span class="id">y</span><span class="id"> +</span><span class="id"> z</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> +</span><span class="id"> x</span><span class="id"> *</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> muleN</span><span class="id"> ge0_muleDr</span><span class="id"> ?oppe_ge0</span><span class="id"> ?muleN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ge0_dsume_distrl</span> (<span class="id">I</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>)<span class="id"> x</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> F</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>)<span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">F</span><span class="id"> i</span><span class="id"> *</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> F0;</span><span class="id"> rewrite</span><span class="id"> !dual_sumeE</span><span class="id"> !mulNe</span><span class="id"> le0_sume_distrl</span><span class="id"> =&gt;</span><span class="id"> [|i</span><span class="id"> Pi]</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> under</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> mulNe</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> oppe_le0</span><span class="id"> F0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ge0_dsume_distrr</span> (<span class="id">I</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>)<span class="id"> x</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> F</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> *</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">x</span><span class="id"> *</span><span class="id"> F</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> F0;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> ge0_dsume_distrl//;</span><span class="id"> under</span><span class="id"> eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> muleC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> le0_dsume_distrl</span> (<span class="id">I</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>)<span class="id"> x</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> F</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>)<span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">F</span><span class="id"> i</span><span class="id"> *</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> F0;</span><span class="id"> rewrite</span><span class="id"> !dual_sumeE</span><span class="id"> mulNe</span><span class="id"> ge0_sume_distrl</span><span class="id"> =&gt;</span><span class="id"> [|i</span><span class="id"> Pi]</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> under</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> mulNe</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> oppe_ge0</span><span class="id"> F0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> le0_dsume_distrr</span> (<span class="id">I</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>)<span class="id"> x</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> F</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> *</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">x</span><span class="id"> *</span><span class="id"> F</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> F0;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> le0_dsume_distrl//;</span><span class="id"> under</span><span class="id"> eq_bigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> muleC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_abs_dadd</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> `|x</span><span class="id"> +</span><span class="id"> y|</span><span class="id"> &lt;=</span><span class="id"> `|x|</span><span class="id"> +</span><span class="id"> `|y|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> /abse</span><span class="id"> -dEFinD</span><span class="id"> lee_fin</span><span class="id"> ler_normD</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_abs_dsum</span> (<span class="id">I</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">s</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> I</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar^d</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">`|\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i|</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> s</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> `|F</span><span class="id"> i|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim/big_ind2</span><span class="id"> :</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> abse0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> exact/</span>(<span class="id">le_trans</span> (<span class="id">lee_abs_dadd</span><span class="id"> _</span><span class="id"> _</span>) (<span class="id">lee_dD</span><span class="id"> _</span><span class="id"> _</span>)).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_abs_dsub</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> `|x</span><span class="id"> -</span><span class="id"> y|</span><span class="id"> &lt;=</span><span class="id"> `|x|</span><span class="id"> +</span><span class="id"> `|y|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> /abse</span><span class="id"> -dEFinD</span><span class="id"> lee_fin</span><span class="id"> ler_normB</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dadde_minl</span><span class="id"> :</span><span class="id"> left_distributive</span> (<span class="id">@GRing</span>.<span class="id">add</span> (<span class="id">\bar^d</span><span class="id"> R</span>))<span class="id"> mine</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> oppe_min</span><span class="id"> adde_maxl</span><span class="id"> oppe_max</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dadde_minr</span><span class="id"> :</span><span class="id"> right_distributive</span> (<span class="id">@GRing</span>.<span class="id">add</span> (<span class="id">\bar^d</span><span class="id"> R</span>))<span class="id"> mine</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z;</span><span class="id"> rewrite</span><span class="id"> !dual_addeE</span><span class="id"> oppe_min</span><span class="id"> adde_maxr</span><span class="id"> oppe_max</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dmule_natl</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> n%:R%:E</span><span class="id"> *</span><span class="id"> x</span><span class="id"> =</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mule_natl</span><span class="id"> ednatmulE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_pdaddl</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> +</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> -[y]dadd0e</span><span class="id"> lee_dD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_pdaddl</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x0</span><span class="id"> /lt_le_trans;</span><span class="id"> apply;</span><span class="id"> rewrite</span><span class="id"> lee_pdaddl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_pdaddr</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> +</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> daddeC</span><span class="id"> lee_pdaddl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_pdaddr</span><span class="id"> y</span><span class="id"> x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> z</span><span class="id"> +</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> daddeC</span><span class="id"> lte_pdaddl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_spdaddre</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> z</span><span class="id"> y</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [z|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> _</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">lte_fin,ltry,ltNyr</span>)<span class="id">//</span>.<br/>
<span class="id">exact:</span><span class="id"> ltr_pwDr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_spdadder</span><span class="id"> z</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> z</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> z</span><span class="id"> y</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [z|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> _</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">lte_fin,ltry,ltNyr</span>)<span class="id">//</span>.<br/>
<span class="id">exact:</span><span class="id"> ltr_pwDr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> DualERealArithTh_realDomainType</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> lee_dsum_nneg_ord</span><span class="id"> {R}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> lee_dsum_npos_ord</span><span class="id"> {R}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> lee_dsum_nneg_natr</span><span class="id"> {R}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> lee_dsum_npos_natr</span><span class="id"> {R}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> lee_dsum_nneg_natl</span><span class="id"> {R}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> lee_dsum_npos_natl</span><span class="id"> {R}</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lte_dD`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_dadd</span><span class="id"> :=</span><span class="id"> lte_dD</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lee_dDl`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_daddl</span><span class="id"> :=</span><span class="id"> lee_dDl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lee_dDr`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_daddr</span><span class="id"> :=</span><span class="id"> lee_dDr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `gee_dDl`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> gee_daddl</span><span class="id"> :=</span><span class="id"> gee_dDl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `gee_dDr`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> gee_daddr</span><span class="id"> :=</span><span class="id"> gee_dDr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lte_dDl`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_daddl</span><span class="id"> :=</span><span class="id"> lte_dDl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lte_dDr`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_daddr</span><span class="id"> :=</span><span class="id"> lte_dDr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `gte_dBl`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> gte_dsubl</span><span class="id"> :=</span><span class="id"> gte_dBl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `gte_dBr`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> gte_dsubr</span><span class="id"> :=</span><span class="id"> gte_dBr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `gte_dDl`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> gte_daddl</span><span class="id"> :=</span><span class="id"> gte_dDl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `gte_dDr`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> gte_daddr</span><span class="id"> :=</span><span class="id"> gte_dDr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lte_dD2lE`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_dadd2lE</span><span class="id"> :=</span><span class="id"> lte_dD2lE</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lee_dD2rE`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_dadd2rE</span><span class="id"> :=</span><span class="id"> lee_dD2rE</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lee_dD2l`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_dadd2l</span><span class="id"> :=</span><span class="id"> lee_dD2l</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lee_dD2r`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_dadd2r</span><span class="id"> :=</span><span class="id"> lee_dD2r</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lee_dD`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_dadd</span><span class="id"> :=</span><span class="id"> lee_dD</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lee_dB`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_dsub</span><span class="id"> :=</span><span class="id"> lee_dB</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lte_dBlDr`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_dsubl_addr</span><span class="id"> :=</span><span class="id"> lte_dBlDr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lte_dBlDl`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_dsubl_addl</span><span class="id"> :=</span><span class="id"> lte_dBlDl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lte_dBrDr`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_dsubr_addr</span><span class="id"> :=</span><span class="id"> lte_dBrDr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lte_dBrDl`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_dsubr_addl</span><span class="id"> :=</span><span class="id"> lte_dBrDl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lte_le_dD`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_le_dadd</span><span class="id"> :=</span><span class="id"> lte_le_dD</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lee_lt_dD`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_lt_dadd</span><span class="id"> :=</span><span class="id"> lee_lt_dD</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lte_le_dB`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_le_dsub</span><span class="id"> :=</span><span class="id"> lte_le_dD</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">End</span><span class="id"> DualAddTheoryRealDomain</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> realFieldType_lemmas</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> realFieldType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> r</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_addgt0Pr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> e,</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> e</span>)<span class="id">%R</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> +</span><span class="id"> e%:E</span>) (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/</span>(<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [|]</span>.<br/>
<span class="id">-</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]//</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> =&gt;</span><span class="id"> xy</span><span class="id"> e</span><span class="id"> e0;</span><span class="id"> rewrite</span><span class="id"> -EFinD</span><span class="id"> lee_fin</span><span class="id"> ler_wpDr//</span><span class="id"> ltW</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> _</span><span class="id"> e</span><span class="id"> e0;</span><span class="id"> rewrite</span><span class="id"> leNye</span>.<br/>
<span class="id">-</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]//</span><span class="id"> xy;</span><span class="id"> rewrite</span><span class="id"> ?leey</span><span class="id"> ?leNye//;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">[|by</span><span class="id"> move:</span><span class="id"> xy</span><span class="id"> =&gt;</span><span class="id"> /</span>(_<span class="id"> _</span><span class="id"> lte01</span>)..<span class="id">]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lee_fin;</span><span class="id"> apply/ler_addgt0Pr</span><span class="id"> =&gt;</span><span class="id"> e</span><span class="id"> e0;</span><span class="id"> rewrite</span><span class="id"> -lee_fin</span><span class="id"> EFinD</span><span class="id"> xy</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_subgt0Pr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> e,</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> e</span>)<span class="id">%R</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> -</span><span class="id"> e%:E</span><span class="id"> &lt;=</span><span class="id"> y</span>) (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/</span>(<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [xy</span><span class="id"> e|xy]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> leeBlDr//;</span><span class="id"> move:</span><span class="id"> e;</span><span class="id"> exact/lee_addgt0Pr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/lee_addgt0Pr</span><span class="id"> =&gt;</span><span class="id"> e</span><span class="id"> e0;</span><span class="id"> rewrite</span><span class="id"> -leeBlDr//</span><span class="id"> xy</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_mul01Pr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> r,</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> 1</span>)<span class="id">%R</span><span class="id"> -&gt;</span><span class="id"> r%:E</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span>) (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x0;</span><span class="id"> apply/</span>(<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [xy</span><span class="id"> r</span><span class="id"> /andP[r0</span><span class="id"> r1]|h]</span>.<br/>
&nbsp;&nbsp;<span class="id">move:</span><span class="id"> x0</span><span class="id"> xy;</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-|x0</span><span class="id"> xy];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mule0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">le_trans</span><span class="id"> _</span><span class="id"> xy</span>)<span class="id">//</span><span class="id"> gee_pMl//</span><span class="id"> ltW</span>.<br/>
<span class="id">have</span><span class="id"> h01</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span> (<span class="id">2^-1</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> &lt;</span><span class="id"> 1</span>)<span class="id">%R</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> invr_gt0</span><span class="id"> ?invf_lt1</span><span class="id"> ?ltr0n</span><span class="id"> ?ltr1n</span>.<br/>
<span class="id">move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x||]</span><span class="id"> [y||]</span><span class="id"> //</span><span class="gallina-kwd"> in</span><span class="id"> x0</span><span class="id"> h</span><span class="id"> *</span>.<br/>
<span class="id">-</span><span class="id"> move:</span> (<span class="id">x0</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-|{}x0]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">le_trans</span><span class="id"> _</span> (<span class="id">h</span><span class="id"> _</span><span class="id"> h01</span>))<span class="id">//</span><span class="id"> mule_ge0//</span><span class="id"> lee_fin</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> y0</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id">%R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -lte_fin</span> (<span class="id">lt_le_trans</span><span class="id"> _</span> (<span class="id">h</span><span class="id"> _</span><span class="id"> h01</span>))<span class="id">//</span><span class="id"> mule_gt0//</span><span class="id"> lte_fin</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> lee_fin</span><span class="id"> leNgt;</span><span class="id"> apply/negP</span><span class="id"> =&gt;</span><span class="id"> yx</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> /h</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span> (<span class="id">y</span><span class="id"> +</span><span class="id"> x</span>)<span class="id"> /</span> (<span class="id">2</span><span class="id"> *</span><span class="id"> x</span>)<span class="id"> &lt;</span><span class="id"> 1</span>)<span class="id">%R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply/andP;</span><span class="id"> split;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> divr_gt0</span><span class="id"> //</span><span class="id"> ?addr_gt0//</span><span class="id"> ?mulr_gt0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltr_pdivrMr</span><span class="id"> ?mulr_gt0//</span><span class="id"> mul1r</span><span class="id"> mulr_natl</span><span class="id"> mulr2n</span><span class="id"> ltrD2r</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">EFinM</span><span class="id"> _</span><span class="id"> x</span>)<span class="id"> lee_fin</span><span class="id"> invrM</span><span class="id"> ?unitfE//</span><span class="id"> ?gt_eqF//</span><span class="id"> -mulrA</span><span class="id"> mulrAC</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulVr</span><span class="id"> ?unitfE</span><span class="id"> ?gt_eqF//</span><span class="id"> mul1r;</span><span class="id"> apply/negP;</span><span class="id"> rewrite</span><span class="id"> -ltNge</span><span class="id"> midf_lt</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> leey</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> h</span><span class="id"> _</span><span class="id"> h01</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> h</span><span class="id"> _</span><span class="id"> h01;</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> sgrV</span><span class="id"> gtr0_sg</span><span class="id"> //</span><span class="id"> mul1e</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> h</span><span class="id"> _</span><span class="id"> h01;</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> sgrV</span><span class="id"> gtr0_sg</span><span class="id"> //</span><span class="id"> mul1e</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_pdivrMl</span><span class="id"> r</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> r</span>)<span class="id">%R</span><span class="id"> -&gt;</span> (<span class="id">r^-1%:E</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> r%:E</span><span class="id"> *</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> r0;</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //=</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> 2!lte_fin</span><span class="id"> ltr_pdivrMl</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> sgrV</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> 2!ltNge</span><span class="id"> 2!leey</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> sgrV</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> -EFinM</span><span class="id"> 2!ltNyr</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> 2!ltry</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> [in</span><span class="id"> RHS]mulr_infty</span><span class="id"> sgrV</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> ltxx</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> [in</span><span class="id"> RHS]mulr_infty</span><span class="id"> sgrV</span><span class="id"> gtr0_sg//</span><span class="id"> 2!mul1e</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> [in</span><span class="id"> RHS]mulr_infty</span><span class="id"> sgrV</span><span class="id"> gtr0_sg//</span><span class="id"> 2!mul1e</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> [in</span><span class="id"> RHS]mulr_infty</span><span class="id"> sgrV</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_pdivrMr</span><span class="id"> r</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> r</span>)<span class="id">%R</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> r^-1%:E</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> r%:E</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> r0;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> lte_pdivrMl//</span><span class="id"> muleC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_pdivlMl</span><span class="id"> r</span><span class="id"> y</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> r</span>)<span class="id">%R</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> r^-1%:E</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">r%:E</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> r0;</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]</span><span class="id"> //=</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> 2!lte_fin</span><span class="id"> ltr_pdivlMl</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> sgrV</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> 2!ltry</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> sgrV</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> [in</span><span class="id"> RHS]mulr_infty</span><span class="id"> sgrV</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> [in</span><span class="id"> RHS]mulr_infty</span><span class="id"> sgrV</span><span class="id"> gtr0_sg//</span><span class="id"> 2!mul1e</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span><span class="id"> 2!ltNyr</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> [in</span><span class="id"> RHS]mulr_infty</span><span class="id"> sgrV</span><span class="id"> gtr0_sg//</span><span class="id"> 2!mul1e</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr_infty</span><span class="id"> [in</span><span class="id"> RHS]mulr_infty</span><span class="id"> sgrV</span><span class="id"> gtr0_sg//</span><span class="id"> mul1e</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_pdivlMr</span><span class="id"> r</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> r</span>)<span class="id">%R</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> *</span><span class="id"> r^-1%:E</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> r%:E</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> r0;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> lte_pdivlMl//</span><span class="id"> muleC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_ndivlMr</span><span class="id"> r</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">r</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> *</span><span class="id"> r^-1%:E</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> r%:E</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -oppr0</span><span class="id"> ltrNr</span><span class="id"> =&gt;</span><span class="id"> r0;</span><span class="id"> rewrite</span><span class="id"> -{1}</span>(<span class="id">opprK</span><span class="id"> r</span>)<span class="id"> invrN</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> EFinN</span><span class="id"> muleN</span><span class="id"> lteNr</span><span class="id"> lte_pdivrMr//</span><span class="id"> EFinN</span><span class="id"> muleNN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_ndivlMl</span><span class="id"> r</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">r</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> r^-1%:E</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> r%:E</span><span class="id"> *</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> r0;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> lte_ndivlMr//</span><span class="id"> muleC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_ndivrMl</span><span class="id"> r</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">r</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> -&gt;</span> (<span class="id">r^-1%:E</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">r%:E</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -oppr0</span><span class="id"> ltrNr</span><span class="id"> =&gt;</span><span class="id"> r0;</span><span class="id"> rewrite</span><span class="id"> -{1}</span>(<span class="id">opprK</span><span class="id"> r</span>)<span class="id"> invrN</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> EFinN</span><span class="id"> mulNe</span><span class="id"> lteNl</span><span class="id"> lte_pdivlMl//</span><span class="id"> EFinN</span><span class="id"> muleNN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lte_ndivrMr</span><span class="id"> r</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">r</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> r^-1%:E</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> r%:E</span><span class="id"> &lt;</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> r0;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> lte_ndivrMl//</span><span class="id"> muleC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_pdivrMl</span><span class="id"> r</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> r</span>)<span class="id">%R</span><span class="id"> -&gt;</span> (<span class="id">r^-1%:E</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> r%:E</span><span class="id"> *</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> r0;</span><span class="id"> apply/idP/idP</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-|];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lte_pdivrMl//</span><span class="id"> =&gt;</span><span class="id"> /ltW</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> muleA</span><span class="id"> -EFinM</span><span class="id"> divrr</span><span class="id"> ?mul1e//</span><span class="id"> unitfE</span><span class="id"> gt_eqF</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[-&gt;|];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -lte_pdivrMl//</span><span class="id"> =&gt;</span><span class="id"> /ltW</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> muleA</span><span class="id"> -EFinM</span><span class="id"> mulVr</span><span class="id"> ?mul1e//</span><span class="id"> unitfE</span><span class="id"> gt_eqF</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_pdivrMr</span><span class="id"> r</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> r</span>)<span class="id">%R</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> r^-1%:E</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> *</span><span class="id"> r%:E</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> r0;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> lee_pdivrMl//</span><span class="id"> muleC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_pdivlMl</span><span class="id"> r</span><span class="id"> y</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> r</span>)<span class="id">%R</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> r^-1%:E</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">r%:E</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> r0;</span><span class="id"> apply/idP/idP</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[-&gt;|];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lte_pdivlMl//</span><span class="id"> =&gt;</span><span class="id"> /ltW</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> muleA</span><span class="id"> -EFinM</span><span class="id"> divrr</span><span class="id"> ?mul1e//</span><span class="id"> unitfE</span><span class="id"> gt_eqF</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-|];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -lte_pdivlMl//</span><span class="id"> =&gt;</span><span class="id"> /ltW</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> muleA</span><span class="id"> -EFinM</span><span class="id"> mulVr</span><span class="id"> ?mul1e//</span><span class="id"> unitfE</span><span class="id"> gt_eqF</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_pdivlMr</span><span class="id"> r</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> r</span>)<span class="id">%R</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> *</span><span class="id"> r^-1%:E</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> r%:E</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> r0;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> lee_pdivlMl//</span><span class="id"> muleC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_ndivlMr</span><span class="id"> r</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">r</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> *</span><span class="id"> r^-1%:E</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> *</span><span class="id"> r%:E</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -oppr0</span><span class="id"> ltrNr</span><span class="id"> =&gt;</span><span class="id"> r0;</span><span class="id"> rewrite</span><span class="id"> -{1}</span>(<span class="id">opprK</span><span class="id"> r</span>)<span class="id"> invrN</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> EFinN</span><span class="id"> muleN</span><span class="id"> leeNr</span><span class="id"> lee_pdivrMr//</span><span class="id"> EFinN</span><span class="id"> muleNN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_ndivlMl</span><span class="id"> r</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">r</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> r^-1%:E</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> r%:E</span><span class="id"> *</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> r0;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> lee_ndivlMr//</span><span class="id"> muleC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_ndivrMl</span><span class="id"> r</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">r</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> -&gt;</span> (<span class="id">r^-1%:E</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">r%:E</span><span class="id"> *</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -oppr0</span><span class="id"> ltrNr</span><span class="id"> =&gt;</span><span class="id"> r0;</span><span class="id"> rewrite</span><span class="id"> -{1}</span>(<span class="id">opprK</span><span class="id"> r</span>)<span class="id"> invrN</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> EFinN</span><span class="id"> mulNe</span><span class="id"> leeNl</span><span class="id"> lee_pdivlMl//</span><span class="id"> EFinN</span><span class="id"> muleNN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_ndivrMr</span><span class="id"> r</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">r</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> r^-1%:E</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> r%:E</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> r0;</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> lee_ndivrMl//</span><span class="id"> muleC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqe_pdivrMl</span><span class="id"> r</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span> (<span class="id">r</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;((<span class="id">r^-1</span>)<span class="id">%:E</span><span class="id"> *</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> r%:E</span><span class="id"> *</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> neq_lt</span><span class="id"> =&gt;</span><span class="id"> /orP[|]</span><span class="id"> r0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eq_le</span><span class="id"> lee_ndivrMl//</span><span class="id"> lee_ndivlMl//</span><span class="id"> -eq_le</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eq_le</span><span class="id"> lee_pdivrMl//</span><span class="id"> lee_pdivlMl//</span><span class="id"> -eq_le</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> realFieldType_lemmas</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lte_pdivrMl`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_pdivr_mull</span><span class="id"> :=</span><span class="id"> lte_pdivrMl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lte_pdivrMr`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_pdivr_mulr</span><span class="id"> :=</span><span class="id"> lte_pdivrMr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lte_pdivlMl`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_pdivl_mull</span><span class="id"> :=</span><span class="id"> lte_pdivlMl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lte_pdivlMr`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_pdivl_mulr</span><span class="id"> :=</span><span class="id"> lte_pdivlMr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lee_pdivrMl`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_pdivr_mull</span><span class="id"> :=</span><span class="id"> lee_pdivrMl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lee_pdivrMr`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_pdivr_mulr</span><span class="id"> :=</span><span class="id"> lee_pdivrMr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lee_pdivlMl`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_pdivl_mull</span><span class="id"> :=</span><span class="id"> lee_pdivlMl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lee_pdivlMr`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_pdivl_mulr</span><span class="id"> :=</span><span class="id"> lee_pdivlMr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lte_ndivrMl`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_ndivr_mull</span><span class="id"> :=</span><span class="id"> lte_ndivrMl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lte_ndivrMr`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_ndivr_mulr</span><span class="id"> :=</span><span class="id"> lte_ndivrMr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lte_ndivlMl`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_ndivl_mull</span><span class="id"> :=</span><span class="id"> lte_ndivlMl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lte_ndivlMr`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lte_ndivl_mulr</span><span class="id"> :=</span><span class="id"> lte_ndivlMr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lee_ndivrMl`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_ndivr_mull</span><span class="id"> :=</span><span class="id"> lee_ndivrMl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lee_ndivrMr`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_ndivr_mulr</span><span class="id"> :=</span><span class="id"> lee_ndivrMr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lee_ndivlMl`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_ndivl_mull</span><span class="id"> :=</span><span class="id"> lee_ndivlMl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `lee_ndivlMr`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> lee_ndivl_mulr</span><span class="id"> :=</span><span class="id"> lee_ndivlMr</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.3.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `eqe_pdivrMl`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> eqe_pdivr_mull</span><span class="id"> :=</span><span class="id"> eqe_pdivrMl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> DualAddTheoryRealField</span>.<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> DualAddTheoryNumDomain</span><span class="id"> DualAddTheoryRealDomain</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> DualRealFieldType_lemmas</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> realFieldType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> \bar^d</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_daddgt0Pr</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> e,</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> e</span>)<span class="id">%R</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> +</span><span class="id"> e%:E</span>) (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> lee_addgt0Pr</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> DualRealFieldType_lemmas</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> DualAddTheoryRealField</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> sqrte</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> rcfType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> sqrte</span><span class="id"> x</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> x</span><span class="id"> is</span><span class="id"> +oo</span><span class="gallina-kwd"> then</span><span class="id"> +oo</span><span class="gallina-kwd"> else</span><span class="gallina-kwd"> if</span><span class="id"> x</span><span class="id"> is</span><span class="id"> r%:E</span><span class="gallina-kwd"> then</span> (<span class="id">Num</span>.<span class="id">sqrt</span><span class="id"> r</span>)<span class="id">%:E</span><span class="gallina-kwd"> else</span><span class="id"> 0</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrte0</span><span class="id"> :</span><span class="id"> sqrte</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> \bar</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> sqrtr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrte_ge0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> sqrte</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|//|];</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> ?leey//</span><span class="id"> lee_fin</span><span class="id"> sqrtr_ge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_sqrt</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">sqrte</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> sqrte</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x||]</span><span class="id"> [y||]</span><span class="id"> yge0</span><span class="id"> //=</span>.<br/>
<span class="id">-</span><span class="id"> exact:</span><span class="id"> mathcomp_extra</span>.<span class="id">ler_sqrt</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !leey</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> leNye</span><span class="id"> lee_fin</span><span class="id"> sqrtr_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrteM</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> sqrte</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> sqrte</span><span class="id"> x</span><span class="id"> *</span><span class="id"> sqrte</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x||]</span><span class="id"> [y||]</span><span class="id"> //=</span><span class="id"> age0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> sqrtrM</span><span class="id"> ?EFinM</span>.<br/>
<span class="id">-</span><span class="id"> move:</span><span class="id"> age0;</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> eqe</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-|x0]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mul0e</span><span class="id"> sqrte0</span><span class="id"> sqrtr0</span><span class="id"> mul0e</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulry</span><span class="id"> gtr0_sg</span><span class="id"> ?mul1e//</span><span class="id"> mulry</span><span class="id"> gtr0_sg</span><span class="id"> ?mul1e//</span><span class="id"> sqrtr_gt0</span>.<br/>
<span class="id">-</span><span class="id"> move:</span><span class="id"> age0;</span><span class="id"> rewrite</span><span class="id"> mule0</span><span class="id"> mulrNy</span><span class="id"> lee_fin</span><span class="id"> -sgr_ge0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> sgrP;</span><span class="id"> rewrite</span><span class="id"> ?mul0e</span><span class="id"> ?sqrte0//</span><span class="id"> ?mul1e//</span><span class="id"> ler0N1</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> !mulyr;</span><span class="id"> case:</span> (<span class="id">sgrP</span><span class="id"> y</span>)<span class="id"> =&gt;</span><span class="id"> [-&gt;||]</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> sqrtr0</span><span class="id"> sgr0</span><span class="id"> mul0e</span><span class="id"> sqrte0</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul1e/=</span><span class="id"> -sqrtr_gt0</span><span class="id"> -sgr_gt0</span><span class="id"> -lte_fin</span><span class="id"> =&gt;</span><span class="id"> /gt0_muley-&gt;</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> y0;</span><span class="id"> rewrite</span><span class="id"> EFinN</span><span class="id"> mulN1e/=</span><span class="id"> ltr0_sqrtr//</span><span class="id"> sgr0</span><span class="id"> mul0e</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulyy</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulyNy</span><span class="id"> mule0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqr_sqrte</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> sqrte</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x||]</span><span class="id"> xge0;</span><span class="id"> rewrite</span><span class="id"> expe2</span><span class="id"> ?mulyy//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -sqrteM//</span><span class="id"> -EFinM/=</span><span class="id"> sqrtr_sqr</span><span class="id"> ger0_norm</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrte_sqr</span><span class="id"> x</span><span class="id"> :</span><span class="id"> sqrte</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> 2</span>)<span class="id"> =</span><span class="id"> `|x|%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x||//];</span><span class="id"> rewrite</span><span class="id"> /expe/=</span><span class="id"> ?sqrtr_sqr//</span><span class="id"> mulyy</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sqrte_fin_num</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">sqrte</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|//|//];</span><span class="id"> rewrite</span><span class="id"> !qualifE/=</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> sqrte</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> DualAddTheory</span>.<br/>
<span class="vernacular">Export</span><span class="id"> DualAddTheoryNumDomain</span>.<br/>
<span class="vernacular">Export</span><span class="id"> DualAddTheoryRealDomain</span>.<br/>
<span class="vernacular">Export</span><span class="id"> DualAddTheoryRealField</span>.<br/>
<span class="vernacular">End</span><span class="id"> DualAddTheory</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> ConstructiveDualAddTheory</span>.<br/>
<span class="vernacular">Export</span><span class="id"> DualAddTheory</span>.<br/>
<span class="vernacular">End</span><span class="id"> ConstructiveDualAddTheory</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> posnume</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> numDomainType</span>)<span class="id"> of</span><span class="id"> phant</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {&gt;</span><span class="id"> 0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R}</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;{ 'posnum' '\bar' R }&quot;</span><span class="id"> :=</span> (<span class="id">@posnume</span><span class="id"> _</span> (<span class="id">Phant</span><span class="id"> R</span>))<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> nonnege</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> numDomainType</span>)<span class="id"> of</span><span class="id"> phant</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> {&gt;=</span><span class="id"> 0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R}</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;{ 'nonneg' '\bar' R }&quot;</span><span class="id"> :=</span> (<span class="id">@nonnege</span><span class="id"> _</span> (<span class="id">Phant</span><span class="id"> R</span>))<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x %:pos&quot;</span><span class="id"> :=</span> (<span class="id">widen_signed</span><span class="id"> x%:sgn</span><span class="id"> :</span><span class="id"> {posnum</span><span class="id"> \bar</span><span class="id"> _}</span>) (<span class="id">only</span><span class="id"> parsing</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x %:pos&quot;</span><span class="id"> :=</span> (<span class="id">widen_signed</span><span class="id"> x%:sgn</span><span class="id"> :</span><span class="id"> {posnum</span><span class="id"> \bar</span><span class="id"> _}</span>) (<span class="id">only</span><span class="id"> parsing</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x %:nng&quot;</span><span class="id"> :=</span> (<span class="id">widen_signed</span><span class="id"> x%:sgn</span><span class="id"> :</span><span class="id"> {nonneg</span><span class="id"> \bar</span><span class="id"> _}</span>) (<span class="id">only</span><span class="id"> parsing</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x %:nng&quot;</span><span class="id"> :=</span> (<span class="id">widen_signed</span><span class="id"> x%:sgn</span><span class="id"> :</span><span class="id"> {nonneg</span><span class="id"> \bar</span><span class="id"> _}</span>) (<span class="id">only</span><span class="id"> parsing</span>)<br/>
&nbsp;&nbsp;<span class="id">:</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x %:pos&quot;</span><span class="id"> :=</span> (<span class="id">@widen_signed</span><span class="id"> ereal_display</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">@Signed</span>.<span class="id">from</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">Phantom</span><span class="id"> _</span><span class="id"> x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">!=0</span> (<span class="id">KnownSign</span>.<span class="id">Real</span> (<span class="id">KnownSign</span>.<span class="id">Sign</span><span class="id"> &gt;=0</span>))<span class="id"> _</span><span class="id"> _</span>)<br/>
&nbsp;&nbsp;(<span class="id">only</span><span class="id"> printing</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x %:pos&quot;</span><span class="id"> :=</span> (<span class="id">@widen_signed</span><span class="id"> ereal_display</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">@Signed</span>.<span class="id">from</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">Phantom</span><span class="id"> _</span><span class="id"> x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">!=0</span> (<span class="id">KnownSign</span>.<span class="id">Real</span> (<span class="id">KnownSign</span>.<span class="id">Sign</span><span class="id"> &gt;=0</span>))<span class="id"> _</span><span class="id"> _</span>)<br/>
&nbsp;&nbsp;(<span class="id">only</span><span class="id"> printing</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x %:nng&quot;</span><span class="id"> :=</span> (<span class="id">@widen_signed</span><span class="id"> ereal_display</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">@Signed</span>.<span class="id">from</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">Phantom</span><span class="id"> _</span><span class="id"> x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">?=0</span> (<span class="id">KnownSign</span>.<span class="id">Real</span> (<span class="id">KnownSign</span>.<span class="id">Sign</span><span class="id"> &gt;=0</span>))<span class="id"> _</span><span class="id"> _</span>)<br/>
&nbsp;&nbsp;(<span class="id">only</span><span class="id"> printing</span>)<span class="id"> :</span><span class="id"> ereal_dual_scope</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x %:nng&quot;</span><span class="id"> :=</span> (<span class="id">@widen_signed</span><span class="id"> ereal_display</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">@Signed</span>.<span class="id">from</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">Phantom</span><span class="id"> _</span><span class="id"> x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">?=0</span> (<span class="id">KnownSign</span>.<span class="id">Real</span> (<span class="id">KnownSign</span>.<span class="id">Sign</span><span class="id"> &gt;=0</span>))<span class="id"> _</span><span class="id"> _</span>)<br/>
&nbsp;&nbsp;(<span class="id">only</span><span class="id"> printing</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">0%E</span><span class="id"> &lt;</span><span class="id"> _</span>)<span class="id">%O</span>)<span class="id"> =&gt;</span><span class="id"> solve</span><span class="id"> [apply:</span><span class="id"> gt0]</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (_<span class="id"> &lt;</span><span class="id"> 0%E</span>)<span class="id">%O</span>)<span class="id"> =&gt;</span><span class="id"> solve</span><span class="id"> [apply:</span><span class="id"> lt0]</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">0%E</span><span class="id"> &lt;=</span><span class="id"> _</span>)<span class="id">%O</span>)<span class="id"> =&gt;</span><span class="id"> solve</span><span class="id"> [apply:</span><span class="id"> ge0]</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (_<span class="id"> &lt;=</span><span class="id"> 0%E</span>)<span class="id">%O</span>)<span class="id"> =&gt;</span><span class="id"> solve</span><span class="id"> [apply:</span><span class="id"> le0]</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">0%E</span><span class="id"> &gt;=&lt;</span><span class="id"> _</span>)<span class="id">%O</span>)<span class="id"> =&gt;</span><span class="id"> solve</span><span class="id"> [apply:</span><span class="id"> cmp0]</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (_<span class="id"> !=</span><span class="id"> 0%E</span>)<span class="id">%O</span>)<span class="id"> =&gt;</span><span class="id"> solve</span><span class="id"> [apply:</span><span class="id"> neq0]</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> SignedNumDomainStability</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> numDomainType}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pinfty_snum_subproof</span><span class="id"> :</span><span class="id"> Signed</span>.<span class="id">spec</span><span class="id"> 0</span><span class="id"> !=0</span><span class="id"> &gt;=0</span> (<span class="id">+oo</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> le0y</span>. Qed.</div></details>
<br/>
<span class="vernacular">Canonical</span><span class="id"> pinfty_snum</span><span class="id"> :=</span><span class="id"> Signed</span>.<span class="id">mk</span> (<span class="id">pinfty_snum_subproof</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ninfty_snum_subproof</span><span class="id"> :</span><span class="id"> Signed</span>.<span class="id">spec</span><span class="id"> 0</span><span class="id"> !=0</span><span class="id"> &lt;=0</span> (<span class="id">-oo</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> leNy0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Canonical</span><span class="id"> ninfty_snum</span><span class="id"> :=</span><span class="id"> Signed</span>.<span class="id">mk</span> (<span class="id">ninfty_snum_subproof</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> EFin_snum_subproof</span><span class="id"> nz</span><span class="id"> cond</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> {num</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> nz</span><span class="id"> &amp;</span><span class="id"> cond}</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">Signed</span>.<span class="id">spec</span><span class="id"> 0</span><span class="id"> nz</span><span class="id"> cond</span><span class="id"> x%:num%:E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/andP;</span><span class="id"> split</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span><span class="id"> cond</span><span class="id"> nz</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [[[]|]|]</span><span class="id"> []</span><span class="id"> x</span><span class="id"> //=;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">do</span><span class="id"> ?[by</span><span class="id"> case:</span> (<span class="id">bottom</span><span class="id"> x</span>)<span class="id">|by</span><span class="id"> rewrite</span><span class="id"> eqe</span><span class="id"> eq0F]</span>.<br/>
<span class="id">case:</span><span class="id"> cond</span><span class="id"> nz</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [[[]|]|]</span><span class="id"> []</span><span class="id"> x</span><span class="id"> //=;</span><br/>
&nbsp;&nbsp;<span class="id">do</span><span class="id"> ?[by</span><span class="id"> case:</span> (<span class="id">bottom</span><span class="id"> x</span>)<span class="id">|by</span><span class="id"> rewrite</span><span class="id"> ?lee_fin</span><span class="id"> ?</span>(<span class="id">eq0,</span><span class="id"> ge0,</span><span class="id"> le0</span>)<span class="id"> ?[_</span><span class="id"> ||</span><span class="id"> _]cmp0]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Canonical</span><span class="id"> EFin_snum</span><span class="id"> nz</span><span class="id"> cond</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> {num</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> nz</span><span class="id"> &amp;</span><span class="id"> cond}</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Signed</span>.<span class="id">mk</span> (<span class="id">EFin_snum_subproof</span><span class="id"> x</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fine_snum_subproof</span> (<span class="id">xnz</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">nullity</span>) (<span class="id">xr</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">reality</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span><span class="id"> :</span><span class="id"> {compare</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> &amp;</span><span class="id"> xnz</span><span class="id"> &amp;</span><span class="id"> xr}</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">Signed</span>.<span class="id">spec</span><span class="id"> 0%R</span><span class="id"> ?=0</span><span class="id"> xr</span> (<span class="id">fine</span><span class="id"> x%:num</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> xr</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [[[]|]|]//=</span><span class="id"> [x</span><span class="id"> /andP[_]]/=</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /eqP</span><span class="id"> -&gt;</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /orP[];</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x||]//=;</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> ?orbT</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Canonical</span><span class="id"> fine_snum</span> (<span class="id">xnz</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">nullity</span>) (<span class="id">xr</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">reality</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span><span class="id"> :</span><span class="id"> {compare</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> &amp;</span><span class="id"> xnz</span><span class="id"> &amp;</span><span class="id"> xr}</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Signed</span>.<span class="id">mk</span> (<span class="id">fine_snum_subproof</span><span class="id"> x</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> oppe_snum_subproof</span> (<span class="id">xnz</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">nullity</span>) (<span class="id">xr</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">reality</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span><span class="id"> :</span><span class="id"> {compare</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> &amp;</span><span class="id"> xnz</span><span class="id"> &amp;</span><span class="id"> xr}</span>) (<span class="id">r</span><span class="id"> :=</span><span class="id"> opp_reality_subdef</span><span class="id"> xnz</span><span class="id"> xr</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">Signed</span>.<span class="id">spec</span><span class="id"> 0</span><span class="id"> xnz</span><span class="id"> r</span> (<span class="id">-</span><span class="id"> x%:num</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> {}/r;</span><span class="id"> case:</span><span class="id"> xr</span><span class="id"> xnz</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [[[]|]|]</span><span class="id"> []</span><span class="id"> x</span><span class="id"> //=;</span><br/>
&nbsp;&nbsp;<span class="id">do</span><span class="id"> ?[by</span><span class="id"> case:</span> (<span class="id">bottom</span><span class="id"> x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|by</span><span class="id"> rewrite</span><span class="id"> ?eqe_oppLR</span><span class="id"> ?oppe0</span><span class="id"> 1?eq0//;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> ?oppe_le0</span><span class="id"> ?oppe_ge0</span><span class="id"> ?</span>(<span class="id">eq0,</span><span class="id"> eq0F,</span><span class="id"> ge0,</span><span class="id"> le0</span>)<span class="id">//;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> orbC</span><span class="id"> [_</span><span class="id"> ||</span><span class="id"> _]cmp0]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Canonical</span><span class="id"> oppe_snum</span> (<span class="id">xnz</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">nullity</span>) (<span class="id">xr</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">reality</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span><span class="id"> :</span><span class="id"> {compare</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> &amp;</span><span class="id"> xnz</span><span class="id"> &amp;</span><span class="id"> xr}</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Signed</span>.<span class="id">mk</span> (<span class="id">oppe_snum_subproof</span><span class="id"> x</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> adde_snum_subproof</span> (<span class="id">xnz</span><span class="id"> ynz</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">nullity</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">xr</span><span class="id"> yr</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">reality</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span><span class="id"> :</span><span class="id"> {compare</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> &amp;</span><span class="id"> xnz</span><span class="id"> &amp;</span><span class="id"> xr}</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">y</span><span class="id"> :</span><span class="id"> {compare</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> &amp;</span><span class="id"> ynz</span><span class="id"> &amp;</span><span class="id"> yr}</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">rnz</span><span class="id"> :=</span><span class="id"> add_nonzero_subdef</span><span class="id"> xnz</span><span class="id"> ynz</span><span class="id"> xr</span><span class="id"> yr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">rrl</span><span class="id"> :=</span><span class="id"> add_reality_subdef</span><span class="id"> xnz</span><span class="id"> ynz</span><span class="id"> xr</span><span class="id"> yr</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">Signed</span>.<span class="id">spec</span><span class="id"> 0</span><span class="id"> rnz</span><span class="id"> rrl</span> (<span class="id">adde</span><span class="id"> x%:num</span><span class="id"> y%:num</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> {}/rnz</span><span class="id"> {}/rrl;</span><span class="id"> apply/andP;</span><span class="id"> split</span>.<br/>
&nbsp;&nbsp;<span class="id">move:</span><span class="id"> xr</span><span class="id"> yr</span><span class="id"> xnz</span><span class="id"> ynz</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [[[]|]|]</span><span class="id"> [[[]|]|]</span><span class="id"> []</span><span class="id"> []//=</span><span class="id"> x</span><span class="id"> y;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> 1?adde_ss_eq0</span><span class="id"> ?</span>(<span class="id">eq0F,</span><span class="id"> ge0,</span><span class="id"> le0,</span><span class="id"> andbF,</span><span class="id"> orbT</span>).<br/>
<span class="id">move:</span><span class="id"> xr</span><span class="id"> yr</span><span class="id"> xnz</span><span class="id"> ynz</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [[[]|]|]</span><span class="id"> [[[]|]|]</span><span class="id"> []</span><span class="id"> []//=</span><span class="id"> x</span><span class="id"> y;</span><br/>
&nbsp;&nbsp;<span class="id">do</span><span class="id"> ?[by</span><span class="id"> case:</span> (<span class="id">bottom</span><span class="id"> x</span>)<span class="id">|by</span><span class="id"> case:</span> (<span class="id">bottom</span><span class="id"> y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|by</span><span class="id"> rewrite</span><span class="id"> adde_ge0|by</span><span class="id"> rewrite</span><span class="id"> adde_le0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|exact:</span><span class="id"> realDe|by</span><span class="id"> rewrite</span><span class="id"> 2!eq0</span><span class="id"> /adde/=</span><span class="id"> addr0]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Canonical</span><span class="id"> adde_snum</span> (<span class="id">xnz</span><span class="id"> ynz</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">nullity</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">xr</span><span class="id"> yr</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">reality</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span><span class="id"> :</span><span class="id"> {compare</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> &amp;</span><span class="id"> xnz</span><span class="id"> &amp;</span><span class="id"> xr}</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">y</span><span class="id"> :</span><span class="id"> {compare</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> &amp;</span><span class="id"> ynz</span><span class="id"> &amp;</span><span class="id"> yr}</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Signed</span>.<span class="id">mk</span> (<span class="id">adde_snum_subproof</span><span class="id"> x</span><span class="id"> y</span>).<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> DualAddTheory</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dEFin_snum_subproof</span><span class="id"> nz</span><span class="id"> cond</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> {num</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> nz</span><span class="id"> &amp;</span><span class="id"> cond}</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">Signed</span>.<span class="id">spec</span><span class="id"> 0</span><span class="id"> nz</span><span class="id"> cond</span> (<span class="id">dEFin</span><span class="id"> x%:num</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> EFin_snum_subproof</span>. Qed.</div></details>
<br/>
<span class="vernacular">Canonical</span><span class="id"> dEFin_snum</span><span class="id"> nz</span><span class="id"> cond</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> {num</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> nz</span><span class="id"> &amp;</span><span class="id"> cond}</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Signed</span>.<span class="id">mk</span> (<span class="id">dEFin_snum_subproof</span><span class="id"> x</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dadde_snum_subproof</span> (<span class="id">xnz</span><span class="id"> ynz</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">nullity</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">xr</span><span class="id"> yr</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">reality</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span><span class="id"> :</span><span class="id"> {compare</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> &amp;</span><span class="id"> xnz</span><span class="id"> &amp;</span><span class="id"> xr}</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">y</span><span class="id"> :</span><span class="id"> {compare</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> &amp;</span><span class="id"> ynz</span><span class="id"> &amp;</span><span class="id"> yr}</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">rnz</span><span class="id"> :=</span><span class="id"> add_nonzero_subdef</span><span class="id"> xnz</span><span class="id"> ynz</span><span class="id"> xr</span><span class="id"> yr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">rrl</span><span class="id"> :=</span><span class="id"> add_reality_subdef</span><span class="id"> xnz</span><span class="id"> ynz</span><span class="id"> xr</span><span class="id"> yr</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">Signed</span>.<span class="id">spec</span><span class="id"> 0</span><span class="id"> rnz</span><span class="id"> rrl</span> (<span class="id">dual_adde</span><span class="id"> x%:num</span><span class="id"> y%:num</span>)<span class="id">%dE</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> {}/rnz</span><span class="id"> {}/rrl;</span><span class="id"> apply/andP;</span><span class="id"> split</span>.<br/>
&nbsp;&nbsp;<span class="id">move:</span><span class="id"> xr</span><span class="id"> yr</span><span class="id"> xnz</span><span class="id"> ynz</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [[[]|]|]</span><span class="id"> [[[]|]|]</span><span class="id"> []</span><span class="id"> []//=</span><span class="id"> x</span><span class="id"> y;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> 1?dadde_ss_eq0</span><span class="id"> ?</span>(<span class="id">eq0F,</span><span class="id"> ge0,</span><span class="id"> le0,</span><span class="id"> andbF,</span><span class="id"> orbT</span>).<br/>
<span class="id">move:</span><span class="id"> xr</span><span class="id"> yr</span><span class="id"> xnz</span><span class="id"> ynz</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [[[]|]|]</span><span class="id"> [[[]|]|]</span><span class="id"> []</span><span class="id"> []//=</span><span class="id"> x</span><span class="id"> y;</span><br/>
&nbsp;&nbsp;<span class="id">do</span><span class="id"> ?[by</span><span class="id"> case:</span> (<span class="id">bottom</span><span class="id"> x</span>)<span class="id">|by</span><span class="id"> case:</span> (<span class="id">bottom</span><span class="id"> y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|by</span><span class="id"> rewrite</span><span class="id"> dadde_ge0|by</span><span class="id"> rewrite</span><span class="id"> dadde_le0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|exact:</span><span class="id"> realDed|by</span><span class="id"> rewrite</span><span class="id"> 2!eq0</span><span class="id"> /dual_adde/=</span><span class="id"> addr0]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Canonical</span><span class="id"> dadde_snum</span> (<span class="id">xnz</span><span class="id"> ynz</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">nullity</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">xr</span><span class="id"> yr</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">reality</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span><span class="id"> :</span><span class="id"> {compare</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> &amp;</span><span class="id"> xnz</span><span class="id"> &amp;</span><span class="id"> xr}</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">y</span><span class="id"> :</span><span class="id"> {compare</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> &amp;</span><span class="id"> ynz</span><span class="id"> &amp;</span><span class="id"> yr}</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Signed</span>.<span class="id">mk</span> (<span class="id">dadde_snum_subproof</span><span class="id"> x</span><span class="id"> y</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mule_snum_subproof</span> (<span class="id">xnz</span><span class="id"> ynz</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">nullity</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">xr</span><span class="id"> yr</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">reality</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span><span class="id"> :</span><span class="id"> {compare</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> &amp;</span><span class="id"> xnz</span><span class="id"> &amp;</span><span class="id"> xr}</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">y</span><span class="id"> :</span><span class="id"> {compare</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> &amp;</span><span class="id"> ynz</span><span class="id"> &amp;</span><span class="id"> yr}</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">rnz</span><span class="id"> :=</span><span class="id"> mul_nonzero_subdef</span><span class="id"> xnz</span><span class="id"> ynz</span><span class="id"> xr</span><span class="id"> yr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">rrl</span><span class="id"> :=</span><span class="id"> mul_reality_subdef</span><span class="id"> xnz</span><span class="id"> ynz</span><span class="id"> xr</span><span class="id"> yr</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">Signed</span>.<span class="id">spec</span><span class="id"> 0</span><span class="id"> rnz</span><span class="id"> rrl</span> (<span class="id">x%:num</span><span class="id"> *</span><span class="id"> y%:num</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> {}/rnz</span><span class="id"> {}/rrl;</span><span class="id"> apply/andP;</span><span class="id"> split</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> xr</span><span class="id"> yr</span><span class="id"> xnz</span><span class="id"> ynz</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [[[]|]|]</span><span class="id"> [[[]|]|]</span><span class="id"> []</span><span class="id"> []//</span><span class="id"> x</span><span class="id"> y;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mule_neq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> xr</span><span class="id"> yr</span><span class="id"> xnz</span><span class="id"> ynz</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [[[]|]|]</span><span class="id"> [[[]|]|]</span><span class="id"> []</span><span class="id"> []/=</span><span class="id"> x</span><span class="id"> y</span><span class="id"> //;</span><br/>
&nbsp;&nbsp;<span class="id">do</span><span class="id"> ?[by</span><span class="id"> case:</span> (<span class="id">bottom</span><span class="id"> x</span>)<span class="id">|by</span><span class="id"> case:</span> (<span class="id">bottom</span><span class="id"> y</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|by</span><span class="id"> rewrite</span><span class="id"> mule_ge0|by</span><span class="id"> rewrite</span><span class="id"> mule_le0_ge0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|by</span><span class="id"> rewrite</span><span class="id"> mule_ge0_le0|by</span><span class="id"> rewrite</span><span class="id"> mule_le0|exact:</span><span class="id"> realMe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|by</span><span class="id"> rewrite</span><span class="id"> eq0</span><span class="id"> ?mule0//</span><span class="id"> mul0e]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Canonical</span><span class="id"> mule_snum</span> (<span class="id">xnz</span><span class="id"> ynz</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">nullity</span>) (<span class="id">xr</span><span class="id"> yr</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">reality</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span><span class="id"> :</span><span class="id"> {compare</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> &amp;</span><span class="id"> xnz</span><span class="id"> &amp;</span><span class="id"> xr}</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">y</span><span class="id"> :</span><span class="id"> {compare</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> &amp;</span><span class="id"> ynz</span><span class="id"> &amp;</span><span class="id"> yr}</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Signed</span>.<span class="id">mk</span> (<span class="id">mule_snum_subproof</span><span class="id"> x</span><span class="id"> y</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> abse_reality_subdef</span> (<span class="id">xnz</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">nullity</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">xr</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">reality</span>)<span class="id"> :=</span> (<span class="gallina-kwd">if</span><span class="id"> xr</span><span class="id"> is</span><span class="id"> =0</span><span class="gallina-kwd"> then</span><span class="id"> =0</span><span class="gallina-kwd"> else</span><span class="id"> &gt;=0</span>)<span class="id">%snum_sign</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> abse_reality_subdef</span><span class="id"> /</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> abse_snum_subproof</span> (<span class="id">xnz</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">nullity</span>) (<span class="id">xr</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">reality</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span><span class="id"> :</span><span class="id"> {compare</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> &amp;</span><span class="id"> xnz</span><span class="id"> &amp;</span><span class="id"> xr}</span>) (<span class="id">r</span><span class="id"> :=</span><span class="id"> abse_reality_subdef</span><span class="id"> xnz</span><span class="id"> xr</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">Signed</span>.<span class="id">spec</span><span class="id"> 0</span><span class="id"> xnz</span><span class="id"> r</span><span class="id"> `|x%:num|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> {}/r;</span><span class="id"> case:</span><span class="id"> xr</span><span class="id"> xnz</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [[[]|]|]</span><span class="id"> []</span><span class="id"> x</span><span class="id"> //=;</span><br/>
&nbsp;&nbsp;<span class="id">do</span><span class="id"> ?[by</span><span class="id"> case:</span> (<span class="id">bottom</span><span class="id"> x</span>)<span class="id">|by</span><span class="id"> rewrite</span><span class="id"> eq0</span><span class="id"> abse0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|by</span><span class="id"> rewrite</span><span class="id"> abse_ge0//</span><span class="id"> andbT</span><span class="id"> gee0_abs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|by</span><span class="id"> rewrite</span><span class="id"> abse_ge0//</span><span class="id"> andbT</span><span class="id"> lee0_abs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">|by</span><span class="id"> rewrite</span><span class="id"> abse_ge0//</span><span class="id"> andbT</span><span class="id"> abse_eq0]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Canonical</span><span class="id"> abse_snum</span> (<span class="id">xnz</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">nullity</span>) (<span class="id">xr</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">reality</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">x</span><span class="id"> :</span><span class="id"> {compare</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> &amp;</span><span class="id"> xnz</span><span class="id"> &amp;</span><span class="id"> xr}</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">Signed</span>.<span class="id">mk</span> (<span class="id">abse_snum_subproof</span><span class="id"> x</span>).<br/>
<br/>
<span class="vernacular">End</span><span class="id"> SignedNumDomainStability</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> MorphNum</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> numDomainType}</span><span class="id"> {nz</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">nullity}</span><span class="id"> {cond</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">reality}</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> nR</span><span class="id"> :=</span><span class="id"> {compare</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> &amp;</span><span class="id"> nz</span><span class="id"> &amp;</span><span class="id"> cond}</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">a</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> num_abse_eq0</span><span class="id"> a</span><span class="id"> :</span> (<span class="id">`|a|%:nng</span><span class="id"> ==</span><span class="id"> 0%:E%:nng</span>)<span class="id"> =</span> (<span class="id">a</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -abse_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> MorphNum</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> MorphReal</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> numDomainType}</span><span class="id"> {nz</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">nullity}</span><span class="id"> {r</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">real}</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> nR</span><span class="id"> :=</span><span class="id"> {compare</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> &amp;</span><span class="id"> nz</span><span class="id"> &amp;</span><span class="id"> r}</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> nR</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> num</span><span class="id"> :=</span> (<span class="id">@num</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> nz</span><span class="id"> r</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> num_lee_max</span><span class="id"> a</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">a</span><span class="id"> &lt;=</span><span class="id"> maxe</span><span class="id"> x%:num</span><span class="id"> y%:num</span><span class="id"> =</span> (<span class="id">a</span><span class="id"> &lt;=</span><span class="id"> x%:num</span>)<span class="id"> ||</span> (<span class="id">a</span><span class="id"> &lt;=</span><span class="id"> y%:num</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -comparable_le_max//</span><span class="id"> ereal_comparable</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> num_gee_max</span><span class="id"> a</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">maxe</span><span class="id"> x%:num</span> <span class="id"> y%:num</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> =</span> (<span class="id">x%:num</span><span class="id"> &lt;=</span><span class="id"> a</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y%:num</span><span class="id"> &lt;=</span><span class="id"> a</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -comparable_ge_max//</span><span class="id"> ereal_comparable</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> num_lee_min</span><span class="id"> a</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">a</span><span class="id"> &lt;=</span><span class="id"> mine</span><span class="id"> x%:num</span><span class="id"> y%:num</span><span class="id"> =</span> (<span class="id">a</span><span class="id"> &lt;=</span><span class="id"> x%:num</span>)<span class="id"> &amp;&amp;</span> (<span class="id">a</span><span class="id"> &lt;=</span><span class="id"> y%:num</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -comparable_le_min//</span><span class="id"> ereal_comparable</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> num_gee_min</span><span class="id"> a</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">mine</span><span class="id"> x%:num</span><span class="id"> y%:num</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> =</span> (<span class="id">x%:num</span><span class="id"> &lt;=</span><span class="id"> a</span>)<span class="id"> ||</span> (<span class="id">y%:num</span><span class="id"> &lt;=</span><span class="id"> a</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -comparable_ge_min//</span><span class="id"> ereal_comparable</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> num_lte_max</span><span class="id"> a</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">a</span><span class="id"> &lt;</span><span class="id"> maxe</span><span class="id"> x%:num</span><span class="id"> y%:num</span><span class="id"> =</span> (<span class="id">a</span><span class="id"> &lt;</span><span class="id"> x%:num</span>)<span class="id"> ||</span> (<span class="id">a</span><span class="id"> &lt;</span><span class="id"> y%:num</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -comparable_lt_max//</span><span class="id"> ereal_comparable</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> num_gte_max</span><span class="id"> a</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">maxe</span><span class="id"> x%:num</span> <span class="id"> y%:num</span><span class="id"> &lt;</span><span class="id"> a</span><span class="id"> =</span> (<span class="id">x%:num</span><span class="id"> &lt;</span><span class="id"> a</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y%:num</span><span class="id"> &lt;</span><span class="id"> a</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -comparable_gt_max//</span><span class="id"> ereal_comparable</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> num_lte_min</span><span class="id"> a</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">a</span><span class="id"> &lt;</span><span class="id"> mine</span><span class="id"> x%:num</span><span class="id"> y%:num</span><span class="id"> =</span> (<span class="id">a</span><span class="id"> &lt;</span><span class="id"> x%:num</span>)<span class="id"> &amp;&amp;</span> (<span class="id">a</span><span class="id"> &lt;</span><span class="id"> y%:num</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -comparable_lt_min//</span><span class="id"> ereal_comparable</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> num_gte_min</span><span class="id"> a</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">mine</span><span class="id"> x%:num</span><span class="id"> y%:num</span><span class="id"> &lt;</span><span class="id"> a</span><span class="id"> =</span> (<span class="id">x%:num</span><span class="id"> &lt;</span><span class="id"> a</span>)<span class="id"> ||</span> (<span class="id">y%:num</span><span class="id"> &lt;</span><span class="id"> a</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -comparable_gt_min//</span><span class="id"> ereal_comparable</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> MorphReal</span>.<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.2.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `num_lee_max`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> num_lee_maxr</span><span class="id"> :=</span><span class="id"> num_lee_max</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.2.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `num_gee_max`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> num_lee_maxl</span><span class="id"> :=</span><span class="id"> num_gee_max</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.2.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `num_lee_min`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> num_lee_minr</span><span class="id"> :=</span><span class="id"> num_lee_min</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.2.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `num_gee_min`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> num_lee_minl</span><span class="id"> :=</span><span class="id"> num_gee_min</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.2.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `num_lte_max`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> num_lte_maxr</span><span class="id"> :=</span><span class="id"> num_lte_max</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.2.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `num_gte_max`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> num_lte_maxl</span><span class="id"> :=</span><span class="id"> num_gte_max</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.2.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `num_lte_min`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> num_lte_minr</span><span class="id"> :=</span><span class="id"> num_lte_min</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.2.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `num_gte_min`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> num_lte_minl</span><span class="id"> :=</span><span class="id"> num_gte_min</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> MorphGe0</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> numDomainType}</span><span class="id"> {nz</span><span class="id"> :</span><span class="id"> KnownSign</span>.<span class="id">nullity}</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> nR</span><span class="id"> :=</span><span class="id"> {compare</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> &amp;</span><span class="id"> ?=0</span><span class="id"> &amp;</span><span class="id"> &gt;=0}</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> nR</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> num</span><span class="id"> :=</span> (<span class="id">@num</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> ?=0</span><span class="id"> &gt;=0</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> num_abse_le</span><span class="id"> a</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> -&gt;</span> (<span class="id">`|a|%:nng</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id">%O</span><span class="id"> =</span> (<span class="id">a</span><span class="id"> &lt;=</span><span class="id"> x%:num</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a0;</span><span class="id"> rewrite</span><span class="id"> -num_le//=</span><span class="id"> gee0_abs</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> num_abse_lt</span><span class="id"> a</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> -&gt;</span> (<span class="id">`|a|%:nng</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id">%O</span><span class="id"> =</span> (<span class="id">a</span><span class="id"> &lt;</span><span class="id"> x%:num</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a0;</span><span class="id"> rewrite</span><span class="id"> -num_lt/=</span><span class="id"> gee0_abs</span>. Qed.</div></details>
<span class="vernacular">End</span><span class="id"> MorphGe0</span>.<br/>
<br/>
<span class="vernacular">Variant</span><span class="id"> posnume_spec</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> numDomainType</span>) (<span class="id">x</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\bar</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span><span class="id"> :=</span><br/>
<span class="id">|</span><span class="id"> IsPinftyPosnume</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">posnume_spec</span><span class="id"> x</span><span class="id"> +oo</span><span class="id"> false</span><span class="id"> true</span><span class="id"> true</span><br/>
<span class="id">|</span><span class="id"> IsRealPosnume</span> (<span class="id">p</span><span class="id"> :</span><span class="id"> {posnum</span><span class="id"> R}</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">posnume_spec</span><span class="id"> x</span> (<span class="id">p%:num%:E</span>)<span class="id"> false</span><span class="id"> true</span><span class="id"> true</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> posnumeP</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> numDomainType</span>) (<span class="id">x</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">posnume_spec</span><span class="id"> x</span><span class="id"> x</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>) (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>) (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|_|//];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> le0y</span><span class="id"> lt0y;</span><span class="id"> exact:</span><span class="id"> IsPinftyPosnume</span>.<br/>
<span class="id">rewrite</span><span class="id"> lte_fin</span><span class="id"> lee_fin</span><span class="id"> eqe</span><span class="id"> =&gt;</span><span class="id"> x_gt0</span>.<br/>
<span class="id">rewrite</span><span class="id"> x_gt0</span> (<span class="id">ltW</span><span class="id"> x_gt0</span>) (<span class="id">negbTE</span> (<span class="id">lt0r_neq0</span><span class="id"> x_gt0</span>)).<br/>
<span class="id">exact:</span><span class="id"> IsRealPosnume</span> (<span class="id">PosNum</span><span class="id"> x_gt0</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Variant</span><span class="id"> nonnege_spec</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> numDomainType</span>) (<span class="id">x</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\bar</span><span class="id"> R</span><span class="id"> -&gt;</span><span class="id"> bool</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span><span class="id"> :=</span><br/>
<span class="id">|</span><span class="id"> IsPinftyNonnege</span><span class="id"> :</span><span class="id"> nonnege_spec</span><span class="id"> x</span><span class="id"> +oo</span><span class="id"> true</span><br/>
<span class="id">|</span><span class="id"> IsRealNonnege</span> (<span class="id">p</span><span class="id"> :</span><span class="id"> {nonneg</span><span class="id"> R}</span>)<span class="id"> :</span><span class="id"> nonnege_spec</span><span class="id"> x</span> (<span class="id">p%:num%:E</span>)<span class="id"> true</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nonnegeP</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> numDomainType</span>) (<span class="id">x</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">nonnege_spec</span><span class="id"> x</span><span class="id"> x</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|_|//];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> le0y;</span><span class="id"> exact:</span><span class="id"> IsPinftyNonnege</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> =&gt;</span><span class="id"> /[dup]</span><span class="id"> x_ge0</span><span class="id"> -&gt;;</span><span class="id"> exact:</span><span class="id"> IsRealNonnege</span> (<span class="id">NngNum</span><span class="id"> x_ge0</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> contract_expand</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> realFieldType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>) (<span class="id">r</span><span class="id"> :</span><span class="id"> R</span>).<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> ereal_scope</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> contract</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> x</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> r%:E</span><span class="id"> =&gt;</span><span class="id"> r</span><span class="id"> /</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> `|r|</span>)<span class="id"> |</span><span class="id"> +oo</span><span class="id"> =&gt;</span><span class="id"> 1</span><span class="id"> |</span><span class="id"> -oo</span><span class="id"> =&gt;</span><span class="id"> -1</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> contract_lt1</span><span class="id"> r</span><span class="id"> :</span> (<span class="id">`|contract</span><span class="id"> r%:E|</span><span class="id"> &lt;</span><span class="id"> 1</span>)<span class="id">%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> normrM</span><span class="id"> normrV</span><span class="id"> ?unitfE</span><span class="id"> //</span>.<br/>
<span class="id">rewrite</span><span class="id"> ltr_pdivrMr</span><span class="id"> //</span><span class="id"> ?mul1r//;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> gtr0_norm</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [ltRHS]gtr0_norm</span><span class="id"> ?ltrDr//</span><span class="id"> ltr_pwDl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> contract_le1</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">`|contract</span><span class="id"> x|</span><span class="id"> &lt;=</span><span class="id"> 1</span>)<span class="id">%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [r|</span><span class="id"> |]</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> ?normrN1</span><span class="id"> ?normr1</span><span class="id"> //</span> (<span class="id">ltW</span> (<span class="id">contract_lt1</span><span class="id"> _</span>)).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> contract0</span><span class="id"> :</span><span class="id"> contract</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /contract/=</span><span class="id"> mul0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> contractN</span><span class="id"> x</span><span class="id"> :</span><span class="id"> contract</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">-</span><span class="id"> contract</span><span class="id"> x</span>)<span class="id">%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> [r|];</span><span class="id"> [</span><span class="id"> rewrite</span><span class="id"> normrN</span><span class="id"> mulNr</span><span class="id"> |</span><span class="id"> rewrite</span><span class="id"> opprK]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> expand</span><span class="id"> r</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span> (<span class="id">r</span><span class="id"> &gt;=</span><span class="id"> 1</span>)<span class="id">%R</span><span class="gallina-kwd"> then</span><span class="id"> +oo</span><span class="gallina-kwd"> else</span><span class="gallina-kwd"> if</span> (<span class="id">r</span><span class="id"> &lt;=</span><span class="id"> -1</span>)<span class="id">%R</span><span class="gallina-kwd"> then</span><span class="id"> -oo</span><span class="gallina-kwd"> else</span> (<span class="id">r</span><span class="id"> /</span> (<span class="id">1</span><span class="id"> -</span><span class="id"> `|r|</span>))<span class="id">%:E</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expand1</span><span class="id"> r</span><span class="id"> :</span> (<span class="id">1</span><span class="id"> &lt;=</span><span class="id"> r</span>)<span class="id">%R</span><span class="id"> -&gt;</span><span class="id"> expand</span><span class="id"> r</span><span class="id"> =</span><span class="id"> +oo</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> r1;</span><span class="id"> rewrite</span><span class="id"> /expand</span><span class="id"> r1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expandN</span><span class="id"> r</span><span class="id"> :</span><span class="id"> expand</span> (<span class="id">-</span><span class="id"> r</span>)<span class="id">%R</span><span class="id"> =</span><span class="id"> -</span><span class="id"> expand</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /expand;</span><span class="id"> case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> [r1|]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> ifF;</span><span class="id"> [by</span><span class="id"> rewrite</span><span class="id"> ifT</span><span class="id"> //</span><span class="id"> -lerNr|apply/negbTE]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -ltNge</span><span class="id"> -</span>(<span class="id">opprK</span><span class="id"> r</span>)<span class="id"> -ltrNl</span> (<span class="id">lt_le_trans</span><span class="id"> _</span><span class="id"> r1</span>)<span class="id"> //</span><span class="id"> -subr_gt0</span><span class="id"> opprK</span>.<br/>
<span class="id">rewrite</span><span class="id"> -ltNge</span><span class="id"> =&gt;</span><span class="id"> r1;</span><span class="id"> case:</span><span class="id"> ifPn;</span><span class="id"> rewrite</span><span class="id"> lerNl</span><span class="id"> opprK;</span><span class="id"> [by</span><span class="id"> move=&gt;</span><span class="id"> -&gt;|]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -ltNge</span><span class="id"> leNgt</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> leNgt</span><span class="id"> -ltrNl</span><span class="id"> r1</span><span class="id"> /=</span><span class="id"> mulNr</span><span class="id"> normrN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expandN1</span><span class="id"> r</span><span class="id"> :</span> (<span class="id">r</span><span class="id"> &lt;=</span><span class="id"> -1</span>)<span class="id">%R</span><span class="id"> -&gt;</span><span class="id"> expand</span><span class="id"> r</span><span class="id"> =</span><span class="id"> -oo</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lerNr</span><span class="id"> =&gt;</span><span class="id"> /expand1/eqP;</span><span class="id"> rewrite</span><span class="id"> expandN</span><span class="id"> eqe_oppLR</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expand0</span><span class="id"> :</span><span class="id"> expand</span><span class="id"> 0%R</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /expand</span><span class="id"> leNgt</span><span class="id"> ltr01</span><span class="id"> /=</span><span class="id"> oppr_ge0</span><span class="id"> leNgt</span><span class="id"> ltr01</span><span class="id"> /=</span><span class="id"> mul0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expandK</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> [pred</span><span class="id"> r</span><span class="id"> |</span><span class="id"> `|r|</span><span class="id"> &lt;=</span><span class="id"> 1]%R,</span><span class="id"> cancel</span><span class="id"> expand</span><span class="id"> contract}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> r;</span><span class="id"> rewrite</span><span class="id"> inE</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /orP[|r1]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> eqr_norml</span><span class="id"> =&gt;</span><span class="id"> /andP[/orP[]/eqP-&gt;{r}]</span><span class="id"> _;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> [rewrite</span><span class="id"> expand1|rewrite</span><span class="id"> expandN1]</span>.<br/>
<span class="id">rewrite</span><span class="id"> /expand</span><span class="id"> 2!leNgt</span><span class="id"> ltrNl;</span><span class="id"> case/ltr_normlP</span><span class="id"> :</span> (<span class="id">r1</span>)<span class="id"> =&gt;</span><span class="id"> -&gt;</span><span class="id"> -&gt;</span><span class="id"> /=</span>.<br/>
<span class="id">have</span><span class="id"> r_pneq0</span><span class="id"> :</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> r</span><span class="id"> /</span> (<span class="id">1</span><span class="id"> -</span><span class="id"> r</span>)<span class="id"> !=</span><span class="id"> 0</span>)<span class="id">%R</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -[X</span><span class="gallina-kwd"> in</span> (<span class="id">X</span><span class="id"> +</span><span class="id"> _</span>)<span class="id">%R]</span>(<span class="id">@divrr</span><span class="id"> _</span> (<span class="id">1</span><span class="id"> -</span><span class="id"> r</span>)<span class="id">%R</span>)<span class="id"> -?mulrDl;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> subr_eq0</span><span class="id"> eq_sym</span><span class="id"> lt_eqF</span><span class="id"> //</span><span class="id"> ltr_normlW</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> subrK</span><span class="id"> mulf_neq0</span><span class="id"> //</span><span class="id"> invr_eq0</span><span class="id"> subr_eq0</span><span class="id"> eq_sym</span><span class="id"> lt_eqF</span><span class="id"> //</span><span class="id"> ltr_normlW</span>.<br/>
<span class="id">have</span><span class="id"> r_nneq0</span><span class="id"> :</span> (<span class="id">1</span><span class="id"> -</span><span class="id"> r</span><span class="id"> /</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> r</span>)<span class="id"> !=</span><span class="id"> 0</span>)<span class="id">%R</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -[X</span><span class="gallina-kwd"> in</span> (<span class="id">X</span><span class="id"> +</span><span class="id"> _</span>)<span class="id">%R]</span>(<span class="id">@divrr</span><span class="id"> _</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> r</span>)<span class="id">%R</span>)<span class="id"> -?mulrBl;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> addrC</span><span class="id"> addr_eq0</span><span class="id"> gt_eqF</span><span class="id"> //</span><span class="id"> ltrNnormlW</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> addrK</span><span class="id"> mulf_neq0</span><span class="id"> //</span><span class="id"> invr_eq0</span><span class="id"> addr_eq0</span><span class="id"> -eqr_oppLR</span><span class="id"> eq_sym</span><span class="id"> gt_eqF</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span><span class="id"> ltrNnormlW</span>.<br/>
<span class="id">wlog</span><span class="id"> :</span><span class="id"> r</span><span class="id"> r1</span><span class="id"> r_pneq0</span><span class="id"> r_nneq0</span><span class="id"> /</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> r</span>)<span class="id">%R</span><span class="id"> =&gt;</span><span class="id"> wlog_r0</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [r0|r0]</span><span class="id"> :=</span><span class="id"> lerP</span><span class="id"> 0</span><span class="id"> r;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> wlog_r0</span>.<br/>
&nbsp;&nbsp;<span class="id">move:</span> (<span class="id">wlog_r0</span> (<span class="id">-</span><span class="id"> r</span>)<span class="id">%R</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !</span>(<span class="id">normrN,</span><span class="id"> opprK,</span><span class="id"> mulNr</span>)<span class="id"> oppr_ge0</span><span class="id"> =&gt;</span><span class="id"> /</span>(_<span class="id"> r1</span><span class="id"> r_nneq0</span><span class="id"> r_pneq0</span> (<span class="id">ltW</span><span class="id"> r0</span>)).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move/eqP;</span><span class="id"> rewrite</span><span class="id"> eqr_opp</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>.<br/>
<span class="id">rewrite</span><span class="id"> /contract</span><span class="id"> !ger0_norm</span><span class="id"> //;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> divr_ge0</span><span class="id"> //</span><span class="id"> subr_ge0</span> (<span class="id">le_trans</span><span class="id"> _</span> (<span class="id">ltW</span><span class="id"> r1</span>))<span class="id"> //</span><span class="id"> ler_norm</span>.<br/>
<span class="id">apply:</span> (<span class="id">@mulIr</span><span class="id"> _</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> r</span><span class="id"> /</span> (<span class="id">1</span><span class="id"> -</span><span class="id"> r</span>))<span class="id">%R</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> unitfE</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">mulrA</span> (<span class="id">r</span><span class="id"> /</span><span class="id"> _</span>))<span class="id"> mulVr</span><span class="id"> ?unitfE</span><span class="id"> //</span><span class="id"> mulr1</span>.<br/>
<span class="id">rewrite</span><span class="id"> -[X</span><span class="gallina-kwd"> in</span> (<span class="id">X</span><span class="id"> +</span><span class="id"> _</span><span class="id"> /</span><span class="id"> _</span>)<span class="id">%R]</span>(<span class="id">@divrr</span><span class="id"> _</span> (<span class="id">1</span><span class="id"> -</span><span class="id"> r</span>)<span class="id">%R</span>)<span class="id"> -?mulrDl</span><span class="id"> ?subrK</span><span class="id"> ?div1r</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> unitfE</span><span class="id"> subr_eq0</span><span class="id"> eq_sym</span><span class="id"> lt_eqF</span><span class="id"> //</span><span class="id"> ltr_normlW</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> le_contract</span><span class="id"> :</span><span class="id"> {mono</span><span class="id"> contract</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id">%O}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span><span class="id"> le_mono;</span><span class="id"> move=&gt;</span><span class="id"> -[r0</span><span class="id"> |</span><span class="id"> |</span><span class="id"> ]</span><span class="id"> [r1</span><span class="id"> |</span><span class="id"> _</span><span class="id"> |</span><span class="id"> _]</span><span class="id"> //=</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> lte_fin</span><span class="id"> =&gt;</span><span class="id"> r0r1;</span><span class="id"> rewrite</span><span class="id"> ltr_pdivrMr</span><span class="id"> ?ltr_wpDr//</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mulrAC</span><span class="id"> ltr_pdivlMr</span><span class="id"> ?ltr_wpDr//</span><span class="id"> 2?mulrDr</span><span class="id"> 2?mulr1</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [r10|?]</span><span class="id"> :=</span><span class="id"> ler0P</span><span class="id"> r1;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> ltr_leD</span><span class="id"> //</span><span class="id"> mulrC;</span><span class="id"> have</span><span class="id"> [r00|//]</span><span class="id"> :=</span><span class="id"> ler0P</span><span class="id"> r0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">@le_trans</span><span class="id"> _</span><span class="id"> _</span><span class="id"> 0%R</span>)<span class="id"> //</span><span class="id"> ?pmulr_rle0//</span><span class="id"> mulr_ge0//</span><span class="id"> ?oppr_ge0//</span><span class="id"> ltW</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [?|r00]</span><span class="id"> :=</span><span class="id"> ler0P</span><span class="id"> r0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltr_leD</span><span class="id"> //</span><span class="id"> 2!mulrN</span><span class="id"> mulrC</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move:</span> (<span class="id">le_lt_trans</span><span class="id"> r10</span> (<span class="id">lt_trans</span><span class="id"> r00</span><span class="id"> r0r1</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ltxx</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltr_pdivrMr</span><span class="id"> ?ltr_wpDr//</span><span class="id"> mul1r</span><span class="id"> ltr_pwDl</span><span class="id"> //</span><span class="id"> ler_norm</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> ltr_pdivlMr</span><span class="id"> ?mulN1r</span><span class="id"> ?ltr_wpDr//</span><span class="id"> =&gt;</span><span class="id"> _</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltrNl</span><span class="id"> ltr_pwDl</span><span class="id"> //</span><span class="id"> ler_normr</span><span class="id"> lexx</span><span class="id"> orbT</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -subr_gt0</span><span class="id"> opprK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lt_contract</span><span class="id"> :=</span><span class="id"> leW_mono</span><span class="id"> le_contract</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> contract_inj</span><span class="id"> :=</span><span class="id"> mono_inj</span><span class="id"> lexx</span><span class="id"> le_anti</span><span class="id"> le_contract</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> le_expand_in</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> [pred</span><span class="id"> r</span><span class="id"> |</span><span class="id"> `|r|</span><span class="id"> &lt;=</span><span class="id"> 1]%R</span><span class="id"> &amp;,</span><br/>
&nbsp;&nbsp;<span class="id">{mono</span><span class="id"> expand</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id">%O}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> can_mono_in</span> (<span class="id">onW_can_in</span><span class="id"> predT</span><span class="id"> expandK</span>)<span class="id"> _</span> (<span class="id">in2W</span><span class="id"> le_contract</span>). Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lt_expand</span><span class="id"> :=</span><span class="id"> leW_mono_in</span><span class="id"> le_expand_in</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> expand_inj</span><span class="id"> :=</span><span class="id"> mono_inj_in</span><span class="id"> lexx</span><span class="id"> le_anti</span><span class="id"> le_expand_in</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fine_expand</span><span class="id"> r</span><span class="id"> :</span> (<span class="id">`|r|</span><span class="id"> &lt;</span><span class="id"> 1</span>)<span class="id">%R</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">fine</span> (<span class="id">expand</span><span class="id"> r</span>))<span class="id">%:E</span><span class="id"> =</span><span class="id"> expand</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> r1;</span><span class="id"> rewrite</span><span class="id"> /expand</span><span class="id"> 2!leNgt</span><span class="id"> ltrNl;</span><span class="id"> case/ltr_normlP</span><span class="id"> :</span><span class="id"> r1</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span><span class="id"> -&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> le_expand</span><span class="id"> :</span><span class="id"> {homo</span><span class="id"> expand</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id">%O}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> xy;</span><span class="id"> have</span><span class="id"> [x1|]</span><span class="id"> :=</span><span class="id"> lerP</span><span class="id"> `|x|</span><span class="id"> 1</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [y_le1|/ltW</span><span class="id"> /expand1-&gt;]</span><span class="id"> :=</span><span class="id"> leP</span><span class="id"> y</span><span class="id"> 1%R;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> leey</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> le_expand_in</span><span class="id"> ?inE//</span><span class="id"> ler_norml</span><span class="id"> y_le1</span> (<span class="id">le_trans</span><span class="id"> _</span><span class="id"> xy</span>)<span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lerNl</span> (<span class="id">ler_normlP</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>).<br/>
<span class="id">rewrite</span><span class="id"> ltr_normr</span><span class="id"> =&gt;</span><span class="id"> /orP[|]</span><span class="id"> x1;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> expandN1</span><span class="id"> //</span><span class="id"> ?leNye</span><span class="id"> //</span><span class="id"> lerNr</span><span class="id"> ltW</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> expand1;</span><span class="id"> [rewrite</span><span class="id"> expand1</span><span class="id"> //</span> (<span class="id">le_trans</span><span class="id"> _</span><span class="id"> xy</span>)<span class="id"> //</span><span class="id"> ltW</span><span class="id"> |</span><span class="id"> exact:</span><span class="id"> ltW]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expand_eqoo</span><span class="id"> r</span><span class="id"> :</span> (<span class="id">expand</span><span class="id"> r</span><span class="id"> ==</span><span class="id"> +oo</span>)<span class="id"> =</span> (<span class="id">1</span><span class="id"> &lt;=</span><span class="id"> r</span>)<span class="id">%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /expand;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> case:</span><span class="id"> ifP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expand_eqNoo</span><span class="id"> r</span><span class="id"> :</span> (<span class="id">expand</span><span class="id"> r</span><span class="id"> ==</span><span class="id"> -oo</span>)<span class="id"> =</span> (<span class="id">r</span><span class="id"> &lt;=</span><span class="id"> -1</span>)<span class="id">%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /expand;</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> r1;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> ifP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/esym/negbTE;</span><span class="id"> rewrite</span><span class="id"> -ltNge</span> (<span class="id">lt_le_trans</span><span class="id"> _</span><span class="id"> r1</span>)<span class="id"> //</span><span class="id"> -subr_gt0</span><span class="id"> opprK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> contract_expand</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> ereal_PseudoMetric</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> realFieldType}</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>) (<span class="id">r</span><span class="id"> :</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> ereal_ball</span><span class="id"> x</span><span class="id"> r</span><span class="id"> y</span><span class="id"> :=</span> (<span class="id">`|contract</span><span class="id"> x</span><span class="id"> -</span><span class="id"> contract</span><span class="id"> y|</span><span class="id"> &lt;</span><span class="id"> r</span>)<span class="id">%R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ereal_ball_center</span><span class="id"> x</span><span class="id"> r</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> r</span>)<span class="id">%R</span><span class="id"> -&gt;</span><span class="id"> ereal_ball</span><span class="id"> x</span><span class="id"> r</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> e0;</span><span class="id"> rewrite</span><span class="id"> /ereal_ball</span><span class="id"> subrr</span><span class="id"> normr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ereal_ball_sym</span><span class="id"> x</span><span class="id"> y</span><span class="id"> r</span><span class="id"> :</span><span class="id"> ereal_ball</span><span class="id"> x</span><span class="id"> r</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> ereal_ball</span><span class="id"> y</span><span class="id"> r</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /ereal_ball</span><span class="id"> distrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ereal_ball_triangle</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> r1</span><span class="id"> r2</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">ereal_ball</span><span class="id"> x</span><span class="id"> r1</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> ereal_ball</span><span class="id"> y</span><span class="id"> r2</span><span class="id"> z</span><span class="id"> -&gt;</span><span class="id"> ereal_ball</span><span class="id"> x</span> (<span class="id">r1</span><span class="id"> +</span><span class="id"> r2</span>)<span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /ereal_ball</span><span class="id"> =&gt;</span><span class="id"> h1</span><span class="id"> h2;</span><span class="id"> rewrite</span><span class="id"> -[X</span><span class="gallina-kwd"> in</span> (<span class="id">X</span><span class="id"> -</span><span class="id"> _</span>)<span class="id">%R]</span>(<span class="id">subrK</span> (<span class="id">contract</span><span class="id"> y</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -addrA</span> (<span class="id">le_lt_trans</span> (<span class="id">ler_normD</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> //</span><span class="id"> ltrD</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ereal_ballN</span><span class="id"> x</span><span class="id"> y</span> (<span class="id">e</span><span class="id"> :</span><span class="id"> {posnum</span><span class="id"> R}</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">ereal_ball</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> e%:num</span> (<span class="id">-</span><span class="id"> y</span>)<span class="id"> -&gt;</span><span class="id"> ereal_ball</span><span class="id"> x</span><span class="id"> e%:num</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /ereal_ball</span><span class="id"> 2!contractN</span><span class="id"> opprK</span><span class="id"> -opprB</span><span class="id"> normrN</span><span class="id"> addrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ereal_ball_ninfty_oversize</span> (<span class="id">e</span><span class="id"> :</span><span class="id"> {posnum</span><span class="id"> R}</span>)<span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">2</span><span class="id"> &lt;</span><span class="id"> e%:num</span>)<span class="id">%R</span><span class="id"> -&gt;</span><span class="id"> ereal_ball</span><span class="id"> -oo</span><span class="id"> e%:num</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> e2;</span><span class="id"> rewrite</span><span class="id"> /ereal_ball</span><span class="id"> /=</span> (<span class="id">le_lt_trans</span><span class="id"> _</span><span class="id"> e2</span>)<span class="id"> //</span><span class="id"> -opprB</span><span class="id"> normrN</span><span class="id"> opprK</span>.<br/>
<span class="id">rewrite</span> (<span class="id">le_trans</span> (<span class="id">ler_normD</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> //</span><span class="id"> normr1</span><span class="id"> -lerBrDr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">le_trans</span> (<span class="id">contract_le1</span><span class="id"> _</span>))<span class="id"> //</span> (_<span class="id"> :</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> +</span><span class="id"> 1</span>)<span class="id">%R</span><span class="id"> //</span><span class="id"> addrK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> contract_ereal_ball_pinfty</span><span class="id"> r</span> (<span class="id">e</span><span class="id"> :</span><span class="id"> {posnum</span><span class="id"> R}</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">1</span><span class="id"> &lt;</span><span class="id"> contract</span><span class="id"> r%:E</span><span class="id"> +</span><span class="id"> e%:num</span>)<span class="id">%R</span><span class="id"> -&gt;</span><span class="id"> ereal_ball</span><span class="id"> r%:E</span><span class="id"> e%:num</span><span class="id"> +oo</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> re1;</span><span class="id"> rewrite</span><span class="id"> /ereal_ball;</span><span class="id"> rewrite</span><span class="id"> [contract</span><span class="id"> +oo]/=</span><span class="id"> ler0_norm;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> subr_le0;</span><span class="id"> case/ler_normlP:</span> (<span class="id">contract_le1</span><span class="id"> r%:E</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> opprB</span><span class="id"> ltrBlDl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> ereal_PseudoMetric</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lt_ereal_nbhs</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> realFieldType</span>) (<span class="id">a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>) (<span class="id">r</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">a</span><span class="id"> &lt;</span><span class="id"> r%:E</span><span class="id"> -&gt;</span><span class="id"> r%:E</span><span class="id"> &lt;</span><span class="id"> b</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span><span class="id"> delta</span><span class="id"> :</span><span class="id"> {posnum</span><span class="id"> R},</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> y,</span> (<span class="id">`|y</span><span class="id"> -</span><span class="id"> r|</span><span class="id"> &lt;</span><span class="id"> delta%:num</span>)<span class="id">%R</span><span class="id"> -&gt;</span> (<span class="id">a</span><span class="id"> &lt;</span><span class="id"> y%:E</span>)<span class="id"> &amp;&amp;</span> (<span class="id">y%:E</span><span class="id"> &lt;</span><span class="id"> b</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> [:wlog];</span><span class="id"> case:</span><span class="id"> a</span><span class="id"> b</span><span class="id"> =&gt;</span><span class="id"> [a||]</span><span class="id"> [b||]</span><span class="id"> //=</span><span class="id"> ltax</span><span class="id"> ltxb</span>.<br/>
<span class="id">-</span><span class="id"> move:</span><span class="id"> a</span><span class="id"> b</span><span class="id"> ltax</span><span class="id"> ltxb;</span><span class="id"> abstract:</span><span class="id"> wlog</span>. <span class="comment">(*BUG*)</span><br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> {}a</span><span class="id"> {}b</span><span class="id"> ltxa</span><span class="id"> ltxb</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> m_gt0</span><span class="id"> :</span> (<span class="id">Num</span>.<span class="id">min</span> ((<span class="id">r</span><span class="id"> -</span><span class="id"> a</span>)<span class="id"> /</span><span class="id"> 2</span>) ((<span class="id">b</span><span class="id"> -</span><span class="id"> r</span>)<span class="id"> /</span><span class="id"> 2</span>)<span class="id"> &gt;</span><span class="id"> 0</span>)<span class="id">%R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lt_min</span><span class="id"> !divr_gt0</span><span class="id"> //</span><span class="id"> ?subr_gt0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span> (<span class="id">PosNum</span><span class="id"> m_gt0</span>)<span class="id"> =&gt;</span><span class="id"> y</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> lt_min</span><span class="id"> !ltr_distl</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> /andP[/andP[ay</span><span class="id"> _]</span><span class="id"> /andP[_</span><span class="id"> yb]]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> 2!lte_fin</span> (<span class="id">lt_trans</span><span class="id"> _</span><span class="id"> ay</span>)<span class="id"> ?</span>(<span class="id">lt_trans</span><span class="id"> yb</span>)<span class="id"> //=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -subr_gt0</span><span class="id"> opprD</span><span class="id"> addrA</span><span class="id"> {1}[</span>(<span class="id">b</span><span class="id"> -</span><span class="id"> r</span>)<span class="id">%R]splitr</span><span class="id"> addrK</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> divr_gt0</span><span class="id"> ?subr_gt0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -subr_gt0</span><span class="id"> addrAC</span><span class="id"> {1}[</span>(<span class="id">r</span><span class="id"> -</span><span class="id"> a</span>)<span class="id">%R]splitr</span><span class="id"> addrK</span><span class="id"> divr_gt0</span><span class="id"> ?subr_gt0</span>.<br/>
<span class="id">-</span><span class="id"> have</span><span class="id"> [//||d</span><span class="id"> dP]</span><span class="id"> :=</span><span class="id"> wlog</span><span class="id"> a</span> (<span class="id">r</span><span class="id"> +</span><span class="id"> 1</span>)<span class="id">%R;</span><span class="id"> rewrite</span><span class="id"> ?lte_fin</span><span class="id"> ?ltrDl</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> d</span><span class="id"> =&gt;</span><span class="id"> y</span><span class="id"> /dP</span><span class="id"> /andP[-&gt;]</span><span class="id"> /=</span><span class="id"> /lt_le_trans;</span><span class="id"> apply;</span><span class="id"> rewrite</span><span class="id"> leey</span>.<br/>
<span class="id">-</span><span class="id"> have</span><span class="id"> [//||d</span><span class="id"> dP]</span><span class="id"> :=</span><span class="id"> wlog</span> (<span class="id">r</span><span class="id"> -</span><span class="id"> 1</span>)<span class="id">%R</span><span class="id"> b;</span><span class="id"> rewrite</span><span class="id"> ?lte_fin</span><span class="id"> ?gtrDl</span><span class="id"> ?ltrN10</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> d</span><span class="id"> =&gt;</span><span class="id"> y</span><span class="id"> /dP</span><span class="id"> /andP[_</span><span class="id"> -&gt;]</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> ltNyr</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="gallina-kwd"> exists</span><span class="id"> 1%:pos%R</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> ltNyr</span><span class="id"> ltry</span>.<br/>
Qed.</div></details>

      <div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/">a fork of coq2html</a></div>
    </div>
  </div>
    </main>
</body>
</html>
