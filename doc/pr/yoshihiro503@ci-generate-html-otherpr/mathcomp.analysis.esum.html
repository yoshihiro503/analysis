
<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module mathcomp.analysis.esum</title>
<meta name="description" content="Documentation of Coq module mathcomp.analysis.esum" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init()">

  <main>
    <div class="sidebar">
      <h2>Files</h2>
      
    </div>

  <div class="coq">

    <div class="content">
      <p><a href="./index.html">Top</a></p>
      <h1 class="title">Module mathcomp.analysis.esum</h1>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> all_ssreflect</span><span class="id"> ssralg</span><span class="id"> ssrnum</span><span class="id"> finmap</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> mathcomp_extra</span><span class="id"> boolp</span><span class="id"> classical_sets</span><span class="id"> functions</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> cardinality</span><span class="id"> fsbigop</span><span class="id"> reals</span><span class="id"> ereal</span><span class="id"> signed</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> topology</span><span class="id"> sequences</span><span class="id"> normedtype</span><span class="id"> numfun</span>.<br/>
<br/>
<div class="ssrdoc md">
# Summation over classical sets

This file provides a definition of sum over classical sets and a few
lemmas in particular for the case of sums of non-negative terms.

```
           fsets S == the set of finite sets (fset) included in S
\esum_(i in I) f i == summation of non-negative extended real numbers over
                      classical sets; I is a classical set and f is a
                      function whose codomain is included in the extended
                      reals; it is 0 if I = set0 and sup(\sum_A a) where A
                      is a finite set included in I o.w.
      summable D f := \esum_(x in D) `| f x | &lt; +oo
```

</div>
<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;\esum_ ( i 'in' P ) F&quot;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">at</span><span class="id"> level</span><span class="id"> 41,</span><span class="id"> F</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 41,</span><span class="id"> format</span> <span class="id">&quot;\esum_ ( i  'in'  P )  F&quot;</span>).<br/>
<br/>
<span class="gallina-kwd">Set</span><span class="vernacular"> Implicit</span><span class="vernacular"> Arguments</span>.<br/>
<span class="vernacular">Unset</span><span class="vernacular"> Strict</span><span class="vernacular"> Implicit</span>.<br/>
<span class="vernacular">Unset</span><span class="vernacular"> Printing</span><span class="vernacular"> Implicit</span><span class="vernacular"> Defensive</span>.<br/>
<span class="vernacular">Import</span><span class="id"> Order</span>.<span class="id">TTheory</span><span class="id"> GRing</span>.<span class="id">Theory</span><span class="id"> Num</span>.<span class="id">Def</span><span class="id"> Num</span>.<span class="id">Theory</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> classical_set_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> ereal_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> set_of_fset_in_a_set</span>.<br/>
<span class="vernacular">Variable</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> choiceType</span>).<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> S</span><span class="id"> :</span><span class="id"> set</span><span class="id"> T</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> fsets</span><span class="id"> S</span><span class="id"> :</span><span class="id"> set</span> (<span class="id">set</span><span class="id"> T</span>)<span class="id"> :=</span><span class="id"> [set</span><span class="id"> F</span><span class="id"> |</span><span class="id"> finite_set</span><span class="id"> F</span><span class="id"> /\</span><span class="id"> F</span><span class="id"> `&lt;=`</span><span class="id"> S]</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fsets_set0</span><span class="id"> S</span><span class="id"> :</span><span class="id"> fsets</span><span class="id"> S</span><span class="id"> set0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fsets_self</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> set</span><span class="id"> T</span>)<span class="id"> :</span><span class="id"> finite_set</span><span class="id"> F</span><span class="id"> -&gt;</span><span class="id"> fsets</span><span class="id"> F</span><span class="id"> F</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> finF;</span><span class="id"> split</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fsets0</span><span class="id"> :</span><span class="id"> fsets</span><span class="id"> set0</span><span class="id"> =</span><span class="id"> [set</span><span class="id"> set0]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> predeqE</span><span class="id"> =&gt;</span><span class="id"> A;</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> [|-&gt;];</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> fsets_set0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /fsets/=</span><span class="id"> subset0</span><span class="id"> =&gt;</span><span class="id"> -[]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> set_of_fset_in_a_set</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> esum</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> realFieldType</span>) (<span class="id">T</span><span class="id"> :</span><span class="id"> choiceType</span>).<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> set</span><span class="id"> T</span>) (<span class="id">a</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> esum</span><span class="id"> S</span><span class="id"> a</span><span class="id"> :=</span><span class="id"> ereal_sup</span><span class="id"> [set</span><span class="id"> \sum_</span>(<span class="id">x</span><span class="id"> \in</span><span class="id"> A</span>)<span class="id"> a</span><span class="id"> x</span><span class="id"> |</span><span class="id"> A</span><span class="gallina-kwd"> in</span><span class="id"> fsets</span><span class="id"> S]</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;\esum_ ( i 'in' P ) A&quot;</span><span class="id"> :=</span> (<span class="id">esum</span><span class="id"> P</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> A</span>)).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> esum_set0</span><span class="id"> a</span><span class="id"> :</span><span class="id"> \esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> set0</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /esum</span><span class="id"> fsets0</span><span class="id"> [X</span><span class="gallina-kwd"> in</span><span class="id"> ereal_sup</span><span class="id"> X]</span>(_<span class="id"> :</span><span class="id"> _</span><span class="id"> =</span><span class="id"> [set</span><span class="id"> 0%E]</span>)<span class="id"> ?ereal_sup1//</span>.<br/>
<span class="id">apply/seteqP;</span><span class="id"> split=&gt;</span><span class="id"> [x</span><span class="id"> [_</span><span class="id"> /=</span><span class="id"> -&gt;]|x];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> fsbig_set0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> -&gt;</span><span class="id"> /=;</span><span class="gallina-kwd"> exists</span><span class="id"> set0</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> fsbig_set0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> esum</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;\esum_ ( i 'in' P ) F&quot;</span><span class="id"> :=</span> (<span class="id">esum</span><span class="id"> P</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> F</span>))<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> esum_realType</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> realType</span>) (<span class="id">T</span><span class="id"> :</span><span class="id"> choiceType</span>).<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">a</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> esum_ge0</span> (<span class="id">S</span><span class="id"> :</span><span class="id"> set</span><span class="id"> T</span>)<span class="id"> a</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> S</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> x</span>)<span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> \esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> S</span>)<span class="id"> a</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> a0;</span><span class="id"> apply:</span><span class="id"> ereal_sup_ubound</span>.<br/>
<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> set0;</span><span class="id"> [exact:</span><span class="id"> fsets_set0|rewrite</span><span class="id"> fsbig_set0]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> esum_fset</span> (<span class="id">F</span><span class="id"> :</span><span class="id"> set</span><span class="id"> T</span>)<span class="id"> a</span><span class="id"> :</span><span class="id"> finite_set</span><span class="id"> F</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> i</span><span class="id"> \in</span><span class="id"> F</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> F</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> \in</span><span class="id"> F</span>)<span class="id"> a</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> finF</span><span class="id"> f0;</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eq_le;</span><span class="id"> apply/andP;</span><span class="id"> split;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> ereal_sup_ubound;</span><span class="gallina-kwd"> exists</span><span class="id"> F</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> exact:</span><span class="id"> fsets_self</span>.<br/>
<span class="id">apply</span><span class="id"> ub_ereal_sup</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> ?</span><span class="id"> -[F'</span><span class="id"> [finF'</span><span class="id"> F'F]</span><span class="id"> &lt;-]</span>.<br/>
<span class="id">apply/lee_fsum_nneg_subset</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> first</span><span class="id"> exact/subsetP</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id"> move=&gt;</span><span class="id"> t;</span><span class="id"> rewrite</span><span class="id"> inE/=</span><span class="id"> =&gt;</span><span class="id"> /andP[_]</span><span class="id"> /f0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> esum_set1</span><span class="id"> t</span><span class="id"> a</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> t</span><span class="id"> -&gt;</span><span class="id"> \esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> [set</span><span class="id"> t]</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> =</span><span class="id"> a</span><span class="id"> t</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> esum_fset//</span><span class="id"> ?fset_set1//</span><span class="id"> ?fsbig_set1//</span><span class="id"> =&gt;</span><span class="id"> t'</span><span class="id"> /[!inE]</span><span class="id"> -&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> esum_realType</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> esum1</span><span class="id"> [R</span><span class="id"> :</span><span class="id"> realFieldType]</span><span class="id"> [I</span><span class="id"> :</span><span class="id"> choiceType]</span> (<span class="id">D</span><span class="id"> :</span><span class="id"> set</span><span class="id"> I</span>) (<span class="id">a</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> D</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> i</span><span class="id"> =</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><span class="id"> \esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> D</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> a0;</span><span class="id"> rewrite</span><span class="id"> /esum</span> (_<span class="id"> :</span><span class="id"> [set</span><span class="id"> _</span><span class="id"> |</span><span class="id"> _</span><span class="gallina-kwd"> in</span><span class="id"> _]</span><span class="id"> =</span><span class="id"> [set</span><span class="id"> 0]</span>)<span class="id"> ?ereal_sup1//</span>.<br/>
<span class="id">apply/seteqP;</span><span class="id"> split=&gt;</span><span class="id"> x</span><span class="id"> //=</span><span class="id"> =&gt;</span><span class="id"> [[X</span><span class="id"> [finX</span><span class="id"> XI]]</span><span class="id"> &lt;-|-&gt;]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> fsbig1//</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> /XI/a0</span>.<br/>
<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> set0;</span><span class="id"> rewrite</span><span class="id"> ?fsbig_set0//;</span><span class="id"> exact:</span><span class="id"> fsets_set0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> esum_ge</span><span class="id"> [R</span><span class="id"> :</span><span class="id"> realType]</span><span class="id"> [T</span><span class="id"> :</span><span class="id"> choiceType]</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> set</span><span class="id"> T</span>) (<span class="id">a</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">exists2</span><span class="id"> X</span><span class="id"> :</span><span class="id"> set</span><span class="id"> T,</span><span class="id"> fsets</span><span class="id"> I</span><span class="id"> X</span><span class="id"> &amp;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> \in</span><span class="id"> X</span>)<span class="id"> a</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> \esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> I</span>)<span class="id"> a</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> [X</span><span class="id"> IX</span><span class="id"> /le_trans-&gt;//];</span><span class="id"> apply:</span><span class="id"> ereal_sup_ubound;</span><span class="gallina-kwd"> exists</span><span class="id"> X</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> le_esum</span><span class="id"> [R</span><span class="id"> :</span><span class="id"> realType]</span><span class="id"> [T</span><span class="id"> :</span><span class="id"> choiceType]</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> set</span><span class="id"> T</span>) (<span class="id">a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> I</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> I</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> \esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> I</span>)<span class="id"> b</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> le_ab;</span><span class="id"> rewrite</span><span class="id"> ub_ereal_sup</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> _</span><span class="id"> [X</span><span class="id"> [finX</span><span class="id"> XI]]</span><span class="id"> &lt;-;</span><span class="id"> rewrite</span><span class="id"> esum_ge//</span>.<br/>
<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> X</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> lee_fsum</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> t</span><span class="id"> /XI</span><span class="id"> /le_ab</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_esum</span><span class="id"> [R</span><span class="id"> :</span><span class="id"> realType]</span><span class="id"> [T</span><span class="id"> :</span><span class="id"> choiceType]</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> set</span><span class="id"> T</span>) (<span class="id">a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> I</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> i</span><span class="id"> =</span><span class="id"> b</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> I</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> =</span><span class="id"> \esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> I</span>)<span class="id"> b</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> e;</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eq_le</span><span class="id"> !le_esum//</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> Ii;</span><span class="id"> rewrite</span><span class="id"> e</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> esumD</span><span class="id"> [R</span><span class="id"> :</span><span class="id"> realType]</span><span class="id"> [T</span><span class="id"> :</span><span class="id"> choiceType]</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> set</span><span class="id"> T</span>) (<span class="id">a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> I</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> i</span>)<span class="id"> -&gt;</span> (<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> I</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> I</span>) (<span class="id">a</span><span class="id"> i</span><span class="id"> +</span><span class="id"> b</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> \esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> I</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> +</span><span class="id"> \esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> I</span>)<span class="id"> b</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> ag0</span><span class="id"> bg0;</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eq_le;</span><span class="id"> apply/andP;</span><span class="id"> split</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> ub_ereal_sup//=</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> [X</span><span class="id"> [finX</span><span class="id"> XI]]</span><span class="id"> &lt;-;</span><span class="id"> rewrite</span><span class="id"> fsbig_split//=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> leeD//</span><span class="id"> ereal_sup_ubound//=;</span><span class="gallina-kwd"> exists</span><span class="id"> X</span>.<br/>
<span class="id">wlog</span><span class="id"> :</span><span class="id"> a</span><span class="id"> b</span><span class="id"> ag0</span><span class="id"> bg0</span><span class="id"> /</span><span class="id"> \esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> I</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> \isn't</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> =&gt;</span><span class="id"> [saoo|];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> /fin_numPn[-&gt;|/[dup]</span><span class="id"> aoo</span><span class="id"> -&gt;];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> leNye</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">@le_trans</span><span class="id"> _</span><span class="id"> _</span><span class="id"> +oo</span>)<span class="id">//;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /adde/=;</span><span class="id"> case:</span><span class="id"> esum</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> leye_eq;</span><span class="id"> apply/eqP/eq_infty</span><span class="id"> =&gt;</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> esum_ge//</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> :</span><span class="id"> y%:E</span><span class="id"> &lt;</span><span class="id"> \esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> I</span>)<span class="id"> a</span><span class="id"> i</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> aoo//</span><span class="id"> ltry</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> /ereal_sup_gt[_</span><span class="id"> [X</span><span class="id"> [finX</span><span class="id"> XI]]</span><span class="id"> &lt;-]</span><span class="id"> /ltW</span><span class="id"> yle;</span><span class="gallina-kwd"> exists</span><span class="id"> X</span><span class="id"> =&gt;</span><span class="id"> //=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">le_trans</span><span class="id"> yle</span>)<span class="id">//</span><span class="id"> fsbig_split//</span><span class="id"> leeDl//</span><span class="id"> fsume_ge0//</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> i</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> /XI;</span><span class="id"> exact:</span><span class="id"> bg0</span>.<br/>
<span class="id">case:</span> (<span class="id">boolP</span> (<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> I</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>))<span class="id"> =&gt;</span><span class="id"> sa;</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> saoo</span>.<br/>
<span class="id">case:</span> (<span class="id">boolP</span> (<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> I</span>)<span class="id"> b</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>))<span class="id"> =&gt;</span><span class="id"> sb;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> addeC</span> (<span class="id">eq_esum</span> (<span class="gallina-kwd">fun</span><span class="id"> _</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> addeC</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> saoo</span>.<br/>
<span class="id">rewrite</span><span class="id"> -leeBrDr//</span><span class="id"> ub_ereal_sup//=</span><span class="id"> =&gt;</span><span class="id"> _</span><span class="id"> [X</span><span class="id"> [finX</span><span class="id"> XI]]</span><span class="id"> &lt;-</span>.<br/>
<span class="id">have</span><span class="id"> saX</span><span class="id"> :</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> \in</span><span class="id"> X</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> contraTT</span><span class="id"> sa</span><span class="id"> =&gt;</span><span class="id"> /fin_numPn[]</span><span class="id"> sa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">suff</span><span class="id"> :</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> \in</span><span class="id"> X</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> &gt;=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> sa</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> fsume_ge0//</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> /XI/ag0</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/fin_numPn;</span><span class="id"> right;</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> -leye_eq</span><span class="id"> esum_ge//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> X;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> sa</span>.<br/>
<span class="id">rewrite</span><span class="id"> leeBrDr//</span><span class="id"> addeC</span><span class="id"> -leeBrDr//</span><span class="id"> ub_ereal_sup//=</span><span class="id"> =&gt;</span><span class="id"> _</span><span class="id"> [Y</span><span class="id"> [finY</span><span class="id"> YI]]</span><span class="id"> &lt;-</span>.<br/>
<span class="id">rewrite</span><span class="id"> leeBrDr//</span><span class="id"> addeC</span><span class="id"> esum_ge//;</span><span class="gallina-kwd"> exists</span> (<span class="id">X</span><span class="id"> `|`</span><span class="id"> Y</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> split;</span><span class="id"> [rewrite</span><span class="id"> finite_setU|rewrite</span><span class="id"> subUset]</span>.<br/>
<span class="id">rewrite</span><span class="id"> fsbig_split</span><span class="id"> ?finite_setU//=</span><span class="id"> leeD//</span><span class="id"> lee_fsum_nneg_subset</span><span class="id"> ?finite_setU//=</span>.<br/>
<span class="id">-</span><span class="id"> exact/subsetP/subsetUl</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> !inE</span><span class="id"> in_setU</span><span class="id"> andb_orr</span><span class="id"> andNb</span><span class="id"> =&gt;</span><span class="id"> /andP[_]</span><span class="id"> /[!inE]</span><span class="id"> /YI/ag0</span>.<br/>
<span class="id">-</span><span class="id"> exact/subsetP/subsetUr</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> !inE</span><span class="id"> in_setU</span><span class="id"> andb_orr</span><span class="id"> andNb/=</span><span class="id"> orbF</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> /andP[_]</span><span class="id"> /[!inE]</span><span class="id"> /XI/bg0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> esum_mkcond</span><span class="id"> [R</span><span class="id"> :</span><span class="id"> realType]</span><span class="id"> [T</span><span class="id"> :</span><span class="id"> choiceType]</span> (<span class="id">I</span><span class="id"> :</span><span class="id"> set</span><span class="id"> T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> I</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> =</span><span class="id"> \esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> [set:</span><span class="id"> T]</span>)<span class="gallina-kwd"> if</span><span class="id"> i</span><span class="id"> \in</span><span class="id"> I</span><span class="gallina-kwd"> then</span><span class="id"> a</span><span class="id"> i</span><span class="gallina-kwd"> else</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eq_le</span><span class="id"> !ub_ereal_sup//=</span><span class="id"> =&gt;</span><span class="id"> _</span><span class="id"> [X</span><span class="id"> [finX</span><span class="id"> XI]]</span><span class="id"> &lt;-</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -big_mkcond/=</span><span class="id"> big_fset_condE/=;</span><span class="id"> set</span><span class="id"> Y</span><span class="id"> :=</span><span class="id"> [fset</span><span class="id"> _</span><span class="id"> |</span><span class="id"> _</span><span class="gallina-kwd"> in</span><span class="id"> _</span><span class="id"> &amp;</span><span class="id"> _]%fset</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> ereal_sup_ubound//=;</span><span class="gallina-kwd"> exists</span><span class="id"> [set`</span><span class="id"> Y]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> i/=;</span><span class="id"> rewrite</span><span class="id"> !inE/=</span><span class="id"> =&gt;</span><span class="id"> /andP[_];</span><span class="id"> rewrite</span><span class="id"> inE</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> fsbig_finite//</span><span class="id"> set_fsetK</span>.<br/>
<span class="id">rewrite</span><span class="id"> ereal_sup_ubound//;</span><span class="gallina-kwd"> exists</span><span class="id"> X</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> eq_fsbigr</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> /[!inE]</span><span class="id"> Xx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ifT//</span><span class="id"> inE;</span><span class="id"> exact:</span><span class="id"> XI</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> esum_mkcondr</span><span class="id"> [R</span><span class="id"> :</span><span class="id"> realType]</span><span class="id"> [T</span><span class="id"> :</span><span class="id"> choiceType]</span> (<span class="id">I</span><span class="id"> J</span><span class="id"> :</span><span class="id"> set</span><span class="id"> T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> I</span><span class="id"> `&amp;`</span><span class="id"> J</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> =</span><span class="id"> \esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> I</span>)<span class="gallina-kwd"> if</span><span class="id"> i</span><span class="id"> \in</span><span class="id"> J</span><span class="gallina-kwd"> then</span><span class="id"> a</span><span class="id"> i</span><span class="gallina-kwd"> else</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> esum_mkcond</span><span class="id"> [RHS]esum_mkcond;</span><span class="id"> apply:</span><span class="id"> eq_esum=&gt;</span><span class="id"> i</span><span class="id"> _</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> in_setI;</span><span class="id"> case:</span> (<span class="id">i</span><span class="id"> \in</span><span class="id"> I</span>) (<span class="id">i</span><span class="id"> \in</span><span class="id"> J</span>)<span class="id"> =&gt;</span><span class="id"> []</span><span class="id"> []</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> esum_mkcondl</span><span class="id"> [R</span><span class="id"> :</span><span class="id"> realType]</span><span class="id"> [T</span><span class="id"> :</span><span class="id"> choiceType]</span> (<span class="id">I</span><span class="id"> J</span><span class="id"> :</span><span class="id"> set</span><span class="id"> T</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">a</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> I</span><span class="id"> `&amp;`</span><span class="id"> J</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> =</span><span class="id"> \esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> J</span>)<span class="gallina-kwd"> if</span><span class="id"> i</span><span class="id"> \in</span><span class="id"> I</span><span class="gallina-kwd"> then</span><span class="id"> a</span><span class="id"> i</span><span class="gallina-kwd"> else</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> esum_mkcond</span><span class="id"> [RHS]esum_mkcond;</span><span class="id"> apply:</span><span class="id"> eq_esum=&gt;</span><span class="id"> i</span><span class="id"> _</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> in_setI;</span><span class="id"> case:</span> (<span class="id">i</span><span class="id"> \in</span><span class="id"> I</span>) (<span class="id">i</span><span class="id"> \in</span><span class="id"> J</span>)<span class="id"> =&gt;</span><span class="id"> []</span><span class="id"> []</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> esumID</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> realType</span>) (<span class="id">I</span><span class="id"> :</span><span class="id"> choiceType</span>) (<span class="id">B</span><span class="id"> :</span><span class="id"> set</span><span class="id"> I</span>) (<span class="id">A</span><span class="id"> :</span><span class="id"> set</span><span class="id"> I</span>)<br/>
&nbsp;&nbsp;(<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> A</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> F</span><span class="id"> i</span><span class="id"> &gt;=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> =</span> (<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> `&amp;`</span><span class="id"> B</span>)<span class="id"> F</span><span class="id"> i</span>)<span class="id"> +</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> A</span><span class="id"> `&amp;`</span><span class="id"> ~`</span><span class="id"> B</span>)<span class="id"> F</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> F0;</span><span class="id"> rewrite</span><span class="id"> !esum_mkcondr</span><span class="id"> -esumD;</span><span class="id"> do</span><span class="id"> ?by</span><span class="id"> move=&gt;</span><span class="id"> i</span><span class="id"> /F0;</span><span class="id"> case:</span><span class="id"> ifP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_esum=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> in_setC;</span><span class="id"> case:</span><span class="id"> ifP;</span><span class="id"> rewrite</span><span class="id"> /=</span> (<span class="id">adde0,</span><span class="id"> add0e</span>).<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> esumID</span><span class="id"> {R</span><span class="id"> I}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> esum_sum</span><span class="id"> [R</span><span class="id"> :</span><span class="id"> realType]</span><span class="id"> [T1</span><span class="id"> T2</span><span class="id"> :</span><span class="id"> choiceType]</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">I</span><span class="id"> :</span><span class="id"> set</span><span class="id"> T1</span>) (<span class="id">r</span><span class="id"> :</span><span class="id"> seq</span><span class="id"> T2</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> T2</span>) (<span class="id">a</span><span class="id"> :</span><span class="id"> T1</span><span class="id"> -&gt;</span><span class="id"> T2</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> I</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> j</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> I</span>)<span class="id"> \sum_</span>(<span class="id">j</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> j</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">j</span><span class="id"> &lt;-</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> j</span>)<span class="id"> \esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> I</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> a_ge0;</span><span class="id"> elim:</span><span class="id"> r</span><span class="id"> =&gt;</span><span class="id"> [|j</span><span class="id"> r</span><span class="id"> IHr];</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">big_nil,</span><span class="id"> big_cons</span>)<span class="id">//</span><span class="id"> -?IHr</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> esum1//</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> big_nil</span>.<br/>
<span class="id">case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> Pj;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_esum</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> Ii;</span><span class="id"> rewrite</span><span class="id"> big_cons</span> (<span class="id">negPf</span><span class="id"> Pj</span>).<br/>
<span class="id">have</span><span class="id"> aj_ge0</span><span class="id"> i</span><span class="id"> :</span><span class="id"> I</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> i</span><span class="id"> j</span><span class="id"> &gt;=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> apply:</span><span class="id"> a_ge0</span>.<br/>
<span class="id">rewrite</span><span class="id"> -esumD//;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> i</span><span class="id"> Ii;</span><span class="id"> apply:</span><span class="id"> sume_ge0</span><span class="id"> =&gt;</span><span class="id"> *;</span><span class="id"> apply:</span><span class="id"> a_ge0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_esum</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> Ii;</span><span class="id"> rewrite</span><span class="id"> big_cons</span><span class="id"> Pj</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> esum_esum</span><span class="id"> [R</span><span class="id"> :</span><span class="id"> realType]</span><span class="id"> [T1</span><span class="id"> T2</span><span class="id"> :</span><span class="id"> choiceType]</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">I</span><span class="id"> :</span><span class="id"> set</span><span class="id"> T1</span>) (<span class="id">J</span><span class="id"> :</span><span class="id"> T1</span><span class="id"> -&gt;</span><span class="id"> set</span><span class="id"> T2</span>) (<span class="id">a</span><span class="id"> :</span><span class="id"> T1</span><span class="id"> -&gt;</span><span class="id"> T2</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> I</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> J</span><span class="id"> i</span><span class="id"> j</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> I</span>)<span class="id"> \esum_</span>(<span class="id">j</span><span class="gallina-kwd"> in</span><span class="id"> J</span><span class="id"> i</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><span class="id"> \esum_</span>(<span class="id">k</span><span class="gallina-kwd"> in</span><span class="id"> I</span><span class="id"> `*``</span><span class="id"> J</span>)<span class="id"> a</span><span class="id"> k</span>.<span class="id">1</span><span class="id"> k</span>.<span class="id">2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> a_ge0;</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eq_le;</span><span class="id"> apply/andP;</span><span class="id"> split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> ub_ereal_sup</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> _</span><span class="id"> [X</span><span class="id"> [finX</span><span class="id"> XI]]</span><span class="id"> &lt;-</span>.<br/>
&nbsp;&nbsp;<span class="id">under</span><span class="id"> eq_fsbigr</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> esum_mkcond</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> fsbig_finite//=</span><span class="id"> big_seq</span><span class="id"> -esum_sum;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> i</span><span class="id"> j</span><span class="id"> _</span><span class="id"> /[!in_fset_set]//</span><span class="id"> /[!inE]</span><span class="id"> /XI</span><span class="id"> Ij</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> /[!inE]</span><span class="id"> /a_ge0-/</span>(_<span class="id"> Ij</span>).<br/>
&nbsp;&nbsp;<span class="id">under</span><span class="id"> eq_esum</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> -big_seq</span><span class="id"> -big_mkcond/=</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> ub_ereal_sup</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> _</span><span class="id"> [Y</span><span class="id"> [finY</span><span class="id"> _]</span><span class="id"> &lt;-];</span><span class="id"> apply:</span><span class="id"> ereal_sup_ubound</span><span class="id"> =&gt;</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">set</span><span class="id"> XYJ</span><span class="id"> :=</span><span class="id"> [set</span><span class="id"> z</span><span class="id"> |</span><span class="id"> z</span><span class="id"> \in</span><span class="id"> X</span><span class="id"> `*`</span><span class="id"> Y</span><span class="id"> /\</span><span class="id"> z</span>.<span class="id">2</span><span class="id"> \in</span><span class="id"> J</span><span class="id"> z</span>.<span class="id">1]</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> ?</span><span class="id"> :</span><span class="id"> finite_set</span><span class="id"> XYJ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> sub_finite_set</span> (<span class="id">finite_setX</span><span class="id"> finX</span><span class="id"> finY</span>)<span class="id"> =&gt;</span><span class="id"> z/=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /XYJ/=</span><span class="id"> in_setX</span><span class="id"> =&gt;</span><span class="id"> -[/andP[]</span><span class="id"> /[!inE]]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span><span class="id"> XYJ</span><span class="id"> =&gt;</span><span class="id"> /=;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> z;</span><span class="id"> rewrite</span><span class="id"> /XYJ/=</span><span class="id"> 2!inE=&gt;</span><span class="id"> -[[/XI]]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> [in</span><span class="id"> RHS]fsbig_finite//=</span> (<span class="id">exchange_big_dep</span><span class="id"> xpredT</span>)<span class="id">//</span><span class="id"> pair_big_dep_cond</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> fsbig_finite//;</span><span class="id"> apply:</span><span class="id"> eq_fbigl</span><span class="id"> =&gt;</span><span class="id"> -[/=</span><span class="id"> x</span><span class="id"> y];</span><span class="id"> rewrite</span><span class="id"> in_fset_set//</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/idP/imfset2P</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> /XYJ</span><span class="id"> !inE/=</span><span class="id"> !inE/=</span><span class="id"> -andA</span><span class="id"> =&gt;</span><span class="id"> -[Xx</span><span class="id"> [Yy</span><span class="id"> Jxy]]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">exists</span><span class="id"> x;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !inE</span><span class="id"> in_fset_set//</span><span class="id"> mem_set</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> !inE</span><span class="id"> mem_set//</span><span class="id"> in_fset_set//</span><span class="id"> mem_set</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> [t1];</span><span class="id"> rewrite</span><span class="id"> !inE</span><span class="id"> andbT/=</span><span class="id"> in_fset_set//</span><span class="id"> inE</span><span class="id"> =&gt;</span><span class="id"> Xt1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> [t2];</span><span class="id"> rewrite</span><span class="id"> !inE</span><span class="id"> in_fset_set</span><span class="id"> /XYJ//=</span><span class="id"> =&gt;/andP[/[!inE]</span><span class="id"> ?</span><span class="id"> ?]</span><span class="id"> [-&gt;</span><span class="id"> -&gt;]</span>.<br/>
<span class="id">apply:</span><span class="id"> ub_ereal_sup</span><span class="id"> =&gt;</span><span class="id"> _</span><span class="id"> /=</span><span class="id"> [X/=</span><span class="id"> [finX</span><span class="id"> XIJ]]</span><span class="id"> &lt;-;</span><span class="id"> apply:</span><span class="id"> esum_ge</span>.<br/>
<span class="gallina-kwd">exists</span><span class="id"> X</span>.<span class="id">`1;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> split=&gt;</span><span class="id"> [|x</span><span class="id"> [y</span><span class="id"> /XIJ[]//]];</span><span class="id"> exact:</span><span class="id"> finite_set_fst</span>.<br/>
<span class="id">apply:</span> (<span class="id">@le_trans</span><span class="id"> _</span><span class="id"> _</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> fset_set</span><span class="id"> X</span>.<span class="id">`1</span>)<span class="id"> \sum_</span>(<span class="id">j</span><span class="id"> &lt;-</span><span class="id"> fset_set</span><span class="id"> X</span>.<span class="id">`2</span><span class="id"> |</span><span class="id"> j</span><span class="id"> \in</span><span class="id"> J</span><span class="id"> i</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> j</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> pair_big_dep_cond//=;</span><span class="id"> set</span><span class="id"> Y</span><span class="id"> :=</span><span class="id"> Imfset</span>.<span class="id">imfset2</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> [leRHS]</span>(<span class="id">big_fsetID</span><span class="id"> _</span> (<span class="id">mem</span><span class="id"> X</span>))<span class="id">/=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (_<span class="id"> :</span><span class="id"> [fset</span><span class="id"> x</span><span class="id"> |</span><span class="id"> x</span><span class="gallina-kwd"> in</span><span class="id"> Y</span><span class="id"> &amp;</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> X]</span><span class="id"> =</span><span class="id"> Y</span><span class="id"> `&amp;`</span><span class="id"> fset_set</span><span class="id"> X</span>)<span class="id">%fset;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/fsetP</span><span class="id"> =&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> 2!inE/=</span><span class="id"> in_fset_set</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">fsetIidPr</span><span class="id"> _</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> fsbig_finite//</span><span class="id"> leeDl//</span><span class="id"> big_seq</span><span class="id"> sume_ge0//=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> [x</span><span class="id"> y]</span><span class="id"> /imfsetP[[x1</span><span class="id"> y1]]</span><span class="id"> /[!inE]</span><span class="id"> /andP[]</span><span class="id"> /imfset2P[x2]/=</span><span class="id"> /[!inE]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> andbT</span><span class="id"> in_fset_set//;</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> finite_set_fst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> /[!inE]</span><span class="id"> x2X</span><span class="id"> [y2]</span><span class="id"> /[!inE]</span><span class="id"> /andP[]</span><span class="id"> /[!in_fset_set];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span><span class="id"> finite_set_snd</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> /[!inE]</span><span class="id"> y2X</span><span class="id"> y2J</span><span class="id"> [-&gt;</span><span class="id"> -&gt;]</span><span class="id"> _</span><span class="id"> [-&gt;</span><span class="id"> -&gt;];</span><span class="id"> rewrite</span><span class="id"> a_ge0//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x2X</span><span class="id"> =&gt;</span><span class="id"> [y3</span><span class="id"> /XIJ</span><span class="id"> []]</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/fsubsetP</span><span class="id"> =&gt;</span><span class="id"> -[i</span><span class="id"> j];</span><span class="id"> rewrite</span><span class="id"> in_fset_set//</span><span class="id"> inE</span><span class="id"> =&gt;</span><span class="id"> Xij;</span><span class="id"> apply/imfset2P</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !inE/=</span><span class="id"> in_fset_set//;</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> finite_set_fst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> andbT</span><span class="id"> mem_set//;</span><span class="id"> move/fst_set_fst</span><span class="id"> :</span><span class="id"> Xij</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">exists</span><span class="id"> j</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> !inE/=</span><span class="id"> in_fset_set;</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> finite_set_snd</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mem_set/=;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> move/snd_set_snd</span><span class="id"> :</span><span class="id"> Xij</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mem_set//;</span><span class="id"> move/XIJ</span><span class="id"> :</span><span class="id"> Xij</span><span class="id"> =&gt;</span><span class="id"> []</span>.<br/>
<span class="id">rewrite</span><span class="id"> -fsbig_finite;</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> finite_set_fst</span>.<br/>
<span class="id">apply</span><span class="id"> lee_fsum=&gt;</span><span class="id"> [|i</span><span class="id"> Xi];</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> finite_set_fst</span>.<br/>
<span class="id">rewrite</span><span class="id"> ereal_sup_ubound</span><span class="id"> //=;</span><span class="id"> have</span><span class="id"> ?</span><span class="id"> :</span><span class="id"> finite_set</span> (<span class="id">X</span>.<span class="id">`2</span><span class="id"> `&amp;`</span><span class="id"> J</span><span class="id"> i</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> finite_setI;</span><span class="id"> left;</span><span class="id"> exact:</span><span class="id"> finite_set_snd</span>.<br/>
<span class="gallina-kwd">exists</span> (<span class="id">X</span>.<span class="id">`2</span><span class="id"> `&amp;`</span><span class="id"> J</span><span class="id"> i</span>)<span class="id"> =&gt;</span><span class="id"> //</span>.<br/>
<span class="id">rewrite</span><span class="id"> [in</span><span class="id"> RHS]big_fset_condE/=</span><span class="id"> fsbig_finite//;</span><span class="id"> apply/eq_fbigl</span><span class="id"> =&gt;</span><span class="id"> j</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> in_fset_set//</span><span class="id"> !inE/=</span><span class="id"> in_setI</span><span class="id"> in_fset_set//;</span><span class="id"> exact:</span><span class="id"> finite_set_snd</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_sum_fset_nat</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> realDomainType</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span><span class="id"> :</span> (<span class="id">\bar</span><span class="id"> R</span>)<span class="id">^nat</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> {fset</span><span class="id"> nat}</span>)<span class="id"> n</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> nat</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0%E</span><span class="id"> &lt;=</span><span class="id"> f</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">[set`</span><span class="id"> F]</span><span class="id"> `&lt;=`</span><span class="id"> `I_n</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> F</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> f0</span><span class="id"> Fn;</span><span class="id"> rewrite</span><span class="id"> [leRHS]</span>(<span class="id">bigID</span> (<span class="id">mem</span><span class="id"> F</span>))<span class="id">/=</span>.<br/>
<span class="id">suff</span><span class="id"> -&gt;</span><span class="id"> :</span><span class="id"> \sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span><span class="id"> &amp;&amp;</span> (<span class="id">i</span><span class="id"> \in</span><span class="id"> F</span>))<span class="id"> f</span><span class="id"> i</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> F</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> leeDl</span><span class="id"> ?sume_ge0//</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> /andP[/f0]</span>.<br/>
<span class="id">rewrite</span><span class="id"> -big_filter</span><span class="id"> -[RHS]big_filter;</span><span class="id"> apply:</span><span class="id"> perm_big</span>.<br/>
<span class="id">rewrite</span><span class="id"> uniq_perm</span><span class="id"> ?filter_uniq</span><span class="id"> ?index_iota</span><span class="id"> ?iota_uniq</span><span class="id"> ?fset_uniq//</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> ?mem_filter</span>.<br/>
<span class="id">case:</span> (<span class="id">boolP</span> (<span class="id">P</span><span class="id"> i</span>))<span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> Pi;</span><span class="id"> case:</span> (<span class="id">boolP</span> (<span class="id">i</span><span class="id"> \in</span><span class="id"> F</span>))<span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> Fi</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mem_iota</span><span class="id"> leq0n</span><span class="id"> add0n</span><span class="id"> subn0/=;</span><span class="id"> apply:</span><span class="id"> Fn</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> lee_sum_fset_nat</span><span class="id"> {R</span><span class="id"> f}</span><span class="id"> F</span><span class="id"> n</span><span class="id"> P</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lee_sum_fset_lim</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> realType</span>) (<span class="id">f</span><span class="id"> :</span> (<span class="id">\bar</span><span class="id"> R</span>)<span class="id">^nat</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> {fset</span><span class="id"> nat}</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> nat</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0%E</span><span class="id"> &lt;=</span><span class="id"> f</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;-</span><span class="id"> F</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;oo</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> f0;</span><span class="id"> pose</span><span class="id"> n</span><span class="id"> :=</span> (<span class="id">\max_</span>(<span class="id">k</span><span class="id"> &lt;-</span><span class="id"> F</span>)<span class="id"> k</span>).<span class="id">+1</span>.<br/>
<span class="id">rewrite</span> (<span class="id">le_trans</span> (<span class="id">lee_sum_fset_nat</span><span class="id"> F</span><span class="id"> n</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>))<span class="id">//;</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> nneseries_lim_ge</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> k</span><span class="id"> /=</span><span class="id"> kF;</span><span class="id"> rewrite</span><span class="id"> /n</span><span class="id"> big_seq_fsetE/=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[k]/</span>(<span class="id">val</span><span class="id"> [`kF]%fset</span>)<span class="id"> ltnS</span><span class="id"> leq_bigmax</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> lee_sum_fset_lim</span><span class="id"> {R</span><span class="id"> f}</span><span class="id"> F</span><span class="id"> P</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nneseries_esum</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> realType</span>) (<span class="id">a</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> nat</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> n,</span><span class="id"> P</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> n</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;oo</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> =</span><span class="id"> \esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> [set</span><span class="id"> x</span><span class="id"> |</span><span class="id"> P</span><span class="id"> x]</span>)<span class="id"> a</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> a0;</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eq_le;</span><span class="id"> apply/andP;</span><span class="id"> split</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">lime_le</span> (<span class="id">is_cvg_nneseries_cond</span><span class="id"> a0</span>))<span class="id">;</span><span class="id"> apply:</span><span class="id"> nearW</span><span class="id"> =&gt;</span><span class="id"> n</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> ereal_sup_ubound;</span><span class="gallina-kwd"> exists</span><span class="id"> [set`</span><span class="id"> [fset</span><span class="id"> val</span><span class="id"> i</span><span class="id"> |</span><span class="id"> i</span><span class="gallina-kwd"> in</span><span class="id"> 'I_n</span><span class="id"> &amp;</span><span class="id"> P</span><span class="id"> i]%fset]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">split;</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> finite_fset</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> /=</span><span class="id"> k</span><span class="id"> /imfsetP[/=</span><span class="id"> i];</span><span class="id"> rewrite</span><span class="id"> inE</span><span class="id"> =&gt;</span><span class="id"> +</span><span class="id"> -&gt;</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> fsbig_finite//=</span><span class="id"> set_fsetK</span><span class="id"> big_imfset/=;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> ?</span><span class="id"> ?</span><span class="id"> ?</span><span class="id"> ?</span><span class="id"> /val_inj</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> big_filter</span><span class="id"> big_enum_cond/=</span><span class="id"> big_mkord</span>.<br/>
<span class="id">apply:</span><span class="id"> ub_ereal_sup</span><span class="id"> =&gt;</span><span class="id"> _</span><span class="id"> [/=</span><span class="id"> F</span><span class="id"> [finF</span><span class="id"> PF]</span><span class="id"> &lt;-]</span>.<br/>
<span class="id">rewrite</span><span class="id"> fsbig_finite//=</span><span class="id"> -</span>(<span class="id">big_rmcond_in</span><span class="id"> P</span>)<span class="id">/=;</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> lee_sum_fset_lim</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> k;</span><span class="id"> rewrite</span><span class="id"> in_fset_set//</span><span class="id"> inE</span><span class="id"> =&gt;</span><span class="id"> /PF</span><span class="id"> -&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> reindex_esum</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> realType</span>) (<span class="id">T</span><span class="id"> T'</span><span class="id"> :</span><span class="id"> choiceType</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P</span><span class="id"> :</span><span class="id"> set</span><span class="id"> T</span>) (<span class="id">Q</span><span class="id"> :</span><span class="id"> set</span><span class="id"> T'</span>) (<span class="id">e</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> T'</span>) (<span class="id">a</span><span class="id"> :</span><span class="id"> T'</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">set_bij</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> e</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\esum_</span>(<span class="id">j</span><span class="gallina-kwd"> in</span><span class="id"> Q</span>)<span class="id"> a</span><span class="id"> j</span><span class="id"> =</span><span class="id"> \esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> P</span>)<span class="id"> a</span> (<span class="id">e</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim/choicePpointed:</span><span class="id"> T</span><span class="id"> =&gt;</span><span class="id"> T</span><span class="gallina-kwd"> in</span><span class="id"> e</span><span class="id"> P</span><span class="id"> *</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !emptyE</span><span class="id"> =&gt;</span><span class="id"> /Pbij[{}e</span><span class="id"> -&gt;]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[in</span><span class="id"> LHS]</span>(<span class="id">image_eq</span><span class="id"> e</span>)<span class="id"> image_set0</span><span class="id"> !esum_set0</span>.<br/>
<span class="id">elim/choicePpointed:</span><span class="id"> T'</span><span class="id"> =&gt;</span><span class="id"> T'</span><span class="gallina-kwd"> in</span><span class="id"> a</span><span class="id"> e</span><span class="id"> Q</span><span class="id"> *;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> no</span> (<span class="id">e</span><span class="id"> point</span>).<br/>
<span class="id">move=&gt;</span><span class="id"> /</span>(<span class="id">@pPbij</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">[{}e</span><span class="id"> -&gt;]</span>.<br/>
<span class="id">gen</span><span class="id"> have</span><span class="id"> le_esum</span><span class="id"> :</span><span class="id"> T</span><span class="id"> T'</span><span class="id"> a</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> e</span><span class="id"> /</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">\esum_</span>(<span class="id">j</span><span class="gallina-kwd"> in</span><span class="id"> Q</span>)<span class="id"> a</span><span class="id"> j</span><span class="id"> &lt;=</span><span class="id"> \esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> P</span>)<span class="id"> a</span> (<span class="id">e</span><span class="id"> i</span>)<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eq_le</span><span class="id"> le_esum//=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> [leRHS]</span>(_<span class="id"> :</span><span class="id"> _</span><span class="id"> =</span><span class="id"> \esum_</span>(<span class="id">j</span><span class="gallina-kwd"> in</span><span class="id"> Q</span>)<span class="id"> a</span> (<span class="id">e</span> (<span class="id">e^-1%FUN</span><span class="id"> j</span>)))<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_esum</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> Qi;</span><span class="id"> rewrite</span><span class="id"> invK</span><span class="id"> ?inE</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> le_esum</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> i</span><span class="id"> Qi;</span><span class="id"> rewrite</span><span class="id"> a_ge0//;</span><span class="id"> exact:</span><span class="id"> funS</span>.<br/>
<span class="id">rewrite</span><span class="id"> ub_ereal_sup</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> _</span><span class="id"> [X</span><span class="id"> [finX</span><span class="id"> XQ]</span><span class="id"> &lt;-];</span><span class="id"> rewrite</span><span class="id"> ereal_sup_ubound</span><span class="id"> =&gt;</span><span class="id"> //=</span>.<br/>
<span class="gallina-kwd">exists</span><span class="id"> [set`</span> (<span class="id">e^-1</span><span class="id"> @`</span> (<span class="id">fset_set</span><span class="id"> X</span>))<span class="id">%fset]</span>.<br/>
&nbsp;&nbsp;<span class="id">split=&gt;</span><span class="id"> [|t</span><span class="id"> /=</span><span class="id"> /imfsetP[t'/=]];</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> finite_fset</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> in_fset_set//</span><span class="id"> inE</span><span class="id"> =&gt;</span><span class="id"> /XQ</span><span class="id"> Qt'</span><span class="id"> -&gt;;</span><span class="id"> exact:</span><span class="id"> funS</span>.<br/>
<span class="id">rewrite</span><span class="id"> fsbig_finite//=</span><span class="id"> set_fsetK</span><span class="id"> big_imfset</span><span class="id"> =&gt;</span><span class="id"> //=;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> !in_fset_set//</span><span class="id"> !inE</span><span class="id"> =&gt;</span><span class="id"> /XQ</span><span class="id"> ?</span><span class="id"> /XQ</span><span class="id"> ?</span><span class="id"> /</span>(<span class="id">congr1</span><span class="id"> e</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !invK</span><span class="id"> ?inE</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -fsbig_finite//;</span><span class="id"> apply:</span><span class="id"> eq_fsbigr=&gt;</span><span class="id"> x</span><span class="id"> /[!inE]/XQ</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> invK</span><span class="id"> ?inE</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> reindex_esum</span><span class="id"> {R</span><span class="id"> T</span><span class="id"> T'}</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> e</span><span class="id"> a</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> nneseries_interchange</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> ereal_scope</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> nneseries_esum_prod</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> realType</span>) (<span class="id">a</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;(<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> nat</span>)<span class="id"> :</span> (<span class="gallina-kwd">forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;oo</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> \sum_</span>(<span class="id">j</span><span class="id"> &lt;oo</span><span class="id"> |</span><span class="id"> Q</span><span class="id"> j</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> P</span><span class="id"> `*`</span><span class="id"> Q</span>)<span class="id"> a</span><span class="id"> i</span>.<span class="id">1</span><span class="id"> i</span>.<span class="id">2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> a0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">@esum_esum</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> P</span> (<span class="id">fun=&gt;</span><span class="id"> Q</span>))<span class="id">//</span>.<br/>
<span class="id">rewrite</span><span class="id"> nneseries_esum//;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n</span><span class="id"> _;</span><span class="id"> exact:</span><span class="id"> nneseries_ge0</span>.<br/>
<span class="id">rewrite</span> (_<span class="id"> :</span><span class="id"> [set</span><span class="id"> x</span><span class="id"> |</span><span class="id"> P</span><span class="id"> x]</span><span class="id"> =</span><span class="id"> P</span>)<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> apply/seteqP;</span><span class="id"> split</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply</span><span class="id"> eq_esum</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> Pi;</span><span class="id"> rewrite</span><span class="id"> nneseries_esum</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nneseries_interchange</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> realType</span>) (<span class="id">a</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;(<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> nat</span>)<span class="id"> :</span> (<span class="gallina-kwd">forall</span><span class="id"> i</span><span class="id"> j,</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> i</span><span class="id"> j</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;oo</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> \sum_</span>(<span class="id">j</span><span class="id"> &lt;oo</span><span class="id"> |</span><span class="id"> Q</span><span class="id"> j</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> j</span><span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">j</span><span class="id"> &lt;oo</span><span class="id"> |</span><span class="id"> Q</span><span class="id"> j</span>)<span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;oo</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> a0;</span><span class="id"> rewrite</span><span class="id"> !nneseries_esum_prod//</span>.<br/>
<span class="id">rewrite</span> (<span class="id">reindex_esum</span> (<span class="id">Q</span><span class="id"> `*`</span><span class="id"> P</span>)<span class="id"> _</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span> (<span class="id">x</span>.<span class="id">2,</span><span class="id"> x</span>.<span class="id">1</span>)))<span class="id">//;</span><span class="id"> split=&gt;</span><span class="id"> //=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> [i</span><span class="id"> j]</span><span class="id"> [/=]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> [i1</span><span class="id"> i2]</span><span class="id"> [j1</span><span class="id"> j2]</span><span class="id"> /=</span><span class="id"> _</span><span class="id"> _</span><span class="id"> []</span><span class="id"> -&gt;</span><span class="id"> -&gt;</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> [i1</span><span class="id"> i2]</span><span class="id"> [Pi1</span><span class="id"> Qi2]</span><span class="id"> /=;</span><span class="gallina-kwd"> exists</span> (<span class="id">i2,</span><span class="id"> i1</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> nneseries_interchange</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> esum_image</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> realType</span>) (<span class="id">T</span><span class="id"> T'</span><span class="id"> :</span><span class="id"> choiceType</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">P</span><span class="id"> :</span><span class="id"> set</span><span class="id"> T</span>) (<span class="id">e</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> T'</span>) (<span class="id">a</span><span class="id"> :</span><span class="id"> T'</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">set_inj</span><span class="id"> P</span><span class="id"> e</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\esum_</span>(<span class="id">j</span><span class="gallina-kwd"> in</span><span class="id"> e</span><span class="id"> @`</span><span class="id"> P</span>)<span class="id"> a</span><span class="id"> j</span><span class="id"> =</span><span class="id"> \esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> P</span>)<span class="id"> a</span> (<span class="id">e</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /inj_bij;</span><span class="id"> apply:</span><span class="id"> reindex_esum</span>. Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> esum_image</span><span class="id"> {R</span><span class="id"> T</span><span class="id"> T'}</span><span class="id"> P</span><span class="id"> e</span><span class="id"> a</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> esum_pred_image</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> realType</span>) (<span class="id">T</span><span class="id"> :</span><span class="id"> choiceType</span>) (<span class="id">a</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">e</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> T</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> nat</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> n,</span><span class="id"> P</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span> (<span class="id">e</span><span class="id"> n</span>))<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">set_inj</span><span class="id"> P</span><span class="id"> e</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> e</span><span class="id"> @`</span><span class="id"> P</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;oo</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> a</span> (<span class="id">e</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a0</span><span class="id"> einj;</span><span class="id"> rewrite</span><span class="id"> esum_image//</span><span class="id"> nneseries_esum</span>. Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> esum_pred_image</span><span class="id"> {R</span><span class="id"> T}</span><span class="id"> a</span><span class="id"> e</span><span class="id"> P</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> esum_set_image</span> <span class="id"> [R</span><span class="id"> :</span><span class="id"> realType]</span><span class="id"> [T</span><span class="id"> :</span><span class="id"> choiceType]</span><span class="id"> [a</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R]</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">[e</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> T]</span><span class="id"> [P</span><span class="id"> :</span><span class="id"> set</span><span class="id"> nat]</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat,</span><span class="id"> P</span><span class="id"> n</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span> (<span class="id">e</span><span class="id"> n</span>))<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">set_inj</span><span class="id"> P</span><span class="id"> e</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> [set</span><span class="id"> e</span><span class="id"> x</span><span class="id"> |</span><span class="id"> x</span><span class="gallina-kwd"> in</span><span class="id"> P]</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;oo</span><span class="id"> |</span><span class="id"> i</span><span class="id"> \in</span><span class="id"> P</span>)<span class="id"> a</span> (<span class="id">e</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> a0</span><span class="id"> einj;</span><span class="id"> rewrite</span><span class="id"> esum_image//</span><span class="id"> nneseries_esum</span><span class="id"> ?set_mem_set//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> n;</span><span class="id"> rewrite</span><span class="id"> inE</span><span class="id"> =&gt;</span><span class="id"> /a0</span>.<br/>
Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> esum_set_image</span><span class="id"> {R</span><span class="id"> T}</span><span class="id"> a</span><span class="id"> e</span><span class="id"> P</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> esum_bigcup</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> realType</span>) (<span class="id">T</span><span class="id"> :</span><span class="id"> choiceType</span>) (<span class="id">K</span><span class="id"> :</span><span class="id"> set</span><span class="id"> nat</span>).<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">J</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> set</span><span class="id"> T</span>) (<span class="id">a</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> esum_bigcupT</span><span class="id"> J</span><span class="id"> a</span><span class="id"> :</span><span class="id"> trivIset</span><span class="id"> setT</span><span class="id"> J</span><span class="id"> -&gt;</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> x</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> \bigcup_</span>(<span class="id">k</span><span class="gallina-kwd"> in</span><span class="id"> K</span>) (<span class="id">J</span><span class="id"> k</span>))<span class="id"> a</span><span class="id"> i</span><span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> K</span>)<span class="id"> \esum_</span>(<span class="id">j</span><span class="gallina-kwd"> in</span><span class="id"> J</span><span class="id"> i</span>)<span class="id"> a</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> tJ</span><span class="id"> a0;</span><span class="id"> rewrite</span><span class="id"> esum_esum//;</span><span class="id"> apply:</span><span class="id"> reindex_esum</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> split</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> [/=</span><span class="id"> i</span><span class="id"> j]</span><span class="id"> [Ki</span><span class="id"> Jij];</span><span class="gallina-kwd"> exists</span><span class="id"> i</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> [/=</span><span class="id"> i1</span><span class="id"> j1]</span><span class="id"> [/=</span><span class="id"> i2</span><span class="id"> j2];</span><span class="id"> rewrite</span><span class="id"> ?inE/=</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> [K1</span><span class="id"> J1]</span><span class="id"> [K2</span><span class="id"> J2]</span><span class="id"> j12;</span><span class="id"> congr</span> (<span class="id">_,</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span> (<span class="id">@tJ</span><span class="id"> i1</span><span class="id"> i2</span>)<span class="id"> =&gt;</span><span class="id"> //;</span><span class="gallina-kwd"> exists</span><span class="id"> j1;</span><span class="id"> split=&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> j12</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> j</span><span class="id"> [i</span><span class="id"> Ki</span><span class="id"> Jij]/=;</span><span class="gallina-kwd"> exists</span> (<span class="id">i,</span><span class="id"> j</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> esum_bigcup</span><span class="id"> J</span><span class="id"> a</span><span class="id"> :</span><span class="id"> trivIset</span><span class="id"> [set</span><span class="id"> i</span><span class="id"> |</span><span class="id"> a</span><span class="id"> @`</span><span class="id"> J</span><span class="id"> i</span><span class="id"> !=</span><span class="id"> [set</span><span class="id"> 0]]</span><span class="id"> J</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> :</span><span class="id"> T,</span> (<span class="id">\bigcup_</span>(<span class="id">k</span><span class="gallina-kwd"> in</span><span class="id"> K</span>)<span class="id"> J</span><span class="id"> k</span>)<span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> x</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> \bigcup_</span>(<span class="id">k</span><span class="gallina-kwd"> in</span><span class="id"> K</span>)<span class="id"> J</span><span class="id"> k</span>)<span class="id"> a</span><span class="id"> i</span><span class="id"> =</span><span class="id"> \esum_</span>(<span class="id">k</span><span class="gallina-kwd"> in</span><span class="id"> K</span>)<span class="id"> \esum_</span>(<span class="id">j</span><span class="gallina-kwd"> in</span><span class="id"> J</span><span class="id"> k</span>)<span class="id"> a</span><span class="id"> j</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Jtriv</span><span class="id"> a_ge0</span>.<br/>
<span class="id">pose</span><span class="id"> J'</span><span class="id"> i</span><span class="id"> :=</span><span class="gallina-kwd"> if</span><span class="id"> a</span><span class="id"> @`</span><span class="id"> J</span><span class="id"> i</span><span class="id"> ==</span><span class="id"> [set</span><span class="id"> 0]</span><span class="gallina-kwd"> then</span><span class="id"> set0</span><span class="gallina-kwd"> else</span><span class="id"> J</span><span class="id"> i</span>.<br/>
<span class="id">pose</span><span class="id"> a'</span><span class="id"> x</span><span class="id"> :=</span><span class="gallina-kwd"> if</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> \bigcup_</span>(<span class="id">k</span><span class="gallina-kwd"> in</span><span class="id"> K</span>)<span class="id"> J</span><span class="id"> k</span><span class="gallina-kwd"> then</span><span class="id"> a</span><span class="id"> x</span><span class="gallina-kwd"> else</span><span class="id"> 0</span>.<br/>
<span class="id">have</span><span class="id"> a'E</span><span class="id"> k</span><span class="id"> x</span><span class="id"> :</span><span class="id"> K</span><span class="id"> k</span><span class="id"> -&gt;</span><span class="id"> J</span><span class="id"> k</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> a'</span><span class="id"> x</span><span class="id"> =</span><span class="id"> a</span><span class="id"> x</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> Kk</span><span class="id"> Jkx;</span><span class="id"> rewrite</span><span class="id"> /a';</span><span class="id"> case:</span><span class="id"> ifPn;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">inE,</span><span class="id"> notin_setE</span>)<span class="id">//=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case;</span><span class="gallina-kwd"> exists</span><span class="id"> k</span>.<br/>
<span class="id">have</span><span class="id"> a'_ge0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> a'</span><span class="id"> x</span><span class="id"> &gt;=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /a';</span><span class="id"> case:</span><span class="id"> ifPn;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> ?inE</span><span class="id"> =&gt;</span><span class="id"> /a_ge0</span>.<br/>
<span class="id">transitivity</span> (<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> \bigcup_</span>(<span class="id">k</span><span class="gallina-kwd"> in</span><span class="id"> K</span>)<span class="id"> J'</span><span class="id"> k</span>)<span class="id"> a'</span><span class="id"> i</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> esum_mkcond</span><span class="id"> [RHS]esum_mkcond</span><span class="id"> /a';</span><span class="id"> apply:</span><span class="id"> eq_esum</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> _</span>.<br/>
&nbsp;&nbsp;<span class="id">do</span><span class="id"> 2!case:</span><span class="id"> ifPn;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">inE,</span><span class="id"> notin_setE</span>)<span class="id">//=</span><span class="id"> =&gt;</span><span class="id"> J'x</span><span class="id"> Jx</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> contra_not_eq</span><span class="id"> J'x</span><span class="id"> =&gt;</span><span class="id"> Nax</span>.<br/>
&nbsp;&nbsp;<span class="id">move:</span><span class="id"> Jx</span><span class="id"> =&gt;</span><span class="id"> [k</span><span class="id"> kK</span><span class="id"> Jkx];</span><span class="gallina-kwd"> exists</span><span class="id"> k=&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> /J'/=;</span><span class="id"> case:</span><span class="id"> ifPn=&gt;</span><span class="id"> //=</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> /eqP/</span>(<span class="id">congr1</span> (<span class="id">@^~</span> (<span class="id">a</span><span class="id"> x</span>)))<span class="id">/=;</span><span class="id"> rewrite</span><span class="id"> propeqE</span><span class="id"> =&gt;</span><span class="id"> -[+</span><span class="id"> _]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> contra_neq_not</span><span class="id"> Nax;</span><span class="id"> apply;</span><span class="gallina-kwd"> exists</span><span class="id"> x</span>.<br/>
<span class="id">rewrite</span><span class="id"> esum_bigcupT//;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> i</span><span class="id"> j</span><span class="id"> _</span><span class="id"> _</span><span class="id"> [x</span><span class="id"> []];</span><span class="id"> rewrite</span><span class="id"> /J'/=</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span><span class="id"> eqVneq</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> Ai0</span><span class="id"> Jix;</span><span class="id"> case:</span><span class="id"> eqVneq</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> Aj0</span><span class="id"> Jjx</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> Jtriv</span><span class="id"> i</span><span class="id"> j</span><span class="id"> Ai0</span><span class="id"> Aj0;</span><span class="id"> apply;</span><span class="gallina-kwd"> exists</span><span class="id"> x</span>.<br/>
<span class="id">apply:</span><span class="id"> eq_esum</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> Ki</span>.<br/>
<span class="id">rewrite</span><span class="id"> esum_mkcond</span><span class="id"> [RHS]esum_mkcond;</span><span class="id"> apply:</span><span class="id"> eq_esum</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> _</span>.<br/>
<span class="id">do</span><span class="id"> 2!case:</span><span class="id"> ifPn;</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">inE,</span><span class="id"> notin_setE</span>)<span class="id">//=</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /a'E-&gt;//</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /J';</span><span class="id"> case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> //</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> Jix;</span><span class="id"> rewrite</span><span class="id"> /J';</span><span class="id"> case:</span><span class="id"> ifPn=&gt;</span><span class="id"> //=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> /eqP/</span>(<span class="id">congr1</span> (<span class="id">@^~</span> (<span class="id">a</span><span class="id"> x</span>)))<span class="id">/=;</span><span class="id"> rewrite</span><span class="id"> propeqE</span><span class="id"> =&gt;</span><span class="id"> -[-&gt;]//;</span><span class="gallina-kwd"> exists</span><span class="id"> x</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> esum_bigcup</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> esum_bigcupT</span><span class="id"> {R</span><span class="id"> T</span><span class="id"> K}</span><span class="id"> J</span><span class="id"> a</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> esum_bigcup</span><span class="id"> {R</span><span class="id"> T</span><span class="id"> K}</span><span class="id"> J</span><span class="id"> a</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nneseries_sum_bigcup</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> realType}</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> choiceType</span>) (<span class="id">F</span><span class="id"> :</span> (<span class="id">set</span><span class="id"> T</span>)<span class="id">^nat</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">f</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> trivIset</span><span class="id"> [set:</span><span class="id"> nat]</span><span class="id"> F</span><span class="id"> -&gt;</span> (<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> f</span><span class="id"> i</span>)<span class="id">%E</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> \bigcup_n</span><span class="id"> F</span><span class="id"> n</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;oo</span>) (<span class="id">\esum_</span>(<span class="id">j</span><span class="gallina-kwd"> in</span><span class="id"> F</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> j</span>))<span class="id">%E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> tF</span><span class="id"> f0;</span><span class="id"> rewrite</span><span class="id"> esum_bigcupT//</span><span class="id"> nneseries_esum//;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> k</span><span class="id"> _;</span><span class="id"> exact:</span><span class="id"> esum_ge0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> fun_true;</span><span class="id"> apply:</span><span class="id"> eq_esum</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> i</span><span class="id"> _</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> summable</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> choiceType</span>) (<span class="id">R</span><span class="id"> :</span><span class="id"> realType</span>) (<span class="id">D</span><span class="id"> :</span><span class="id"> set</span><span class="id"> T</span>)<br/>
&nbsp;&nbsp;(<span class="id">f</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :=</span> (<span class="id">\esum_</span>(<span class="id">x</span><span class="gallina-kwd"> in</span><span class="id"> D</span>)<span class="id"> `|</span><span class="id"> f</span><span class="id"> x</span><span class="id"> |</span><span class="id"> &lt;</span><span class="id"> +oo</span>)<span class="id">%E</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> summable_lemmas</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> choiceType</span>) (<span class="id">R</span><span class="id"> :</span><span class="id"> realType</span>).<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">D</span><span class="id"> :</span><span class="id"> set</span><span class="id"> T</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> summable_pinfty</span><span class="id"> D</span><span class="id"> f</span><span class="id"> :</span><span class="id"> summable</span><span class="id"> D</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> D</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> `|</span><span class="id"> f</span><span class="id"> x</span><span class="id"> |</span><span class="id"> &lt;</span><span class="id"> +oo</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Dfoo</span><span class="id"> x</span><span class="id"> Dx;</span><span class="id"> apply:</span><span class="id"> le_lt_trans</span><span class="id"> Dfoo</span>.<br/>
<span class="id">rewrite</span> (<span class="id">esumID</span><span class="id"> [set</span><span class="id"> x]</span>)<span class="id">//</span><span class="id"> setI1</span><span class="id"> mem_set//</span><span class="id"> esum_set1//</span><span class="id"> leeDl//</span>.<br/>
<span class="id">exact:</span><span class="id"> esum_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> summableE</span><span class="id"> D</span><span class="id"> f</span><span class="id"> :</span><span class="id"> summable</span><span class="id"> D</span><span class="id"> f</span><span class="id"> =</span> (<span class="id">\esum_</span>(<span class="id">x</span><span class="gallina-kwd"> in</span><span class="id"> D</span>)<span class="id"> `|</span><span class="id"> f</span><span class="id"> x</span><span class="id"> |</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /summable</span><span class="id"> fin_numElt;</span><span class="id"> apply/idP/idP</span><span class="id"> =&gt;</span><span class="id"> [-&gt;|/andP[]//]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> andbT</span> (<span class="id">lt_le_trans</span> (<span class="id">ltNyr</span><span class="id"> 0</span>))<span class="id">//;</span><span class="id"> exact:</span><span class="id"> esum_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> summableD</span><span class="id"> D</span><span class="id"> f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> summable</span><span class="id"> D</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> summable</span><span class="id"> D</span><span class="id"> g</span><span class="id"> -&gt;</span><span class="id"> summable</span><span class="id"> D</span> (<span class="id">f</span><span class="id"> \+</span><span class="id"> g</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Df</span><span class="id"> Dg;</span><span class="id"> apply:</span><span class="id"> le_lt_trans</span> (<span class="id">lte_add_pinfty</span><span class="id"> Df</span><span class="id"> Dg</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -esumD//;</span><span class="id"> apply</span><span class="id"> le_esum</span><span class="id"> =&gt;</span><span class="id"> t</span><span class="id"> Dt;</span><span class="id"> exact:</span><span class="id"> lee_abs_add</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> summableN</span><span class="id"> D</span><span class="id"> f</span><span class="id"> :</span><span class="id"> summable</span><span class="id"> D</span><span class="id"> f</span><span class="id"> =</span><span class="id"> summable</span><span class="id"> D</span> (<span class="id">\-</span><span class="id"> f</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /summable;</span><span class="id"> congr</span> (_<span class="id"> &lt;</span><span class="id"> +oo</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> eq_esum</span><span class="id"> =&gt;</span><span class="id"> t</span><span class="id"> Dt;</span><span class="id"> rewrite</span><span class="id"> abseN</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> summableB</span><span class="id"> D</span><span class="id"> f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> summable</span><span class="id"> D</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> summable</span><span class="id"> D</span><span class="id"> g</span><span class="id"> -&gt;</span><span class="id"> summable</span><span class="id"> D</span> (<span class="id">f</span><span class="id"> \-</span><span class="id"> g</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> Df;</span><span class="id"> rewrite</span><span class="id"> summableN;</span><span class="id"> exact:</span><span class="id"> summableD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> summable_funepos</span><span class="id"> D</span><span class="id"> f</span><span class="id"> :</span><span class="id"> summable</span><span class="id"> D</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> summable</span><span class="id"> D</span><span class="id"> f^\+</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span><span class="id"> le_lt_trans;</span><span class="id"> apply</span><span class="id"> le_esum</span><span class="id"> =&gt;</span><span class="id"> t</span><span class="id"> Dt</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -/</span>((<span class="id">abse</span><span class="id"> \o</span><span class="id"> f</span>)<span class="id"> t</span>)<span class="id"> fune_abse</span><span class="id"> gee0_abs//</span><span class="id"> leeDl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> summable_funeneg</span><span class="id"> D</span><span class="id"> f</span><span class="id"> :</span><span class="id"> summable</span><span class="id"> D</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> summable</span><span class="id"> D</span><span class="id"> f^\-</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span><span class="id"> le_lt_trans;</span><span class="id"> apply</span><span class="id"> le_esum</span><span class="id"> =&gt;</span><span class="id"> t</span><span class="id"> Dt</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -/</span>((<span class="id">abse</span><span class="id"> \o</span><span class="id"> f</span>)<span class="id"> t</span>)<span class="id"> fune_abse</span><span class="id"> gee0_abs//</span><span class="id"> leeDr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> summable_lemmas</span>.<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> numFieldNormedType</span>.<span class="vernacular">Exports</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> summable_nat</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> realType</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> summable_fine_sum</span><span class="id"> r</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> nat</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> summable</span><span class="id"> P</span><span class="id"> f</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> k</span>)<span class="id"> fine</span> (<span class="id">f</span><span class="id"> k</span>))<span class="id">%R</span><span class="id"> =</span><span class="id"> fine</span> (<span class="id">\sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> r</span><span class="id"> |</span><span class="id"> P</span><span class="id"> k</span>)<span class="id"> f</span><span class="id"> k</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Pf;</span><span class="id"> elim:</span><span class="id"> r</span><span class="id"> =&gt;</span><span class="id"> [|r</span><span class="id"> ih];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !big_nil</span>.<br/>
<span class="id">rewrite</span><span class="id"> big_mkcond/=</span><span class="id"> big_nat_recr//</span><span class="id"> [in</span><span class="id"> RHS]big_mkcond/=</span><span class="id"> big_nat_recr//=</span>.<br/>
<span class="id">rewrite</span><span class="id"> -!big_mkcond/=</span><span class="id"> ih;</span><span class="id"> case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> Pr</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> adde0</span><span class="id"> addr0</span>.<br/>
<span class="id">rewrite</span><span class="id"> fineD//;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> fin_num_abs</span> (<span class="id">summable_pinfty</span><span class="id"> Pf</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/sum_fin_numP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> ir</span><span class="id"> Pi;</span><span class="id"> rewrite</span><span class="id"> fin_num_abs</span> (<span class="id">summable_pinfty</span><span class="id"> Pf</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> summable_cvg</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> nat</span>) (<span class="id">f</span><span class="id"> :</span> (<span class="id">\bar</span><span class="id"> R</span>)<span class="id">^nat</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> f</span><span class="id"> i</span>)<span class="id">%E</span><span class="id"> -&gt;</span><span class="id"> summable</span><span class="id"> P</span><span class="id"> f</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">cvg</span> ((<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> \sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P</span><span class="id"> k</span>)<span class="id"> fine</span> (<span class="id">f</span><span class="id"> k</span>))<span class="id">%R</span><span class="id"> @</span><span class="id"> \oo</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> f0</span><span class="id"> Pf;</span><span class="id"> apply:</span><span class="id"> nondecreasing_is_cvgn</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> nondecreasing_series</span><span class="id"> =&gt;</span><span class="id"> n</span><span class="id"> Pn;</span><span class="id"> exact/fine_ge0/f0</span>.<br/>
<span class="gallina-kwd">exists</span> (<span class="id">fine</span> (<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;oo</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> `|f</span><span class="id"> i|</span>))<span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> /=</span><span class="id"> [n</span><span class="id"> _</span><span class="id"> &lt;-]</span>.<br/>
<span class="id">rewrite</span><span class="id"> summable_fine_sum//</span><span class="id"> -lee_fin</span><span class="id"> fineK//;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/sum_fin_numP</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> ni</span><span class="id"> Pi;</span><span class="id"> rewrite</span><span class="id"> fin_num_abs</span> (<span class="id">summable_pinfty</span><span class="id"> Pf</span>).<br/>
<span class="id">rewrite</span><span class="id"> fineK//;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> nneseries_esum//</span><span class="id"> fin_numElt;</span><span class="id"> apply/andP;</span><span class="id"> split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">@lt_le_trans</span><span class="id"> _</span><span class="id"> _</span><span class="id"> 0</span>)<span class="id">//</span><span class="id"> ?lte_ninfty//;</span><span class="id"> exact:</span><span class="id"> esum_ge0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> le_lt_trans</span><span class="id"> Pf;</span><span class="id"> apply</span><span class="id"> le_esum</span>.<br/>
<span class="id">apply:</span><span class="id"> le_trans</span> (<span class="id">nneseries_lim_ge</span><span class="id"> n</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> lee_sum</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lee_abs</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> summable_nneseries_lim</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> nat</span>) (<span class="id">f</span><span class="id"> :</span> (<span class="id">\bar</span><span class="id"> R</span>)<span class="id">^nat</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> f</span><span class="id"> i</span>)<span class="id">%E</span><span class="id"> -&gt;</span><span class="id"> summable</span><span class="id"> P</span><span class="id"> f</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;oo</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> =</span><br/>
&nbsp;&nbsp;(<span class="id">lim</span> ((<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span> (<span class="id">\sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P</span><span class="id"> k</span>)<span class="id"> fine</span> (<span class="id">f</span><span class="id"> k</span>))<span class="id">%R</span>)<span class="id"> @</span><span class="id"> \oo</span>))<span class="id">%:E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> f0</span><span class="id"> Pf;</span><span class="id"> pose</span><span class="id"> A_</span><span class="id"> n</span><span class="id"> :=</span> (<span class="id">\sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P</span><span class="id"> k</span>)<span class="id"> fine</span> (<span class="id">f</span><span class="id"> k</span>))<span class="id">%R</span>.<br/>
<span class="id">transitivity</span> (<span class="id">lim</span> (<span class="id">EFin</span><span class="id"> \o</span><span class="id"> A_</span><span class="id"> @</span><span class="id"> \oo</span>)).<br/>
&nbsp;&nbsp;<span class="id">apply/congr_lim/funext</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> n;</span><span class="id"> rewrite</span><span class="id"> /A_</span><span class="id"> /=</span><span class="id"> -sumEFin</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> Pi/=;</span><span class="id"> rewrite</span><span class="id"> fineK//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> fin_num_abs</span> (<span class="id">@summable_pinfty</span><span class="id"> _</span><span class="id"> _</span><span class="id"> P</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> EFin_lim//;</span><span class="id"> apply:</span><span class="id"> summable_cvg</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> summable_eseries</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> nat</span>)<span class="id"> :</span><span class="id"> summable</span><span class="id"> P</span><span class="id"> f</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;oo</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>) (<span class="id">f</span><span class="id"> i</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">i</span><span class="id"> &lt;oo</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f^\+</span><span class="id"> i</span><span class="id"> -</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;oo</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f^\-</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Pf</span>.<br/>
<span class="id">pose</span><span class="id"> A_</span><span class="id"> n</span><span class="id"> :=</span> (<span class="id">\sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P</span><span class="id"> k</span>)<span class="id"> fine</span> (<span class="id">f^\+</span><span class="id"> k</span>))<span class="id">%R</span>.<br/>
<span class="id">pose</span><span class="id"> B_</span><span class="id"> n</span><span class="id"> :=</span> (<span class="id">\sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P</span><span class="id"> k</span>)<span class="id"> fine</span> (<span class="id">f^\-</span><span class="id"> k</span>))<span class="id">%R</span>.<br/>
<span class="id">pose</span><span class="id"> C_</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> fine</span> (<span class="id">\sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> k</span><span class="id"> &lt;</span><span class="id"> n</span><span class="id"> |</span><span class="id"> P</span><span class="id"> k</span>)<span class="id"> f</span><span class="id"> k</span>).<br/>
<span class="id">pose</span><span class="id"> A</span><span class="id"> :=</span><span class="id"> lim</span> (<span class="id">A_</span><span class="id"> @</span><span class="id"> \oo</span>).<br/>
<span class="id">pose</span><span class="id"> B</span><span class="id"> :=</span><span class="id"> lim</span> (<span class="id">B_</span><span class="id"> @</span><span class="id"> \oo</span>).<br/>
<span class="id">suff:</span> ((<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> C_</span><span class="id"> n</span><span class="id"> -</span> (<span class="id">A</span><span class="id"> -</span><span class="id"> B</span>))<span class="id"> @</span><span class="id"> \oo</span><span class="id"> --&gt;</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> R^o</span>))<span class="id">%R</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> CAB</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> [X</span><span class="gallina-kwd"> in</span> <span class="id"> X</span><span class="id"> -</span><span class="id"> _]summable_nneseries_lim//;</span><span class="id"> last</span><span class="id"> exact/summable_funepos</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> [X</span><span class="gallina-kwd"> in</span><span class="id"> _</span><span class="id"> -</span><span class="id"> X]summable_nneseries_lim//;</span><span class="id"> last</span><span class="id"> exact/summable_funeneg</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -EFinB;</span><span class="id"> apply/cvg_lim</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> apply/fine_cvgP;</span><span class="id"> split;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span> (<span class="id">@cvg_sub0</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">cst</span> (<span class="id">A</span><span class="id"> -</span><span class="id"> B</span>)<span class="id">%R</span>)<span class="id"> _</span><span class="id"> CAB</span>)<span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> exact:</span><span class="id"> cvg_cst</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> nearW</span><span class="id"> =&gt;</span><span class="id"> n;</span><span class="id"> rewrite</span><span class="id"> fin_num_abs;</span><span class="id"> apply:</span><span class="id"> le_lt_trans</span><span class="id"> Pf</span><span class="id"> =&gt;</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -nneseries_esum//</span> (<span class="id">le_trans</span> (<span class="id">lee_abs_sum</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>))<span class="id">//</span><span class="id"> nneseries_lim_ge</span>.<br/>
<span class="id">have</span><span class="id"> :</span> ((<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> A_</span><span class="id"> x</span><span class="id"> -</span><span class="id"> B_</span><span class="id"> x</span>)<span class="id"> @</span><span class="id"> \oo</span><span class="id"> --&gt;</span><span class="id"> A</span><span class="id"> -</span><span class="id"> B</span>)<span class="id">%R</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> cvgD</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> summable_cvg</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> exact/summable_funepos</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> cvgN;</span><span class="id"> apply:</span><span class="id"> summable_cvg</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> exact/summable_funeneg</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> /cvgrPdist_lt</span><span class="id"> cvgAB;</span><span class="id"> apply/cvgrPdist_lt</span><span class="id"> =&gt;</span><span class="id"> e</span><span class="id"> e0</span>.<br/>
<span class="id">move:</span><span class="id"> cvgAB</span><span class="id"> =&gt;</span><span class="id"> /</span>(_<span class="id"> _</span><span class="id"> e0</span>)<span class="id"> [N</span><span class="id"> _/=</span><span class="id"> hN]</span><span class="id"> /=</span>.<br/>
<span class="id">near=&gt;</span><span class="id"> n</span>.<br/>
<span class="id">rewrite</span><span class="id"> distrC</span><span class="id"> subr0</span>.<br/>
<span class="id">have</span><span class="id"> -&gt;</span><span class="id"> :</span> (<span class="id">C_</span><span class="id"> =</span><span class="id"> A_</span><span class="id"> \-</span><span class="id"> B_</span>)<span class="id">%R</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/funext</span><span class="id"> =&gt;</span><span class="id"> k</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> /=</span><span class="id"> /A_</span><span class="id"> /C_</span><span class="id"> /B_</span><span class="id"> -sumrN</span><span class="id"> -big_split/=</span><span class="id"> -summable_fine_sum//</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> Pi;</span><span class="id"> rewrite</span><span class="id"> -fineB//</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [in</span><span class="id"> LHS]</span>(<span class="id">funeposneg</span><span class="id"> f</span>).<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> fin_num_abs</span> (<span class="id">@summable_pinfty</span><span class="id"> _</span><span class="id"> _</span><span class="id"> P</span>)<span class="id"> //;</span><span class="id"> exact/summable_funepos</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> fin_num_abs</span> (<span class="id">@summable_pinfty</span><span class="id"> _</span><span class="id"> _</span><span class="id"> P</span>)<span class="id"> //;</span><span class="id"> exact/summable_funeneg</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> distrC;</span><span class="id"> apply:</span><span class="id"> hN;</span><span class="id"> near:</span><span class="id"> n;</span><span class="gallina-kwd"> exists</span><span class="id"> N</span>.<br/>
<span class="id">Unshelve</span>.<span class="id"> all:</span><span class="gallina-kwd"> by</span><span class="id"> end_near</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> summable_eseries_esum</span>  (<span class="id">f</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> nat</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">summable</span><span class="id"> P</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> \sum_</span>(<span class="id">i</span><span class="id"> &lt;oo</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> =</span><span class="id"> esum</span><span class="id"> P</span><span class="id"> f^\+</span><span class="id"> -</span><span class="id"> esum</span><span class="id"> P</span><span class="id"> f^\-</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Pfoo;</span><span class="id"> rewrite</span><span class="id"> -nneseries_esum;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> n</span><span class="id"> Pn;</span><span class="id"> rewrite</span><span class="id"> /maxe;</span><span class="id"> case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> -leNgt</span>.<br/>
<span class="id">rewrite</span><span class="id"> -nneseries_esum</span><span class="id"> ?[LHS]summable_eseries//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> n</span><span class="id"> Pn;</span><span class="id"> rewrite</span><span class="id"> /maxe;</span><span class="id"> case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> leNgt</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> summable_nat</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> esumB</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> realType</span>) (<span class="id">T</span><span class="id"> :</span><span class="id"> choiceType</span>).<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">D</span><span class="id"> :</span><span class="id"> set</span><span class="id"> T</span>) (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> \bar</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> esum_posneg</span><span class="id"> D</span><span class="id"> f</span><span class="id"> :=</span><span class="id"> esum</span><span class="id"> D</span><span class="id"> f^\+</span><span class="id"> -</span><span class="id"> esum</span><span class="id"> D</span><span class="id"> f^\-</span>.<br/>
<br/>
<span class="vernacular">Let</span><span class="id"> ge0_esum_posneg</span><span class="id"> D</span><span class="id"> f</span><span class="id"> :</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> D</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> f</span><span class="id"> x</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">esum_posneg</span><span class="id"> D</span><span class="id"> f</span><span class="id"> =</span><span class="id"> \esum_</span>(<span class="id">x</span><span class="gallina-kwd"> in</span><span class="id"> D</span>)<span class="id"> f</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Sa;</span><span class="id"> rewrite</span><span class="id"> /esum_posneg</span><span class="id"> [X</span><span class="gallina-kwd"> in</span><span class="id"> _</span><span class="id"> -</span><span class="id"> X]</span>(_<span class="id"> :</span><span class="id"> _</span><span class="id"> =</span><span class="id"> 0</span>)<span class="id"> ?sube0;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> esum1//</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> Sx;</span><span class="id"> rewrite</span><span class="id"> -[LHS]/</span>(<span class="id">f^\-</span><span class="id"> x</span>) (<span class="id">ge0_funenegE</span><span class="id"> Sa</span>)<span class="id">//</span><span class="id"> inE</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_esum</span><span class="id"> =&gt;</span><span class="id"> t</span><span class="id"> St;</span><span class="id"> apply/max_idPl;</span><span class="id"> exact:</span><span class="id"> Sa</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> esumB</span><span class="id"> D</span><span class="id"> f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> summable</span><span class="id"> D</span><span class="id"> f</span><span class="id"> -&gt;</span><span class="id"> summable</span><span class="id"> D</span><span class="id"> g</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> D</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> f</span><span class="id"> i</span>)<span class="id"> -&gt;</span> (<span class="gallina-kwd">forall</span><span class="id"> i,</span><span class="id"> D</span><span class="id"> i</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> g</span><span class="id"> i</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> D</span>) (<span class="id">f</span><span class="id"> \-</span><span class="id"> g</span>)<span class="id">^\+</span><span class="id"> i</span><span class="id"> -</span><span class="id"> \esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> D</span>) (<span class="id">f</span><span class="id"> \-</span><span class="id"> g</span>)<span class="id">^\-</span><span class="id"> i</span><span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">\esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> D</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> -</span><span class="id"> \esum_</span>(<span class="id">i</span><span class="gallina-kwd"> in</span><span class="id"> D</span>)<span class="id"> g</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Df</span><span class="id"> Dg</span><span class="id"> f0</span><span class="id"> g0</span>.<br/>
<span class="id">have</span><span class="id"> /eqP</span><span class="id"> :</span><span class="id"> esum</span><span class="id"> D</span> (<span class="id">f</span><span class="id"> \-</span><span class="id"> g</span>)<span class="id">^\+</span><span class="id"> +</span><span class="id"> esum_posneg</span><span class="id"> D</span><span class="id"> g</span><span class="id"> =</span><span class="id"> esum</span><span class="id"> D</span> (<span class="id">f</span><span class="id"> \-</span><span class="id"> g</span>)<span class="id">^\-</span><span class="id"> +</span><span class="id"> esum_posneg</span><span class="id"> D</span><span class="id"> f</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !ge0_esum_posneg//</span><span class="id"> -!esumD//;</span><span class="id"> last</span><span class="id"> 2</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> t</span><span class="id"> Dt;</span><span class="id"> rewrite</span><span class="id"> le_max</span><span class="id"> lexx</span><span class="id"> orbT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> t</span><span class="id"> Dt;</span><span class="id"> rewrite</span><span class="id"> le_max</span><span class="id"> lexx</span><span class="id"> orbT</span>.<br/>
&nbsp;&nbsp;<span class="id">apply</span><span class="id"> eq_esum</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> Di;</span><span class="id"> have</span><span class="id"> [fg|fg]</span><span class="id"> :=</span><span class="id"> leP</span><span class="id"> 0</span> (<span class="id">f</span><span class="id"> i</span><span class="id"> -</span><span class="id"> g</span><span class="id"> i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> max_r</span><span class="id"> 1?leeNl</span><span class="id"> ?oppe0//</span><span class="id"> add0e</span><span class="id"> subeK//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> fin_num_abs</span> (<span class="id">summable_pinfty</span><span class="id"> Dg</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> add0e</span><span class="id"> max_l;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> leeNr</span><span class="id"> oppe0</span><span class="id"> ltW</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> fin_num_oppeB//;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> fin_num_abs</span> (<span class="id">summable_pinfty</span><span class="id"> Dg</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -addeA</span><span class="id"> addeCA</span><span class="id"> addeA</span><span class="id"> subeK//</span><span class="id"> fin_num_abs</span> (<span class="id">summable_pinfty</span><span class="id"> Df</span>).<br/>
<span class="id">rewrite</span><span class="id"> [X</span><span class="gallina-kwd"> in</span><span class="id"> _</span><span class="id"> ==</span><span class="id"> X</span><span class="id"> -&gt;</span><span class="id"> _]addeC</span><span class="id"> -sube_eq;</span><span class="id"> last</span><span class="id"> 2</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="id"> rewrite</span><span class="id"> fin_numD;</span><span class="id"> apply/andP;</span><span class="id"> split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">@eq_esum</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">abse</span><span class="id"> \o</span> (<span class="id">f</span><span class="id"> \-</span><span class="id"> g</span>)<span class="id">^\+</span>))<span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -summableE;</span><span class="id"> exact/summable_funepos/summableB</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> t</span><span class="id"> Dt;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> gee0_abs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move:</span><span class="id"> Dg;</span><span class="id"> rewrite</span><span class="id"> summableE</span> (<span class="id">@eq_esum</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> g</span>)<span class="id">//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ge0_esum_posneg//</span><span class="id"> =&gt;</span><span class="id"> t</span><span class="id"> Tt;</span><span class="id"> rewrite</span><span class="id"> gee0_abs//</span><span class="id"> g0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> t</span><span class="id"> Tt;</span><span class="id"> rewrite</span><span class="id"> gee0_abs//</span><span class="id"> g0</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="id"> rewrite</span><span class="id"> fin_num_adde_defr//</span><span class="id"> ge0_esum_posneg//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">@eq_esum</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">abse</span><span class="id"> \o</span><span class="id"> f</span>))<span class="id">//</span><span class="id"> -?summableE//</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> Di</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> gee0_abs//</span><span class="id"> f0</span>.<br/>
<span class="id">rewrite</span><span class="id"> -addeA</span><span class="id"> addeCA</span><span class="id"> eq_sym</span><span class="id"> [X</span><span class="gallina-kwd"> in</span><span class="id"> _</span><span class="id"> ==</span><span class="id"> X</span><span class="id"> -&gt;</span><span class="id"> _]addeC</span><span class="id"> -sube_eq;</span><span class="id"> last</span><span class="id"> 2</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="id"> rewrite</span><span class="id"> ge0_esum_posneg//</span> (<span class="id">@eq_esum</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">abse</span><span class="id"> \o</span><span class="id"> f</span>))<span class="id">//</span><span class="id"> -?summableE//</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> Di</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> gee0_abs//</span><span class="id"> f0</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="id"> rewrite</span><span class="id"> fin_num_adde_defl//</span><span class="id"> ge0_esum_posneg//</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">@eq_esum</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">abse</span><span class="id"> \o</span><span class="id"> g</span>))<span class="id">//</span><span class="id"> -?summableE//</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> Di</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> gee0_abs//</span><span class="id"> g0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ge0_esum_posneg//</span><span class="id"> ge0_esum_posneg//</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> -&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> esumB</span>.<br/>

      <div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/">a fork of coq2html</a></div>
    </div>
  </div>
    </main>
</body>
</html>
