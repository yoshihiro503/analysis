
<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module mathcomp.analysis.trigo</title>
<meta name="description" content="Documentation of Coq module mathcomp.analysis.trigo" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init()">

  <main>
    <div class="sidebar">
      <h2>Files</h2>
      
    </div>

  <div class="coq">

    <div class="content">
      <p><a href="./index.html">Top</a></p>
      <h1 class="title">Module mathcomp.analysis.trigo</h1>
<span class="vernacular">From</span><span class="id"> HB</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> structures</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> all_ssreflect</span><span class="id"> ssralg</span><span class="id"> ssrint</span><span class="id"> ssrnum</span><span class="id"> matrix</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> interval</span><span class="id"> rat</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> mathcomp_extra</span><span class="id"> boolp</span><span class="id"> classical_sets</span><span class="id"> functions</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> reals</span><span class="id"> ereal</span><span class="id"> nsatz_realtype</span><span class="id"> signed</span><span class="id"> topology</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> normedtype</span><span class="id"> landau</span><span class="id"> sequences</span><span class="id"> derive</span><span class="id"> realfun</span><span class="id"> exp</span>.<br/>
<br/>
<div class="ssrdoc md">
# Theory of trigonometric functions

This file provides the definitions of basic trigonometric functions and
develops their theories.

```
   periodic f T == f is a periodic function of period T
alternating f T == f is an alternating function of period T
    sin_coeff x == the sequence of coefficients of sin x
          sin x == the sine function, i.e., lim (series (sin_coeff x))
   sin_coeff' x == the sequence of odd coefficients of sin x
    cos_coeff x == the sequence of coefficients of cos x
          cos x == the cosine function, i.e., lim (series (cos_coeff x))
   cos_coeff' x == the sequence of even coefficients of cos x
             pi == pi
          tan x == the tangent function
         acos x == the arccos function
         asin x == the arcsin function
         atan x == the arctangent function
```

Acknowledgments: the proof of cos 2 &lt; 0 is inspired from HOL-light, some
proofs of trigonometric relations are taken from
https://github.com/affeldt-aist/coq-robot.

</div>
<br/>
<span class="gallina-kwd">Set</span><span class="vernacular"> Implicit</span><span class="vernacular"> Arguments</span>.<br/>
<span class="vernacular">Unset</span><span class="vernacular"> Strict</span><span class="vernacular"> Implicit</span>.<br/>
<span class="vernacular">Unset</span><span class="vernacular"> Printing</span><span class="vernacular"> Implicit</span><span class="vernacular"> Defensive</span>.<br/>
<span class="vernacular">Import</span><span class="id"> Order</span>.<span class="id">TTheory</span><span class="id"> GRing</span>.<span class="id">Theory</span><span class="id"> Num</span>.<span class="id">Def</span><span class="id"> Num</span>.<span class="id">Theory</span>.<br/>
<span class="vernacular">Import</span><span class="id"> numFieldNormedType</span>.<span class="vernacular">Exports</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> classical_set_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cvg_series_cvg_series_group</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> realFieldType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> R</span><span class="id"> ^nat</span>)<span class="id"> k</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">cvg</span> (<span class="id">series</span><span class="id"> f</span><span class="id"> @</span><span class="id"> \oo</span>)<span class="id"> -&gt;</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> k</span>)<span class="id">%N</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">[series</span><span class="id"> \sum_</span>(<span class="id">n</span><span class="id"> *</span><span class="id"> k</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>.<span class="id">+1</span><span class="id"> *</span><span class="id"> k</span>)<span class="id"> f</span><span class="id"> i]_n</span><span class="id"> @</span><span class="id"> \oo</span><span class="id"> --&gt;</span><span class="id"> lim</span> (<span class="id">series</span><span class="id"> f</span><span class="id"> @</span><span class="id"> \oo</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /cvg_ballP</span><span class="id"> cf</span><span class="id"> k0;</span><span class="id"> apply/cvg_ballP</span><span class="id"> =&gt;</span><span class="id"> _/posnumP[e]</span>.<br/>
<span class="id">have</span><span class="id"> :=</span><span class="id"> !!</span><span class="id"> cf</span><span class="id"> _</span> (<span class="id">gt0</span><span class="id"> e</span>)<span class="id"> =&gt;</span><span class="id"> -[n</span><span class="id"> _</span><span class="id"> nl];</span><span class="id"> near=&gt;</span><span class="id"> m</span>.<br/>
<span class="id">rewrite</span><span class="id"> /ball</span><span class="id"> /=</span><span class="id"> [in</span><span class="id"> X</span><span class="gallina-kwd"> in</span><span class="id"> `|_</span><span class="id"> -</span><span class="id"> X|]/series</span><span class="id"> [in</span><span class="id"> X</span><span class="gallina-kwd"> in</span><span class="id"> `|_</span><span class="id"> -</span><span class="id"> X|]/=</span><span class="id"> -big_nat_mul</span>.<br/>
<span class="id">have</span><span class="id"> /nl</span><span class="id"> :</span> (<span class="id">n</span><span class="id"> &lt;=</span><span class="id"> m</span><span class="id"> *</span><span class="id"> k</span>)<span class="id">%N</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> near:</span><span class="id"> m;</span><span class="gallina-kwd"> exists</span><span class="id"> n</span>.<span class="id">+1</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> p</span><span class="id"> /ltnW</span><span class="id"> /leq_trans</span><span class="id"> /</span>(_ (<span class="id">leq_pmulr</span><span class="id"> _</span><span class="id"> k0</span>)).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /ball</span><span class="id"> /=</span><span class="id"> distrC</span>.<br/>
<span class="id">Unshelve</span>.<span class="id"> all:</span><span class="gallina-kwd"> by</span><span class="id"> end_near</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lt_sum_lim_series</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> realFieldType</span>) (<span class="id">f</span><span class="id"> :</span><span class="id"> R</span><span class="id"> ^nat</span>)<span class="id"> n</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cvg</span> (<span class="id">series</span><span class="id"> f</span><span class="id"> @</span><span class="id"> \oo</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> d,</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> f</span> (<span class="id">n</span><span class="id"> +</span><span class="id"> d</span>.<span class="id">*2</span>)<span class="id">%N</span><span class="id"> +</span><span class="id"> f</span> (<span class="id">n</span><span class="id"> +</span><span class="id"> d</span>.<span class="id">*2</span>.<span class="id">+1</span>)<span class="id">%N</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> lim</span> (<span class="id">series</span><span class="id"> f</span><span class="id"> @</span><span class="id"> \oo</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /cvg_ballP</span><span class="id"> cf</span><span class="id"> fn</span>.<br/>
<span class="id">have</span><span class="id"> fn0</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> f</span><span class="id"> n</span><span class="id"> +</span><span class="id"> f</span><span class="id"> n</span>.<span class="id">+1</span><span class="gallina-kwd"> by</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> fn</span><span class="id"> 0%N;</span><span class="id"> rewrite</span><span class="id"> double0</span><span class="id"> addn0</span><span class="id"> addn1</span>.<br/>
<span class="id">rewrite</span><span class="id"> ltNge;</span><span class="id"> apply:</span><span class="id"> contraPN</span><span class="id"> cf</span><span class="id"> =&gt;</span><span class="id"> ffn</span><span class="id"> /</span>(_<span class="id"> _</span><span class="id"> fn0</span>).<br/>
<span class="id">have</span><span class="id"> nf_ub</span><span class="id"> N</span><span class="id"> :</span><span class="id"> \sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>.<span class="id">+2</span>)<span class="id"> f</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> N</span>.<span class="id">+1</span>.<span class="id">*2</span><span class="id"> +</span><span class="id"> n</span>)<span class="id"> f</span><span class="id"> i</span>.<br/>
&nbsp;&nbsp;<span class="id">elim:</span><span class="id"> N</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> N</span><span class="id"> /le_trans</span><span class="id"> -&gt;//;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">addn1</span> (<span class="id">N</span>.<span class="id">+1</span>))<span class="id"> doubleD</span><span class="id"> addnAC</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> [in</span><span class="id"> leRHS]/index_iota</span><span class="id"> subn0</span><span class="id"> iotaD</span><span class="id"> big_cat</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -[in</span><span class="id"> X</span><span class="gallina-kwd"> in</span><span class="id"> _</span><span class="id"> &lt;=</span><span class="id"> X</span><span class="id"> +</span><span class="id"> _]</span>(<span class="id">subn0</span> (<span class="id">N</span>.<span class="id">+1</span>.<span class="id">*2</span><span class="id"> +</span><span class="id"> n</span>)<span class="id">%N</span>)<span class="id"> lerDl</span><span class="id"> /=</span><span class="id"> add0n</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> 2!big_cons</span><span class="id"> big_nil</span><span class="id"> addr0</span><span class="id"> -</span>(<span class="id">addnC</span><span class="id"> n</span>)<span class="id"> ltW//</span><span class="id"> -addnS</span><span class="id"> fn</span>.<br/>
<span class="id">case=&gt;</span><span class="id"> N</span><span class="id"> _</span><span class="id"> Nfn;</span><span class="id"> have</span><span class="id"> /Nfn/ltr_distlCDr</span><span class="id"> :</span> (<span class="id">N</span>.<span class="id">+1</span>.<span class="id">*2</span><span class="id"> +</span><span class="id"> n</span><span class="id"> &gt;=</span><span class="id"> N</span>)<span class="id">%N</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> doubleS</span><span class="id"> -addn2</span><span class="id"> -addnn</span><span class="id"> -2!addnA</span><span class="id"> leq_addr</span>.<br/>
<span class="id">rewrite</span><span class="id"> addrA</span><span class="id"> =&gt;</span><span class="id"> ffnfn</span>.<br/>
<span class="id">have</span><span class="id"> :</span><span class="id"> lim</span> (<span class="id">series</span><span class="id"> f</span><span class="id"> @</span><span class="id"> \oo</span>)<span class="id"> +</span><span class="id"> f</span><span class="id"> n</span><span class="id"> +</span><span class="id"> f</span><span class="id"> n</span>.<span class="id">+1</span><span class="id"> &lt;=</span><span class="id"> \sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> N</span>.<span class="id">+1</span>.<span class="id">*2</span><span class="id"> +</span><span class="id"> n</span>)<span class="id"> f</span><span class="id"> i</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span> (<span class="id">le_trans</span><span class="id"> _</span> (<span class="id">nf_ub</span><span class="id"> N</span>)).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> do</span><span class="id"> 2</span><span class="id"> rewrite</span><span class="id"> big_nat_recr</span><span class="id"> //=;</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -2!addrA</span><span class="id"> lerD2r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move/</span>(<span class="id">lt_le_trans</span><span class="id"> ffnfn</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ltxx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> periodic</span>.<br/>
<span class="vernacular">Variables</span><span class="id"> U</span><span class="id"> V</span><span class="id"> :</span><span class="id"> zmodType</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> f</span><span class="id"> :</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> periodic</span><span class="id"> f</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> U</span>)<span class="id"> :=</span><span class="gallina-kwd"> forall</span><span class="id"> u,</span><span class="id"> f</span> (<span class="id">u</span><span class="id"> +</span><span class="id"> T</span>)<span class="id"> =</span><span class="id"> f</span><span class="id"> u</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> periodicn</span><span class="id"> f</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> U</span>)<span class="id"> :</span><span class="id"> periodic</span><span class="id"> f</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> forall</span><span class="id"> n</span><span class="id"> a,</span><span class="id"> f</span> (<span class="id">a</span><span class="id"> +</span><span class="id"> T</span><span class="id"> *+</span><span class="id"> n</span>)<span class="id"> =</span><span class="id"> f</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> fT;</span><span class="id"> elim=&gt;</span><span class="id"> [|n</span><span class="id"> ih]</span><span class="id"> a;[rewrite</span><span class="id"> mulr0n</span><span class="id"> addr0|rewrite</span><span class="id"> mulrS</span><span class="id"> addrA</span><span class="id"> ih</span><span class="id"> fT]</span>.<br/>
Qed.</div></details>
<span class="vernacular">End</span><span class="id"> periodic</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> alternating</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">U</span><span class="id"> :</span><span class="id"> zmodType</span>) (<span class="id">V</span><span class="id"> :</span><span class="id"> ringType</span>).<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> f</span><span class="id"> :</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> alternating</span><span class="id"> f</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> U</span>)<span class="id"> :=</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> f</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> T</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> f</span><span class="id"> x</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> alternatingn</span><span class="id"> f</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> U</span>)<span class="id"> :</span><span class="id"> alternating</span><span class="id"> f</span><span class="id"> T</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> n</span><span class="id"> a,</span><span class="id"> f</span> (<span class="id">a</span><span class="id"> +</span><span class="id"> T</span><span class="id"> *+</span><span class="id"> n</span>)<span class="id"> =</span> (<span class="id">-</span><span class="id"> 1</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> *</span><span class="id"> f</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> fT;</span><span class="id"> elim</span><span class="id"> =&gt;</span><span class="id"> [a|n</span><span class="id"> ih</span><span class="id"> a];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr0n</span><span class="id"> expr0</span><span class="id"> addr0</span><span class="id"> mul1r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrS</span><span class="id"> addrA</span><span class="id"> ih</span><span class="id"> fT</span><span class="id"> exprS</span><span class="id"> mulrN</span><span class="id"> mulN1r</span><span class="id"> mulNr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> alternating</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> sin_coeff</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> realType}</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">[sequence</span> (<span class="id">odd</span><span class="id"> n</span>)<span class="id">%:R</span><span class="id"> *</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span>.<span class="id">-1</span>.<span class="id">/2</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> /</span><span class="id"> n`!%:R]_n</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">lock</span><span class="vernacular"> Definition</span><span class="id"> sin</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> realType}</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> lim</span> (<span class="id">series</span> (<span class="id">sin_coeff</span><span class="id"> x</span>)<span class="id"> @</span><span class="id"> \oo</span>).<br/>
<span class="vernacular">Canonical</span><span class="id"> locked_sin</span><span class="id"> :=</span><span class="id"> Unlockable</span><span class="id"> sin</span>.<span class="id">unlock</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> cos_coeff</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> realType}</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">[sequence</span> (<span class="id">~~</span><span class="id"> odd</span><span class="id"> n</span>)<span class="id">%:R</span><span class="id"> *</span> (<span class="id">-1</span>)<span class="id">^n</span>.<span class="id">/2</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span><span class="id"> /</span><span class="id"> n`!%:R]_n</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">lock</span><span class="vernacular"> Definition</span><span class="id"> cos</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> realType}</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> lim</span> (<span class="id">series</span> (<span class="id">cos_coeff</span><span class="id"> x</span>)<span class="id"> @</span><span class="id"> \oo</span>).<br/>
<span class="vernacular">Canonical</span><span class="id"> locked_cos</span><span class="id"> :=</span><span class="id"> Unlockable</span><span class="id"> cos</span>.<span class="id">unlock</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> CosSin</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> realType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sin_coeffE</span><span class="id"> x</span><span class="id"> :</span><span class="id"> sin_coeff</span><span class="id"> x</span><span class="id"> =</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span> (<span class="id">odd</span><span class="id"> n</span>)<span class="id">%:R</span><span class="id"> *</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span>.<span class="id">-1</span>.<span class="id">/2</span><span class="id"> *</span> (<span class="id">n`!%:R</span>)<span class="id">^-1</span>)<span class="id"> n</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> /sin_coeff</span><span class="id"> /=</span><span class="id"> -!mulrA</span><span class="id"> [_</span><span class="id"> /</span><span class="id"> _]mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sin_coeff_even</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> sin_coeff</span><span class="id"> x</span><span class="id"> n</span>.<span class="id">*2</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /sin_coeff</span><span class="id"> /=</span><span class="id"> odd_double</span><span class="id"> /=</span><span class="id"> !mul0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_cvg_series_sin_coeff</span><span class="id"> x</span><span class="id"> :</span><span class="id"> cvg</span> (<span class="id">series</span> (<span class="id">sin_coeff</span><span class="id"> x</span>)<span class="id"> @</span><span class="id"> \oo</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span><span class="id"> normed_cvg</span>.<br/>
<span class="id">apply:</span><span class="id"> series_le_cvg;</span><span class="id"> last</span><span class="id"> exact:</span> (<span class="id">@is_cvg_series_exp_coeff</span><span class="id"> _</span><span class="id"> `|x|</span>).<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n;</span><span class="id"> rewrite</span><span class="id"> normr_ge0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n;</span><span class="id"> rewrite</span><span class="id"> divr_ge0</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> n</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> /exp_coeff</span><span class="id"> /sin_coeff</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !normrM</span><span class="id"> normfV</span><span class="id"> !normr_nat</span><span class="id"> !normrX</span><span class="id"> normrN</span><span class="id"> normr1</span><span class="id"> expr1n</span><span class="id"> mulr1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> odd;</span><span class="id"> [rewrite</span><span class="id"> mul1r|</span><span class="id"> rewrite</span><span class="id"> !mul0r]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sinE</span><span class="id"> :</span><span class="id"> @sin</span><span class="id"> R</span><span class="id"> =</span><span class="gallina-kwd"> fun</span><span class="id"> x</span><span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;<span class="id">lim</span> (<span class="id">pseries</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span> (<span class="id">odd</span><span class="id"> n</span>)<span class="id">%:R</span><span class="id"> *</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span>.<span class="id">-1</span>.<span class="id">/2</span><span class="id"> *</span> (<span class="id">n`!%:R</span>)<span class="id">^-1</span>)<span class="id"> x</span><span class="id"> @</span><span class="id"> \oo</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> /pseries</span><span class="id"> unlock</span><span class="id"> -sin_coeffE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> sin_coeff'</span><span class="id"> x</span> (<span class="id">n</span><span class="id"> :</span><span class="id"> nat</span>)<span class="id"> :=</span> (<span class="id">-1</span>)<span class="id">^n</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<span class="id">*2</span>.<span class="id">+1</span><span class="id"> /</span><span class="id"> n</span>.<span class="id">*2</span>.<span class="id">+1`!%:R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sin_coeff'E</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> sin_coeff'</span><span class="id"> x</span><span class="id"> n</span><span class="id"> =</span><span class="id"> sin_coeff</span><span class="id"> x</span><span class="id"> n</span>.<span class="id">*2</span>.<span class="id">+1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /sin_coeff'</span><span class="id"> /sin_coeff</span><span class="id"> /=</span><span class="id"> odd_double</span><span class="id"> mul1r</span><span class="id"> -2!mulrA</span><span class="id"> doubleK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cvg_sin_coeff'</span><span class="id"> x</span><span class="id"> :</span><span class="id"> series</span> (<span class="id">sin_coeff'</span><span class="id"> x</span>)<span class="id"> @</span><span class="id"> \oo</span><span class="id"> --&gt;</span><span class="id"> sin</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> unlock</span>.<br/>
<span class="id">have</span><span class="id"> /</span>(<span class="id">@cvg_series_cvg_series_group</span><span class="id"> _</span><span class="id"> _</span><span class="id"> 2</span>)<span class="id"> :=</span><span class="id"> @is_cvg_series_sin_coeff</span><span class="id"> x</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> /</span>(_<span class="id"> isT</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> cvg_trans</span>.<br/>
<span class="id">rewrite</span><span class="id"> [X</span><span class="gallina-kwd"> in</span><span class="id"> _</span><span class="id"> --&gt;</span><span class="id"> series</span><span class="id"> X</span><span class="id"> @</span><span class="id"> \oo]</span>(_<span class="id"> :</span><span class="id"> _</span><span class="id"> =</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> sin_coeff</span><span class="id"> x</span><span class="id"> n</span>.<span class="id">*2</span>.<span class="id">+1</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> [X</span><span class="gallina-kwd"> in</span><span class="id"> series</span><span class="id"> X</span><span class="id"> @</span><span class="id"> \oo</span><span class="id"> --&gt;</span><span class="id"> _]</span>(_<span class="id"> :</span><span class="id"> _</span><span class="id"> =</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> sin_coeff</span><span class="id"> x</span><span class="id"> n</span>.<span class="id">*2</span>.<span class="id">+1</span>))<span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> funeqE</span><span class="id"> =&gt;</span><span class="id"> n;</span><span class="id"> exact:</span><span class="id"> sin_coeff'E</span>.<br/>
<span class="id">rewrite</span><span class="id"> funeqE=&gt;</span><span class="id"> n;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> 2!muln2</span><span class="id"> big_nat_recl</span><span class="id"> //=</span><span class="id"> sin_coeff_even</span><span class="id"> add0r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> big_nat_recl</span><span class="id"> //</span><span class="id"> big_geq</span><span class="id"> //</span><span class="id"> addr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> diffs_sin</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">pseries_diffs</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span> (<span class="id">odd</span><span class="id"> n</span>)<span class="id">%:R</span><span class="id"> *</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span>.<span class="id">-1</span>.<span class="id">/2</span><span class="id"> *</span> (<span class="id">n`!%:R</span>)<span class="id">^-1</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span> (<span class="id">~~</span>(<span class="id">odd</span><span class="id"> n</span>))<span class="id">%:R</span><span class="id"> *</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span>.<span class="id">/2</span><span class="id"> *</span> (<span class="id">n`!%:R</span>)<span class="id">^-1</span><span class="id"> :</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/funext</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> /pseries_diffs</span><span class="id"> /=</span><span class="id"> factS</span><span class="id"> natrM</span><span class="id"> invfM</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [_</span>.<span class="id">+1%:R</span><span class="id"> *</span><span class="id"> _]mulrC</span><span class="id"> -!mulrA</span><span class="id"> [_</span>.<span class="id">+1%:R^-1</span><span class="id"> *</span><span class="id"> _]mulrC</span><span class="id"> mulfK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> series_sin_coeff0</span><span class="id"> n</span><span class="id"> :</span><span class="id"> series</span> (<span class="id">@sin_coeff</span><span class="id"> R</span><span class="id"> 0</span>)<span class="id"> n</span>.<span class="id">+1</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /series</span><span class="id"> /=</span><span class="id"> big_nat_recl</span><span class="id"> //=</span><span class="id"> /sin_coeff</span><span class="id"> /=</span><span class="id"> expr0n</span><span class="id"> divr1</span><span class="id"> !mulr1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> big1</span><span class="id"> ?addr0</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> expr0n</span><span class="id"> !</span>(<span class="id">mul0r,</span><span class="id"> mulr0</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sin0</span><span class="id"> :</span><span class="id"> sin</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> unlock</span>.<br/>
<span class="id">apply:</span><span class="id"> lim_near_cst</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> near=&gt;</span><span class="id"> m;</span><span class="id"> rewrite</span><span class="id"> -[m]prednK;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> near:</span><span class="id"> m</span>.<br/>
<span class="id">rewrite</span><span class="id"> -addn1</span><span class="id"> series_addn</span><span class="id"> series_sin_coeff0</span><span class="id"> big_add1</span><span class="id"> big1</span><span class="id"> ?addr0//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> /sin_coeff</span><span class="id"> /=</span><span class="id"> expr0n</span><span class="id"> !</span>(<span class="id">mulr0,</span><span class="id"> mul0r</span>).<br/>
<span class="id">Unshelve</span>.<span class="id"> all:</span><span class="gallina-kwd"> by</span><span class="id"> end_near</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos_coeff_odd</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> cos_coeff</span><span class="id"> x</span><span class="id"> n</span>.<span class="id">*2</span>.<span class="id">+1</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /cos_coeff</span><span class="id"> /=</span><span class="id"> odd_double</span><span class="id"> /=</span><span class="id"> !mul0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos_coeff_2_0</span><span class="id"> :</span><span class="id"> cos_coeff</span><span class="id"> 2</span><span class="id"> 0%N</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /cos_coeff</span><span class="id"> /=</span><span class="id"> divr1</span><span class="id"> 2!mul1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos_coeff_2_2</span><span class="id"> :</span><span class="id"> cos_coeff</span><span class="id"> 2</span><span class="id"> 2%N</span><span class="id"> =</span><span class="id"> -</span><span class="id"> 2%:R</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /cos_coeff</span><span class="id"> /=</span><span class="id"> mul1r</span><span class="id"> mulN1r</span><span class="id"> mulNr</span><span class="id"> mulfK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos_coeff_2_4</span><span class="id"> :</span><span class="id"> cos_coeff</span><span class="id"> 2</span><span class="id"> 4%N</span><span class="id"> =</span><span class="id"> 2%:R</span><span class="id"> /</span><span class="id"> 3%:R</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eqr_div</span><span class="id"> //=</span><span class="id"> ?pnatr_eq0</span><span class="id"> //</span><span class="id"> -exprnP</span><span class="id"> sqrrN</span><span class="id"> expr1n</span><span class="id"> 2!mul1r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -natrX</span><span class="id"> -2!natrM</span><span class="id"> eqr_nat</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos_coeffE</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">cos_coeff</span><span class="id"> x</span><span class="id"> =</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span> (<span class="id">~~</span>(<span class="id">odd</span><span class="id"> n</span>))<span class="id">%:R</span><span class="id"> *</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span>.<span class="id">/2</span><span class="id"> *</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">n`!%:R</span>)<span class="id">^-1</span>)<span class="id"> n</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> /cos_coeff</span><span class="id"> /=</span><span class="id"> -!mulrA</span><span class="id"> [_</span><span class="id"> /</span><span class="id"> _]mulrC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_cvg_series_cos_coeff</span><span class="id"> x</span><span class="id"> :</span><span class="id"> cvg</span> (<span class="id">series</span> (<span class="id">cos_coeff</span><span class="id"> x</span>)<span class="id"> @</span><span class="id"> \oo</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span><span class="id"> normed_cvg</span>.<br/>
<span class="id">apply:</span><span class="id"> series_le_cvg;</span><span class="id"> last</span><span class="id"> exact:</span> (<span class="id">@is_cvg_series_exp_coeff</span><span class="id"> _</span><span class="id"> `|x|</span>).<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n;</span><span class="id"> rewrite</span><span class="id"> normr_ge0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> n;</span><span class="id"> rewrite</span><span class="id"> divr_ge0</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> n</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> /exp_coeff</span><span class="id"> /cos_coeff</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !normrM</span><span class="id"> normfV</span><span class="id"> !normr_nat</span><span class="id"> !normrX</span><span class="id"> normrN</span><span class="id"> normr1</span><span class="id"> expr1n</span><span class="id"> mulr1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> odd;</span><span class="id"> [rewrite</span><span class="id"> !mul0r</span><span class="id"> |</span><span class="id"> rewrite</span><span class="id"> mul1r]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cosE</span><span class="id"> :</span><span class="id"> @cos</span><span class="id"> R</span><span class="id"> =</span><span class="gallina-kwd"> fun</span><span class="id"> x</span><span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;<span class="id">lim</span> (<span class="id">series</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span> (<span class="id">~~</span>(<span class="id">odd</span><span class="id"> n</span>))<span class="id">%:R</span><span class="id"> *</span> (<span class="id">-1</span>)<span class="id">^+</span><span class="id"> n</span>.<span class="id">/2</span><span class="id"> *</span> (<span class="id">n`!%:R</span>)<span class="id">^-1</span>)<span class="id"> n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">*</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> @</span><span class="id"> \oo</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> unlock;</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> -cos_coeffE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> cos_coeff'</span><span class="id"> x</span> (<span class="id">n</span><span class="id"> :</span><span class="id"> nat</span>)<span class="id"> :=</span> (<span class="id">-1</span>)<span class="id">^n</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<span class="id">*2</span><span class="id"> /</span><span class="id"> n</span>.<span class="id">*2`!%:R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos_coeff'E</span><span class="id"> x</span><span class="id"> n</span><span class="id"> :</span><span class="id"> cos_coeff'</span><span class="id"> x</span><span class="id"> n</span><span class="id"> =</span><span class="id"> cos_coeff</span><span class="id"> x</span><span class="id"> n</span>.<span class="id">*2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /cos_coeff'</span><span class="id"> /cos_coeff</span><span class="id"> /=</span><span class="id"> odd_double</span><span class="id"> /=</span><span class="id"> mul1r</span><span class="id"> -2!mulrA;</span><span class="id"> congr</span> (_<span class="id"> *</span><span class="id"> _</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">half_bit_double</span><span class="id"> n</span><span class="id"> false</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cvg_cos_coeff'</span><span class="id"> x</span><span class="id"> :</span><span class="id"> series</span> (<span class="id">cos_coeff'</span><span class="id"> x</span>)<span class="id"> @</span><span class="id"> \oo</span><span class="id"> --&gt;</span><span class="id"> cos</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> unlock</span>.<br/>
<span class="id">have</span><span class="id"> /</span>(<span class="id">@cvg_series_cvg_series_group</span><span class="id"> _</span><span class="id"> _</span><span class="id"> 2</span>)<span class="id"> :=</span><span class="id"> @is_cvg_series_cos_coeff</span><span class="id"> x</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> /</span>(_<span class="id"> isT</span>)<span class="id">;</span><span class="id"> apply:</span><span class="id"> cvg_trans</span>.<br/>
<span class="id">rewrite</span><span class="id"> [X</span><span class="gallina-kwd"> in</span><span class="id"> _</span><span class="id"> --&gt;</span><span class="id"> series</span><span class="id"> X</span><span class="id"> @</span><span class="id"> \oo]</span>(_<span class="id"> :</span><span class="id"> _</span><span class="id"> =</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> cos_coeff</span><span class="id"> x</span><span class="id"> n</span>.<span class="id">*2</span>))<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> funeqE=&gt;</span><span class="id"> n;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> 2!muln2</span><span class="id"> big_nat_recr</span><span class="id"> //=</span><span class="id"> cos_coeff_odd</span><span class="id"> addr0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> big_nat_recl//=</span><span class="id"> /index_iota</span><span class="id"> subnn</span><span class="id"> big_nil</span><span class="id"> addr0</span>.<br/>
<span class="id">rewrite</span><span class="id"> [X</span><span class="gallina-kwd"> in</span><span class="id"> series</span><span class="id"> X</span><span class="id"> @</span><span class="id"> \oo</span><span class="id"> --&gt;</span><span class="id"> _]</span>(_<span class="id"> :</span><span class="id"> _</span><span class="id"> =</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> cos_coeff</span><span class="id"> x</span><span class="id"> n</span>.<span class="id">*2</span>))<span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> funeqE</span><span class="id"> =&gt;</span><span class="id"> n;</span><span class="id"> exact:</span><span class="id"> cos_coeff'E</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> diffs_cos</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">pseries_diffs</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span> (<span class="id">~~</span><span class="id"> odd</span><span class="id"> n</span>)<span class="id">%:R</span><span class="id"> *</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span>.<span class="id">/2</span><span class="id"> *</span><span class="id"> n`!%:R^-1</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> -</span> ((<span class="id">odd</span><span class="id"> n</span>)<span class="id">%:R</span><span class="id"> *</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span>.<span class="id">-1</span>.<span class="id">/2</span><span class="id"> *</span><span class="id"> n`!%:R^-1</span>)<span class="id"> :</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/funext</span><span class="id"> =&gt;</span><span class="id"> []</span><span class="id"> [|i]</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /pseries_diffs</span><span class="id"> /=</span><span class="id"> !mul0r</span><span class="id"> mulr0</span><span class="id"> oppr0</span>.<br/>
<span class="id">rewrite</span><span class="id"> /pseries_diffs</span><span class="id"> /=</span><span class="id"> negbK</span><span class="id"> exprS</span><span class="id"> mulN1r</span><span class="id"> !</span>(<span class="id">mulNr,</span><span class="id"> mulrN</span>).<br/>
<span class="id">rewrite</span><span class="id"> factS</span><span class="id"> natrM</span><span class="id"> invfM</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [_</span>.<span class="id">+1%:R</span><span class="id"> *</span><span class="id"> _]mulrC</span><span class="id"> -!mulrA</span><span class="id"> [_</span>.<span class="id">+1%:R^-1</span><span class="id"> *</span><span class="id"> _]mulrC</span><span class="id"> mulfK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> series_cos_coeff0</span><span class="id"> n</span><span class="id"> :</span><span class="id"> series</span> (<span class="id">cos_coeff</span><span class="id"> 0</span>)<span class="id"> n</span>.<span class="id">+1</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /series</span><span class="id"> /=</span><span class="id"> big_nat_recl</span><span class="id"> //=</span><span class="id"> /cos_coeff</span><span class="id"> /=</span><span class="id"> expr0n</span><span class="id"> divr1</span><span class="id"> !mulr1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> big1</span><span class="id"> ?addr0</span><span class="id"> //</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> expr0n</span><span class="id"> !</span>(<span class="id">mul0r,</span><span class="id"> mulr0</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos0</span><span class="id"> :</span><span class="id"> cos</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> unlock</span>.<br/>
<span class="id">apply:</span><span class="id"> lim_near_cst</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> near=&gt;</span><span class="id"> m;</span><span class="id"> rewrite</span><span class="id"> -[m]prednK;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> near:</span><span class="id"> m</span>.<br/>
<span class="id">rewrite</span><span class="id"> -addn1</span><span class="id"> series_addn</span><span class="id"> series_cos_coeff0</span><span class="id"> big_add1</span><span class="id"> big1</span><span class="id"> ?addr0//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> /cos_coeff</span><span class="id"> /=</span><span class="id"> expr0n</span><span class="id"> !</span>(<span class="id">mulr0,</span><span class="id"> mul0r</span>).<br/>
<span class="id">Unshelve</span>.<span class="id"> all:</span><span class="gallina-kwd"> by</span><span class="id"> end_near</span>. Qed.</div></details>
<br/>
<span class="id">Global</span><span class="vernacular"> Instance</span><span class="id"> is_derive_sin</span><span class="id"> x</span><span class="id"> :</span><span class="id"> is_derive</span><span class="id"> x</span><span class="id"> 1</span> (<span class="id">@sin</span><span class="id"> R</span>) (<span class="id">cos</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> sinE</span><span class="id"> /=</span>.<br/>
<span class="id">pose</span><span class="id"> s</span><span class="id"> :</span><span class="id"> R^nat</span><span class="id"> :=</span><span class="gallina-kwd"> fun</span><span class="id"> n</span><span class="id"> =&gt;</span> (<span class="id">odd</span><span class="id"> n</span>)<span class="id">%:R</span><span class="id"> *</span> (<span class="id">-1</span>)<span class="id"> ^+</span> (<span class="id">n</span>.<span class="id">-1</span>).<span class="id">/2</span><span class="id"> /</span><span class="id"> n`!%:R</span>.<br/>
<span class="id">pose</span><span class="id"> s1</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> pseries_diffs</span><span class="id"> s</span><span class="id"> n</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<span class="id">rewrite</span><span class="id"> cosE</span><span class="id"> /=</span><span class="id"> /pseries</span> (_<span class="id"> :</span> (<span class="gallina-kwd">fun</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> _</span>)<span class="id"> =</span><span class="id"> s1</span>)<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> /s1</span><span class="id"> diffs_sin</span>.<br/>
<span class="id">apply:</span> (<span class="id">@pseries_snd_diffs</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">`|x|</span><span class="id"> +</span><span class="id"> 1</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> /pseries</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -sin_coeffE;</span><span class="id"> apply:</span><span class="id"> is_cvg_series_sin_coeff</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span> (_<span class="id"> :</span> (<span class="gallina-kwd">fun</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> _</span>)<span class="id"> =</span><span class="id"> cos_coeff</span> (<span class="id">`|x|</span><span class="id"> +</span><span class="id"> 1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span><span class="id"> is_cvg_series_cos_coeff</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> diffs_sin</span><span class="id"> cos_coeffE</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> /pseries</span> (_<span class="id"> :</span> (<span class="gallina-kwd">fun</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> _</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> sin_coeff</span> (<span class="id">`|x|</span><span class="id"> +</span><span class="id"> 1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> is_cvg_seriesN;</span><span class="id"> exact:</span><span class="id"> is_cvg_series_sin_coeff</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> diffs_sin</span><span class="id"> diffs_cos</span><span class="id"> sin_coeffE</span><span class="id"> !fctE</span><span class="id"> !mulNr</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [ltRHS]ger0_norm//</span><span class="id"> addrC</span><span class="id"> -subr_gt0</span><span class="id"> addrK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> derivable_sin</span><span class="id"> x</span><span class="id"> :</span><span class="id"> derivable</span> (<span class="id">@sin</span><span class="id"> R</span>)<span class="id"> x</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> ex_derive;</span><span class="id"> apply:</span><span class="id"> is_derive_sin</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> continuous_sin</span><span class="id"> :</span><span class="id"> continuous</span> (<span class="id">@sin</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> apply/differentiable_continuous/derivable1_diffP/derivable_sin</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">Global</span><span class="vernacular"> Instance</span><span class="id"> is_derive_cos</span><span class="id"> x</span><span class="id"> :</span><span class="id"> is_derive</span><span class="id"> x</span><span class="id"> 1</span> (<span class="id">@cos</span><span class="id"> R</span>) (<span class="id">-</span><span class="id"> sin</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> cosE</span><span class="id"> /=</span>.<br/>
<span class="id">pose</span><span class="id"> s</span><span class="id"> :</span><span class="id"> R^nat</span><span class="id"> :=</span><span class="gallina-kwd"> fun</span><span class="id"> n</span><span class="id"> =&gt;</span> (<span class="id">~~</span><span class="id"> odd</span><span class="id"> n</span>)<span class="id">%:R</span><span class="id"> *</span> (<span class="id">-1</span>)<span class="id"> ^+</span><span class="id"> n</span>.<span class="id">/2</span><span class="id"> /</span><span class="id"> n`!%:R</span>.<br/>
<span class="id">pose</span><span class="id"> s1</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> pseries_diffs</span><span class="id"> s</span><span class="id"> n</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<span class="id">rewrite</span><span class="id"> sinE</span><span class="id"> /=</span><span class="id"> /pseries</span>.<br/>
<span class="id">rewrite</span> (_<span class="id"> :</span> (<span class="gallina-kwd">fun</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> _</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> s1</span>)<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> /s1</span><span class="id"> diffs_cos</span><span class="id"> !fctE</span><span class="id"> mulNr</span><span class="id"> opprK</span>.<br/>
<span class="id">rewrite</span><span class="id"> lim_seriesN</span><span class="id"> ?opprK;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (_<span class="id"> :</span><span class="id"> s1</span><span class="id"> =</span><span class="id"> -</span><span class="id"> sin_coeff</span><span class="id"> x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> is_cvg_seriesN;</span><span class="id"> exact:</span><span class="id"> is_cvg_series_sin_coeff</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> /s1</span><span class="id"> diffs_cos</span><span class="id"> sin_coeffE</span><span class="id"> !fctE</span><span class="id"> mulNr</span>.<br/>
<span class="id">apply:</span> (<span class="id">@pseries_snd_diffs</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">`|x|</span><span class="id"> +</span><span class="id"> 1</span>)).<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /pseries</span><span class="id"> -cos_coeffE;</span><span class="id"> apply:</span><span class="id"> is_cvg_series_cos_coeff</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> /pseries</span> (_<span class="id"> :</span> (<span class="gallina-kwd">fun</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> _</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> sin_coeff</span> (<span class="id">`|x|</span><span class="id"> +</span><span class="id"> 1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> is_cvg_seriesN;</span><span class="id"> exact:</span><span class="id"> is_cvg_series_sin_coeff</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> diffs_cos</span><span class="id"> sin_coeffE</span><span class="id"> !fctE</span><span class="id"> mulNr</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> /pseries</span> (_<span class="id"> :</span> (<span class="gallina-kwd">fun</span><span class="id"> _=&gt;</span><span class="id"> _</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> cos_coeff</span> (<span class="id">`|x|</span><span class="id"> +</span><span class="id"> 1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> is_cvg_seriesN;</span><span class="id"> exact:</span><span class="id"> is_cvg_series_cos_coeff</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/funext</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> diffs_cos</span><span class="id"> pseries_diffsN</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> diffs_sin</span><span class="id"> cos_coeffE</span><span class="id"> mulNr</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> [ltRHS]ger0_norm//</span><span class="id"> addrC</span><span class="id"> -subr_gt0</span><span class="id"> addrK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> derivable_cos</span><span class="id"> x</span><span class="id"> :</span><span class="id"> derivable</span> (<span class="id">@cos</span><span class="id"> R</span>)<span class="id"> x</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> ex_derive;</span><span class="id"> apply:</span><span class="id"> is_derive_cos</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> continuous_cos</span><span class="id"> :</span><span class="id"> continuous</span> (<span class="id">@cos</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> exact/differentiable_continuous/derivable1_diffP/derivable_cos</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos2Dsin2</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">cos</span><span class="id"> x</span>)<span class="id"> ^+</span><span class="id"> 2</span><span class="id"> +</span> (<span class="id">sin</span><span class="id"> x</span>)<span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">set</span><span class="id"> v</span><span class="id"> :=</span><span class="id"> LHS;</span><span class="id"> pattern</span><span class="id"> x</span><span class="gallina-kwd"> in</span><span class="id"> v;</span><span class="id"> move:</span><span class="id"> @v;</span><span class="id"> set</span><span class="id"> f</span><span class="id"> :=</span> (<span class="id">X</span><span class="gallina-kwd"> in</span><span class="gallina-kwd"> let</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> X</span><span class="id"> x</span><span class="gallina-kwd"> in</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> /=</span>.<br/>
<span class="id">apply:</span> (<span class="id">@eq_trans</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">f</span><span class="id"> 0</span>))<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /f</span><span class="id"> sin0</span><span class="id"> cos0</span><span class="id"> expr1n</span><span class="id"> expr0n</span><span class="id"> addr0</span>.<br/>
<span class="id">apply:</span><span class="id"> is_derive_0_is_cst</span><span class="id"> =&gt;</span><span class="id"> {}x</span>.<br/>
<span class="id">apply:</span><span class="id"> trigger_derive;</span><span class="id"> rewrite</span><span class="id"> /GRing</span>.<span class="id">scale</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrN</span><span class="id"> ![sin</span><span class="id"> x</span><span class="id"> *</span><span class="id"> _]mulrC</span><span class="id"> -opprD</span><span class="id"> addrC</span><span class="id"> subrr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos_max</span><span class="id"> x</span><span class="id"> :</span><span class="id"> `|</span><span class="id"> cos</span><span class="id"> x</span><span class="id"> |</span><span class="id"> &lt;=</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">expr_le1</span> (_<span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> 2</span>)<span class="id">%nat</span>)<span class="id"> //</span><span class="id"> -normrX</span><span class="id"> ger0_norm</span><span class="id"> ?exprn_even_ge0</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">cos2Dsin2</span><span class="id"> x</span>)<span class="id"> lerDl</span><span class="id"> ?sqr_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos_geN1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> &lt;=</span><span class="id"> cos</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lerNl;</span><span class="id"> have</span><span class="id"> /ler_normlP[]</span><span class="id"> :=</span><span class="id"> cos_max</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos_le1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> cos</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> have</span><span class="id"> /ler_normlP[]</span><span class="id"> :=</span><span class="id"> cos_max</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sin_max</span><span class="id"> x</span><span class="id"> :</span><span class="id"> `|</span><span class="id"> sin</span><span class="id"> x</span><span class="id"> |</span><span class="id"> &lt;=</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">expr_le1</span> (_<span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> 2</span>)<span class="id">%nat</span>)<span class="id"> //</span><span class="id"> -normrX</span><span class="id"> ger0_norm</span><span class="id"> ?exprn_even_ge0</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">cos2Dsin2</span><span class="id"> x</span>)<span class="id"> lerDr</span><span class="id"> ?sqr_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sin_geN1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> &lt;=</span><span class="id"> sin</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lerNl;</span><span class="id"> have</span><span class="id"> /ler_normlP[]</span><span class="id"> :=</span><span class="id"> sin_max</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sin_le1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> sin</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> have</span><span class="id"> /ler_normlP[]</span><span class="id"> :=</span><span class="id"> sin_max</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> sinD_cosD</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">sin</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> -</span> (<span class="id">sin</span><span class="id"> x</span><span class="id"> *</span><span class="id"> cos</span><span class="id"> y</span><span class="id"> +</span><span class="id"> cos</span><span class="id"> x</span><span class="id"> *</span><span class="id"> sin</span><span class="id"> y</span>))<span class="id"> ^+</span><span class="id"> 2</span><span class="id"> +</span><br/>
&nbsp;&nbsp;(<span class="id">cos</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> -</span> (<span class="id">cos</span><span class="id"> x</span><span class="id"> *</span><span class="id"> cos</span><span class="id"> y</span><span class="id"> -</span><span class="id"> sin</span><span class="id"> x</span><span class="id"> *</span><span class="id"> sin</span><span class="id"> y</span>))<span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">set</span><span class="id"> v</span><span class="id"> :=</span><span class="id"> LHS;</span><span class="id"> pattern</span><span class="id"> x</span><span class="gallina-kwd"> in</span><span class="id"> v;</span><span class="id"> move:</span><span class="id"> @v;</span><span class="id"> set</span><span class="id"> f</span><span class="id"> :=</span> (<span class="id">X</span><span class="gallina-kwd"> in</span><span class="gallina-kwd"> let</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> X</span><span class="id"> x</span><span class="gallina-kwd"> in</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> /=</span>.<br/>
<span class="id">apply:</span> (<span class="id">@eq_trans</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">f</span><span class="id"> 0</span>))<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /f</span><span class="id"> cos0</span><span class="id"> sin0</span><span class="id"> !</span>(<span class="id">mul1r,</span><span class="id"> mul0r,</span><span class="id"> add0r,</span><span class="id"> subr0,</span><span class="id"> subrr,</span><span class="id"> expr0n</span>).<br/>
<span class="id">apply:</span><span class="id"> is_derive_0_is_cst</span><span class="id"> =&gt;</span><span class="id"> {}x</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> trigger_derive;</span><span class="id"> rewrite</span><span class="id"> /GRing</span>.<span class="id">scale</span><span class="id"> /=;</span><span class="id"> nsatz</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sinD</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> sin</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> sin</span><span class="id"> x</span><span class="id"> *</span><span class="id"> cos</span><span class="id"> y</span><span class="id"> +</span><span class="id"> cos</span><span class="id"> x</span><span class="id"> *</span><span class="id"> sin</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> /eqP</span><span class="id"> :=</span><span class="id"> sinD_cosD</span><span class="id"> x</span><span class="id"> y</span>.<br/>
<span class="id">rewrite</span><span class="id"> paddr_eq0</span><span class="id"> =&gt;</span><span class="id"> [/andP[]||];</span><span class="id"> try</span><span class="id"> exact:</span><span class="id"> sqr_ge0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> sqrf_eq0</span><span class="id"> subr_eq0</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cosD</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> cos</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> cos</span><span class="id"> x</span><span class="id"> *</span><span class="id"> cos</span><span class="id"> y</span><span class="id"> -</span><span class="id"> sin</span><span class="id"> x</span><span class="id"> *</span><span class="id"> sin</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> /eqP</span><span class="id"> :=</span><span class="id"> sinD_cosD</span><span class="id"> x</span><span class="id"> y</span>.<br/>
<span class="id">rewrite</span><span class="id"> paddr_eq0</span><span class="id"> =&gt;</span><span class="id"> [/andP[_]||];</span><span class="id"> try</span><span class="id"> exact:</span><span class="id"> sqr_ge0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> sqrf_eq0</span><span class="id"> subr_eq0</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sin2cos2</span><span class="id"> x</span><span class="id"> :</span><span class="id"> sin</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> -</span><span class="id"> cos</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/eqP:</span> (<span class="id">cos2Dsin2</span><span class="id"> x</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> eq_sym</span><span class="id"> addrC</span><span class="id"> -subr_eq</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos2sin2</span><span class="id"> x</span><span class="id"> :</span><span class="id"> cos</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> -</span><span class="id"> sin</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/eqP:</span> (<span class="id">cos2Dsin2</span><span class="id"> x</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> eq_sym</span><span class="id"> -subr_eq</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sin_mulr2n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> sin</span> (<span class="id">x</span><span class="id"> *+</span><span class="id"> 2</span>)<span class="id"> =</span> (<span class="id">cos</span><span class="id"> x</span><span class="id"> *</span><span class="id"> sin</span><span class="id"> x</span>)<span class="id"> *+</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr2n</span><span class="id"> sinD</span><span class="id"> mulrC</span><span class="id"> -mulr2n</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos_mulr2n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> cos</span> (<span class="id">x</span><span class="id"> *+</span><span class="id"> 2</span>)<span class="id"> =</span><span class="id"> cos</span><span class="id"> x</span><span class="id"> ^+2</span><span class="id"> *+</span><span class="id"> 2</span><span class="id"> -</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr2n</span><span class="id"> cosD</span><span class="id"> -!expr2</span><span class="id"> sin2cos2</span><span class="id"> opprB</span><span class="id"> addrA</span><span class="id"> mulr2n</span>. Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> sinN_cosN</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">sin</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> +</span><span class="id"> sin</span><span class="id"> x</span>)<span class="id"> ^+</span><span class="id"> 2</span><span class="id"> +</span> (<span class="id">cos</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> -</span><span class="id"> cos</span><span class="id"> x</span>)<span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">set</span><span class="id"> v</span><span class="id"> :=</span><span class="id"> LHS;</span><span class="id"> pattern</span><span class="id"> x</span><span class="gallina-kwd"> in</span><span class="id"> v;</span><span class="id"> move:</span><span class="id"> @v;</span><span class="id"> set</span><span class="id"> f</span><span class="id"> :=</span> (<span class="id">X</span><span class="gallina-kwd"> in</span><span class="gallina-kwd"> let</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> X</span><span class="id"> x</span><span class="gallina-kwd"> in</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> /=</span>.<br/>
<span class="id">apply:</span> (<span class="id">@eq_trans</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">f</span><span class="id"> 0</span>))<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /f</span><span class="id"> oppr0</span><span class="id"> cos0</span><span class="id"> sin0</span><span class="id"> !</span>(<span class="id">addr0,</span><span class="id"> subrr,</span><span class="id"> expr0n</span>).<br/>
<span class="id">apply:</span><span class="id"> is_derive_0_is_cst</span><span class="id"> =&gt;</span><span class="id"> {}x</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> trigger_derive;</span><span class="id"> rewrite</span><span class="id"> /GRing</span>.<span class="id">scale</span><span class="id"> /=;</span><span class="id"> nsatz</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sinN</span><span class="id"> x</span><span class="id"> :</span><span class="id"> sin</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> sin</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> /eqP</span><span class="id"> :=</span><span class="id"> sinN_cosN</span><span class="id"> x</span>.<br/>
<span class="id">rewrite</span><span class="id"> paddr_eq0</span><span class="id"> =&gt;</span><span class="id"> [/andP[]||];</span><span class="id"> try</span><span class="id"> exact:</span><span class="id"> sqr_ge0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> sqrf_eq0</span><span class="id"> addr_eq0</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cosN</span><span class="id"> x</span><span class="id"> :</span><span class="id"> cos</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> cos</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> /eqP</span><span class="id"> :=</span><span class="id"> sinN_cosN</span><span class="id"> x</span>.<br/>
<span class="id">rewrite</span><span class="id"> paddr_eq0</span><span class="id"> =&gt;</span><span class="id"> [/andP[_]||];</span><span class="id"> try</span><span class="id"> exact:</span><span class="id"> sqr_ge0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> sqrf_eq0</span><span class="id"> subr_eq0</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sin_sg</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> sin</span> (<span class="id">Num</span>.<span class="id">sg</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> Num</span>.<span class="id">sg</span><span class="id"> x</span><span class="id"> *</span><span class="id"> sin</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> sgrP;</span><span class="id"> rewrite</span><span class="id"> ?mul1r</span><span class="id"> ?mulN1r</span><span class="id"> ?sinN</span><span class="id"> //</span><span class="id"> !mul0r</span><span class="id"> sin0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos_sg</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> cos</span> (<span class="id">Num</span>.<span class="id">sg</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> cos</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> sgrP;</span><span class="id"> rewrite</span><span class="id"> ?mul1r</span><span class="id"> ?mulN1r</span><span class="id"> ?cosN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cosB</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> cos</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> cos</span><span class="id"> x</span><span class="id"> *</span><span class="id"> cos</span><span class="id"> y</span><span class="id"> +</span><span class="id"> sin</span><span class="id"> x</span><span class="id"> *</span><span class="id"> sin</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> cosD</span><span class="id"> cosN</span><span class="id"> sinN</span><span class="id"> mulrN</span><span class="id"> opprK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sinB</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> sin</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> sin</span><span class="id"> x</span><span class="id"> *</span><span class="id"> cos</span><span class="id"> y</span><span class="id"> -</span><span class="id"> cos</span><span class="id"> x</span><span class="id"> *</span><span class="id"> sin</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> sinD</span><span class="id"> cosN</span><span class="id"> sinN</span><span class="id"> mulrN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> norm_cos_eq1</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">`|cos</span><span class="id"> x|</span><span class="id"> ==</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">sin</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -sqrf_eq0</span><span class="id"> -sqrp_eq1</span><span class="id"> //</span><span class="id"> -normrX</span><span class="id"> ger0_norm</span><span class="id"> ?exprn_even_ge0</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [X</span><span class="gallina-kwd"> in</span><span class="id"> _</span><span class="id"> =</span> (<span class="id">X</span><span class="id"> ==</span><span class="id"> _</span>)<span class="id">]sin2cos2</span><span class="id"> subr_eq0</span><span class="id"> eq_sym</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> norm_sin_eq1</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">`|sin</span><span class="id"> x|</span><span class="id"> ==</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">cos</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -sqrf_eq0</span><span class="id"> -sqrp_eq1</span><span class="id"> //</span><span class="id"> -normrX</span><span class="id"> ger0_norm</span><span class="id"> ?exprn_even_ge0</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [X</span><span class="gallina-kwd"> in</span><span class="id"> _</span><span class="id"> =</span> (<span class="id">X</span><span class="id"> ==</span><span class="id"> _</span>)<span class="id">]cos2sin2</span><span class="id"> subr_eq0</span><span class="id"> eq_sym</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos1sin0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> `|cos</span><span class="id"> x|</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> sin</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/eqP;</span><span class="id"> rewrite</span><span class="id"> norm_cos_eq1</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sin1cos0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> `|sin</span><span class="id"> x|</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> cos</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/eqP;</span><span class="id"> rewrite</span><span class="id"> norm_sin_eq1</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sin0cos1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> sin</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> `|cos</span><span class="id"> x|</span><span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/eqP;</span><span class="id"> rewrite</span><span class="id"> -norm_cos_eq1</span><span class="id"> =&gt;</span><span class="id"> /eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos_norm</span><span class="id"> x</span><span class="id"> :</span><span class="id"> cos</span><span class="id"> `|x|</span><span class="id"> =</span><span class="id"> cos</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span> (<span class="id">ler0P</span><span class="id"> x</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?cosN</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> CosSin</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> sin</span><span class="id"> {R}</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> cos</span><span class="id"> {R}</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Pi</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> realType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> R</span>) (<span class="id">n</span><span class="id"> k</span><span class="id"> :</span><span class="id"> nat</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> pi</span><span class="id"> :</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> get</span><span class="id"> [set</span><span class="id"> x</span><span class="id"> |</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 2</span><span class="id"> /\</span><span class="id"> cos</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0]</span><span class="id"> *+</span><span class="id"> 2</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pihalfE</span><span class="id"> :</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> get</span><span class="id"> [set</span><span class="id"> x</span><span class="id"> |</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 2</span><span class="id"> /\</span><span class="id"> cos</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /pi</span><span class="id"> -[_</span><span class="id"> *+</span><span class="id"> 2]mulr_natr</span><span class="id"> -mulrA</span><span class="id"> divff</span><span class="id"> ?mulr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos2_lt0</span><span class="id"> :</span><span class="id"> cos</span><span class="id"> 2</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">opprK</span> (<span class="id">cos</span><span class="id"> _</span>))<span class="id"> oppr_lt0;</span><span class="id"> have</span><span class="id"> /cvgN</span><span class="id"> h</span><span class="id"> :=</span><span class="id"> @cvg_cos_coeff'</span><span class="id"> R</span><span class="id"> 2</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">cvg_lim</span> (<span class="id">@Rhausdorff</span><span class="id"> R</span>)<span class="id"> h</span>).<br/>
<span class="id">apply:</span> (<span class="id">@lt_trans</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">\sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> 3</span>)<span class="id"> -</span><span class="id"> cos_coeff'</span><span class="id"> 2</span><span class="id"> i</span>)).<br/>
&nbsp;&nbsp;<span class="id">do</span><span class="id"> 3</span><span class="id"> rewrite</span><span class="id"> big_nat_recl//;</span><span class="id"> rewrite</span><span class="id"> big_nil</span><span class="id"> addr0</span><span class="id"> 3!cos_coeff'E</span><span class="id"> double0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> cos_coeff_2_0</span><span class="id"> cos_coeff_2_2</span><span class="id"> -muln2</span><span class="id"> cos_coeff_2_4</span><span class="id"> addrA</span><span class="id"> -</span>(<span class="id">opprD</span><span class="id"> 1</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> opprB</span><span class="id"> -</span>(<span class="id">@natrB</span><span class="id"> _</span><span class="id"> 2</span><span class="id"> 1</span>)<span class="id">//</span><span class="id"> subn1/=</span><span class="id"> -[in</span><span class="id"> X</span><span class="gallina-kwd"> in</span><span class="id"> X</span><span class="id"> -</span><span class="id"> _]</span>(<span class="id">@divff</span><span class="id"> _</span><span class="id"> 3%:R</span>)<span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -mulrBl</span><span class="id"> divr_gt0//</span><span class="id"> -natrB//</span><span class="id"> -[</span>(_<span class="id"> -</span><span class="id"> _</span>)<span class="id">%N]/_</span>.<span class="id">+1</span>.<br/>
<span class="id">rewrite</span><span class="id"> -seriesN</span><span class="id"> lt_sum_lim_series</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move/cvgP</span><span class="gallina-kwd"> in</span><span class="id"> h;</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> seriesN</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> d</span>.<br/>
<span class="id">rewrite</span><span class="id"> /cos_coeff'</span><span class="id"> 2!exprzD_nat</span> (<span class="id">exprSz</span><span class="id"> _</span><span class="id"> d</span>.<span class="id">*2</span>)<span class="id"> -[in</span> (<span class="id">-1</span>)<span class="id"> ^</span><span class="id"> d</span>.<span class="id">*2]</span>(<span class="id">muln2</span><span class="id"> d</span>).<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">exprnP</span><span class="id"> _</span> (<span class="id">d</span><span class="id"> *</span><span class="id"> 2</span>)) (<span class="id">exprM</span> (<span class="id">-1</span>))<span class="id"> sqrr_sign</span><span class="id"> 2!mulr1</span><span class="id"> -exprSzr</span>.<br/>
<span class="id">rewrite</span> (_<span class="id"> :</span><span class="id"> 4</span><span class="id"> =</span><span class="id"> 2</span><span class="id"> *</span><span class="id"> 2</span>)<span class="id">%N</span><span class="id"> //</span><span class="id"> -</span>(<span class="id">exprnP</span><span class="id"> _</span> (<span class="id">2</span><span class="id"> *</span><span class="id"> 2</span>)) (<span class="id">exprM</span> (<span class="id">-1</span>))<span class="id"> sqrr_sign</span>.<br/>
<span class="id">rewrite</span><span class="id"> mul1r</span><span class="id"> [</span>(<span class="id">-1</span>)<span class="id"> ^</span><span class="id"> 3]</span>(_<span class="id"> :</span><span class="id"> _</span><span class="id"> =</span><span class="id"> -1</span>)<span class="id"> ?mulN1r</span><span class="id"> ?mulNr</span><span class="id"> ?opprK;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -exprnP</span><span class="id"> 2!exprS</span><span class="id"> expr1</span><span class="id"> mulrN1</span><span class="id"> opprK</span><span class="id"> mulr1</span>.<br/>
<span class="id">rewrite</span><span class="id"> subr_gt0</span>.<br/>
<span class="id">rewrite</span><span class="id"> addnS</span><span class="id"> doubleS</span><span class="id"> -[X</span><span class="gallina-kwd"> in</span><span class="id"> 2</span><span class="id"> ^+</span><span class="id"> X]addn2</span><span class="id"> exprD</span><span class="id"> -mulrA</span><span class="id"> ltr_pM2l//</span>.<br/>
<span class="id">rewrite</span><span class="id"> factS</span><span class="id"> factS</span><span class="id"> 2!natrM</span><span class="id"> mulrA</span><span class="id"> invfM</span><span class="id"> !mulrA</span>.<br/>
<span class="id">rewrite</span><span class="id"> ltr_pdivrMr</span><span class="id"> ?ltr0n</span><span class="id"> ?fact_gt0//</span><span class="id"> mulVf</span><span class="id"> ?pnatr_eq0</span><span class="id"> ?gtn_eqF</span><span class="id"> ?fact_gt0//</span>.<br/>
<span class="id">rewrite</span><span class="id"> ltr_pdivrMr</span><span class="id"> ?mul1r</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> expr2</span><span class="id"> -!natrM</span><span class="id"> ltr_nat</span><span class="id"> !mulSn</span><span class="id"> !add2n</span><span class="id"> mul0n</span><span class="id"> !addnS</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sin2_gt0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 2</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> sin</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /andP[x_gt0</span><span class="id"> x_lt2]</span>.<br/>
<span class="id">have</span><span class="id"> sinx</span><span class="id"> :=</span><span class="id"> @cvg_sin_coeff'</span><span class="id"> _</span><span class="id"> x</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">cvg_lim</span> (<span class="id">@Rhausdorff</span><span class="id"> R</span>)<span class="id"> sinx</span>).<br/>
<span class="id">rewrite</span><span class="id"> [ltLHS]</span>(_<span class="id"> :</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> \sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> 0</span>)<span class="id"> sin_coeff'</span><span class="id"> x</span><span class="id"> i</span><span class="id"> :&gt;</span><span class="id"> R</span>)<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> big_nil</span>.<br/>
<span class="id">apply:</span><span class="id"> lt_sum_lim_series;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> move/cvgP</span><span class="gallina-kwd"> in</span><span class="id"> sinx</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> d</span>.<br/>
<span class="id">rewrite</span><span class="id"> /sin_coeff'</span><span class="id"> 2!exprzD_nat</span> (<span class="id">exprSz</span><span class="id"> _</span><span class="id"> d</span>.<span class="id">*2</span>)<span class="id"> -[in</span> (<span class="id">-1</span>)<span class="id"> ^</span><span class="id"> d</span>.<span class="id">*2]</span>(<span class="id">muln2</span><span class="id"> d</span>).<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">exprnP</span><span class="id"> _</span> (<span class="id">d</span><span class="id"> *</span><span class="id"> 2</span>)) (<span class="id">exprM</span> (<span class="id">-1</span>))<span class="id"> sqrr_sign</span><span class="id"> 2!mulr1</span><span class="id"> -exprSzr</span>.<br/>
<span class="id">rewrite</span><span class="id"> !add0n!mul1r</span><span class="id"> mulN1r</span><span class="id"> -[d</span>.<span class="id">*2</span>.<span class="id">+1]addn1</span><span class="id"> doubleD</span><span class="id"> -addSn</span><span class="id"> exprD</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">ffact_fact</span> (<span class="id">leq_addl</span><span class="id"> _</span><span class="id"> _</span>))<span class="id"> addnK</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulNr</span><span class="id"> -!mulrA</span><span class="id"> -mulrBr</span><span class="id"> mulr_gt0</span><span class="id"> ?exprn_gt0</span><span class="id"> //</span>.<br/>
<span class="id">set</span><span class="id"> u</span><span class="id"> :=</span><span class="id"> _</span>.<span class="id">+1</span>.<br/>
<span class="id">rewrite</span><span class="id"> natrM</span><span class="id"> invfM</span>.<br/>
<span class="id">rewrite</span><span class="id"> -[X</span><span class="gallina-kwd"> in</span><span class="id"> _</span><span class="id"> &lt;</span><span class="id"> X</span><span class="id"> -</span><span class="id"> _]mul1r</span><span class="id"> !mulrA</span><span class="id"> -mulrBl</span><span class="id"> divr_gt0</span><span class="id"> //;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">ltr_nat</span><span class="id"> _</span><span class="id"> 0</span>)<span class="id"> fact_gt0</span>.<br/>
<span class="id">rewrite</span><span class="id"> subr_gt0</span>.<br/>
<span class="id">set</span><span class="id"> v</span><span class="id"> :=</span><span class="id"> _</span><span class="id"> ^_</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> -[ltRHS]</span>(<span class="id">divff</span> (_<span class="id"> :</span><span class="id"> v%:R</span><span class="id"> !=</span><span class="id"> 0</span>))<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lt0r_neq0</span><span class="id"> //</span> (<span class="id">ltr_nat</span><span class="id"> _</span><span class="id"> 0</span>)<span class="id"> ffact_gt0</span><span class="id"> leq_addl</span>.<br/>
<span class="id">rewrite</span><span class="id"> ltr_pM2r;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> invr_gt0</span> (<span class="id">ltr_nat</span><span class="id"> _</span><span class="id"> 0</span>)<span class="id"> ffact_gt0</span><span class="id"> leq_addl</span>.<br/>
<span class="id">rewrite</span><span class="id"> {}/v</span><span class="id"> !addnS</span><span class="id"> addn0</span><span class="id"> !ffactnS</span><span class="id"> ffactn0</span><span class="id"> muln1</span><span class="id"> /=</span><span class="id"> natrM</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">ltr_pM</span> (<span class="id">ltW</span><span class="id"> _</span> ) (<span class="id">ltW</span><span class="id"> _</span>))<span class="id"> //</span> (<span class="id">lt_le_trans</span><span class="id"> x_lt2</span>)<span class="id"> //</span><span class="id"> ler_nat</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos1_gt0</span><span class="id"> :</span><span class="id"> cos</span><span class="id"> 1</span><span class="id"> &gt;</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> h</span><span class="id"> :=</span><span class="id"> @cvg_cos_coeff'</span><span class="id"> R</span><span class="id"> 1;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">cvg_lim</span> (<span class="id">@Rhausdorff</span><span class="id"> R</span>)<span class="id"> h</span>).<br/>
<span class="id">apply:</span> (<span class="id">@lt_trans</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">\sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> 2</span>)<span class="id"> cos_coeff'</span><span class="id"> 1</span><span class="id"> i</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> big_nat_recr//=</span><span class="id"> big_nat_recr//=</span><span class="id"> big_nil</span><span class="id"> add0r</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> /cos_coeff'</span><span class="id"> expr0z</span><span class="id"> expr1n</span><span class="id"> fact0</span><span class="id"> !mul1r</span><span class="id"> expr1n</span><span class="id"> expr1z</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !mulNr</span><span class="id"> subr_gt0</span><span class="id"> mul1r</span><span class="id"> div1r</span><span class="id"> ltf_pV2</span><span class="id"> ?posrE</span><span class="id"> ?ltr0n//</span><span class="id"> ltr_nat</span>.<br/>
<span class="id">apply:</span><span class="id"> lt_sum_lim_series;</span><span class="id"> [by</span><span class="id"> move/cvgP</span><span class="gallina-kwd"> in</span><span class="id"> h|move=&gt;</span><span class="id"> d]</span>.<br/>
<span class="id">rewrite</span><span class="id"> /cos_coeff'</span><span class="id"> !</span>(<span class="id">expr1n,mulr1</span>).<br/>
<span class="id">rewrite</span><span class="id"> -muln2</span><span class="id"> -mulSn</span><span class="id"> muln2</span><span class="id"> -exprnP</span><span class="id"> -signr_odd</span><span class="id"> odd_double</span><span class="id"> expr0</span>.<br/>
<span class="id">rewrite</span><span class="id"> -exprnP</span><span class="id"> -signr_odd</span><span class="id"> oddD/=</span><span class="id"> muln2</span><span class="id"> odd_double/=</span><span class="id"> expr1</span><span class="id"> add2n</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulNr</span><span class="id"> subr_gt0</span><span class="id"> 2!div1r</span><span class="id"> ltf_pV2</span><span class="id"> ?posrE</span><span class="id"> ?ltr0n</span><span class="id"> ?fact_gt0//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltr_nat</span><span class="id"> ltn_pfact//ltn_double</span><span class="id"> doubleS</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos_exists</span><span class="id"> :</span><span class="gallina-kwd"> exists2</span><span class="id"> pih</span><span class="id"> :</span><span class="id"> R,</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> pih</span><span class="id"> &lt;=</span><span class="id"> 2</span><span class="id"> &amp;</span><span class="id"> cos</span><span class="id"> pih</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> /IVT[]</span><span class="id"> :</span><span class="id"> minr</span> (<span class="id">cos</span><span class="id"> 1</span>) (<span class="id">cos</span><span class="id"> 2</span>)<span class="id"> &lt;=</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> &lt;=</span><span class="id"> maxr</span> (<span class="id">cos</span><span class="id"> 1</span>) (<span class="id">cos</span><span class="id"> 2</span>).<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> le_max</span> (<span class="id">ltW</span><span class="id"> cos1_gt0</span>)<span class="id"> ge_min</span> (<span class="id">ltW</span><span class="id"> cos2_lt0</span>)<span class="id"> orbC</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ler1n</span>.<br/>
&nbsp;&nbsp;<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> apply/continuous_subspaceT</span><span class="id"> =&gt;</span><span class="id"> ?;</span><span class="id"> exact:</span><span class="id"> continuous_cos</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> pih</span><span class="id"> /itvP</span><span class="id"> pihI</span><span class="id"> chpi_eq0;</span><span class="gallina-kwd"> exists</span><span class="id"> pih;</span><span class="id"> rewrite</span><span class="id"> ?pihI</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos_02_uniq</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 2</span><span class="id"> -&gt;</span><span class="id"> cos</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> 2</span><span class="id"> -&gt;</span><span class="id"> cos</span><span class="id"> y</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">wlog</span><span class="id"> xLy</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [H</span><span class="id"> xB</span><span class="id"> cx0</span><span class="id"> yB</span><span class="id"> cy0|]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">lerP</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> =&gt;</span><span class="id"> [/H</span><span class="id"> //|</span><span class="id"> /ltW</span><span class="id"> /H</span><span class="id"> H1];</span><span class="id"> [exact|exact/esym/H1]</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> /andP[x_ge0</span><span class="id"> x_le2]</span><span class="id"> cx0</span><span class="id"> /andP[y_ge0</span><span class="id"> y_le2]</span><span class="id"> cy0</span>.<br/>
<span class="id">move:</span><span class="id"> xLy;</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[//|xLLs]</span>.<br/>
<span class="id">have</span><span class="id"> /</span>(<span class="id">Rolle</span><span class="id"> xLLs</span>)<span class="id">[x1</span><span class="id"> _|x1|x1</span><span class="id"> x1I</span><span class="id"> [_</span><span class="id"> x1D]]</span><span class="id"> :</span><span class="id"> cos</span><span class="id"> x</span><span class="id"> =</span><span class="id"> cos</span><span class="id"> y</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> cy0</span>.<br/>
<span class="id">-</span><span class="id"> exact:</span><span class="id"> derivable_cos</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> apply/continuous_subspaceT</span><span class="id"> =&gt;</span><span class="id"> ?;</span><span class="id"> exact:</span><span class="id"> continuous_cos</span>.<br/>
<span class="id">-</span><span class="id"> have</span><span class="id"> [_</span><span class="id"> /esym/eqP]</span><span class="id"> :=</span><span class="id"> is_derive_cos</span><span class="id"> x1;</span><span class="id"> rewrite</span><span class="id"> x1D</span><span class="id"> oppr_eq0</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> Hs</span>.<br/>
&nbsp;&nbsp;<span class="id">suff</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> sin</span><span class="id"> x1</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> Hs</span><span class="id"> ltxx</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/sin2_gt0/andP;</span><span class="id"> split</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">le_lt_trans</span><span class="id"> x_ge0</span>)<span class="id">//</span> (<span class="id">itvP</span><span class="id"> x1I</span>).<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">lt_le_trans</span><span class="id"> _</span><span class="id"> y_le2</span>)<span class="id">//</span> (<span class="id">itvP</span><span class="id"> x1I</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pihalf_02_cos_pihalf</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span><span class="id"> &lt;=</span><span class="id"> 2</span><span class="id"> /\</span><span class="id"> cos</span> (<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [x</span><span class="id"> /andP[x1</span><span class="id"> x2]</span><span class="id"> cs0]</span><span class="id"> :=</span><span class="id"> cos_exists;</span><span class="id"> rewrite</span><span class="id"> pihalfE</span>.<br/>
<span class="id">case:</span><span class="id"> xgetP</span><span class="id"> =&gt;</span><span class="id"> [_-&gt;[]//|/</span>(_<span class="id"> x</span>)<span class="id">/=]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> cs0</span> (<span class="id">le_trans</span><span class="id"> _</span><span class="id"> x1</span>)<span class="id">//</span><span class="id"> x2</span><span class="id"> =&gt;</span><span class="id"> /not_andP[]</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">#[deprecated</span>(<span class="id">note=</span><span class="id">&quot;Use pihalf_ge1 and pihalf_lt2 instead&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Lemma</span><span class="id"> pihalf_02</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span><span class="id"> &lt;</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [pih02</span><span class="id"> cpih]</span><span class="id"> :=</span><span class="id"> pihalf_02_cos_pihalf</span>.<br/>
<span class="id">rewrite</span><span class="id"> 2!lt_neqAle</span><span class="id"> andbCA</span><span class="id"> -andbA</span><span class="id"> pih02</span><span class="id"> andbT;</span><span class="id"> apply/andP;</span><span class="id"> split</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/eqP</span><span class="id"> =&gt;</span><span class="id"> pih2;</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> cos2_lt0;</span><span class="id"> rewrite</span><span class="id"> -pih2</span><span class="id"> cpih</span><span class="id"> ltxx</span>.<br/>
<span class="id">apply/eqP</span><span class="id"> =&gt;</span><span class="id"> pih0;</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> @cos0</span><span class="id"> R</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> pih0</span><span class="id"> cpih;</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eq_sym</span><span class="id"> oner_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> pihalf_12</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span><span class="id"> &lt;</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [/andP[pih0</span><span class="id"> pih2]</span><span class="id"> cpih]</span><span class="id"> :=</span><span class="id"> pihalf_02_cos_pihalf</span>.<br/>
<span class="id">rewrite</span><span class="id"> lt_neqAle</span><span class="id"> andbA</span><span class="id"> andbAC</span><span class="id"> pih2</span><span class="id"> andbT;</span><span class="id"> apply/andP;</span><span class="id"> split;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/eqP</span><span class="id"> =&gt;</span><span class="id"> hpi2;</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> cos2_lt0;</span><span class="id"> rewrite</span><span class="id"> -hpi2</span><span class="id"> cpih</span><span class="id"> ltxx</span>.<br/>
<span class="id">rewrite</span><span class="id"> leNgt;</span><span class="id"> apply/negP</span><span class="id"> =&gt;</span><span class="id"> hpi1;</span><span class="id"> have</span><span class="id"> [x</span><span class="id"> /andP[x1</span><span class="id"> x2]</span><span class="id"> cs0]</span><span class="id"> :=</span><span class="id"> cos_exists</span>.<br/>
<span class="id">have</span><span class="id"> :=</span><span class="id"> @cos_02_uniq</span> (<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id"> x</span>.<br/>
<span class="id">rewrite</span><span class="id"> pih0</span><span class="id"> pih2</span><span class="id"> cpih</span> (<span class="id">le_trans</span><span class="id"> _</span><span class="id"> x1</span>)<span class="id">//</span><span class="id"> x2</span><span class="id"> cs0</span><span class="id"> =&gt;</span><span class="id"> /</span>(_<span class="id"> erefl</span><span class="id"> erefl</span><span class="id"> erefl</span><span class="id"> erefl</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> pih;</span><span class="id"> move:</span><span class="id"> hpi1;</span><span class="id"> rewrite</span><span class="id"> pih</span><span class="id"> =&gt;</span><span class="id"> /lt_le_trans/</span>(_<span class="id"> x1</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ltxx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pihalf_ge1</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> have</span><span class="id"> /andP[]</span><span class="id"> :=</span><span class="id"> pihalf_12</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pihalf_lt2</span><span class="id"> :</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span><span class="id"> &lt;</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> have</span><span class="id"> /andP[]</span><span class="id"> :=</span><span class="id"> pihalf_12</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pi_ge2</span><span class="id"> :</span><span class="id"> 2</span><span class="id"> &lt;=</span><span class="id"> pi</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span> <span class="id"> have</span><span class="id"> :=</span><span class="id"> pihalf_ge1;</span><span class="id"> rewrite</span><span class="id"> ler_pdivlMr//</span><span class="id"> mul1r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pi_gt0</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> pi</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">lt_le_trans</span><span class="id"> _</span><span class="id"> pi_ge2</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pi_ge0</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> pi</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">ltW</span><span class="id"> pi_gt0</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sin_gt0_pihalf</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> sin</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /andP[x_gt0</span><span class="id"> xLpi];</span><span class="id"> apply:</span><span class="id"> sin2_gt0;</span><span class="id"> rewrite</span><span class="id"> x_gt0</span><span class="id"> /=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> lt_trans</span><span class="id"> xLpi</span><span class="id"> _;</span><span class="id"> exact:</span><span class="id"> pihalf_lt2</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos_gt0_pihalf</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -</span>(<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> cos</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">wlog</span><span class="id"> :</span><span class="id"> x</span><span class="id"> /</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [Hw|x_ge0]</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span> (<span class="id">leP</span><span class="id"> 0</span><span class="id"> x</span>)<span class="id"> =&gt;</span><span class="id"> [/Hw//|</span><span class="id"> x_lt_0]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -{-1}[x]opprK</span><span class="id"> ltrNl</span><span class="id"> andbC</span><span class="id"> [--</span><span class="id"> _</span><span class="id"> &lt;</span><span class="id"> _]ltrNl</span><span class="id"> cosN</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> Hw</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> oppr_cp0</span><span class="id"> ltW</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> /andP[x_gt0</span><span class="id"> xLpi2];</span><span class="id"> case:</span> (<span class="id">ler0P</span> (<span class="id">cos</span><span class="id"> x</span>))<span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> cx_le0</span>.<br/>
<span class="id">have</span><span class="id"> /IVT[]//</span><span class="id"> :</span><span class="id"> minr</span> (<span class="id">cos</span><span class="id"> 0</span>) (<span class="id">cos</span><span class="id"> x</span>)<span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> maxr</span> (<span class="id">cos</span><span class="id"> 0</span>) (<span class="id">cos</span><span class="id"> x</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> cos0</span><span class="id"> /minr</span><span class="id"> /maxr</span><span class="id"> !ifN</span><span class="id"> ?cx_le0</span><span class="id"> //=</span><span class="id"> -leNgt</span> (<span class="id">le_trans</span><span class="id"> cx_le0</span>).<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> apply/continuous_subspaceT</span><span class="id"> =&gt;</span><span class="id"> ?;</span><span class="id"> exact:</span><span class="id"> continuous_cos</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> x1</span><span class="id"> /itvP</span><span class="id"> xx1</span><span class="id"> cx1_eq0</span>.<br/>
<span class="id">suff</span><span class="id"> x1E</span><span class="id"> :</span><span class="id"> x1</span><span class="id"> =</span><span class="id"> pi/2</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> :</span><span class="id"> x1</span><span class="id"> &lt;</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> le_lt_trans</span><span class="id"> xLpi2;</span><span class="id"> rewrite</span><span class="id"> xx1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> x1E</span><span class="id"> ltxx</span>.<br/>
<span class="id">apply:</span><span class="id"> cos_02_uniq=&gt;</span><span class="id"> //;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> case</span><span class="id"> pihalf_02_cos_pihalf</span><span class="id"> =&gt;</span><span class="id"> _</span><span class="id"> -&gt;</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> xx1</span><span class="id"> ltW</span><span class="id"> //</span> (<span class="id">lt_trans</span><span class="id"> _</span><span class="id"> pihalf_lt2</span>)<span class="id"> //</span> (<span class="id">le_lt_trans</span><span class="id"> _</span><span class="id"> xLpi2</span>)<span class="id"> //</span><span class="id"> xx1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> divr_ge0</span><span class="id"> ?</span>(<span class="id">ltW</span><span class="id"> pihalf_lt2</span>)<span class="id">//</span><span class="id"> pi_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos_pihalf</span><span class="id"> :</span><span class="id"> cos</span> (<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id"> =</span><span class="id"> 0</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> pihalf_02_cos_pihalf</span>.<span class="id">2</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sin_pihalf</span><span class="id"> :</span><span class="id"> sin</span> (<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> :=</span><span class="id"> cos2Dsin2</span> (<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> cos_pihalf</span><span class="id"> expr0n</span><span class="id"> add0r</span>.<br/>
<span class="id">rewrite</span><span class="id"> -[in</span><span class="id"> X</span><span class="gallina-kwd"> in</span><span class="id"> _</span><span class="id"> =</span><span class="id"> X</span><span class="id"> -&gt;</span><span class="id"> _]</span>(<span class="id">expr1n</span><span class="id"> _</span><span class="id"> 2%N</span>)<span class="id"> =&gt;</span><span class="id"> /eqP;</span><span class="id"> rewrite</span><span class="id"> -subr_eq0</span><span class="id"> subr_sqr</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulf_eq0=&gt;</span><span class="id"> /orP[|];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> subr_eq0=&gt;</span><span class="id"> /eqP</span>.<br/>
<span class="id">rewrite</span><span class="id"> addr_eq0</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> spi21;</span><span class="id"> have</span><span class="id"> /sin2_gt0:</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span><span class="id"> &lt;</span><span class="id"> 2</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> pihalf_lt2</span><span class="id"> andbT</span> (<span class="id">lt_le_trans</span><span class="id"> _</span><span class="id"> pihalf_ge1</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> spi21</span><span class="id"> ltr0N1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos_ge0_pihalf</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -</span> (<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> cos</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> 2!le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /andP[/predU1P[&lt;-|?]];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> cosN</span><span class="id"> cos_pihalf</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> /predU1P[-&gt;|?];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> cos_pihalf</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/ltW/cos_gt0_pihalf/andP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cospi</span><span class="id"> :</span><span class="id"> cos</span><span class="id"> pi</span><span class="id"> =</span><span class="id"> -</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /pi</span><span class="id"> mulr2n</span><span class="id"> cosD</span><span class="id"> -pihalfE</span><span class="id"> sin_pihalf</span><span class="id"> mulr1</span><span class="id"> cos_pihalf</span><span class="id"> mulr0</span><span class="id"> add0r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sinpi</span><span class="id"> :</span><span class="id"> sin</span><span class="id"> pi</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> sinD</span> (<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>) (<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> cos_pihalf</span><span class="id"> mulr0</span><span class="id"> mul0r</span><span class="id"> -splitr</span><span class="id"> addr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos2pi</span><span class="id"> :</span><span class="id"> cos</span> (<span class="id">pi</span><span class="id"> *+</span><span class="id"> 2</span>)<span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr2n</span><span class="id"> cosD</span><span class="id"> cospi</span><span class="id"> sinpi</span><span class="id"> mulrN1</span><span class="id"> opprK</span><span class="id"> mulr0</span><span class="id"> subr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sin2pi</span><span class="id"> :</span><span class="id"> sin</span> (<span class="id">pi</span><span class="id"> *+</span><span class="id"> 2</span>)<span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr2n</span><span class="id"> sinD</span><span class="id"> sinpi</span><span class="id"> cospi</span><span class="id"> mul0r</span><span class="id"> mulr0</span><span class="id"> add0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sinDpi</span><span class="id"> :</span><span class="id"> alternating</span><span class="id"> sin</span><span class="id"> pi</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a;</span><span class="id"> rewrite</span><span class="id"> sinD</span><span class="id"> cospi</span><span class="id"> mulrN1</span><span class="id"> sinpi</span><span class="id"> mulr0</span><span class="id"> addr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cosDpi</span><span class="id"> :</span><span class="id"> alternating</span><span class="id"> cos</span><span class="id"> pi</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a;</span><span class="id"> rewrite</span><span class="id"> cosD</span><span class="id"> cospi</span><span class="id"> mulrN1</span><span class="id"> sinpi</span><span class="id"> mulr0</span><span class="id"> subr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sinD2pi</span><span class="id"> :</span><span class="id"> periodic</span><span class="id"> sin</span> (<span class="id">pi</span><span class="id"> *+</span><span class="id"> 2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a;</span><span class="id"> rewrite</span><span class="id"> sinD</span><span class="id"> cos2pi</span><span class="id"> sin2pi</span><span class="id"> mulr0</span><span class="id"> mulr1</span><span class="id"> addr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cosD2pi</span><span class="id"> :</span><span class="id"> periodic</span><span class="id"> cos</span> (<span class="id">pi</span><span class="id"> *+</span><span class="id"> 2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a;</span><span class="id"> rewrite</span><span class="id"> cosD</span><span class="id"> cos2pi</span><span class="id"> mulr1</span><span class="id"> sin2pi</span><span class="id"> mulr0</span><span class="id"> subr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cosDpihalf</span><span class="id"> a</span><span class="id"> :</span><span class="id"> cos</span> (<span class="id">a</span><span class="id"> +</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> sin</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> cosD</span><span class="id"> cos_pihalf</span><span class="id"> mulr0</span><span class="id"> add0r</span><span class="id"> sin_pihalf</span><span class="id"> mulr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cosBpihalf</span><span class="id"> a</span><span class="id"> :</span><span class="id"> cos</span> (<span class="id">a</span><span class="id"> -</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id"> =</span><span class="id"> sin</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> cosB</span><span class="id"> cos_pihalf</span><span class="id"> mulr0</span><span class="id"> add0r</span><span class="id"> sin_pihalf</span><span class="id"> mulr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sinDpihalf</span><span class="id"> a</span><span class="id"> :</span><span class="id"> sin</span> (<span class="id">a</span><span class="id"> +</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id"> =</span><span class="id"> cos</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> sinD</span><span class="id"> cos_pihalf</span><span class="id"> mulr0</span><span class="id"> add0r</span><span class="id"> sin_pihalf</span><span class="id"> mulr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sinBpihalf</span><span class="id"> a</span><span class="id"> :</span><span class="id"> sin</span> (<span class="id">a</span><span class="id"> -</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> cos</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> sinB</span><span class="id"> cos_pihalf</span><span class="id"> mulr0</span><span class="id"> add0r</span><span class="id"> sin_pihalf</span><span class="id"> mulr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sin_ge0_pi</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> pi</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> sin</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> xI;</span><span class="id"> rewrite</span><span class="id"> -cosBpihalf</span><span class="id"> cos_ge0_pihalf//</span><span class="id"> lerBrDl</span><span class="id"> subrr</span><span class="id"> lerBDr</span><span class="id"> -splitr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sin_gt0_pi</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> pi</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> sin</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> xI;</span><span class="id"> rewrite</span><span class="id"> -cosBpihalf</span><span class="id"> cos_gt0_pihalf//</span><span class="id"> ltrBrDl</span><span class="id"> subrr</span><span class="id"> ltrBDr</span><span class="id"> -splitr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_cos</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> `[0,</span><span class="id"> pi]</span><span class="id"> &amp;,</span><span class="id"> {mono</span><span class="id"> cos</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> x}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> !in_itv/=</span><span class="id"> le_eqVlt;</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> [&lt;-</span><span class="id"> _|_]</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> cos0</span><span class="id"> le_eqVlt;</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> [&lt;-</span><span class="id"> _|_</span><span class="id"> /andP[y_gt0</span><span class="id"> gLpi]]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> cos0</span><span class="id"> !ltxx</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> y_gt0;</span><span class="id"> apply/idP</span>.<br/>
&nbsp;&nbsp;<span class="id">suff</span><span class="id"> :</span><span class="id"> cos</span><span class="id"> y</span><span class="id"> !=</span><span class="id"> 1</span><span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> ltrgtP</span> (<span class="id">cos_le1</span><span class="id"> y</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -cos0</span><span class="id"> eq_sym;</span><span class="id"> apply/eqP</span><span class="id"> =&gt;</span><span class="id"> /Rolle</span><span class="id"> [||x1|x1</span><span class="id"> /itvP</span><span class="id"> x1I</span><span class="id"> [_</span><span class="id"> x1D]]</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact/continuous_subspaceT/continuous_cos</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span> (<span class="id">is_derive_cos</span><span class="id"> x1</span>)<span class="id"> =&gt;</span><span class="id"> _</span><span class="id"> /eqP;</span><span class="id"> rewrite</span><span class="id"> x1D</span><span class="id"> eq_sym</span><span class="id"> oppr_eq0</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> s_eq0</span>.<br/>
&nbsp;&nbsp;<span class="id">suff</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> sin</span><span class="id"> x1</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> s_eq0</span><span class="id"> ltxx</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> sin_gt0_pi;</span><span class="id"> rewrite</span><span class="id"> x1I</span><span class="id"> /=</span> (<span class="id">lt_le_trans</span> (_<span class="id"> :</span><span class="id"> _</span><span class="id"> &lt;</span><span class="id"> y</span>))<span class="id"> ?x1I</span><span class="id"> //</span><span class="id"> yI</span>.<br/>
<span class="id">rewrite</span><span class="id"> le_eqVlt;</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> [-&gt;</span><span class="id"> _</span><span class="id"> /andP[y_ge0]|/=</span><span class="id"> _</span><span class="id"> /andP[x_gt0</span><span class="id"> x_ltpi]]</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> cospi</span><span class="id"> le_eqVlt;</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> [-&gt;</span><span class="id"> _|/eqP</span><span class="id"> yDpi</span><span class="id"> y_ltpi]</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> cospi</span><span class="id"> ltxx</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltNge</span><span class="id"> cos_geN1</span><span class="id"> ltNge</span><span class="id"> ltW</span>.<br/>
<span class="id">rewrite</span><span class="id"> le_eqVlt;</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> [&lt;-</span><span class="id"> _|_]</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> cos0</span><span class="id"> [_</span><span class="id"> &lt;</span><span class="id"> 0]ltNge</span><span class="id"> ltW</span><span class="id"> //=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/idP/negP;</span><span class="id"> rewrite</span><span class="id"> -leNgt</span><span class="id"> cos_le1</span>.<br/>
<span class="id">rewrite</span><span class="id"> le_eqVlt;</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> [-&gt;</span><span class="id"> _</span><span class="id"> |</span><span class="id"> _</span><span class="id"> /andP[y_gt0</span><span class="id"> y_ltpi]]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> cospi</span><span class="id"> x_ltpi;</span><span class="id"> apply/idP</span>.<br/>
&nbsp;&nbsp;<span class="id">suff</span><span class="id"> :</span><span class="id"> cos</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> -1</span><span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> ltrgtP</span> (<span class="id">cos_geN1</span><span class="id"> x</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -cospi;</span><span class="id"> apply/eqP</span><span class="id"> =&gt;</span><span class="id"> /Rolle</span><span class="id"> [||x1|x1</span><span class="id"> /itvP</span><span class="id"> x1I</span><span class="id"> [_</span><span class="id"> x1D]]</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact/continuous_subspaceT/continuous_cos</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span> (<span class="id">is_derive_cos</span><span class="id"> x1</span>)<span class="id"> =&gt;</span><span class="id"> _</span><span class="id"> /eqP;</span><span class="id"> rewrite</span><span class="id"> x1D</span><span class="id"> eq_sym</span><span class="id"> oppr_eq0</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> s_eq0</span>.<br/>
&nbsp;&nbsp;<span class="id">suff</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> sin</span><span class="id"> x1</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> s_eq0</span><span class="id"> ltxx</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> sin_gt0_pi;</span><span class="id"> rewrite</span><span class="id"> x1I</span><span class="id"> /=</span> (<span class="id">lt_le_trans</span> (_<span class="id"> :</span><span class="id"> _</span><span class="id"> &lt;</span><span class="id"> x</span>))<span class="id"> ?x1I</span>.<br/>
<span class="id">wlog</span><span class="id"> xLy</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> x_gt0</span><span class="id"> x_ltpi</span><span class="id"> y_gt0</span><span class="id"> y_ltpi</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [H</span><span class="id"> |</span><span class="id"> ]</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span> (<span class="id">lerP</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> =&gt;</span><span class="id"> [/H</span><span class="id"> //-&gt;//|yLx]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !ltNge</span><span class="id"> ltW</span><span class="id"> ?</span>(<span class="id">ltW</span><span class="id"> yLx</span>)<span class="id"> //</span><span class="id"> H</span><span class="id"> //</span><span class="id"> ltW</span>.<br/>
<span class="id">move:</span> (<span class="id">xLy</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[-&gt;|xLLs];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltxx</span>.<br/>
<span class="id">rewrite</span><span class="id"> xLLs</span><span class="id"> -subr_gt0</span><span class="id"> -opprB;</span><span class="id"> rewrite</span><span class="id"> -subr_gt0</span><span class="gallina-kwd"> in</span><span class="id"> xLLs;</span><span class="id"> apply/idP</span>.<br/>
<span class="id">have</span><span class="id"> [x1|z</span><span class="id"> /itvP</span><span class="id"> zI</span><span class="id"> -&gt;]</span><span class="id"> :=</span><span class="id"> @MVT_segment</span><span class="id"> _</span><span class="id"> cos</span> (<span class="id">-</span><span class="id"> sin</span>)<span class="id"> _</span><span class="id"> _</span><span class="id"> xLy</span>.<br/>
&nbsp;&nbsp;<span class="id">exact/continuous_subspaceT/continuous_cos</span>.<br/>
<span class="id">rewrite</span><span class="id"> -mulNr</span><span class="id"> opprK</span><span class="id"> mulr_gt0</span><span class="id"> //;</span><span class="id"> apply:</span><span class="id"> sin_gt0_pi</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">lt_le_trans</span><span class="id"> x_gt0</span>)<span class="id"> ?zI</span><span class="id"> //=</span> (<span class="id">le_lt_trans</span><span class="id"> _</span><span class="id"> y_ltpi</span>)<span class="id"> ?zI</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_sin</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> `[</span> (<span class="id">-</span> (<span class="id">pi/2</span>))<span class="id">,</span><span class="id"> pi/2]</span><span class="id"> &amp;,</span><span class="id"> {mono</span><span class="id"> sin</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /itvP</span><span class="id"> xpi</span><span class="id"> /itvP</span><span class="id"> ypi;</span><span class="id"> rewrite</span><span class="id"> -[sin</span><span class="id"> x]opprK</span><span class="id"> ltrNl</span>.<br/>
<span class="id">rewrite</span><span class="id"> -!cosDpihalf</span><span class="id"> -[x</span><span class="id"> &lt;</span><span class="id"> y]</span>(<span class="id">ltrD2r</span> (<span class="id">pi</span><span class="id"> /2</span>))<span class="id"> ltr_cos//</span><span class="id"> !in_itv/=</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -lerBlDr</span><span class="id"> sub0r</span><span class="id"> xpi/=</span><span class="id"> [leRHS]splitr</span><span class="id"> lerD2r</span><span class="id"> xpi</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -lerBlDr</span><span class="id"> sub0r</span><span class="id"> ypi/=</span><span class="id"> [leRHS]splitr</span><span class="id"> lerD2r</span><span class="id"> ypi</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos_inj</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> `[0,pi]</span><span class="id"> &amp;,</span><span class="id"> injective</span> (<span class="id">@cos</span><span class="id"> R</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> x0pi</span><span class="id"> y0pi</span><span class="id"> xy;</span><span class="id"> apply/eqP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> eq_le</span><span class="id"> 2!leNgt</span><span class="id"> -ltr_cos</span><span class="id"> //</span><span class="id"> xy</span><span class="id"> ltxx</span><span class="id"> -ltr_cos</span><span class="id"> //</span><span class="id"> xy</span><span class="id"> ltxx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sin_inj</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> `[</span>(<span class="id">-</span> (<span class="id">pi/2</span>))<span class="id">,</span> (<span class="id">pi/2</span>)<span class="id">]</span><span class="id"> &amp;,</span><span class="id"> injective</span><span class="id"> sin}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /itvP</span><span class="id"> xpi</span><span class="id"> /itvP</span><span class="id"> ypi</span><span class="id"> sinE;</span><span class="id"> have</span><span class="id"> :</span><span class="id"> -</span><span class="id"> sin</span><span class="id"> x</span><span class="id"> =</span><span class="id"> -</span><span class="id"> sin</span><span class="id"> y</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> sinE</span>.<br/>
<span class="id">rewrite</span><span class="id"> -!cosDpihalf</span><span class="id"> =&gt;</span><span class="id"> /cos_inj</span><span class="id"> h;</span><span class="id"> apply/</span>(<span class="id">addIr</span> (<span class="id">pi/2</span>))<span class="id">/h;</span><span class="id"> rewrite</span><span class="id"> !in_itv/=</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -lerBlDr</span><span class="id"> sub0r</span><span class="id"> xpi/=</span><span class="id"> [leRHS]splitr</span><span class="id"> lerD2r</span><span class="id"> xpi</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -lerBlDr</span><span class="id"> sub0r</span><span class="id"> ypi/=</span><span class="id"> [leRHS]splitr</span><span class="id"> lerD2r</span><span class="id"> ypi</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Pi</span>.<br/>
<br/>
<span class="vernacular">Arguments</span><span class="id"> pi</span><span class="id"> {R}</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Tan</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> realType</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> tan</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :=</span><span class="id"> sin</span><span class="id"> x</span><span class="id"> /</span><span class="id"> cos</span><span class="id"> x</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tan0</span><span class="id"> :</span><span class="id"> tan</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /tan</span><span class="id"> sin0</span><span class="id"> cos0</span><span class="id"> mul0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tanpi</span><span class="id"> :</span><span class="id"> tan</span><span class="id"> pi</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /tan</span><span class="id"> sinpi</span><span class="id"> mul0r</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tanN</span><span class="id"> x</span><span class="id"> :</span><span class="id"> tan</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> tan</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /tan</span><span class="id"> sinN</span><span class="id"> cosN</span><span class="id"> mulNr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tanD</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> cos</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> cos</span><span class="id"> y</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">tan</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">tan</span><span class="id"> x</span><span class="id"> +</span><span class="id"> tan</span><span class="id"> y</span>)<span class="id"> /</span> (<span class="id">1</span><span class="id"> -</span><span class="id"> tan</span><span class="id"> x</span><span class="id"> *</span><span class="id"> tan</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> cxNZ</span><span class="id"> cyNZ</span>.<br/>
<span class="id">rewrite</span><span class="id"> /tan</span><span class="id"> sinD</span><span class="id"> cosD</span><span class="id"> addf_div//</span><span class="id"> [sin</span><span class="id"> y</span><span class="id"> *</span><span class="id"> cos</span><span class="id"> x]mulrC</span><span class="id"> -[_</span><span class="id"> /</span><span class="id"> _</span><span class="id"> /</span><span class="id"> _]mulrA</span><span class="id"> -invfM</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> congr</span> (_<span class="id"> /</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> mulf_div</span><span class="id"> [RHS]mulrC</span><span class="id"> mulrBl</span><span class="id"> mul1r</span><span class="id"> divfK</span><span class="id"> //</span><span class="id"> mulf_neq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tan_mulr2n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> cos</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> tan</span> (<span class="id">x</span><span class="id"> *+</span><span class="id"> 2</span>)<span class="id"> =</span><span class="id"> tan</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> 2</span><span class="id"> /</span> (<span class="id">1</span><span class="id"> -</span><span class="id"> tan</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> cxNZ;</span><span class="id"> rewrite</span><span class="id"> mulr2n</span><span class="id"> tanD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos2_tan2</span><span class="id"> x</span><span class="id"> :</span><span class="id"> cos</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">cos</span><span class="id"> x</span>)<span class="id"> ^-</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> +</span><span class="id"> tan</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> cosx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /tan</span><span class="id"> expr_div_n</span><span class="id"> sin2cos2</span><span class="id"> mulrBl</span><span class="id"> divff</span><span class="id"> ?expf_neq0//</span><span class="id"> addrC</span><span class="id"> subrK</span><span class="id"> mul1r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tan_pihalf</span><span class="id"> :</span><span class="id"> tan</span> (<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /tan</span><span class="id"> cos_pihalf</span><span class="id"> invr0</span><span class="id"> mulr0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tan_piquarter</span><span class="id"> :</span><span class="id"> tan</span> (<span class="id">pi</span><span class="id"> /</span><span class="id"> 4%:R</span>)<span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /tan</span><span class="id"> -cosBpihalf</span><span class="id"> addrC</span><span class="id"> [pi</span><span class="id"> /</span><span class="id"> 2]splitr</span><span class="id"> opprD</span><span class="id"> -mulrA</span><span class="id"> -invfM</span><span class="id"> -natrM</span>.<br/>
<span class="id">rewrite</span><span class="id"> subrK</span><span class="id"> cosN</span><span class="id"> divff//</span><span class="id"> gt_eqF//</span><span class="id"> cos_gt0_pihalf//</span>.<br/>
<span class="id">rewrite</span><span class="id"> ltr_pM2l</span><span class="id"> ?pi_gt0//</span><span class="id"> ltf_pV2</span><span class="id"> ?qualifE//=</span><span class="id"> ltr_nat</span><span class="id"> andbT</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">@lt_trans</span><span class="id"> _</span><span class="id"> _</span><span class="id"> 0</span>)<span class="id">//</span><span class="id"> ?oppr_lt0</span><span class="id"> ?divr_gt0</span><span class="id"> ?pi_gt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tanDpi</span><span class="id"> x</span><span class="id"> :</span><span class="id"> tan</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> pi</span>)<span class="id"> =</span><span class="id"> tan</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /tan</span><span class="id"> cosDpi</span><span class="id"> sinDpi</span><span class="id"> divrNN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> continuous_tan</span><span class="id"> x</span><span class="id"> :</span><span class="id"> cos</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> {for</span><span class="id"> x,</span><span class="id"> continuous</span><span class="id"> tan}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> cxNZ</span>.<br/>
<span class="id">apply:</span><span class="id"> continuousM;</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> continuous_sin</span>.<br/>
<span class="id">exact/</span>(<span class="id">continuousV</span><span class="id"> cxNZ</span>)<span class="id">/continuous_cos</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_derive_tan</span><span class="id"> x</span><span class="id"> :</span><span class="id"> cos</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> is_derive</span><span class="id"> x</span><span class="id"> 1</span><span class="id"> tan</span> ((<span class="id">cos</span><span class="id"> x</span>)<span class="id">^-2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> cxNZ;</span><span class="id"> apply:</span><span class="id"> trigger_derive</span>.<br/>
<span class="id">rewrite</span><span class="id"> [_</span><span class="id"> *:</span><span class="id"> -</span><span class="id"> _]mulrNN</span><span class="id"> [_^-1</span><span class="id"> *:</span><span class="id"> _]mulVf</span><span class="id"> //</span><span class="id"> [_</span><span class="id"> *:</span><span class="id"> _]mulrCA</span><span class="id"> -expr2</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> sin2cos2</span><span class="id"> mulrBr</span><span class="id"> mulr1</span><span class="id"> mulVf</span><span class="id"> ?sqrf_eq0</span><span class="id"> //</span><span class="id"> subrK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> derivable_tan</span><span class="id"> x</span><span class="id"> :</span><span class="id"> cos</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> derivable</span><span class="id"> tan</span><span class="id"> x</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case/is_derive_tan</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_tan</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> `]</span>(<span class="id">-</span> (<span class="id">pi/2</span>))<span class="id">,</span> (<span class="id">pi/2</span>)<span class="id">[</span><span class="id"> &amp;,</span><span class="id"> {mono</span><span class="id"> tan</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> wlog</span><span class="id"> xLy</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [H</span><span class="id"> xB</span><span class="id"> yB|/itvP</span><span class="id"> xB</span><span class="id"> /itvP</span><span class="id"> yB]</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span> (<span class="id">lerP</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> =&gt;</span><span class="id"> [/H</span><span class="id"> //-&gt;//|yLx]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !ltNge</span><span class="id"> ltW</span><span class="id"> ?</span>(<span class="id">ltW</span><span class="id"> yLx</span>)<span class="id"> //</span><span class="id"> H</span><span class="id"> //</span><span class="id"> ltW</span>.<br/>
<span class="id">move:</span> (<span class="id">xLy</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[-&gt;|xLLs];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltxx</span>.<br/>
<span class="id">rewrite</span><span class="id"> -subr_gt0</span><span class="id"> xLLs;</span><span class="id"> rewrite</span><span class="id"> -subr_gt0</span><span class="gallina-kwd"> in</span><span class="id"> xLLs;</span><span class="id"> apply/idP</span>.<br/>
<span class="id">have</span><span class="id"> [x1</span><span class="id"> /itvP</span><span class="id"> x1I|z</span><span class="id"> |]</span><span class="id"> :=</span><span class="id"> @MVT_segment</span><span class="id"> _</span><span class="id"> tan</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span> (<span class="id">cos</span><span class="id"> x</span>)<span class="id"> ^-2</span>)<span class="id"> _</span><span class="id"> _</span><span class="id"> xLy</span>.<br/>
<span class="id">-</span><span class="id"> apply:</span><span class="id"> is_derive_tan</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> gt_eqF</span><span class="id"> //</span><span class="id"> cos_gt0_pihalf</span><span class="id"> //</span> (<span class="id">@lt_le_trans</span><span class="id"> _</span> <span class="id"> _</span><span class="id"> x</span>)<span class="id"> ?x1I</span><span class="id"> ?xB//=</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">@le_lt_trans</span><span class="id"> _</span> <span class="id"> _</span><span class="id"> y</span>)<span class="id"> ?x1I</span><span class="id"> ?yB</span>.<br/>
<span class="id">-</span><span class="id"> apply/continuous_in_subspaceT</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> -/[!</span>(<span class="id">@mem_setE</span><span class="id"> R</span>)<span class="id">]</span><span class="id"> /itvP</span><span class="id"> inI</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> continuous_tan;</span><span class="id"> rewrite</span><span class="id"> gt_eqF//</span><span class="id"> cos_gt0_pihalf//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">@lt_le_trans</span><span class="id"> _</span> <span class="id"> _</span><span class="id"> x</span>)<span class="id"> ?xB</span><span class="id"> ?inI//</span> (<span class="id">@le_lt_trans</span><span class="id"> _</span> <span class="id"> _</span><span class="id"> y</span>)<span class="id"> ?yB</span><span class="id"> ?inI</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> x1</span><span class="id"> /itvP</span><span class="id"> x1I</span><span class="id"> -&gt;</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mulr_gt0</span><span class="id"> //</span><span class="id"> invr_gt0</span><span class="id"> //</span><span class="id"> exprn_gte0</span><span class="id"> //</span><span class="id"> cos_gt0_pihalf</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">@lt_le_trans</span><span class="id"> _</span> <span class="id"> _</span><span class="id"> x</span>)<span class="id"> ?x1I</span><span class="id"> ?xB//=</span> (<span class="id">@le_lt_trans</span><span class="id"> _</span> <span class="id"> _</span><span class="id"> y</span>)<span class="id"> ?x1I</span><span class="id"> ?yB</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tan_inj</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> `]</span>(<span class="id">-</span> (<span class="id">pi/2</span>))<span class="id">,</span> (<span class="id">pi/2</span>)<span class="id">[</span><span class="id"> &amp;,</span><span class="id"> injective</span><span class="id"> tan}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> xB</span><span class="id"> yB</span><span class="id"> tanE</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">ltrgtP</span><span class="id"> x</span><span class="id"> y</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> //</span><span class="id"> -ltr_tan</span><span class="id"> ?tanE</span><span class="id"> ?ltxx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Tan</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> tan</span><span class="id"> {R}</span>.<br/>
<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_derive</span><span class="id"> _</span><span class="id"> _</span><span class="id"> tan</span><span class="id"> _</span>)<span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">eapply</span><span class="id"> is_derive_tan;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> []</span>)<span class="id"> :</span><span class="id"> typeclass_instances</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">lock</span><span class="vernacular"> Definition</span><span class="id"> acos</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> realType}</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> R</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">get</span><span class="id"> [set</span><span class="id"> y</span><span class="id"> |</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> pi</span><span class="id"> /\</span><span class="id"> cos</span><span class="id"> y</span><span class="id"> =</span><span class="id"> x]</span>.<br/>
<span class="vernacular">Canonical</span><span class="id"> locked_acos</span><span class="id"> :=</span><span class="id"> Unlockable</span><span class="id"> acos</span>.<span class="id">unlock</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Acos</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> realType</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> acos_def</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">-1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> acos</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> pi</span><span class="id"> /\</span><span class="id"> cos</span> (<span class="id">acos</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xB;</span><span class="id"> rewrite</span><span class="id"> unlock</span><span class="id"> /acos;</span><span class="id"> case:</span><span class="id"> xgetP</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> He</span>.<br/>
<span class="id">pose</span><span class="id"> f</span><span class="id"> y</span><span class="id"> :=</span><span class="id"> cos</span><span class="id"> y</span><span class="id"> -</span><span class="id"> x</span>.<br/>
<span class="id">have</span><span class="id"> /</span>(<span class="id">IVT</span> (<span class="id">@pi_ge0</span><span class="id"> _</span>))<span class="id">[]</span><span class="id"> //</span><span class="id"> :</span><span class="id"> minr</span> (<span class="id">f</span><span class="id"> 0</span>) (<span class="id">f</span><span class="id"> pi</span>)<span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> maxr</span> (<span class="id">f</span><span class="id"> 0</span>) (<span class="id">f</span><span class="id"> pi</span>).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> /f</span><span class="id"> cos0</span><span class="id"> cospi</span><span class="id"> /minr</span><span class="id"> /maxr</span><span class="id"> ltrD2r</span><span class="id"> -subr_lt0</span><span class="id"> opprK</span> (_<span class="id"> :</span><span class="id"> 1</span><span class="id"> +</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> 2</span>)<span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltrn0</span><span class="id"> subr_le0</span><span class="id"> subr_ge0</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> y</span><span class="id"> y0pi</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> continuousB;</span><span class="id"> apply/continuous_in_subspaceT</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> ?;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">[exact:</span><span class="id"> continuous_cos|exact:</span><span class="id"> cst_continuous]</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> /f</span><span class="id"> =&gt;</span><span class="id"> x1</span><span class="id"> /itvP</span><span class="id"> x1I</span><span class="id"> /eqP;</span><span class="id"> rewrite</span><span class="id"> subr_eq0</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> cosx1E</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">He</span><span class="id"> x1</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> !x1I</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> acos_ge0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> acos</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /acos_def[/andP[]]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> acos_lepi</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> acos</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> pi</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /acos_def[/andP[]]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> acosK</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> `[</span>(<span class="id">-1</span>)<span class="id">,1],</span><span class="id"> cancel</span> (<span class="id">@acos</span><span class="id"> R</span>)<span class="id"> cos}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> in_itv/==&gt;</span><span class="id"> /acos_def[/andP[]]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> acos_gt0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> acos</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /andP[x_geN1</span><span class="id"> x_lt1];</span><span class="id"> move:</span> (<span class="id">x_lt1</span>).<br/>
<span class="id">have</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> acos</span><span class="id"> x</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> acos_ge0</span><span class="id"> //</span><span class="id"> x_geN1</span><span class="id"> ltW</span>.<br/>
<span class="id">have</span><span class="id"> :</span><span class="id"> cos</span> (<span class="id">acos</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> x</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> acosK//</span><span class="id"> in_itv/=</span><span class="id"> x_geN1/=</span><span class="id"> ltW</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> ltrgt0P</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> cos0</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> ltxx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> acos_ltpi</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> acos</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> pi</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /andP[x_gtN1</span><span class="id"> x_le1];</span><span class="id"> move:</span> (<span class="id">x_gtN1</span>).<br/>
<span class="id">have</span><span class="id"> :</span><span class="id"> acos</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> pi</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> acos_lepi</span><span class="id"> //</span><span class="id"> x_le1</span><span class="id"> ltW</span>.<br/>
<span class="id">have</span><span class="id"> :</span><span class="id"> cos</span> (<span class="id">acos</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> x</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> acosK//</span><span class="id"> in_itv/=</span><span class="id"> x_le1</span><span class="id"> ltW</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">ltrgtP</span> (<span class="id">acos</span><span class="id"> x</span>)<span class="id"> pi</span>)<span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> cospi</span><span class="id"> =&gt;</span><span class="id"> -&gt;;</span><span class="id"> rewrite</span><span class="id"> ltxx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cosK</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> `[0,</span><span class="id"> pi],</span><span class="id"> cancel</span> (<span class="id">@cos</span><span class="id"> R</span>) (<span class="id">@acos</span><span class="id"> R</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> xB;</span><span class="id"> apply:</span><span class="id"> cos_inj</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> ?acosK//;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> xB;</span><span class="id"> rewrite</span><span class="id"> !in_itv/=</span><span class="id"> =&gt;</span><span class="id"> /andP[?</span><span class="id"> ?];rewrite</span><span class="id"> cos_geN1</span><span class="id"> cos_le1</span>.<br/>
<span class="id">move:</span><span class="id"> xB;</span><span class="id"> rewrite</span><span class="id"> !in_itv/=</span><span class="id"> =&gt;</span><span class="id"> /andP[?</span><span class="id"> ?]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> acos_ge0</span><span class="id"> ?acos_lepi</span><span class="id"> ?cos_geN1</span><span class="id"> ?cos_le1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> acos1</span><span class="id"> :</span><span class="id"> acos</span> (<span class="id">1</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> @cosK</span><span class="id"> 0;</span><span class="id"> rewrite</span><span class="id"> cos0</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> in_itv</span><span class="id"> //=</span><span class="id"> lexx</span><span class="id"> pi_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> acos0</span><span class="id"> :</span><span class="id"> acos</span> (<span class="id">0</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> =</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2%:R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> :=</span><span class="id"> @cosK</span> (<span class="id">pi</span><span class="id"> /</span><span class="id"> 2%:R</span>).<br/>
<span class="id">rewrite</span><span class="id"> cos_pihalf</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> in_itv//=</span><span class="id"> divr_ge0</span><span class="id"> ?ler0n</span><span class="id"> ?pi_ge0//=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ler_pdivrMr</span><span class="id"> ?ltr0n//</span><span class="id"> ler_peMr</span><span class="id"> ?pi_ge0//</span><span class="id"> ler1n</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> acosN</span><span class="id"> a</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> acos</span> (<span class="id">-</span><span class="id"> a</span>)<span class="id"> =</span><span class="id"> pi</span><span class="id"> -</span><span class="id"> acos</span><span class="id"> a</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> a1;</span><span class="id"> have</span><span class="id"> ?</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> &lt;=</span><span class="id"> -</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lerNl</span><span class="id"> opprK</span><span class="id"> lerNl</span><span class="id"> andbC</span>.<br/>
<span class="id">apply:</span><span class="id"> cos_inj;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> in_itv/=</span><span class="id"> acos_ge0//=</span><span class="id"> acos_lepi</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> in_itv/=</span><span class="id"> subr_ge0</span><span class="id"> acos_lepi//=</span><span class="id"> lerBlDl</span><span class="id"> lerDr</span><span class="id"> acos_ge0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> addrC</span><span class="id"> cosDpi</span><span class="id"> cosN</span><span class="id"> !acosK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> acosN1</span><span class="id"> :</span><span class="id"> acos</span> (<span class="id">-</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">pi</span><span class="id"> :</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> acosN</span><span class="id"> ?acos1</span><span class="id"> ?subr0</span><span class="id"> ?lexx//</span><span class="id"> -subr_ge0</span><span class="id"> opprK</span><span class="id"> addr_ge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cosKN</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -</span><span class="id"> pi</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> acos</span> (<span class="id">cos</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> pia0;</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">cosN</span><span class="id"> x</span>)<span class="id"> cosK//</span><span class="id"> in_itv/=</span><span class="id"> lerNr</span><span class="id"> oppr0</span><span class="id"> lerNl</span><span class="id"> andbC</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sin_acos</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> sin</span> (<span class="id">acos</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> Num</span>.<span class="id">sqrt</span> (<span class="id">1</span><span class="id"> -</span><span class="id"> x^+2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xB</span>.<br/>
<span class="id">rewrite</span><span class="id"> -[LHS]ger0_norm;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> sin_ge0_pi</span><span class="id"> //</span><span class="id"> acos_ge0</span><span class="id"> ?acos_lepi</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -sqrtr_sqr</span><span class="id"> sin2cos2</span><span class="id"> acosK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> continuous_acos</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> {for</span><span class="id"> x,</span><span class="id"> continuous</span> (<span class="id">@acos</span><span class="id"> R</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /andP[x_gtN1</span><span class="id"> x_lt1];</span><span class="id"> rewrite</span><span class="id"> -[x]acosK;</span><span class="id"> first</span><span class="id"> last</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !ltW</span><span class="id"> //;</span><span class="id"> case/andP:</span><span class="id"> xB</span>.<br/>
<span class="id">apply:</span><span class="id"> nbhs_singleton</span> (<span class="id">near_can_continuous</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> near=&gt;</span><span class="id"> z;</span><span class="id"> apply:</span><span class="id"> continuous_cos</span>.<br/>
<span class="id">have</span><span class="id"> /near_in_itvoo</span><span class="id"> aI</span><span class="id"> :</span><span class="id"> acos</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> `]0,</span><span class="id"> pi[</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> in_itv/=</span><span class="id"> acos_gt0</span><span class="id"> ?ltW</span><span class="id"> //=</span><span class="id"> acos_ltpi</span><span class="id"> //</span><span class="id"> ltW</span><span class="id"> ?andbT</span>.<br/>
<span class="id">near=&gt;</span><span class="id"> z;</span><span class="id"> apply:</span><span class="id"> cosK</span>.<br/>
<span class="id">suff</span><span class="id"> /itvP</span><span class="id"> zI</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \in</span><span class="id"> `]0,</span><span class="id"> pi[</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> in_itv/=</span><span class="id"> ltW</span><span class="id"> zI</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> near:</span><span class="id"> z</span>.<br/>
<span class="id">Unshelve</span>.<span class="id"> all:</span><span class="gallina-kwd"> by</span><span class="id"> end_near</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_derive1_acos</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">-1</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> is_derive</span><span class="id"> x</span><span class="id"> 1</span> (<span class="id">@acos</span><span class="id"> R</span>) (<span class="id">-</span> (<span class="id">Num</span>.<span class="id">sqrt</span> (<span class="id">1</span><span class="id"> -</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span>))<span class="id">^-1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /andP[x_gtN1</span><span class="id"> x_lt1];</span><span class="id"> rewrite</span><span class="id"> -sin_acos</span><span class="id"> ?ltW</span><span class="id"> //</span><span class="id"> -invrN</span>.<br/>
<span class="id">rewrite</span><span class="id"> -{1}[x]acosK;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> in_itv</span><span class="id"> /=</span><span class="id"> ?ltW</span>.<br/>
<span class="id">have</span><span class="id"> /near_in_itvoo</span><span class="id"> aI</span><span class="id"> :</span><span class="id"> acos</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> `]0,</span><span class="id"> pi[</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> in_itv/=</span><span class="id"> acos_gt0</span><span class="id"> ?ltW</span><span class="id"> //=</span><span class="id"> acos_ltpi</span><span class="id"> //</span><span class="id"> x_gtN1</span><span class="id"> ltW</span>.<br/>
<span class="id">apply:</span> (<span class="id">@is_derive_inverse</span><span class="id"> R</span><span class="id"> cos</span>).<br/>
<span class="id">-</span><span class="id"> near=&gt;</span><span class="id"> z;</span><span class="id"> apply:</span><span class="id"> cosK</span>.<br/>
&nbsp;&nbsp;<span class="id">suff</span><span class="id"> /itvP</span><span class="id"> zI</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \in</span><span class="id"> `]0,</span><span class="id"> pi[</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> in_itv/=</span><span class="id"> ?zI</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> near:</span><span class="id"> z</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> near=&gt;</span><span class="id"> z;</span><span class="id"> apply:</span><span class="id"> continuous_cos</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> oppr_eq0</span><span class="id"> sin_acos</span><span class="id"> ?ltW</span><span class="id"> //</span><span class="id"> sqrtr_eq0</span><span class="id"> //</span><span class="id"> -ltNge</span><span class="id"> subr_gt0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -real_normK</span><span class="id"> ?qualifE/=;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> ltrgt0P</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> exprn_cp1</span><span class="id"> //</span><span class="id"> ltr_norml</span><span class="id"> x_gtN1</span>.<br/>
<span class="id">Unshelve</span>.<span class="id"> all:</span><span class="gallina-kwd"> by</span><span class="id"> end_near</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Acos</span>.<br/>
<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_derive</span><span class="id"> _</span><span class="id"> 1</span> (<span class="id">@acos</span><span class="id"> _</span>)<span class="id"> _</span>)<span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">eapply</span><span class="id"> is_derive1_acos;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> []</span>)<span class="id"> :</span><span class="id"> typeclass_instances</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">lock</span><span class="vernacular"> Definition</span><span class="id"> asin</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> realType}</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> R</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">get</span><span class="id"> [set</span><span class="id"> y</span><span class="id"> |</span><span class="id"> -</span>(<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span><span class="id"> /\</span><span class="id"> sin</span><span class="id"> y</span><span class="id"> =</span><span class="id"> x]</span>.<br/>
<span class="vernacular">Canonical</span><span class="id"> locked_asin</span><span class="id"> :=</span><span class="id"> Unlockable</span><span class="id"> asin</span>.<span class="id">unlock</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Asin</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> realType</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> asin_def</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">-1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> -</span>(<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id"> &lt;=</span><span class="id"> asin</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span><span class="id"> /\</span><span class="id"> sin</span> (<span class="id">asin</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xB;</span><span class="id"> rewrite</span><span class="id"> unlock</span><span class="id"> /asin;</span><span class="id"> case:</span><span class="id"> xgetP</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> He</span>.<br/>
<span class="id">pose</span><span class="id"> f</span><span class="id"> y</span><span class="id"> :=</span><span class="id"> sin</span><span class="id"> y</span><span class="id"> -</span><span class="id"> x</span>.<br/>
<span class="id">have</span><span class="id"> /IVT[]</span><span class="id"> //</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">minr</span> (<span class="id">f</span> (<span class="id">-</span>(<span class="id">pi/2</span>))) (<span class="id">f</span> (<span class="id">pi/2</span>))<span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> maxr</span> (<span class="id">f</span> (<span class="id">-</span>(<span class="id">pi/2</span>))) (<span class="id">f</span> (<span class="id">pi/2</span>)).<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> /f</span><span class="id"> sinN</span><span class="id"> sin_pihalf</span><span class="id"> /minr</span><span class="id"> /maxr</span><span class="id"> ltrD2r</span><span class="id"> -subr_gt0</span><span class="id"> opprK</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (_<span class="id"> :</span><span class="id"> 1</span><span class="id"> +</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> 2</span>)<span class="id">//</span><span class="id"> ltr0n/=</span><span class="id"> subr_le0</span><span class="id"> subr_ge0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -subr_ge0</span><span class="id"> opprK</span><span class="id"> -splitr</span><span class="id"> pi_ge0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> apply:</span><span class="id"> continuousB;</span><span class="id"> apply/continuous_in_subspaceT</span><span class="id"> =&gt;</span><span class="id"> ?</span><span class="id"> ?;</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">[exact:</span><span class="id"> continuous_sin|</span><span class="id"> exact:</span><span class="id"> cst_continuous]</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> /f</span><span class="id"> =&gt;</span><span class="id"> x1</span><span class="id"> /itvP</span><span class="id"> x1I</span><span class="id"> /eqP;</span><span class="id"> rewrite</span><span class="id"> subr_eq0</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> sinx1E</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">He</span><span class="id"> x1</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> !x1I</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> asin_geNpi2</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> -</span>(<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id"> &lt;=</span><span class="id"> asin</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /asin_def[/andP[]]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> asin_lepi2</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> asin</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /asin_def[/andP[]]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> asinK</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> `[</span>(<span class="id">-1</span>)<span class="id">,1],</span><span class="id"> cancel</span> (<span class="id">@asin</span><span class="id"> R</span>)<span class="id"> sin}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> in_itv/=</span><span class="id"> =&gt;</span><span class="id"> /asin_def[/andP[]]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> asin_ltpi2</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> asin</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> pi/2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /andP[x_geN1</span><span class="id"> x_lt1];</span><span class="id"> move:</span> (<span class="id">x_lt1</span>).<br/>
<span class="id">have</span><span class="id"> :</span><span class="id"> asin</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> asin_lepi2</span><span class="id"> //</span><span class="id"> x_geN1</span><span class="id"> ltW</span>.<br/>
<span class="id">have</span><span class="id"> :</span><span class="id"> sin</span> (<span class="id">asin</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> x</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> asinK//</span><span class="id"> in_itv/=</span><span class="id"> x_geN1</span><span class="id"> ltW</span>.<br/>
<span class="id">case:</span> (<span class="id">ltrgtP</span><span class="id"> _</span> ((<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>)))<span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> -&gt;</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> sin_pihalf</span><span class="id"> =&gt;</span><span class="id"> &lt;-;</span><span class="id"> rewrite</span><span class="id"> ltxx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> asin_gtNpi2</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> -</span> (<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id"> &lt;</span><span class="id"> asin</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /andP[x_gtN1</span><span class="id"> x_le1];</span><span class="id"> move:</span> (<span class="id">x_gtN1</span>).<br/>
<span class="id">have</span><span class="id"> :</span><span class="id"> -</span> (<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id"> &lt;=</span><span class="id"> asin</span><span class="id"> x</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> asin_geNpi2</span><span class="id"> //</span><span class="id"> x_le1</span><span class="id"> ltW</span>.<br/>
<span class="id">have</span><span class="id"> :</span><span class="id"> sin</span> (<span class="id">asin</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> x</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> asinK//</span><span class="id"> in_itv/=</span><span class="id"> x_le1</span><span class="id"> ltW</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">ltrgtP</span> (<span class="id">asin</span><span class="id"> x</span>))<span class="id"> =&gt;</span><span class="id"> //-&gt;;</span><span class="id"> rewrite</span><span class="id"> sinN</span><span class="id"> sin_pihalf</span><span class="id"> =&gt;</span><span class="id"> &lt;-;</span><span class="id"> rewrite</span><span class="id"> ltxx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> sinK</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> `[</span>(<span class="id">-</span> (<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>))<span class="id">,</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2],</span><span class="id"> cancel</span> (<span class="id">@sin</span><span class="id"> R</span>) (<span class="id">@asin</span><span class="id"> R</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> !in_itv/=</span><span class="id"> =&gt;</span><span class="id"> xB</span><span class="id"> ;</span><span class="id"> apply:</span><span class="id"> sin_inj</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> asinK//</span><span class="id"> in_itv/=</span><span class="id"> sin_geN1</span><span class="id"> sin_le1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> in_itv/=</span><span class="id"> asin_geNpi2/=</span><span class="id"> ?asin_lepi2</span><span class="id"> ?sin_geN1</span><span class="id"> ?sin_le1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos_asin</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> cos</span> (<span class="id">asin</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> Num</span>.<span class="id">sqrt</span> (<span class="id">1</span><span class="id"> -</span><span class="id"> x^+2</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xB;</span><span class="id"> rewrite</span><span class="id"> -[LHS]ger0_norm;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -sqrtr_sqr</span><span class="id"> cos2sin2</span><span class="id"> asinK</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> cos_ge0_pihalf;</span><span class="id"> rewrite</span><span class="id"> asin_lepi2</span><span class="id"> //</span><span class="id"> asin_geNpi2</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> continuous_asin</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> {for</span><span class="id"> x,</span><span class="id"> continuous</span> (<span class="id">@asin</span><span class="id"> R</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /andP[x_gtN1</span><span class="id"> x_lt1];</span><span class="id"> rewrite</span><span class="id"> -[x]asinK;</span><span class="id"> first</span><span class="id"> last</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !ltW</span><span class="id"> //;</span><span class="id"> case/andP:</span><span class="id"> xB</span>.<br/>
<span class="id">apply:</span><span class="id"> nbhs_singleton</span> (<span class="id">near_can_continuous</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> near=&gt;</span><span class="id"> z;</span><span class="id"> apply:</span><span class="id"> continuous_sin</span>.<br/>
<span class="id">have</span><span class="id"> /near_in_itvoo</span><span class="id"> aI</span><span class="id"> :</span><span class="id"> asin</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> `]</span>(<span class="id">-</span>(<span class="id">pi/2</span>))<span class="id">,</span> (<span class="id">pi/2</span>)<span class="id">[</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> in_itv/=</span><span class="id"> asin_gtNpi2</span><span class="id"> ?ltW</span><span class="id"> ?andbT</span><span class="id"> //=</span><span class="id"> asin_ltpi2</span><span class="id"> //</span><span class="id"> ltW</span>.<br/>
<span class="id">near=&gt;</span><span class="id"> z;</span><span class="id"> apply:</span><span class="id"> sinK</span>.<br/>
<span class="id">suff</span><span class="id"> /itvP</span><span class="id"> zI</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \in</span><span class="id"> `]</span>(<span class="id">-</span>(<span class="id">pi/2</span>))<span class="id">,</span> (<span class="id">pi/2</span>)<span class="id">[</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> :</span><span class="id"> -</span> (<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltW</span><span class="id"> ?zI</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> near:</span><span class="id"> z</span>.<br/>
<span class="id">Unshelve</span>.<span class="id"> all:</span><span class="gallina-kwd"> by</span><span class="id"> end_near</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_derive1_asin</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">-1</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> is_derive</span><span class="id"> x</span><span class="id"> 1</span> (<span class="id">@asin</span><span class="id"> R</span>) (<span class="id">Num</span>.<span class="id">sqrt</span> (<span class="id">1</span><span class="id"> -</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span>))<span class="id">^-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /andP[x_gtN1</span><span class="id"> x_lt1];</span><span class="id"> rewrite</span><span class="id"> -cos_asin</span><span class="id"> ?ltW</span><span class="id"> //</span>.<br/>
<span class="id">rewrite</span><span class="id"> -{1}[x]asinK;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> have</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltW</span><span class="id"> //</span><span class="id"> ltW</span>.<br/>
<span class="id">have</span><span class="id"> /near_in_itvoo</span><span class="id"> aI</span><span class="id"> :</span><span class="id"> asin</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> `]</span>(<span class="id">-</span>(<span class="id">pi/2</span>))<span class="id">,</span> (<span class="id">pi/2</span>)<span class="id">[</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> in_itv/=</span><span class="id"> asin_gtNpi2</span><span class="id"> ?ltW</span><span class="id"> ?andbT</span><span class="id"> //=</span><span class="id"> asin_ltpi2</span><span class="id"> //</span><span class="id"> ltW</span>.<br/>
<span class="id">apply:</span> (<span class="id">@is_derive_inverse</span><span class="id"> R</span><span class="id"> sin</span>).<br/>
<span class="id">-</span><span class="id"> near=&gt;</span><span class="id"> z;</span><span class="id"> apply:</span><span class="id"> sinK</span>.<br/>
&nbsp;&nbsp;<span class="id">suff</span><span class="id"> /itvP</span><span class="id"> zI</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \in</span><span class="id"> `]</span>(<span class="id">-</span>(<span class="id">pi/2</span>))<span class="id">,</span> (<span class="id">pi/2</span>)<span class="id">[</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> :</span><span class="id"> -</span> (<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id"> &lt;=</span><span class="id"> z</span><span class="id"> &lt;=</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltW</span><span class="id"> ?zI</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> near:</span><span class="id"> z</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> near=&gt;</span><span class="id"> z;</span><span class="id"> exact:</span><span class="id"> continuous_sin</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> cos_asin</span><span class="id"> ?ltW</span><span class="id"> //</span><span class="id"> sqrtr_eq0</span><span class="id"> //</span><span class="id"> -ltNge</span><span class="id"> subr_gt0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -real_normK</span><span class="id"> ?qualifE/=;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> ltrgt0P</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> exprn_cp1</span><span class="id"> //</span><span class="id"> ltr_norml</span><span class="id"> x_gtN1</span>.<br/>
<span class="id">Unshelve</span>.<span class="id"> all:</span><span class="gallina-kwd"> by</span><span class="id"> end_near</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Asin</span>.<br/>
<br/>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_derive</span><span class="id"> _</span><span class="id"> 1</span> (<span class="id">@asin</span><span class="id"> _</span>)<span class="id"> _</span>)<span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">eapply</span><span class="id"> is_derive1_asin;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> []</span>)<span class="id"> :</span><span class="id"> typeclass_instances</span>.<br/>
<br/>
<span class="id">HB</span>.<span class="id">lock</span><span class="vernacular"> Definition</span><span class="id"> atan</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> realType}</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> R</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">get</span><span class="id"> [set</span><span class="id"> y</span><span class="id"> |</span><span class="id"> -</span>(<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id"> &lt;</span><span class="id"> y</span><span class="id"> &lt;</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span><span class="id"> /\</span><span class="id"> tan</span><span class="id"> y</span><span class="id"> =</span><span class="id"> x]</span>.<br/>
<span class="vernacular">Canonical</span><span class="id"> locked_atan</span><span class="id"> :=</span><span class="id"> Unlockable</span><span class="id"> atan</span>.<span class="id">unlock</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Atan</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> realType</span>.<br/>
<span class="vernacular">Implicit</span><span class="gallina-kwd"> Type</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> atan_def</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -</span>(<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id"> &lt;</span><span class="id"> atan</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span><span class="id"> /\</span><span class="id"> tan</span> (<span class="id">atan</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> unlock</span><span class="id"> /atan;</span><span class="id"> case:</span><span class="id"> xgetP</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> He</span>.<br/>
<span class="id">pose</span><span class="id"> x1</span><span class="id"> :=</span><span class="id"> Num</span>.<span class="id">sqrt</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span>)<span class="id">^-1</span>.<br/>
<span class="id">have</span><span class="id"> ox2_gt0</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> 1</span><span class="id"> +</span><span class="id"> x^2</span><span class="gallina-kwd"> by</span><span class="id"> exact/ltr_pwDl/sqr_ge0</span>.<br/>
<span class="id">have</span><span class="id"> ox2_ge0</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> +</span><span class="id"> x^2</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltW</span>.<br/>
<span class="id">have</span><span class="id"> x1B</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> &lt;=</span><span class="id"> x1</span><span class="id"> &lt;=</span><span class="id"> 1</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -ler_norml</span><span class="id"> /x1</span><span class="id"> ger0_norm</span><span class="id"> ?sqrt_ge0//</span><span class="id"> -[leRHS]sqrtr1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ler_psqrt</span><span class="id"> ?qualifE/=</span><span class="id"> ?invr_gte0//</span><span class="id"> invf_le1//</span><span class="id"> lerDl</span><span class="id"> sqr_ge0</span>.<br/>
<span class="id">case:</span> (<span class="id">He</span> (<span class="id">Num</span>.<span class="id">sg</span><span class="id"> x</span><span class="id"> *</span><span class="id"> acos</span><span class="id"> x1</span>))<span class="id">;</span><span class="id"> split;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> [-&gt;|xD0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> x</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> sgr0</span><span class="id"> mul0r</span><span class="id"> tan0</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> /tan</span><span class="id"> sin_sg</span><span class="id"> cos_sg</span><span class="id"> //</span><span class="id"> acosK</span><span class="id"> ?sin_acos//</span><span class="id"> /x1</span><span class="id"> sqr_sqrtr//</span><span class="id"> ?invr_ge0//</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -[X</span><span class="gallina-kwd"> in</span><span class="id"> 1</span><span class="id"> -</span><span class="id"> X]div1r</span><span class="id"> -[X</span><span class="gallina-kwd"> in</span><span class="id"> X</span><span class="id"> -</span><span class="id"> _]divr1//</span><span class="id"> -mulNr</span><span class="id"> addf_div</span><span class="id"> ?lt0r_neq0//</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mul1r</span><span class="id"> mulr1</span><span class="id"> [X</span><span class="gallina-kwd"> in</span><span class="id"> X</span><span class="id"> -</span><span class="id"> 1]addrC</span><span class="id"> addrK//</span><span class="id"> sqrtrM</span><span class="id"> ?sqr_ge0//</span><span class="id"> sqrtrV//</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> invrK//</span><span class="id"> mulrA</span><span class="id"> divfK//;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> sqrtr_eq0</span><span class="id"> -ltNge</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> sqrtr_sqr</span><span class="id"> mulr_sg_norm</span>.<br/>
<span class="id">rewrite</span><span class="id"> -ltr_norml</span><span class="id"> normrM</span>.<br/>
<span class="id">have</span><span class="id"> pi2</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span><span class="id"> :&gt;</span><span class="id"> R</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> divr_gt0</span><span class="id"> //</span><span class="id"> pi_gt0</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|xD0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> x</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> sgr0</span><span class="id"> normr0</span><span class="id"> mul0r</span>.<br/>
<span class="id">rewrite</span><span class="id"> normr_sg</span><span class="id"> xD0</span><span class="id"> mul1r</span><span class="id"> ltr_norml</span>.<br/>
<span class="id">rewrite</span> (<span class="id">@lt_le_trans</span><span class="id"> _</span><span class="id"> _</span><span class="id"> 0</span>)<span class="id"> ?acos_ge0</span><span class="id"> ?oppr_cp0</span><span class="id"> //=</span>.<br/>
<span class="id">rewrite</span><span class="id"> -ltr_cos</span><span class="id"> ?in_itv/=</span><span class="id"> ?acos_ge0/=</span><span class="id"> ?acos_lepi//;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltW//=</span><span class="id"> ler_pdivrMr//</span><span class="id"> ler_pMr</span><span class="id"> ?pi_gt0//</span><span class="id"> ler1n</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> cos_pihalf</span><span class="id"> acosK//</span><span class="id"> sqrtr_gt0</span><span class="id"> ?invr_gt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> atan_gtNpi2</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -</span> (<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id"> &lt;</span><span class="id"> atan</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> have</span><span class="id"> [/andP[]]</span><span class="id"> :=</span><span class="id"> atan_def</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> atan_ltpi2</span><span class="id"> x</span><span class="id"> :</span><span class="id"> atan</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> have</span><span class="id"> [/andP[]]</span><span class="id"> :=</span><span class="id"> atan_def</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> atanK</span><span class="id"> :</span><span class="id"> cancel</span> (<span class="id">@atan</span><span class="id"> R</span>)<span class="id"> tan</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> case:</span> (<span class="id">atan_def</span><span class="id"> x</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> atan0</span><span class="id"> :</span><span class="id"> atan</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span><span class="id"> tan_inj;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> atanK</span><span class="id"> tan0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> in_itv/=</span><span class="id"> atan_gtNpi2</span><span class="id"> atan_ltpi2</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> in_itv/=</span><span class="id"> oppr_cp0</span><span class="id"> divr_gt0</span><span class="id"> ?pi_gt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> atan1</span><span class="id"> :</span><span class="id"> atan</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 4%:R</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span><span class="id"> tan_inj;</span><span class="id"> first</span><span class="id"> 2</span><span class="id"> last</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> atanK</span><span class="id"> tan_piquarter</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> in_itv/=</span><span class="id"> atan_gtNpi2</span><span class="id"> atan_ltpi2</span>.<br/>
<span class="id">rewrite</span><span class="id"> in_itv/=</span><span class="id"> -divrN</span><span class="id"> !ltr_pM2l</span><span class="id"> ?pi_gt0//</span> (<span class="id">lt_trans</span> (_<span class="id"> :</span><span class="id"> _</span><span class="id"> &lt;</span><span class="id"> 0</span>))<span class="id">//=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltf_pV2</span><span class="id"> ?qualifE//=</span><span class="id"> ltr_nat</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> atanN</span><span class="id"> x</span><span class="id"> :</span><span class="id"> atan</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> -</span><span class="id"> atan</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span><span class="id"> tan_inj;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> in_itv/=</span><span class="id"> atan_ltpi2</span><span class="id"> atan_gtNpi2</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> in_itv/=</span><span class="id"> ltrNl</span><span class="id"> opprK</span><span class="id"> ltrNl</span><span class="id"> andbC</span><span class="id"> atan_ltpi2</span><span class="id"> atan_gtNpi2</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> tanN</span><span class="id"> !atanK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> tanK</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> `]</span>(<span class="id">-</span> (<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>))<span class="id">,</span> (<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id">[</span><span class="id"> ,</span><span class="id"> cancel</span> (<span class="id">@tan</span><span class="id"> R</span>) (<span class="id">@atan</span><span class="id"> R</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> xB;</span><span class="id"> apply</span><span class="id"> tan_inj</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> ?atanK//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> in_itv/=</span><span class="id"> atan_gtNpi2</span><span class="id"> atan_ltpi2</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> continuous_atan</span><span class="id"> x</span><span class="id"> :</span><span class="id"> {for</span><span class="id"> x,</span><span class="id"> continuous</span> (<span class="id">@atan</span><span class="id"> R</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -[x]atanK</span>.<br/>
<span class="id">have</span><span class="id"> /near_in_itvoo</span><span class="id"> aI</span><span class="id"> :</span><span class="id"> atan</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> `]</span>(<span class="id">-</span>(<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>))<span class="id">,</span> (<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id">[</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> in_itv/=</span><span class="id"> atan_gtNpi2</span><span class="id"> atan_ltpi2</span>.<br/>
<span class="id">apply:</span><span class="id"> nbhs_singleton</span> (<span class="id">near_can_continuous</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> near=&gt;</span><span class="id"> z;</span><span class="id"> apply/continuous_tan/lt0r_neq0/cos_gt0_pihalf;</span><span class="id"> near:</span><span class="id"> z</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> near=&gt;</span><span class="id"> z;</span><span class="id"> apply:</span><span class="id"> tanK;</span><span class="id"> near:</span><span class="id"> z</span>.<br/>
<span class="id">Unshelve</span>.<span class="id"> all:</span><span class="gallina-kwd"> by</span><span class="id"> end_near</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cos_atan</span><span class="id"> x</span><span class="id"> :</span><span class="id"> cos</span> (<span class="id">atan</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">Num</span>.<span class="id">sqrt</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span>))<span class="id"> ^-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> cos_gt0</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> cos</span> (<span class="id">atan</span><span class="id"> x</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> cos_gt0_pihalf;</span><span class="id"> rewrite</span><span class="id"> atan_gtNpi2</span><span class="id"> atan_ltpi2</span>.<br/>
<span class="id">have</span><span class="id"> cosD0</span><span class="id"> :</span><span class="id"> cos</span> (<span class="id">atan</span><span class="id"> x</span>)<span class="id"> !=</span><span class="id"> 0</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> lt0r_neq0</span>.<br/>
<span class="id">have</span><span class="id"> /eqP</span><span class="id"> :</span><span class="id"> cos</span> (<span class="id">atan</span><span class="id"> x</span>)<span class="id"> ^+2</span><span class="id"> =</span> (<span class="id">Num</span>.<span class="id">sqrt</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span>))<span class="id">^-2</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -[LHS]invrK</span><span class="id"> cos2_tan2</span><span class="id"> //</span><span class="id"> atanK</span><span class="id"> sqr_sqrtr</span><span class="id"> //</span><span class="id"> addr_ge0</span><span class="id"> //</span><span class="id"> sqr_ge0</span>.<br/>
<span class="id">rewrite</span><span class="id"> -exprVn</span><span class="id"> eqf_sqr</span><span class="id"> =&gt;</span><span class="id"> /orP[]</span><span class="id"> /eqP</span><span class="id"> //</span><span class="id"> cosE</span>.<br/>
<span class="id">move:</span><span class="id"> cos_gt0;</span><span class="id"> rewrite</span><span class="id"> cosE</span><span class="id"> ltNge;</span><span class="id"> case/negP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> oppr_le0</span><span class="id"> invr_ge0</span><span class="id"> sqrtr_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">Global</span><span class="vernacular"> Instance</span><span class="id"> is_derive1_atan</span><span class="id"> x</span><span class="id"> :</span><span class="id"> is_derive</span><span class="id"> x</span><span class="id"> 1</span><span class="id"> atan</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span>)<span class="id">^-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -{1}[x]atanK</span>.<br/>
<span class="id">have</span><span class="id"> cosD0</span><span class="id"> :</span><span class="id"> cos</span> (<span class="id">atan</span><span class="id"> x</span>)<span class="id"> !=</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/lt0r_neq0/cos_gt0_pihalf;</span><span class="id"> rewrite</span><span class="id"> atan_gtNpi2</span><span class="id"> atan_ltpi2</span>.<br/>
<span class="id">have</span><span class="id"> /near_in_itvoo</span><span class="id"> aI</span><span class="id"> :</span><span class="id"> atan</span><span class="id"> x</span><span class="id"> \in</span><span class="id"> `]</span>(<span class="id">-</span>(<span class="id">pi/2</span>))<span class="id">,</span> (<span class="id">pi/2</span>)<span class="id">[</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> in_itv/=</span><span class="id"> atan_gtNpi2</span><span class="id"> atan_ltpi2</span>.<br/>
<span class="id">apply:</span> (<span class="id">@is_derive_inverse</span><span class="id"> R</span><span class="id"> tan</span>).<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> near=&gt;</span><span class="id"> z;</span><span class="id"> apply:</span><span class="id"> tanK;</span><span class="id"> near:</span><span class="id"> z</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> near=&gt;</span><span class="id"> z;</span><span class="id"> apply/continuous_tan/lt0r_neq0/cos_gt0_pihalf;</span><span class="id"> near:</span><span class="id"> z</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[X</span><span class="gallina-kwd"> in</span><span class="id"> 1</span><span class="id"> +</span><span class="id"> X</span><span class="id"> ^+</span><span class="id"> 2]atanK</span><span class="id"> -cos2_tan2</span><span class="id"> //;</span><span class="id"> exact:</span><span class="id"> is_derive_tan</span>.<br/>
<span class="id">exact/lt0r_neq0/ltr_pwDl/sqr_ge0</span>.<br/>
<span class="id">Unshelve</span>.<span class="id"> all:</span><span class="gallina-kwd"> by</span><span class="id"> end_near</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> derive1_atan</span><span class="id"> :</span><span class="id"> atan^`</span>()<span class="id"> =1</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> 2</span>)<span class="id">^-1</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> derive1E</span><span class="id"> derive_val</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lt_atan</span><span class="id"> :</span><span class="id"> {homo</span> (<span class="id">@atan</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> xy;</span><span class="id"> rewrite</span><span class="id"> -subr_gt0</span>.<br/>
<span class="id">have</span><span class="id"> datan</span><span class="id"> z</span><span class="id"> :</span><span class="id"> z</span><span class="id"> \in</span><span class="id"> `]x,</span><span class="id"> y[</span><span class="id"> -&gt;</span><span class="id"> is_derive</span><span class="id"> z</span><span class="id"> 1</span><span class="id"> atan</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> z</span><span class="id"> ^+</span><span class="id"> 2</span>)<span class="id">^-1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> _;</span><span class="id"> exact:</span><span class="id"> is_derive1_atan</span>.<br/>
<span class="id">have</span><span class="id"> catan</span><span class="id"> :</span><span class="id"> {within</span><span class="id"> `[x,</span><span class="id"> y],</span><span class="id"> continuous</span><span class="id"> atan}</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> derivable_within_continuous</span><span class="id"> =&gt;</span><span class="id"> z</span><span class="id"> _;</span><span class="id"> exact:</span><span class="id"> ex_derive</span>.<br/>
<span class="id">have</span><span class="id"> [c</span><span class="id"> _</span><span class="id"> -&gt;]</span><span class="id"> :=</span><span class="id"> MVT</span><span class="id"> xy</span><span class="id"> datan</span><span class="id"> catan</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulr_gt0//</span><span class="id"> ?subr_gt0//</span><span class="id"> invr_gt0//</span><span class="id"> ltr_wpDr//</span><span class="id"> sqr_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> le_atan</span><span class="id"> :</span><span class="id"> {homo</span><span class="id"> @atan</span><span class="id"> R</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[-&gt;</span><span class="id"> //|xy];</span><span class="id"> exact/ltW/lt_atan</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cvgy_atan</span><span class="id"> :</span> (<span class="id">@atan</span><span class="id"> R</span>)<span class="id"> x</span><span class="id"> @[x</span><span class="id"> --&gt;</span><span class="id"> +oo]</span><span class="id"> --&gt;</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> ?</span><span class="id"> :</span><span class="id"> ubound</span> (<span class="id">range</span> (<span class="id">@atan</span><span class="id"> R</span>)) (<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> _</span><span class="id"> /=</span><span class="id"> [x</span><span class="id"> _</span><span class="id"> &lt;-];</span><span class="id"> exact/ltW/atan_ltpi2</span>.<br/>
<span class="id">rewrite</span> (_<span class="id"> :</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> sup</span> (<span class="id">range</span><span class="id"> atan</span>)).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/</span>(<span class="id">nondecreasing_cvgr</span><span class="id"> le_atan</span>)<span class="id">;</span><span class="gallina-kwd"> exists</span> (<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>).<br/>
<span class="id">apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eq_le;</span><span class="id"> apply/andP;</span><span class="id"> split;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> sup_le_ub</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="gallina-kwd"> exists</span><span class="id"> 0,</span><span class="id"> 0</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> exact:</span><span class="id"> atan0</span>.<br/>
<span class="id">have</span><span class="id"> -&gt;</span><span class="id"> :</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2</span><span class="id"> =</span><span class="id"> sup</span><span class="id"> `[0,</span><span class="id"> pi</span><span class="id"> /</span><span class="id"> 2[</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> real_interval</span>.<span class="id">sup_itv//</span><span class="id"> bnd_simp</span><span class="id"> divr_gt0//</span><span class="id"> pi_gt0</span>.<br/>
<span class="id">apply:</span><span class="id"> le_sup;</span><span class="id"> last</span><span class="id"> 2</span><span class="id"> first</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="gallina-kwd"> exists</span><span class="id"> 0;</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> in_itv/=</span><span class="id"> lexx/=</span><span class="id"> divr_gt0//</span><span class="id"> pi_gt0</span>.<br/>
<span class="id">-</span><span class="id"> split;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="gallina-kwd"> exists</span><span class="id"> 0,</span><span class="id"> 0</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> atan0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span> (<span class="id">pi</span><span class="id"> /</span><span class="id"> 2</span>)<span class="id"> =&gt;</span><span class="id"> _</span><span class="id"> [x</span><span class="id"> _</span><span class="id"> &lt;-];</span><span class="id"> exact/ltW/atan_ltpi2</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> x/=</span><span class="id"> /[!in_itv]/=</span><span class="id"> /andP[x0</span><span class="id"> xpi2]</span>.<br/>
<span class="id">apply/downP;</span><span class="gallina-kwd"> exists</span> (<span class="id">atan</span> (<span class="id">tan</span><span class="id"> x</span>))<span class="id"> =&gt;</span><span class="id"> /=;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="gallina-kwd"> exists</span> (<span class="id">tan</span><span class="id"> x</span>).<br/>
<span class="id">rewrite</span><span class="id"> tanK//</span><span class="id"> in_itv/=</span><span class="id"> xpi2</span><span class="id"> andbT</span> (<span class="id">lt_le_trans</span><span class="id"> _</span><span class="id"> x0</span>)<span class="id">//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltrNl</span><span class="id"> oppr0</span><span class="id"> divr_gt0//</span><span class="id"> pi_gt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Atan</span>.<br/>

      <div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/">a fork of coq2html</a></div>
    </div>
  </div>
    </main>
</body>
</html>
