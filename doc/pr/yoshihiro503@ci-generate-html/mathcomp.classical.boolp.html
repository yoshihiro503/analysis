
<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module mathcomp.classical.boolp</title>
<meta name="description" content="Documentation of Coq module mathcomp.classical.boolp" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init()">

  <main>
    <div class="sidebar">
      <h2>Files</h2>
      
    </div>

  <div class="coq">

    <div class="content">
      <p><a href="./index.html">Top</a></p>
      <h1 class="title">Module mathcomp.classical.boolp</h1>
<span class="vernacular">From</span><span class="id"> HB</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> structures</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> all_ssreflect</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> mathcomp_extra</span>.<br/>
<br/>
<div class="ssrdoc md">
# Classical Logic

This file provides the axioms of classical logic and tools to perform
classical reasoning in the Mathematical Compnent framework. The three
axioms are taken from the standard library of Coq, more details can be
found in Section 5 of
- R. Affeldt, C. Cohen, D. Rouhling. Formalization Techniques for
  Asymptotic Reasoning in Classical Analysis. JFR 2018

## Axioms
```
functional_extensionality_dep == functional extensionality (on dependently
                    typed functions), i.e., functions that are pointwise
                    equal are equal
propositional_extensionality == propositional extensionality, i.e., iff
                    and equality are the same on Prop
constructive_indefinite_description == existential in Prop (ex) implies
                    existential in Type (sig)
             cid := constructive_indefinite_description (shortcut)
```

A number of properties are derived below from these axioms and are
often more pratical to use than directly using the axioms. For instance
propext, funext, the excluded middle (EM),...

## Boolean View of Prop
```
        `[&lt; P &gt;] == boolean view of P : Prop, see all lemmas about asbool
```

## Mathematical Components Structures
```
 {classic T} == Endow T : Type with a canonical eqType/choiceType.
                This is intended for local use.
                E.g., T : Type |- A : {fset {classic T}}
                Alternatively one may use elim/Pchoice: T =&gt; T in H *.
                to substitute T with T : choiceType once and for all.
{eclassic T} == Endow T : eqType with a canonical choiceType.
                On the model of {classic _}.
                See also the lemmas Peq and eqPchoice.
```

Functions onto a porderType (resp. latticeType) are equipped with
a porderType (resp. latticeType), so that the generic notation (_ &lt;= _)%O
(resp. `&amp;`, `|`) from `order.v` can be used.
```
    FunOrder.lef f g == pointwise large inequality between two functions
    FunOrder.ltf f g == pointwise strict inequality between two functions
FunLattice.meetf f g == pointwise meet between two functions
FunLattice.joinf f g == pointwise join between two functions
```

</div>
<br/>
<span class="gallina-kwd">Set</span>  <span class="vernacular"> Implicit</span><span class="vernacular"> Arguments</span>.<br/>
<span class="vernacular">Unset</span><span class="vernacular"> Strict</span><span class="vernacular"> Implicit</span>.<br/>
<span class="vernacular">Unset</span><span class="vernacular"> Printing</span><span class="vernacular"> Implicit</span><span class="vernacular"> Defensive</span>.<br/>
<br/>
<span class="vernacular">Declare</span><span class="vernacular"> Scope</span><span class="id"> box_scope</span>.<br/>
<span class="vernacular">Declare</span><span class="vernacular"> Scope</span><span class="id"> quant_scope</span>.<br/>
<br/>
<span class="vernacular">Axiom</span><span class="id"> functional_extensionality_dep</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">forall</span> (<span class="id">A</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">B</span><span class="id"> :</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span>) (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> :</span><span class="id"> A,</span><span class="id"> B</span><span class="id"> x</span>)<span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> :</span><span class="id"> A,</span><span class="id"> f</span><span class="id"> x</span><span class="id"> =</span><span class="id"> g</span><span class="id"> x</span>)<span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> =</span><span class="id"> g</span>.<br/>
<span class="vernacular">Axiom</span><span class="id"> propositional_extensionality</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">forall</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> Prop,</span><span class="id"> P</span><span class="id"> &lt;-&gt;</span><span class="id"> Q</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> =</span><span class="id"> Q</span>.<br/>
<br/>
<span class="vernacular">Axiom</span><span class="id"> constructive_indefinite_description</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">forall</span> (<span class="id">A</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id">,</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">exists</span><span class="id"> x</span><span class="id"> :</span><span class="id"> A,</span><span class="id"> P</span><span class="id"> x</span>)<span class="id"> -&gt;</span><span class="id"> {x</span><span class="id"> :</span><span class="id"> A</span><span class="id"> |</span><span class="id"> P</span><span class="id"> x}</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> cid</span><span class="id"> :=</span><span class="id"> constructive_indefinite_description</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cid2</span> (<span class="id">A</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> A</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">exists2</span><span class="id"> x</span><span class="id"> :</span><span class="id"> A,</span><span class="id"> P</span><span class="id"> x</span><span class="id"> &amp;</span><span class="id"> Q</span><span class="id"> x</span>)<span class="id"> -&gt;</span><span class="id"> {x</span><span class="id"> :</span><span class="id"> A</span><span class="id"> |</span><span class="id"> P</span><span class="id"> x</span><span class="id"> &amp;</span><span class="id"> Q</span><span class="id"> x}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> PQA;</span><span class="id"> suff:</span><span class="id"> {x</span><span class="id"> |</span><span class="id"> P</span><span class="id"> x</span><span class="id"> /\</span><span class="id"> Q</span><span class="id"> x}</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> [a</span><span class="id"> [*]];</span><span class="gallina-kwd"> exists</span><span class="id"> a</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> cid;</span><span class="id"> case:</span><span class="id"> PQA</span><span class="id"> =&gt;</span><span class="id"> x;</span><span class="gallina-kwd"> exists</span><span class="id"> x</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> existT_inj1</span> (<span class="id">T</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span>) (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> T</span>) (<span class="id">Px</span><span class="id"> :</span><span class="id"> P</span><span class="id"> x</span>) (<span class="id">Py</span><span class="id"> :</span><span class="id"> P</span><span class="id"> y</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">existT</span><span class="id"> P</span><span class="id"> x</span><span class="id"> Px</span><span class="id"> =</span><span class="id"> existT</span><span class="id"> P</span><span class="id"> y</span><span class="id"> Py</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> existT_inj2</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> eqType</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span>) (<span class="id">x</span><span class="id"> :</span><span class="id"> T</span>) (<span class="id">Px1</span><span class="id"> Px2</span><span class="id"> :</span><span class="id"> P</span><span class="id"> x</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">existT</span><span class="id"> P</span><span class="id"> x</span><span class="id"> Px1</span><span class="id"> =</span><span class="id"> existT</span><span class="id"> P</span><span class="id"> x</span><span class="id"> Px2</span><span class="id"> -&gt;</span><span class="id"> Px1</span><span class="id"> =</span><span class="id"> Px2</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span><span class="id"> Eqdep_dec</span>.<span class="id">inj_pair2_eq_dec</span><span class="id"> =&gt;</span><span class="id"> y</span><span class="id"> z</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> [|/eqP]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> y</span><span class="id"> z;</span><span class="id"> [left|right]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> surjective_existT</span> (<span class="id">T</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span>) (<span class="id">p</span><span class="id"> :</span><span class="id"> {x</span><span class="id"> :</span><span class="id"> T</span><span class="id"> &amp;</span><span class="id"> P</span><span class="id"> x}</span>)<span class="id">:</span><br/>
&nbsp;&nbsp;<span class="id">existT</span><span class="id"> [eta</span><span class="id"> P]</span> (<span class="id">projT1</span><span class="id"> p</span>) (<span class="id">projT2</span><span class="id"> p</span>)<span class="id"> =</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> p</span>. Qed.</div></details>
<br/>
<span class="vernacular">Record</span><span class="id"> mextensionality</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;_<span class="id"> :</span><span class="gallina-kwd"> forall</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id">,</span> (<span class="id">P</span><span class="id"> &lt;-&gt;</span><span class="id"> Q</span>)<span class="id"> -&gt;</span> (<span class="id">P</span><span class="id"> =</span><span class="id"> Q</span>)<span class="id">;</span><br/>
&nbsp;&nbsp;_<span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> {T</span><span class="id"> U</span><span class="id"> :</span><span class="id"> Type}</span> (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> U</span>)<span class="id">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> f</span><span class="id"> x</span><span class="id"> =</span><span class="id"> g</span><span class="id"> x</span>)<span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> =</span><span class="id"> g;</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> extensionality</span><span class="id"> :</span><span class="id"> mextensionality</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split</span>.<br/>
<span class="id">-</span><span class="id"> exact:</span><span class="id"> propositional_extensionality</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> T</span><span class="id"> U</span><span class="id"> f</span><span class="id"> g;</span><span class="id"> apply:</span><span class="id"> functional_extensionality_dep</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> propext</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="id">P</span><span class="id"> &lt;-&gt;</span><span class="id"> Q</span>)<span class="id"> -&gt;</span> (<span class="id">P</span><span class="id"> =</span><span class="id"> Q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> have</span><span class="id"> [propext</span><span class="id"> _]</span><span class="id"> :=</span><span class="id"> extensionality;</span><span class="id"> apply:</span><span class="id"> propext</span>. Qed.</div></details>
<br/>
<span class="vernacular">Ltac</span><span class="id"> eqProp</span><span class="id"> :=</span><span class="id"> apply:</span><span class="id"> propext;</span><span class="id"> split</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> funext</span><span class="id"> {T</span><span class="id"> U</span><span class="id"> :</span><span class="id"> Type}</span> (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> U</span>)<span class="id"> :</span> (<span class="id">f</span><span class="id"> =1</span><span class="id"> g</span>)<span class="id"> -&gt;</span><span class="id"> f</span><span class="id"> =</span><span class="id"> g</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> extensionality=&gt;</span><span class="id"> _;</span><span class="id"> apply</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> propeqE</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="id">P</span><span class="id"> =</span><span class="id"> Q</span>)<span class="id"> =</span> (<span class="id">P</span><span class="id"> &lt;-&gt;</span><span class="id"> Q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> propext;</span><span class="id"> split=&gt;</span><span class="id"> [-&gt;|/propext]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> propeqP</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="id">P</span><span class="id"> =</span><span class="id"> Q</span>)<span class="id"> &lt;-&gt;</span> (<span class="id">P</span><span class="id"> &lt;-&gt;</span><span class="id"> Q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> propeqE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> funeqE</span><span class="id"> {T</span><span class="id"> U</span><span class="id"> :</span><span class="id"> Type}</span> (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> U</span>)<span class="id"> :</span> (<span class="id">f</span><span class="id"> =</span><span class="id"> g</span>)<span class="id"> =</span> (<span class="id">f</span><span class="id"> =1</span><span class="id"> g</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> propeqE;</span><span class="id"> split=&gt;</span><span class="id"> [-&gt;//|/funext]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> funeq2E</span><span class="id"> {T</span><span class="id"> U</span><span class="id"> V</span><span class="id"> :</span><span class="id"> Type}</span> (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> :</span> (<span class="id">f</span><span class="id"> =</span><span class="id"> g</span>)<span class="id"> =</span> (<span class="id">f</span><span class="id"> =2</span><span class="id"> g</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> propeqE;</span><span class="id"> split=&gt;</span><span class="id"> [-&gt;//|?];</span><span class="id"> rewrite</span><span class="id"> funeqE=&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> funeqE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> funeq3E</span><span class="id"> {T</span><span class="id"> U</span><span class="id"> V</span><span class="id"> W</span><span class="id"> :</span><span class="id"> Type}</span> (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> W</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">f</span><span class="id"> =</span><span class="id"> g</span>)<span class="id"> =</span> (<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z,</span><span class="id"> f</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =</span><span class="id"> g</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> propeqE;</span><span class="id"> split=&gt;</span><span class="id"> [-&gt;//|?];</span><span class="id"> rewrite</span><span class="id"> funeq2E=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> funeqE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> funeqP</span><span class="id"> {T</span><span class="id"> U</span><span class="id"> :</span><span class="id"> Type}</span> (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> U</span>)<span class="id"> :</span> (<span class="id">f</span><span class="id"> =</span><span class="id"> g</span>)<span class="id"> &lt;-&gt;</span> (<span class="id">f</span><span class="id"> =1</span><span class="id"> g</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> funeqE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> funeq2P</span><span class="id"> {T</span><span class="id"> U</span><span class="id"> V</span><span class="id"> :</span><span class="id"> Type}</span> (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span>)<span class="id"> :</span> (<span class="id">f</span><span class="id"> =</span><span class="id"> g</span>)<span class="id"> &lt;-&gt;</span> (<span class="id">f</span><span class="id"> =2</span><span class="id"> g</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> funeq2E</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> funeq3P</span><span class="id"> {T</span><span class="id"> U</span><span class="id"> V</span><span class="id"> W</span><span class="id"> :</span><span class="id"> Type}</span> (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="id"> W</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">f</span><span class="id"> =</span><span class="id"> g</span>)<span class="id"> &lt;-&gt;</span> (<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z,</span><span class="id"> f</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =</span><span class="id"> g</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> funeq3E</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> predeqE</span><span class="id"> {T}</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="id">P</span><span class="id"> =</span><span class="id"> Q</span>)<span class="id"> =</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> P</span><span class="id"> x</span><span class="id"> &lt;-&gt;</span><span class="id"> Q</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> propeqE;</span><span class="id"> split=&gt;</span><span class="id"> [-&gt;//|?];</span><span class="id"> rewrite</span><span class="id"> funeqE=&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> propeqE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> predeq2E</span><span class="id"> {T</span><span class="id"> U}</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id">P</span><span class="id"> =</span><span class="id"> Q</span>)<span class="id"> =</span> (<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> P</span><span class="id"> x</span><span class="id"> y</span><span class="id"> &lt;-&gt;</span><span class="id"> Q</span><span class="id"> x</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> propeqE;</span><span class="id"> split=&gt;</span><span class="id"> [-&gt;//|?];</span><span class="id"> rewrite</span><span class="id"> funeq2E=&gt;</span><span class="id"> ??;</span><span class="id"> rewrite</span><span class="id"> propeqE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> predeq3E</span><span class="id"> {T</span><span class="id"> U</span><span class="id"> V}</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id">P</span><span class="id"> =</span><span class="id"> Q</span>)<span class="id"> =</span> (<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z,</span><span class="id"> P</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> &lt;-&gt;</span><span class="id"> Q</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> propeqE;</span><span class="id"> split=&gt;</span><span class="id"> [-&gt;//|?];</span><span class="id"> rewrite</span><span class="id"> funeq3E=&gt;</span><span class="id"> ???;</span><span class="id"> rewrite</span><span class="id"> propeqE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> predeqP</span><span class="id"> {T}</span> (<span class="id">A</span><span class="id"> B</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="id">A</span><span class="id"> =</span><span class="id"> B</span>)<span class="id"> &lt;-&gt;</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> A</span><span class="id"> x</span><span class="id"> &lt;-&gt;</span><span class="id"> B</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> predeqE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> predeq2P</span><span class="id"> {T</span><span class="id"> U}</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id">P</span><span class="id"> =</span><span class="id"> Q</span>)<span class="id"> &lt;-&gt;</span> (<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> P</span><span class="id"> x</span><span class="id"> y</span><span class="id"> &lt;-&gt;</span><span class="id"> Q</span><span class="id"> x</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> predeq2E</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> predeq3P</span><span class="id"> {T</span><span class="id"> U</span><span class="id"> V}</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> V</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="id">P</span><span class="id"> =</span><span class="id"> Q</span>)<span class="id"> &lt;-&gt;</span> (<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z,</span><span class="id"> P</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> &lt;-&gt;</span><span class="id"> Q</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> predeq3E</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> propT</span><span class="id"> {P</span><span class="id"> :</span><span class="id"> Prop}</span><span class="id"> :</span><span class="id"> P</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> =</span><span class="id"> True</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> p;</span><span class="id"> rewrite</span><span class="id"> propeqE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Prop_irrelevance</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>) (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> P</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> =</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span> (<span class="id">x</span>)<span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> /propT-&gt;</span><span class="id"> []</span><span class="id"> []</span>. Qed.</div></details>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Resolve</span><span class="id"> Prop_irrelevance</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Record</span><span class="id"> mclassic</span><span class="id"> :=</span><span class="id"> {</span><br/>
&nbsp;&nbsp;_<span class="id"> :</span><span class="gallina-kwd"> forall</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id">,</span><span class="id"> {P}</span><span class="id"> +</span><span class="id"> {~P};</span><br/>
&nbsp;&nbsp;_<span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> T,</span><span class="id"> hasChoice</span><span class="id"> T</span><br/>
<span class="id">}</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> choice</span><span class="id"> X</span><span class="id"> Y</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> X</span><span class="id"> -&gt;</span><span class="id"> Y</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="gallina-kwd"> exists</span><span class="id"> y,</span><span class="id"> P</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> -&gt;</span><span class="id"> {f</span><span class="id"> &amp;</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> P</span><span class="id"> x</span> (<span class="id">f</span><span class="id"> x</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /</span>(_<span class="id"> _</span>)<span class="id">/constructive_indefinite_description</span><span class="id"> -/all_tag</span>. Qed.</div></details>
<br/>
<span class="vernacular">Theorem</span><span class="id"> EM</span><span class="id"> P</span><span class="id"> :</span><span class="id"> P</span><span class="id"> \/</span><span class="id"> ~</span><span class="id"> P</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">pose</span><span class="id"> U</span><span class="id"> val</span><span class="id"> :=</span><span class="gallina-kwd"> fun</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> bool</span><span class="id"> =&gt;</span><span class="id"> Q</span><span class="id"> =</span><span class="id"> val</span><span class="id"> \/</span><span class="id"> P</span>.<br/>
<span class="id">have</span><span class="id"> Uex</span><span class="id"> val</span><span class="id"> :</span><span class="gallina-kwd"> exists</span><span class="id"> b,</span><span class="id"> U</span><span class="id"> val</span><span class="id"> b</span><span class="gallina-kwd"> by</span><span class="gallina-kwd"> exists</span><span class="id"> val;</span><span class="id"> left</span>.<br/>
<span class="id">pose</span><span class="id"> f</span><span class="id"> val</span><span class="id"> :=</span><span class="id"> projT1</span> (<span class="id">cid</span> (<span class="id">Uex</span><span class="id"> val</span>)).<br/>
<span class="id">pose</span><span class="id"> Uf</span><span class="id"> val</span><span class="id"> :</span><span class="id"> U</span><span class="id"> val</span> (<span class="id">f</span><span class="id"> val</span>)<span class="id"> :=</span><span class="id"> projT2</span> (<span class="id">cid</span> (<span class="id">Uex</span><span class="id"> val</span>)).<br/>
<span class="id">have</span><span class="id"> :</span><span class="id"> f</span><span class="id"> true</span><span class="id"> !=</span><span class="id"> f</span><span class="id"> false</span><span class="id"> \/</span><span class="id"> P</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> []</span><span class="id"> :=</span> (<span class="id">Uf</span><span class="id"> true,</span><span class="id"> Uf</span><span class="id"> false</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> /U</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> [-&gt;|?]</span><span class="id"> [-&gt;|?]</span><span class="id"> ;</span><span class="id"> do</span><span class="id"> ?[by</span><span class="id"> right];</span><span class="id"> left</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> [/eqP</span><span class="id"> fTFN|];</span><span class="id"> [right=&gt;</span><span class="id"> p|by</span><span class="id"> left];</span><span class="id"> apply:</span><span class="id"> fTFN</span>.<br/>
<span class="id">have</span><span class="id"> UTF</span><span class="id"> :</span><span class="id"> U</span><span class="id"> true</span><span class="id"> =</span><span class="id"> U</span><span class="id"> false</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> predeqE</span><span class="id"> /U</span><span class="id"> =&gt;</span><span class="id"> b;</span><span class="id"> split=&gt;</span><span class="id"> _;</span><span class="id"> right</span>.<br/>
<span class="id">rewrite</span><span class="id"> /f;</span><span class="id"> move:</span> (<span class="id">Uex</span><span class="id"> true</span>) (<span class="id">Uex</span><span class="id"> false</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> UTF</span><span class="id"> =&gt;</span><span class="id"> p1</span><span class="id"> p2</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> congr</span> (<span class="id">projT1</span> (<span class="id">cid</span><span class="id"> _</span>)).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pselect</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id">:</span><span class="id"> {P}</span><span class="id"> +</span><span class="id"> {~P}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> :</span><span class="gallina-kwd"> exists</span><span class="id"> b,</span><span class="gallina-kwd"> if</span><span class="id"> b</span><span class="gallina-kwd"> then</span><span class="id"> P</span><span class="gallina-kwd"> else</span><span class="id"> ~</span><span class="id"> P</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">EM</span><span class="id"> P</span>)<span class="id">;</span><span class="id"> [exists</span><span class="id"> true|exists</span><span class="id"> false]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> /cid</span><span class="id"> [[]];</span><span class="id"> [left|right]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pselectT</span><span class="id"> T</span><span class="id"> :</span> (<span class="id">T</span><span class="id"> -&gt;</span><span class="id"> False</span>)<span class="id"> +</span><span class="id"> T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [/cid[]//|NT]</span><span class="id"> :=</span><span class="id"> pselect</span> (<span class="gallina-kwd">exists</span><span class="id"> t</span><span class="id"> :</span><span class="id"> T,</span><span class="id"> True</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> right</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> left=&gt;</span><span class="id"> t;</span><span class="id"> case:</span><span class="id"> NT;</span><span class="gallina-kwd"> exists</span><span class="id"> t</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> classic</span><span class="id"> :</span><span class="id"> mclassic</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split=&gt;</span><span class="id"> [|T];</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> pselect</span>.<br/>
<span class="gallina-kwd">exists</span> (<span class="gallina-kwd">fun</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> T</span>) (<span class="id">n</span><span class="id"> :</span><span class="id"> nat</span>)<span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">if</span><span class="id"> pselect</span> (<span class="gallina-kwd">exists</span><span class="id"> x,</span><span class="id"> P</span><span class="id"> x</span>)<span class="id"> isn't</span><span class="id"> left</span><span class="id"> ex</span><span class="gallina-kwd"> then</span><span class="id"> None</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">else</span><span class="id"> Some</span> (<span class="id">projT1</span> (<span class="id">cid</span><span class="id"> ex</span>)))<br/>
&nbsp;&nbsp;<span class="id">=&gt;</span><span class="id"> [P</span><span class="id"> n</span><span class="id"> x|P</span><span class="id"> [x</span><span class="id"> Px]|P</span><span class="id"> Q</span><span class="id"> /funext</span><span class="id"> -&gt;</span><span class="id"> //]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> pselect</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> ex</span><span class="id"> [&lt;-</span><span class="id"> ];</span><span class="id"> case:</span><span class="id"> cid</span>.<br/>
<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> 0;</span><span class="id"> case:</span><span class="id"> pselect</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> -[];</span><span class="gallina-kwd"> exists</span><span class="id"> x</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gen_choiceMixin</span> (<span class="id">T</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>)<span class="id"> :</span><span class="id"> hasChoice</span><span class="id"> T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> classic</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lem</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id">:</span><span class="id"> P</span><span class="id"> \/</span><span class="id"> ~P</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span> (<span class="id">pselect</span><span class="id"> P</span>)<span class="id">;</span><span class="id"> tauto</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> trueE</span><span class="id"> :</span><span class="id"> true</span><span class="id"> =</span><span class="id"> True</span><span class="id"> :&gt;</span><span class="gallina-kwd"> Prop</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> propeqE;</span><span class="id"> split</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> falseE</span><span class="id"> :</span><span class="id"> false</span><span class="id"> =</span><span class="id"> False</span><span class="id"> :&gt;</span><span class="gallina-kwd"> Prop</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> propeqE;</span><span class="id"> split</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> propF</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><span class="id"> ~</span><span class="id"> P</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> =</span><span class="id"> False</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> p;</span><span class="id"> rewrite</span><span class="id"> propeqE;</span><span class="id"> tauto</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_fun</span><span class="id"> T</span><span class="id"> rT</span> (<span class="id">U</span><span class="id"> V</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> rT</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> :</span><span class="id"> T,</span><span class="id"> U</span><span class="id"> x</span><span class="id"> =</span><span class="id"> V</span><span class="id"> x</span>)<span class="id"> -&gt;</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> U</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> V</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /funext-&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_fun2</span><span class="id"> T1</span><span class="id"> T2</span><span class="id"> rT</span> (<span class="id">U</span><span class="id"> V</span><span class="id"> :</span><span class="id"> T1</span><span class="id"> -&gt;</span><span class="id"> T2</span><span class="id"> -&gt;</span><span class="id"> rT</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> U</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =</span><span class="id"> V</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> -&gt;</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> U</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> V</span><span class="id"> x</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> UV;</span><span class="id"> rewrite</span><span class="id"> funeq2E</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> UV</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_fun3</span> <span class="id"> T1</span><span class="id"> T2</span><span class="id"> T3</span><span class="id"> rT</span> (<span class="id">U</span><span class="id"> V</span><span class="id"> :</span><span class="id"> T1</span><span class="id"> -&gt;</span><span class="id"> T2</span><span class="id"> -&gt;</span><span class="id"> T3</span><span class="id"> -&gt;</span><span class="id"> rT</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z,</span><span class="id"> U</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =</span><span class="id"> V</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =&gt;</span><span class="id"> U</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =&gt;</span><span class="id"> V</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> UV;</span><span class="id"> rewrite</span><span class="id"> funeq3E</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z;</span><span class="id"> rewrite</span><span class="id"> UV</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_forall</span><span class="id"> T</span> (<span class="id">U</span><span class="id"> V</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> :</span><span class="id"> T,</span><span class="id"> U</span><span class="id"> x</span><span class="id"> =</span><span class="id"> V</span><span class="id"> x</span>)<span class="id"> -&gt;</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> U</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> V</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> e;</span><span class="id"> rewrite</span><span class="id"> propeqE;</span><span class="id"> split=&gt;</span><span class="id"> ??;</span><span class="id"> rewrite</span> (<span class="id">e,=^~e</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_forall2</span><span class="id"> T</span><span class="id"> S</span> (<span class="id">U</span><span class="id"> V</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> :</span><span class="id"> T,</span><span class="id"> S</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> U</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =</span><span class="id"> V</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> -&gt;</span> (<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> U</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> V</span><span class="id"> x</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> UV;</span><span class="id"> apply/eq_forall</span><span class="id"> =&gt;</span><span class="id"> x;</span><span class="id"> apply/eq_forall</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_forall3</span><span class="id"> T</span><span class="id"> S</span><span class="id"> R</span> (<span class="id">U</span><span class="id"> V</span><span class="id"> :</span><span class="gallina-kwd"> forall</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> T</span>) (<span class="id">y</span><span class="id"> :</span><span class="id"> S</span><span class="id"> x</span>)<span class="id">,</span><span class="id"> R</span><span class="id"> x</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z,</span><span class="id"> U</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =</span><span class="id"> V</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z,</span><span class="id"> U</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z,</span><span class="id"> V</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> UV;</span><span class="id"> apply/eq_forall2</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> apply/eq_forall</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_exists</span><span class="id"> T</span> (<span class="id">U</span><span class="id"> V</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> :</span><span class="id"> T,</span><span class="id"> U</span><span class="id"> x</span><span class="id"> =</span><span class="id"> V</span><span class="id"> x</span>)<span class="id"> -&gt;</span> (<span class="gallina-kwd">exists</span><span class="id"> x,</span><span class="id"> U</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="gallina-kwd">exists</span><span class="id"> x,</span><span class="id"> V</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> e;</span><span class="id"> rewrite</span><span class="id"> propeqE;</span><span class="id"> split=&gt;</span><span class="id"> -</span><span class="id"> []</span><span class="id"> x</span><span class="id"> ?;</span><span class="gallina-kwd"> exists</span><span class="id"> x;</span><span class="id"> rewrite</span> (<span class="id">e,=^~e</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_exists2</span><span class="id"> T</span><span class="id"> S</span> (<span class="id">U</span><span class="id"> V</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> :</span><span class="id"> T,</span><span class="id"> S</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> U</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =</span><span class="id"> V</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> -&gt;</span> (<span class="gallina-kwd">exists</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> U</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="gallina-kwd">exists</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> V</span><span class="id"> x</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> UV;</span><span class="id"> apply/eq_exists</span><span class="id"> =&gt;</span><span class="id"> x;</span><span class="id"> apply/eq_exists</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_exists3</span><span class="id"> T</span><span class="id"> S</span><span class="id"> R</span> (<span class="id">U</span><span class="id"> V</span><span class="id"> :</span><span class="gallina-kwd"> forall</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> T</span>) (<span class="id">y</span><span class="id"> :</span><span class="id"> S</span><span class="id"> x</span>)<span class="id">,</span><span class="id"> R</span><span class="id"> x</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z,</span><span class="id"> U</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> =</span><span class="id"> V</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">exists</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z,</span><span class="id"> U</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="gallina-kwd">exists</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z,</span><span class="id"> V</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> UV;</span><span class="id"> apply/eq_exists2</span><span class="id"> =&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> apply/eq_exists</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_exist</span><span class="id"> T</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>) (<span class="id">s</span><span class="id"> t</span><span class="id"> :</span><span class="id"> T</span>) (<span class="id">p</span><span class="id"> :</span><span class="id"> P</span><span class="id"> s</span>) (<span class="id">q</span><span class="id"> :</span><span class="id"> P</span><span class="id"> t</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">s</span><span class="id"> =</span><span class="id"> t</span><span class="id"> -&gt;</span><span class="id"> exist</span><span class="id"> P</span><span class="id"> s</span><span class="id"> p</span><span class="id"> =</span><span class="id"> exist</span><span class="id"> P</span><span class="id"> t</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> st;</span><span class="id"> case:</span><span class="id"> _</span><span class="id"> /</span><span class="id"> st</span><span class="gallina-kwd"> in</span><span class="id"> q</span><span class="id"> *;</span><span class="id"> apply/congr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> forall_swap</span><span class="id"> T</span><span class="id"> S</span> (<span class="id">U</span><span class="id"> :</span><span class="gallina-kwd"> forall</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> T</span>) (<span class="id">y</span><span class="id"> :</span><span class="id"> S</span>)<span class="id">,</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> U</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="gallina-kwd">forall</span><span class="id"> y</span><span class="id"> x,</span><span class="id"> U</span><span class="id"> x</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> propeqE;</span><span class="id"> split</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exists_swap</span><span class="id"> T</span><span class="id"> S</span> (<span class="id">U</span><span class="id"> :</span><span class="gallina-kwd"> forall</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> T</span>) (<span class="id">y</span><span class="id"> :</span><span class="id"> S</span>)<span class="id">,</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">exists</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> U</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="gallina-kwd">exists</span><span class="id"> y</span><span class="id"> x,</span><span class="id"> U</span><span class="id"> x</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> propeqE;</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> -[x</span><span class="id"> [y]];</span><span class="gallina-kwd"> exists</span><span class="id"> y,</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> reflect_eq</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>) (<span class="id">b</span><span class="id"> :</span><span class="id"> bool</span>)<span class="id"> :</span><span class="id"> reflect</span><span class="id"> P</span><span class="id"> b</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> =</span><span class="id"> b</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> propeqE;</span><span class="id"> exact:</span><span class="id"> rwP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> asbool</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :=</span><span class="gallina-kwd"> if</span><span class="id"> pselect</span><span class="id"> P</span><span class="gallina-kwd"> then</span><span class="id"> true</span><span class="gallina-kwd"> else</span><span class="id"> false</span>.<br/>
<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;`[&lt; P &gt;]&quot;</span><span class="id"> :=</span> (<span class="id">asbool</span><span class="id"> P</span>)<span class="id"> :</span><span class="id"> bool_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> asboolE</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><span class="id"> `[&lt;P&gt;]</span><span class="id"> =</span><span class="id"> P</span><span class="id"> :&gt;</span><span class="gallina-kwd"> Prop</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> propeqE</span><span class="id"> /asbool;</span><span class="id"> case:</span><span class="id"> pselect;</span><span class="id"> split</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> asboolP</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><span class="id"> reflect</span><span class="id"> P</span><span class="id"> `[&lt;P&gt;]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span> (<span class="id">equivP</span><span class="id"> idP</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> asboolE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> asboolb</span> (<span class="id">b</span><span class="id"> :</span><span class="id"> bool</span>)<span class="id"> :</span><span class="id"> `[&lt;</span><span class="id"> b</span><span class="id"> &gt;]</span><span class="id"> =</span><span class="id"> b</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/asboolP/idP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> asboolPn</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><span class="id"> reflect</span> (<span class="id">~</span><span class="id"> P</span>) (<span class="id">~~</span><span class="id"> `[&lt;P&gt;]</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /asbool;</span><span class="id"> case:</span><span class="id"> pselect=&gt;</span><span class="id"> h;</span><span class="id"> constructor</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> asboolW</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><span class="id"> `[&lt;P&gt;]</span><span class="id"> -&gt;</span><span class="id"> P</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> asboolP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> asboolT</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><span class="id"> P</span><span class="id"> -&gt;</span><span class="id"> `[&lt;P&gt;]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> asboolP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> asboolF</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><span class="id"> ~</span><span class="id"> P</span><span class="id"> -&gt;</span><span class="id"> `[&lt;P&gt;]</span><span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/introF/asboolP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eq_opE</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> eqType</span>) (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> T</span>)<span class="id"> :</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> y</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> =</span><span class="id"> y</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/propext;</span><span class="id"> split=&gt;</span><span class="id"> /eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_true_inj</span><span class="id"> :</span><span class="id"> injective</span><span class="id"> is_true</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> []</span><span class="id"> [];</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">trueE,</span><span class="id"> falseE</span>)<span class="id"> ?propeqE;</span><span class="id"> tauto</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> gen_eq</span> (<span class="id">T</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">u</span><span class="id"> v</span><span class="id"> :</span><span class="id"> T</span>)<span class="id"> :=</span><span class="id"> `[&lt;u</span><span class="id"> =</span><span class="id"> v&gt;]</span>.<br/>
<span class="vernacular">Lemma</span><span class="id"> gen_eqP</span> (<span class="id">T</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>)<span class="id"> :</span><span class="id"> Equality</span>.<span class="id">axiom</span> (<span class="id">@gen_eq</span><span class="id"> T</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> apply:</span> (<span class="id">iffP</span> (<span class="id">asboolP</span><span class="id"> _</span>)). Qed.</div></details>
<span class="vernacular">Definition</span><span class="id"> gen_eqMixin</span> (<span class="id">T</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>)<span class="id"> :</span><span class="id"> hasDecEq</span><span class="id"> T</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">hasDecEq</span>.<span class="id">Build</span><span class="id"> T</span> (<span class="id">@gen_eqP</span><span class="id"> T</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">T</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">T'</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> eqType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">gen_eqMixin</span> (<span class="gallina-kwd">forall</span><span class="id"> t</span><span class="id"> :</span><span class="id"> T,</span><span class="id"> T'</span><span class="id"> t</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span> (<span class="id">T</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">T'</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> choiceType</span>)<span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="id">gen_choiceMixin</span> (<span class="gallina-kwd">forall</span><span class="id"> t</span><span class="id"> :</span><span class="id"> T,</span><span class="id"> T'</span><span class="id"> t</span>).<br/>
<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> gen_eqMixin</span><span class="gallina-kwd"> Prop</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> gen_choiceMixin</span><span class="gallina-kwd"> Prop</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> classicType</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> T</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> classicType</span><span class="id"> :=</span><span class="id"> T</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> gen_eqMixin</span><span class="id"> classicType</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> gen_choiceMixin</span><span class="id"> classicType</span>.<br/>
<span class="vernacular">End</span><span class="id"> classicType</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;'{classic' T }&quot;</span><span class="id"> :=</span> (<span class="id">classicType</span><span class="id"> T</span>)<br/>
&nbsp;(<span class="id">format</span> <span class="id">&quot;'{classic'  T }&quot;</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> eclassicType</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> T</span><span class="id"> :</span><span class="id"> eqType</span>.<br/>
<span class="vernacular">Definition</span><span class="id"> eclassicType</span><span class="id"> :</span><span class="gallina-kwd"> Type</span><span class="id"> :=</span><span class="id"> T</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Equality</span>.<span class="id">copy</span><span class="id"> eclassicType</span><span class="id"> T</span>.<br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> gen_choiceMixin</span><span class="id"> eclassicType</span>.<br/>
<span class="vernacular">End</span><span class="id"> eclassicType</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;'{eclassic' T }&quot;</span><span class="id"> :=</span> (<span class="id">eclassicType</span><span class="id"> T</span>)<br/>
&nbsp;(<span class="id">format</span> <span class="id">&quot;'{eclassic'  T }&quot;</span>)<span class="id"> :</span><span class="id"> type_scope</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> canonical_of</span><span class="id"> T</span><span class="id"> U</span> (<span class="id">sort</span><span class="id"> :</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> T</span>)<span class="id"> :=</span><span class="gallina-kwd"> forall</span> (<span class="id">G</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span>)<span class="id">,</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> x',</span><span class="id"> G</span> (<span class="id">sort</span><span class="id"> x'</span>))<span class="id"> -&gt;</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> G</span><span class="id"> x</span>.<br/>
<span class="vernacular">Notation</span><span class="id"> canonical_</span><span class="id"> sort</span><span class="id"> :=</span> (<span class="id">@canonical_of</span><span class="id"> _</span><span class="id"> _</span><span class="id"> sort</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> canonical</span><span class="id"> T</span><span class="id"> E</span><span class="id"> :=</span> (<span class="id">@canonical_of</span><span class="id"> T</span><span class="id"> E</span><span class="id"> id</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> canon</span><span class="id"> T</span><span class="id"> U</span> (<span class="id">sort</span><span class="id"> :</span><span class="id"> U</span><span class="id"> -&gt;</span><span class="id"> T</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="gallina-kwd"> exists</span><span class="id"> y,</span><span class="id"> sort</span><span class="id"> y</span><span class="id"> =</span><span class="id"> x</span>)<span class="id"> -&gt;</span><span class="id"> canonical_</span><span class="id"> sort</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> +</span><span class="id"> G</span><span class="id"> Gs</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> /</span>(_<span class="id"> x</span>)<span class="id">/cid[x'</span><span class="id"> &lt;-]</span>. Qed.</div></details>
<span class="vernacular">Arguments</span><span class="id"> canon</span><span class="id"> {T</span><span class="id"> U</span><span class="id"> sort}</span><span class="id"> x</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> Peq</span><span class="id"> :</span><span class="id"> canonical</span><span class="gallina-kwd"> Type</span><span class="id"> eqType</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> canon</span><span class="id"> =&gt;</span><span class="id"> T;</span><span class="gallina-kwd"> exists</span><span class="id"> {classic</span><span class="id"> T}</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> Pchoice</span><span class="id"> :</span><span class="id"> canonical</span><span class="gallina-kwd"> Type</span><span class="id"> choiceType</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> canon</span><span class="id"> =&gt;</span><span class="id"> T;</span><span class="gallina-kwd"> exists</span><span class="id"> {classic</span><span class="id"> T}</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> eqPchoice</span><span class="id"> :</span><span class="id"> canonical</span><span class="id"> eqType</span><span class="id"> choiceType</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> canon</span><span class="id"> =&gt;</span><span class="id"> T;</span><span class="gallina-kwd"> exists</span><span class="id"> {eclassic</span><span class="id"> T};</span><span class="id"> case:</span><span class="id"> T</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> T</span><span class="id"> [?]//</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> not_True</span><span class="id"> :</span> (<span class="id">~</span><span class="id"> True</span>)<span class="id"> =</span><span class="id"> False</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact/propext</span>. Qed.</div></details>
<span class="vernacular">Lemma</span><span class="id"> not_False</span><span class="id"> :</span> (<span class="id">~</span><span class="id"> False</span>)<span class="id"> =</span><span class="id"> True</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/propext;</span><span class="id"> split=&gt;</span><span class="id"> _</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> asbool_equiv_eq</span><span class="id"> {P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> Prop}</span><span class="id"> :</span> (<span class="id">P</span><span class="id"> &lt;-&gt;</span><span class="id"> Q</span>)<span class="id"> -&gt;</span><span class="id"> `[&lt;P&gt;]</span><span class="id"> =</span><span class="id"> `[&lt;Q&gt;]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -propeqE</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> asbool_equiv_eqP</span><span class="id"> {P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> Prop}</span><span class="id"> b</span><span class="id"> :</span><span class="id"> reflect</span><span class="id"> Q</span><span class="id"> b</span><span class="id"> -&gt;</span> (<span class="id">P</span><span class="id"> &lt;-&gt;</span><span class="id"> Q</span>)<span class="id"> -&gt;</span><span class="id"> `[&lt;P&gt;]</span><span class="id"> =</span><span class="id"> b</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> Q_b</span><span class="id"> [PQ</span><span class="id"> QP];</span><span class="id"> apply/asboolP/Q_b</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> asbool_equiv</span><span class="id"> {P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> Prop}</span><span class="id"> :</span> (<span class="id">P</span><span class="id"> &lt;-&gt;</span><span class="id"> Q</span>)<span class="id"> -&gt;</span> (<span class="id">`[&lt;P&gt;]</span><span class="id"> &lt;-&gt;</span><span class="id"> `[&lt;Q&gt;]</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/asbool_equiv_eq-&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> asbool_eq_equiv</span><span class="id"> {P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> Prop}</span><span class="id"> :</span><span class="id"> `[&lt;P&gt;]</span><span class="id"> =</span><span class="id"> `[&lt;Q&gt;]</span><span class="id"> -&gt;</span> (<span class="id">P</span><span class="id"> &lt;-&gt;</span><span class="id"> Q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> eq;</span><span class="id"> split=&gt;</span><span class="id"> /asboolP;</span><span class="id"> rewrite</span> (<span class="id">eq,</span><span class="id"> =^~</span><span class="id"> eq</span>)<span class="id"> =&gt;</span><span class="id"> /asboolP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> and_asboolP</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><span class="id"> reflect</span> (<span class="id">P</span><span class="id"> /\</span><span class="id"> Q</span>) (<span class="id">`[&lt;</span><span class="id"> P</span><span class="id"> &gt;]</span><span class="id"> &amp;&amp;</span><span class="id"> `[&lt;</span><span class="id"> Q</span><span class="id"> &gt;]</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> case/andP</span><span class="id"> =&gt;</span><span class="id"> /asboolP</span><span class="id"> p</span><span class="id"> /asboolP</span><span class="id"> q</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case=&gt;</span><span class="id"> /asboolP-&gt;</span><span class="id"> /asboolP-&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> and3_asboolP</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> R</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span><span class="id"> [/\</span><span class="id"> P,</span><span class="id"> Q</span><span class="id"> &amp;</span><span class="id"> R]</span><span class="id"> [&amp;&amp;</span><span class="id"> `[&lt;</span><span class="id"> P</span><span class="id"> &gt;],</span><span class="id"> `[&lt;</span><span class="id"> Q</span><span class="id"> &gt;]</span><span class="id"> &amp;</span><span class="id"> `[&lt;</span><span class="id"> R</span><span class="id"> &gt;]]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> case/and3P</span><span class="id"> =&gt;</span><span class="id"> /asboolP</span><span class="id"> p</span><span class="id"> /asboolP</span><span class="id"> q</span><span class="id"> /asboolP</span><span class="id"> r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case</span><span class="id"> =&gt;</span><span class="id"> /asboolP</span><span class="id"> -&gt;</span><span class="id"> /asboolP</span><span class="id"> -&gt;</span><span class="id"> /asboolP</span><span class="id"> -&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> or_asboolP</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><span class="id"> reflect</span> (<span class="id">P</span><span class="id"> \/</span><span class="id"> Q</span>) (<span class="id">`[&lt;</span><span class="id"> P</span><span class="id"> &gt;]</span><span class="id"> ||</span><span class="id"> `[&lt;</span><span class="id"> Q</span><span class="id"> &gt;]</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> case/orP=&gt;</span><span class="id"> /asboolP;</span><span class="id"> [left</span><span class="id"> |</span><span class="id"> right]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case=&gt;</span><span class="id"> /asboolP-&gt;</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> orbT</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> or3_asboolP</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> R</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span><span class="id"> [\/</span><span class="id"> P,</span><span class="id"> Q</span><span class="id"> |</span><span class="id"> R]</span><span class="id"> [||</span><span class="id"> `[&lt;</span><span class="id"> P</span><span class="id"> &gt;],</span><span class="id"> `[&lt;</span><span class="id"> Q</span><span class="id"> &gt;]</span><span class="id"> |</span><span class="id"> `[&lt;</span><span class="id"> R</span><span class="id"> &gt;]]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> [|</span><span class="id"> |]</span><span class="id"> /asboolP</span><span class="id"> -&gt;</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> !orbT</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case/orP=&gt;</span><span class="id"> [/asboolP</span><span class="id"> p|/orP[]/asboolP];</span><span class="id"> [exact:Or31|exact:Or32|exact:Or33]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> asbool_neg</span><span class="id"> {P</span><span class="id"> :</span><span class="id"> Prop}</span><span class="id"> :</span><span class="id"> `[&lt;~</span><span class="id"> P&gt;]</span><span class="id"> =</span><span class="id"> ~~</span><span class="id"> `[&lt;P&gt;]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/idP/asboolPn=&gt;</span><span class="id"> [/asboolP|/asboolT]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> asbool_or</span><span class="id"> {P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> Prop}</span><span class="id"> :</span><span class="id"> `[&lt;P</span><span class="id"> \/</span><span class="id"> Q&gt;]</span><span class="id"> =</span><span class="id"> `[&lt;P&gt;]</span><span class="id"> ||</span><span class="id"> `[&lt;Q&gt;]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">asbool_equiv_eqP</span> (<span class="id">or_asboolP</span><span class="id"> _</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> asbool_and</span><span class="id"> {P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> Prop}</span><span class="id"> :</span><span class="id"> `[&lt;P</span><span class="id"> /\</span><span class="id"> Q&gt;]</span><span class="id"> =</span><span class="id"> `[&lt;P&gt;]</span><span class="id"> &amp;&amp;</span><span class="id"> `[&lt;Q&gt;]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">asbool_equiv_eqP</span> (<span class="id">and_asboolP</span><span class="id"> _</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> imply_asboolP</span><span class="id"> {P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> Prop}</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="id">P</span><span class="id"> -&gt;</span><span class="id"> Q</span>) (<span class="id">`[&lt;P&gt;]</span><span class="id"> ==&gt;</span><span class="id"> `[&lt;Q&gt;]</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> implyP</span>)<span class="id">=&gt;</span><span class="id"> [PQb</span><span class="id"> /asboolP/PQb/asboolW</span><span class="id"> //|]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> PQ</span><span class="id"> /asboolP/PQ/asboolT</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> asbool_imply</span><span class="id"> {P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> Prop}</span><span class="id"> :</span><span class="id"> `[&lt;P</span><span class="id"> -&gt;</span><span class="id"> Q&gt;]</span><span class="id"> =</span><span class="id"> `[&lt;P&gt;]</span><span class="id"> ==&gt;</span><span class="id"> `[&lt;Q&gt;]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span> (<span class="id">asbool_equiv_eqP</span><span class="id"> imply_asboolP</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> imply_asboolPn</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><span class="id"> reflect</span> (<span class="id">P</span><span class="id"> /\</span><span class="id"> ~</span><span class="id"> Q</span>) (<span class="id">~~</span><span class="id"> `[&lt;P</span><span class="id"> -&gt;</span><span class="id"> Q&gt;]</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> asbool_imply</span><span class="id"> negb_imply</span><span class="id"> -asbool_neg</span><span class="id"> =&gt;</span><span class="id"> /and_asboolP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move/and_asboolP;</span><span class="id"> rewrite</span><span class="id"> asbool_neg</span><span class="id"> -negb_imply</span><span class="id"> asbool_imply</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> forall_asboolP</span><span class="id"> {T</span><span class="id"> :</span><span class="id"> Type}</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> `[&lt;P</span><span class="id"> x&gt;]</span>) (<span class="id">`[&lt;forall</span><span class="id"> x,</span><span class="id"> P</span><span class="id"> x&gt;]</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> move/asboolP=&gt;</span><span class="id"> Px</span><span class="id"> x;</span><span class="id"> apply/asboolP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> Px;</span><span class="id"> apply/asboolP=&gt;</span><span class="id"> x;</span><span class="id"> apply/asboolP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exists_asboolP</span><span class="id"> {T</span><span class="id"> :</span><span class="id"> Type}</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> x,</span><span class="id"> `[&lt;P</span><span class="id"> x&gt;]</span>) (<span class="id">`[&lt;exists</span><span class="id"> x,</span><span class="id"> P</span><span class="id"> x&gt;]</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> case/asboolP=&gt;</span><span class="id"> x</span><span class="id"> Px;</span><span class="gallina-kwd"> exists</span><span class="id"> x;</span><span class="id"> apply/asboolP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case=&gt;</span><span class="id"> x</span><span class="id"> bPx;</span><span class="id"> apply/asboolP;</span><span class="gallina-kwd"> exists</span><span class="id"> x;</span><span class="id"> apply/asboolP</span>.<br/>
Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Variant</span><span class="id"> BoolProp</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Type</span><span class="id"> :=</span><br/>
&nbsp;<span class="id">|</span><span class="id"> TrueProp</span><span class="id"> :</span><span class="id"> BoolProp</span><span class="id"> True</span><br/>
&nbsp;<span class="id">|</span><span class="id"> FalseProp</span><span class="id"> :</span><span class="id"> BoolProp</span><span class="id"> False</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> PropB</span><span class="id"> P</span><span class="id"> :</span><span class="id"> BoolProp</span><span class="id"> P</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span> (<span class="id">asboolP</span><span class="id"> P</span>)<span class="id"> =&gt;</span><span class="id"> [/propT-&gt;</span><span class="id"> |</span><span class="id"> /propF-&gt;];</span><span class="id"> [left</span><span class="id"> |</span><span class="id"> right]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> notB</span><span class="id"> :</span> ((<span class="id">~</span><span class="id"> True</span>)<span class="id"> =</span><span class="id"> False</span>)<span class="id"> *</span> ((<span class="id">~</span><span class="id"> False</span>)<span class="id"> =</span><span class="id"> True</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /not;</span><span class="id"> split;</span><span class="id"> eqProp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> andB</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> True</span><span class="id"> and</span><span class="id"> *</span><span class="id"> right_id</span><span class="id"> True</span><span class="id"> and</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">*</span> (<span class="id">left_zero</span><span class="id"> False</span><span class="id"> and</span><span class="id"> *</span><span class="id"> right_zero</span><span class="id"> False</span><span class="id"> and</span><span class="id"> *</span><span class="id"> idempotent</span><span class="id"> and</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> do</span><span class="id"> ![split]</span><span class="id"> =&gt;</span><span class="id"> /PropB[];</span><span class="id"> eqProp=&gt;</span><span class="id"> //</span><span class="id"> -[]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> orB</span><span class="id"> :</span><span class="id"> left_id</span><span class="id"> False</span><span class="id"> or</span><span class="id"> *</span><span class="id"> right_id</span><span class="id"> False</span><span class="id"> or</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">*</span> (<span class="id">left_zero</span><span class="id"> True</span><span class="id"> or</span><span class="id"> *</span><span class="id"> right_zero</span><span class="id"> True</span><span class="id"> or</span><span class="id"> *</span><span class="id"> idempotent</span><span class="id"> or</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> do</span><span class="id"> ![split]</span><span class="id"> =&gt;</span><span class="id"> /PropB[];</span><span class="id"> eqProp=&gt;</span><span class="id"> -[]</span><span class="id"> //;</span><span class="gallina-kwd"> by</span><span class="id"> [left</span><span class="id"> |</span><span class="id"> right]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> implyB</span><span class="id"> :</span><span class="gallina-kwd"> let</span><span class="id"> imply</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :=</span> <span class="id"> P</span><span class="id"> -&gt;</span><span class="id"> Q</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">imply</span><span class="id"> False</span><span class="id"> =1</span><span class="id"> fun=&gt;</span><span class="id"> True</span>)<span class="id"> *</span> (<span class="id">imply^~</span><span class="id"> False</span><span class="id"> =1</span><span class="id"> not</span>)<br/>
&nbsp;&nbsp;<span class="id">*</span> (<span class="id">left_id</span><span class="id"> True</span><span class="id"> imply</span><span class="id"> *</span><span class="id"> right_zero</span><span class="id"> True</span><span class="id"> imply</span><span class="id"> *</span><span class="id"> self_inverse</span><span class="id"> True</span><span class="id"> imply</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> do</span><span class="id"> ![split]</span><span class="id"> =&gt;</span><span class="id"> /PropB[];</span><span class="id"> eqProp=&gt;</span><span class="id"> //;</span><span class="id"> apply</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> decide_or</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> P</span><span class="id"> \/</span><span class="id"> Q</span><span class="id"> -&gt;</span><span class="id"> {P}</span><span class="id"> +</span><span class="id"> {Q}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case/PropB:</span><span class="id"> P;</span><span class="id"> [left</span><span class="id"> |</span><span class="id"> rewrite</span><span class="id"> orB;</span><span class="id"> right]</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> notT</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><span class="id"> P</span><span class="id"> =</span><span class="id"> False</span><span class="id"> -&gt;</span><span class="id"> ~</span><span class="id"> P</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move-&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> contrapT</span><span class="id"> P</span><span class="id"> :</span><span class="id"> ~</span><span class="id"> ~</span><span class="id"> P</span><span class="id"> -&gt;</span><span class="id"> P</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span> (<span class="id">PropB</span><span class="id"> P</span>)<span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> not_False</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> notTE</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="id">~</span><span class="id"> P</span>)<span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> =</span><span class="id"> False</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span> (<span class="id">PropB</span><span class="id"> P</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> notFE</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="id">~</span><span class="id"> P</span>)<span class="id"> =</span><span class="id"> False</span><span class="id"> -&gt;</span><span class="id"> P</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/notT;</span><span class="id"> exact:</span><span class="id"> contrapT</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> notK</span><span class="id"> :</span><span class="id"> involutive</span><span class="id"> not</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case/PropB;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">not_False,not_True</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> contra_notP</span> (<span class="id">Q</span><span class="id"> P</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="id">~</span><span class="id"> Q</span><span class="id"> -&gt;</span><span class="id"> P</span>)<span class="id"> -&gt;</span><span class="id"> ~</span><span class="id"> P</span><span class="id"> -&gt;</span><span class="id"> Q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> Q</span><span class="id"> P</span><span class="id"> =&gt;</span><span class="id"> /PropB[]</span><span class="id"> /PropB[]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> contraPP</span> (<span class="id">Q</span><span class="id"> P</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="id">~</span><span class="id"> Q</span><span class="id"> -&gt;</span><span class="id"> ~</span><span class="id"> P</span>)<span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> -&gt;</span><span class="id"> Q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> Q</span><span class="id"> P</span><span class="id"> =&gt;</span><span class="id"> /PropB[]</span><span class="id"> /PropB[]//;</span><span class="id"> rewrite</span><span class="id"> not_False</span><span class="id"> not_True</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> contra_notT</span><span class="id"> b</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="id">~~</span><span class="id"> b</span><span class="id"> -&gt;</span><span class="id"> P</span>)<span class="id"> -&gt;</span><span class="id"> ~</span><span class="id"> P</span><span class="id"> -&gt;</span><span class="id"> b</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> bP;</span><span class="id"> apply:</span><span class="id"> contra_notP</span><span class="id"> =&gt;</span><span class="id"> /negP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> contraPT</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> b</span><span class="id"> :</span> (<span class="id">~~</span><span class="id"> b</span><span class="id"> -&gt;</span><span class="id"> ~</span><span class="id"> P</span>)<span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> -&gt;</span><span class="id"> b</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /contra_notT;</span><span class="id"> rewrite</span><span class="id"> notK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> contraTP</span><span class="id"> b</span> (<span class="id">Q</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="id">~</span><span class="id"> Q</span><span class="id"> -&gt;</span><span class="id"> ~~</span><span class="id"> b</span>)<span class="id"> -&gt;</span><span class="id"> b</span><span class="id"> -&gt;</span><span class="id"> Q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> QB;</span><span class="id"> apply:</span><span class="id"> contraPP</span><span class="id"> =&gt;</span><span class="id"> /QB/negP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> contraNP</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>) (<span class="id">b</span><span class="id"> :</span><span class="id"> bool</span>)<span class="id"> :</span> (<span class="id">~</span><span class="id"> P</span><span class="id"> -&gt;</span><span class="id"> b</span>)<span class="id"> -&gt;</span><span class="id"> ~~</span><span class="id"> b</span><span class="id"> -&gt;</span><span class="id"> P</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /contra_notP</span><span class="id"> +</span><span class="id"> /negP</span><span class="id"> =&gt;</span><span class="id"> /[apply]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> contra_neqP</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> eqType</span>) (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> T</span>)<span class="id"> P</span><span class="id"> :</span> (<span class="id">~</span><span class="id"> P</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> y</span>)<span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> P</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> Pxy;</span><span class="id"> apply:</span><span class="id"> contraNP</span><span class="id"> =&gt;</span><span class="id"> /Pxy/eqP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> contra_eqP</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> eqType</span>) (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> T</span>)<span class="id"> Q</span><span class="id"> :</span> (<span class="id">~</span><span class="id"> Q</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> y</span>)<span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> Q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> Qxy</span><span class="id"> /eqP;</span><span class="id"> apply:</span><span class="id"> contraTP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> contra_leP</span><span class="id"> {disp1}</span><span class="id"> {T1</span><span class="id"> :</span><span class="id"> porderType</span><span class="id"> disp1}</span><span class="id"> [P</span><span class="id"> :</span><span class="id"> Prop]</span><span class="id"> [x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> T1]</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">~</span><span class="id"> P</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> y</span>)<span class="id">%O</span>)<span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> &lt;=</span><span class="id"> x</span>)<span class="id">%O</span><span class="id"> -&gt;</span><span class="id"> P</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Pxy</span><span class="id"> yx;</span><span class="id"> apply/asboolP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> Order</span>.<span class="id">POrderTheory</span>.<span class="id">contra_leT</span><span class="id"> yx</span><span class="id"> =&gt;</span><span class="id"> /asboolPn</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> contra_ltP</span><span class="id"> {disp1}</span><span class="id"> {T1</span><span class="id"> :</span><span class="id"> porderType</span><span class="id"> disp1}</span><span class="id"> [P</span><span class="id"> :</span><span class="id"> Prop]</span><span class="id"> [x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> T1]</span><span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="id">~</span><span class="id"> P</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> y</span>)<span class="id">%O</span>)<span class="id"> -&gt;</span> (<span class="id">y</span><span class="id"> &lt;</span><span class="id"> x</span>)<span class="id">%O</span><span class="id"> -&gt;</span><span class="id"> P</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Pxy</span><span class="id"> yx;</span><span class="id"> apply/asboolP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> Order</span>.<span class="id">POrderTheory</span>.<span class="id">contra_ltT</span><span class="id"> yx</span><span class="id"> =&gt;</span><span class="id"> /asboolPn</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> wlog_neg</span><span class="id"> P</span><span class="id"> :</span> (<span class="id">~</span><span class="id"> P</span><span class="id"> -&gt;</span><span class="id"> P</span>)<span class="id"> -&gt;</span><span class="id"> P</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span> (<span class="id">PropB</span><span class="id"> P</span>)<span class="id">;</span><span class="id"> exact</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> not_inj</span><span class="id"> :</span><span class="id"> injective</span><span class="id"> not</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> can_inj</span><span class="id"> notK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> notLR</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> :</span> (<span class="id">P</span><span class="id"> =</span><span class="id"> ~</span><span class="id"> Q</span>)<span class="id"> -&gt;</span> (<span class="id">~</span><span class="id"> P</span>)<span class="id"> =</span><span class="id"> Q</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> canLR</span><span class="id"> notK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> notRL</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> :</span> (<span class="id">~</span><span class="id"> P</span>)<span class="id"> =</span><span class="id"> Q</span><span class="id"> -&gt;</span><span class="id"> P</span><span class="id"> =</span><span class="id"> ~</span><span class="id"> Q</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> canRL</span><span class="id"> notK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> iff_notr</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="id">P</span><span class="id"> &lt;-&gt;</span><span class="id"> ~</span><span class="id"> Q</span>)<span class="id"> &lt;-&gt;</span> (<span class="id">~</span><span class="id"> P</span><span class="id"> &lt;-&gt;</span><span class="id"> Q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split=&gt;</span><span class="id"> [/propext</span><span class="id"> -&gt;|/propext</span><span class="id"> &lt;-];</span><span class="id"> rewrite</span><span class="id"> notK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> iff_not2</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="id">~</span><span class="id"> P</span><span class="id"> &lt;-&gt;</span><span class="id"> ~</span><span class="id"> Q</span>)<span class="id"> &lt;-&gt;</span> (<span class="id">P</span><span class="id"> &lt;-&gt;</span><span class="id"> Q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split=&gt;</span><span class="id"> [/iff_notr|PQ];</span><span class="id"> [|apply/iff_notr];</span><span class="id"> rewrite</span><span class="id"> notK</span>. Qed.</div></details>
<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> predp</span><span class="id"> T</span><span class="id"> :=</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>.<br/>
<br/>
<span class="id">Identity</span><span class="vernacular"> Coercion</span><span class="id"> fun_of_pred</span><span class="id"> :</span><span class="id"> predp</span><span class="id"> &gt;-&gt;</span><span class="id"> Funclass</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> relp</span><span class="id"> T</span><span class="id"> :=</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> predp</span><span class="id"> T</span>.<br/>
<br/>
<span class="id">Identity</span><span class="vernacular"> Coercion</span><span class="id"> fun_of_rel</span><span class="id"> :</span><span class="id"> rel</span><span class="id"> &gt;-&gt;</span><span class="id"> Funclass</span>.<br/>
<br/>
<span class="vernacular">Notation</span><span class="id"> xpredp0</span><span class="id"> :=</span> (<span class="gallina-kwd">fun</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> False</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> xpredpT</span><span class="id"> :=</span> (<span class="gallina-kwd">fun</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> True</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> xpredpI</span><span class="id"> :=</span> (<span class="gallina-kwd">fun</span> (<span class="id">p1</span><span class="id"> p2</span><span class="id"> :</span><span class="id"> predp</span><span class="id"> _</span>)<span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> p1</span><span class="id"> x</span><span class="id"> /\</span><span class="id"> p2</span><span class="id"> x</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> xpredpU</span><span class="id"> :=</span> (<span class="gallina-kwd">fun</span> (<span class="id">p1</span><span class="id"> p2</span><span class="id"> :</span><span class="id"> predp</span><span class="id"> _</span>)<span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> p1</span><span class="id"> x</span><span class="id"> \/</span><span class="id"> p2</span><span class="id"> x</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> xpredpC</span><span class="id"> :=</span> (<span class="gallina-kwd">fun</span> (<span class="id">p</span><span class="id"> :</span><span class="id"> predp</span><span class="id"> _</span>)<span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> ~</span><span class="id"> p</span><span class="id"> x</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> xpredpD</span><span class="id"> :=</span> (<span class="gallina-kwd">fun</span> (<span class="id">p1</span><span class="id"> p2</span><span class="id"> :</span><span class="id"> predp</span><span class="id"> _</span>)<span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> ~</span><span class="id"> p2</span><span class="id"> x</span><span class="id"> /\</span><span class="id"> p1</span><span class="id"> x</span>).<br/>
<span class="vernacular">Notation</span><span class="id"> xpreimp</span><span class="id"> :=</span> (<span class="gallina-kwd">fun</span><span class="id"> f</span> (<span class="id">p</span><span class="id"> :</span><span class="id"> predp</span><span class="id"> _</span>)<span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> p</span> (<span class="id">f</span><span class="id"> x</span>)).<br/>
<span class="vernacular">Notation</span><span class="id"> xrelpU</span><span class="id"> :=</span> (<span class="gallina-kwd">fun</span> (<span class="id">r1</span><span class="id"> r2</span><span class="id"> :</span><span class="id"> relp</span><span class="id"> _</span>)<span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> r1</span><span class="id"> x</span><span class="id"> y</span><span class="id"> \/</span><span class="id"> r2</span><span class="id"> x</span><span class="id"> y</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> pred0p</span> (<span class="id">T</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> predp</span><span class="id"> T</span>)<span class="id"> :</span><span class="id"> bool</span><span class="id"> :=</span><span class="id"> `[&lt;P</span><span class="id"> =1</span><span class="id"> xpredp0&gt;]</span>.<br/>
<span class="id">Prenex</span><span class="vernacular"> Implicits</span><span class="id"> pred0p</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pred0pP</span>  (<span class="id">T</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> predp</span><span class="id"> T</span>)<span class="id"> :</span><span class="id"> reflect</span> (<span class="id">P</span><span class="id"> =1</span><span class="id"> xpredp0</span>) (<span class="id">pred0p</span><span class="id"> P</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span> (<span class="id">iffP</span> (<span class="id">asboolP</span><span class="id"> _</span>)). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> forallp_asboolPn</span><span class="id"> {T}</span><span class="id"> {P</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> Prop}</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> :</span><span class="id"> T,</span><span class="id"> ~</span><span class="id"> P</span><span class="id"> x</span>) (<span class="id">~~</span><span class="id"> `[&lt;exists</span><span class="id"> x</span><span class="id"> :</span><span class="id"> T,</span><span class="id"> P</span><span class="id"> x&gt;]</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id">=&gt;</span><span class="id"> [/asboolPn</span><span class="id"> NP</span><span class="id"> x</span><span class="id"> Px|NP]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/NP;</span><span class="gallina-kwd"> exists</span><span class="id"> x</span>.<span class="gallina-kwd"> by</span><span class="id"> apply/asboolP=&gt;</span><span class="id"> -[x];</span><span class="id"> apply/NP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> existsp_asboolPn</span><span class="id"> {T}</span><span class="id"> {P</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> Prop}</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">exists</span><span class="id"> x</span><span class="id"> :</span><span class="id"> T,</span><span class="id"> ~</span><span class="id"> P</span><span class="id"> x</span>) (<span class="id">~~</span><span class="id"> `[&lt;forall</span><span class="id"> x</span><span class="id"> :</span><span class="id"> T,</span><span class="id"> P</span><span class="id"> x&gt;]</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id">;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> case=&gt;</span><span class="id"> x</span><span class="id"> NPx;</span><span class="id"> apply/asboolPn=&gt;</span><span class="id"> /</span>(_<span class="id"> x</span>).<br/>
<span class="id">move/asboolPn=&gt;</span><span class="id"> NP;</span><span class="id"> apply/asboolP/negbNE/asboolPn=&gt;</span><span class="id"> h</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/NP=&gt;</span><span class="id"> x;</span><span class="id"> apply/asboolP/negbNE/asboolPn=&gt;</span><span class="id"> NPx;</span><span class="id"> apply/h;</span><span class="gallina-kwd"> exists</span><span class="id"> x</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> asbool_forallNb</span><span class="id"> {T</span><span class="id"> :</span><span class="id"> Type}</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> T</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">`[&lt;</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> :</span><span class="id"> T,</span><span class="id"> ~~</span> (<span class="id">P</span><span class="id"> x</span>)<span class="id"> &gt;]</span><span class="id"> =</span><span class="id"> ~~</span><span class="id"> `[&lt;</span><span class="gallina-kwd"> exists</span><span class="id"> x</span><span class="id"> :</span><span class="id"> T,</span><span class="id"> P</span><span class="id"> x</span><span class="id"> &gt;]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">asbool_equiv_eqP</span><span class="id"> forallp_asboolPn</span>)<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> split=&gt;</span><span class="id"> h</span><span class="id"> x;</span><span class="id"> apply/negP/h</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> asbool_existsNb</span><span class="id"> {T</span><span class="id"> :</span><span class="id"> Type}</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> T</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">`[&lt;</span><span class="gallina-kwd"> exists</span><span class="id"> x</span><span class="id"> :</span><span class="id"> T,</span><span class="id"> ~~</span> (<span class="id">P</span><span class="id"> x</span>)<span class="id"> &gt;]</span><span class="id"> =</span><span class="id"> ~~</span><span class="id"> `[&lt;</span><span class="gallina-kwd"> forall</span><span class="id"> x</span><span class="id"> :</span><span class="id"> T,</span><span class="id"> P</span><span class="id"> x</span><span class="id"> &gt;]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">asbool_equiv_eqP</span><span class="id"> existsp_asboolPn</span>)<span class="id">;</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> split=&gt;</span><span class="id"> -[x</span><span class="id"> h];</span><span class="gallina-kwd"> exists</span><span class="id"> x;</span><span class="id"> apply/negP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> not_implyP</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><span class="id"> ~</span> (<span class="id">P</span><span class="id"> -&gt;</span><span class="id"> Q</span>)<span class="id"> &lt;-&gt;</span><span class="id"> P</span><span class="id"> /\</span><span class="id"> ~</span><span class="id"> Q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split=&gt;</span><span class="id"> [/asboolP|[p</span><span class="id"> nq</span><span class="id"> pq]];</span><span class="id"> [|exact/nq/pq]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> asbool_neg</span><span class="id"> =&gt;</span><span class="id"> /imply_asboolPn</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> not_andE</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="id">~</span> (<span class="id">P</span><span class="id"> /\</span><span class="id"> Q</span>))<span class="id"> =</span><span class="id"> ~</span><span class="id"> P</span><span class="id"> \/</span><span class="id"> ~</span><span class="id"> Q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">eqProp=&gt;</span><span class="id"> [/asboolPn|[|]];</span><span class="id"> try</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> contra_not</span><span class="id"> =&gt;</span><span class="id"> -[]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> asbool_and</span><span class="id"> negb_and</span><span class="id"> =&gt;</span><span class="id"> /orP[]/asboolPn;</span><span class="id"> [left|right]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> not_andP</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><span class="id"> ~</span> (<span class="id">P</span><span class="id"> /\</span><span class="id"> Q</span>)<span class="id"> &lt;-&gt;</span><span class="id"> ~</span><span class="id"> P</span><span class="id"> \/</span><span class="id"> ~</span><span class="id"> Q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> not_andE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> not_and3P</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> R</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><span class="id"> ~</span><span class="id"> [/\</span><span class="id"> P,</span><span class="id"> Q</span><span class="id"> &amp;</span><span class="id"> R]</span><span class="id"> &lt;-&gt;</span><span class="id"> [\/</span><span class="id"> ~</span><span class="id"> P,</span><span class="id"> ~</span><span class="id"> Q</span><span class="id"> |</span><span class="id"> ~</span><span class="id"> R]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split=&gt;</span><span class="id"> [/and3_asboolP|/or3_asboolP]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> 2!negb_and</span><span class="id"> -3!asbool_neg</span><span class="id"> =&gt;</span><span class="id"> /or3_asboolP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> 3!asbool_neg</span><span class="id"> -2!negb_and</span><span class="id"> =&gt;</span><span class="id"> /and3_asboolP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> notP</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><span class="id"> ~</span><span class="id"> ~</span><span class="id"> P</span><span class="id"> &lt;-&gt;</span><span class="id"> P</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> [|p];</span><span class="id"> [exact:</span><span class="id"> contrapT|exact]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> notE</span> (<span class="id">P</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="id">~</span><span class="id"> ~</span><span class="id"> P</span>)<span class="id"> =</span><span class="id"> P</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> propeqE</span><span class="id"> notP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> not_orE</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="id">~</span> (<span class="id">P</span><span class="id"> \/</span><span class="id"> Q</span>))<span class="id"> =</span><span class="id"> ~</span><span class="id"> P</span><span class="id"> /\</span><span class="id"> ~</span><span class="id"> Q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[_</span><span class="id"> /\</span><span class="id"> _]notE</span><span class="id"> not_andE</span><span class="id"> 2!notE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> not_orP</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><span class="id"> ~</span> (<span class="id">P</span><span class="id"> \/</span><span class="id"> Q</span>)<span class="id"> &lt;-&gt;</span><span class="id"> ~</span><span class="id"> P</span><span class="id"> /\</span><span class="id"> ~</span><span class="id"> Q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> not_orE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> not_implyE</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="id">~</span> (<span class="id">P</span><span class="id"> -&gt;</span><span class="id"> Q</span>))<span class="id"> =</span> (<span class="id">P</span><span class="id"> /\</span><span class="id"> ~</span><span class="id"> Q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> propeqE</span><span class="id"> not_implyP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> implyE</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="id">P</span><span class="id"> -&gt;</span><span class="id"> Q</span>)<span class="id"> =</span> (<span class="id">~</span><span class="id"> P</span><span class="id"> \/</span><span class="id"> Q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[LHS]notE</span><span class="id"> not_implyE</span><span class="id"> propeqE</span><span class="id"> not_andP</span><span class="id"> notE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> orC</span><span class="id"> :</span><span class="id"> commutative</span><span class="id"> or</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /PropB[]</span><span class="id"> /PropB[]</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> !orB</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> orA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> or</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> R;</span><span class="id"> rewrite</span><span class="id"> propeqE;</span><span class="id"> split=&gt;</span><span class="id"> [|];</span><span class="id"> tauto</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> orCA</span><span class="id"> :</span><span class="id"> left_commutative</span><span class="id"> or</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> R;</span><span class="id"> rewrite</span><span class="id"> !orA</span> (<span class="id">orC</span><span class="id"> P</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> orAC</span><span class="id"> :</span><span class="id"> right_commutative</span><span class="id"> or</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> R;</span><span class="id"> rewrite</span><span class="id"> -!orA</span> (<span class="id">orC</span><span class="id"> Q</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> orACA</span><span class="id"> :</span><span class="id"> interchange</span><span class="id"> or</span><span class="id"> or</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> R</span><span class="id"> S;</span><span class="id"> rewrite</span><span class="id"> !orA</span> (<span class="id">orAC</span><span class="id"> P</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> orNp</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> :</span> (<span class="id">~</span><span class="id"> P</span><span class="id"> \/</span><span class="id"> Q</span>)<span class="id"> =</span> (<span class="id">P</span><span class="id"> -&gt;</span><span class="id"> Q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case/PropB:</span><span class="id"> P;</span><span class="id"> rewrite</span><span class="id"> notB</span><span class="id"> orB</span><span class="id"> implyB</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> orpN</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> :</span> (<span class="id">P</span><span class="id"> \/</span><span class="id"> ~</span><span class="id"> Q</span>)<span class="id"> =</span> (<span class="id">Q</span><span class="id"> -&gt;</span><span class="id"> P</span>)<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> orC</span><span class="id"> orNp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> or3E</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> R</span><span class="id"> :</span><span class="id"> [\/</span><span class="id"> P,</span><span class="id"> Q</span><span class="id"> |</span><span class="id"> R]</span><span class="id"> =</span> (<span class="id">P</span><span class="id"> \/</span><span class="id"> Q</span><span class="id"> \/</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">asboolE</span><span class="id"> P</span>)<span class="id"> -</span>(<span class="id">asboolE</span><span class="id"> Q</span>)<span class="id"> -</span>(<span class="id">asboolE</span><span class="id"> R</span>) (<span class="id">reflect_eq</span><span class="id"> or3P</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -2!</span>(<span class="id">reflect_eq</span><span class="id"> orP</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> or4E</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> R</span><span class="id"> S</span><span class="id"> :</span><span class="id"> [\/</span><span class="id"> P,</span><span class="id"> Q,</span><span class="id"> R</span><span class="id"> |</span><span class="id"> S]</span><span class="id"> =</span> (<span class="id">P</span><span class="id"> \/</span><span class="id"> Q</span><span class="id"> \/</span><span class="id"> R</span><span class="id"> \/</span><span class="id"> S</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">asboolE</span><span class="id"> P</span>)<span class="id"> -</span>(<span class="id">asboolE</span><span class="id"> Q</span>)<span class="id"> -</span>(<span class="id">asboolE</span><span class="id"> R</span>)<span class="id"> -</span>(<span class="id">asboolE</span><span class="id"> S</span>) (<span class="id">reflect_eq</span><span class="id"> or4P</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -3!</span>(<span class="id">reflect_eq</span><span class="id"> orP</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> andC</span><span class="id"> :</span><span class="id"> commutative</span><span class="id"> and</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /PropB[]</span><span class="id"> /PropB[];</span><span class="id"> rewrite</span><span class="id"> !andB</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> andA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> and</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> R;</span><span class="id"> rewrite</span><span class="id"> propeqE;</span><span class="id"> split=&gt;</span><span class="id"> [|];</span><span class="id"> tauto</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> andCA</span><span class="id"> :</span><span class="id"> left_commutative</span><span class="id"> and</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> R;</span><span class="id"> rewrite</span><span class="id"> !andA</span> (<span class="id">andC</span><span class="id"> P</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> andAC</span><span class="id"> :</span><span class="id"> right_commutative</span><span class="id"> and</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> R;</span><span class="id"> rewrite</span><span class="id"> -!andA</span> (<span class="id">andC</span><span class="id"> Q</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> andACA</span><span class="id"> :</span><span class="id"> interchange</span><span class="id"> and</span><span class="id"> and</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> R</span><span class="id"> S;</span><span class="id"> rewrite</span><span class="id"> !andA</span> (<span class="id">andAC</span><span class="id"> P</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> and3E</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> R</span><span class="id"> :</span><span class="id"> [/\</span><span class="id"> P,</span><span class="id"> Q</span><span class="id"> &amp;</span><span class="id"> R]</span><span class="id"> =</span> (<span class="id">P</span><span class="id"> /\</span><span class="id"> Q</span><span class="id"> /\</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> eqProp=&gt;</span><span class="id"> [[]</span><span class="id"> |</span><span class="id"> [?</span><span class="id"> []]]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> and4E</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> R</span><span class="id"> S</span><span class="id"> :</span><span class="id"> [/\</span><span class="id"> P,</span><span class="id"> Q,</span><span class="id"> R</span><span class="id"> &amp;</span><span class="id"> S]</span><span class="id"> =</span> (<span class="id">P</span><span class="id"> /\</span><span class="id"> Q</span><span class="id"> /\</span><span class="id"> R</span><span class="id"> /\</span><span class="id"> S</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> eqProp=&gt;</span><span class="id"> [[]</span><span class="id"> |</span><span class="id"> [?</span><span class="id"> [?</span><span class="id"> []]]]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> and5E</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> R</span><span class="id"> S</span><span class="id"> T</span><span class="id"> :</span><span class="id"> [/\</span><span class="id"> P,</span><span class="id"> Q,</span><span class="id"> R,</span><span class="id"> S</span><span class="id"> &amp;</span><span class="id"> T]</span><span class="id"> =</span> (<span class="id">P</span><span class="id"> /\</span><span class="id"> Q</span><span class="id"> /\</span><span class="id"> R</span><span class="id"> /\</span><span class="id"> S</span><span class="id"> /\</span><span class="id"> T</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> eqProp=&gt;</span><span class="id"> [[]</span><span class="id"> |</span><span class="id"> [?</span><span class="id"> [?</span><span class="id"> [?</span><span class="id"> []]]]]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> implyNp</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> :</span> (<span class="id">~</span><span class="id"> P</span><span class="id"> -&gt;</span><span class="id"> Q</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> =</span> (<span class="id">P</span><span class="id"> \/</span><span class="id"> Q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -orNp</span><span class="id"> notK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> implypN</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="id">P</span><span class="id"> -&gt;</span><span class="id"> ~</span><span class="id"> Q</span>)<span class="id"> =</span><span class="id"> ~</span> (<span class="id">P</span><span class="id"> /\</span><span class="id"> Q</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case/PropB:</span><span class="id"> P;</span><span class="id"> rewrite</span><span class="id"> implyB</span><span class="id"> andB</span><span class="id"> ?notB</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> implyNN</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> :</span> (<span class="id">~</span><span class="id"> P</span><span class="id"> -&gt;</span><span class="id"> ~</span><span class="id"> Q</span>)<span class="id"> =</span> (<span class="id">Q</span><span class="id"> -&gt;</span><span class="id"> P</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> implyNp</span><span class="id"> orpN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> or_andr</span><span class="id"> :</span><span class="id"> right_distributive</span><span class="id"> or</span><span class="id"> and</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case/PropB=&gt;</span><span class="id"> Q</span><span class="id"> R;</span><span class="id"> rewrite</span><span class="id"> !orB</span><span class="id"> ?andB</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> or_andl</span><span class="id"> :</span><span class="id"> left_distributive</span><span class="id"> or</span><span class="id"> and</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> R;</span><span class="id"> rewrite</span><span class="id"> -!</span>(<span class="id">orC</span><span class="id"> R</span>)<span class="id"> or_andr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> and_orr</span><span class="id"> :</span><span class="id"> right_distributive</span><span class="id"> and</span><span class="id"> or</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> R;</span><span class="id"> apply/not_inj;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">not_andE,</span><span class="id"> not_orE</span>)<span class="id"> or_andr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> and_orl</span><span class="id"> :</span><span class="id"> left_distributive</span><span class="id"> and</span><span class="id"> or</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> R;</span><span class="id"> apply/not_inj;</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">not_andE,</span><span class="id"> not_orE</span>)<span class="id"> or_andl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> forallNE</span><span class="id"> {T}</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> ~</span><span class="id"> P</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> ~</span><span class="gallina-kwd"> exists</span><span class="id"> x,</span><span class="id"> P</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> propeqE;</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> [fP</span><span class="id"> [x</span><span class="id"> /fP]//|nexP</span><span class="id"> x</span><span class="id"> Px];</span><span class="id"> apply:</span><span class="id"> nexP;</span><span class="gallina-kwd"> exists</span><span class="id"> x</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> existsNE</span><span class="id"> {T}</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="gallina-kwd">exists</span><span class="id"> x,</span><span class="id"> ~</span><span class="id"> P</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> ~</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> P</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> propeqE;</span><span class="id"> split=&gt;</span><span class="id"> [[x</span><span class="id"> Px]</span><span class="id"> aP</span><span class="id"> //|NaP]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> contrapT;</span><span class="id"> rewrite</span><span class="id"> -forallNE</span><span class="id"> =&gt;</span><span class="id"> aP;</span><span class="id"> apply:</span><span class="id"> NaP</span><span class="id"> =&gt;</span><span class="id"> x;</span><span class="id"> apply:</span><span class="id"> contrapT</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> existsNP</span><span class="id"> T</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="gallina-kwd">exists</span><span class="id"> x,</span><span class="id"> ~</span><span class="id"> P</span><span class="id"> x</span>)<span class="id"> &lt;-&gt;</span><span class="id"> ~</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> P</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> existsNE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> not_existsP</span><span class="id"> T</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="gallina-kwd">exists</span><span class="id"> x,</span><span class="id"> P</span><span class="id"> x</span>)<span class="id"> &lt;-&gt;</span><span class="id"> ~</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> ~</span><span class="id"> P</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> forallNE</span><span class="id"> notK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> forallNP</span><span class="id"> T</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> ~</span><span class="id"> P</span><span class="id"> x</span>)<span class="id"> &lt;-&gt;</span><span class="id"> ~</span><span class="gallina-kwd"> exists</span><span class="id"> x,</span><span class="id"> P</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> forallNE</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> not_forallP</span><span class="id"> T</span> (<span class="id">P</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> P</span><span class="id"> x</span>)<span class="id"> &lt;-&gt;</span><span class="id"> ~</span><span class="gallina-kwd"> exists</span><span class="id"> x,</span><span class="id"> ~</span><span class="id"> P</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> existsNE</span><span class="id"> notK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exists2E</span><span class="id"> A</span><span class="id"> P</span><span class="id"> Q</span><span class="id"> :</span> (<span class="gallina-kwd">exists2</span><span class="id"> x</span><span class="id"> :</span><span class="id"> A,</span><span class="id"> P</span><span class="id"> x</span><span class="id"> &amp;</span><span class="id"> Q</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="gallina-kwd">exists</span><span class="id"> x,</span><span class="id"> P</span><span class="id"> x</span><span class="id"> /\</span><span class="id"> Q</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> eqProp=&gt;</span><span class="id"> -[x];</span><span class="id"> last</span><span class="id"> case;</span><span class="gallina-kwd"> exists</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exists2P</span><span class="id"> T</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">exists2</span><span class="id"> x,</span><span class="id"> P</span><span class="id"> x</span><span class="id"> &amp;</span><span class="id"> Q</span><span class="id"> x</span>)<span class="id"> &lt;-&gt;</span><span class="gallina-kwd"> exists</span><span class="id"> x,</span><span class="id"> P</span><span class="id"> x</span><span class="id"> /\</span><span class="id"> Q</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> exists2E</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> not_exists2P</span><span class="id"> T</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">exists2</span><span class="id"> x,</span><span class="id"> P</span><span class="id"> x</span><span class="id"> &amp;</span><span class="id"> Q</span><span class="id"> x</span>)<span class="id"> &lt;-&gt;</span><span class="id"> ~</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span><span class="id"> ~</span><span class="id"> P</span><span class="id"> x</span><span class="id"> \/</span><span class="id"> ~</span><span class="id"> Q</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> exists2P</span><span class="id"> not_existsP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> split;</span><span class="id"> apply:</span><span class="id"> contra_not</span><span class="id"> =&gt;</span><span class="id"> PQx</span><span class="id"> x;</span> <span class="id"> apply/not_andP;</span><span class="id"> apply:</span><span class="id"> PQx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> forall2NP</span><span class="id"> T</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> ~</span><span class="id"> P</span><span class="id"> x</span><span class="id"> \/</span><span class="id"> ~</span><span class="id"> Q</span><span class="id"> x</span>)<span class="id"> &lt;-&gt;</span><span class="id"> ~</span> (<span class="gallina-kwd">exists2</span><span class="id"> x,</span><span class="id"> P</span><span class="id"> x</span><span class="id"> &amp;</span><span class="id"> Q</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split=&gt;</span><span class="id"> [PQ</span><span class="id"> [t</span><span class="id"> Pt</span><span class="id"> Qt]|PQ</span><span class="id"> t];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> have</span><span class="id"> []</span><span class="id"> :=</span><span class="id"> PQ</span><span class="id"> t</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -not_andP</span><span class="id"> =&gt;</span><span class="id"> -[Pt</span><span class="id"> Qt];</span><span class="id"> apply</span><span class="id"> PQ;</span><span class="gallina-kwd"> exists</span><span class="id"> t</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> forallPNP</span><span class="id"> T</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> P</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> ~</span><span class="id"> Q</span><span class="id"> x</span>)<span class="id"> &lt;-&gt;</span><span class="id"> ~</span> (<span class="gallina-kwd">exists2</span><span class="id"> x,</span><span class="id"> P</span><span class="id"> x</span><span class="id"> &amp;</span><span class="id"> Q</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split=&gt;</span><span class="id"> [PQ</span><span class="id"> [t</span><span class="id"> Pt</span><span class="id"> Qt]|PQ</span><span class="id"> t];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> have</span><span class="id"> []</span><span class="id"> :=</span><span class="id"> PQ</span><span class="id"> t</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> Pt</span><span class="id"> Qt;</span><span class="id"> apply:</span><span class="id"> PQ;</span><span class="gallina-kwd"> exists</span><span class="id"> t</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> existsPNP</span><span class="id"> T</span> (<span class="id">P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="gallina-kwd"> Prop</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">exists2</span><span class="id"> x,</span><span class="id"> P</span><span class="id"> x</span><span class="id"> &amp;</span><span class="id"> ~</span><span class="id"> Q</span><span class="id"> x</span>)<span class="id"> &lt;-&gt;</span><span class="id"> ~</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span><span class="id"> P</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> Q</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">split=&gt;</span><span class="id"> [[x</span><span class="id"> Px</span><span class="id"> NQx]</span><span class="id"> /</span>(_<span class="id"> x</span><span class="id"> Px</span>)<span class="id">//|];</span><span class="id"> apply:</span><span class="id"> contra_notP</span><span class="id"> =&gt;</span><span class="id"> +</span><span class="id"> x</span><span class="id"> Px</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> contra_notP</span><span class="id"> =&gt;</span><span class="id"> NQx;</span><span class="gallina-kwd"> exists</span><span class="id"> x</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> forallp_asboolPn2</span><span class="id"> {T}</span><span class="id"> {P</span><span class="id"> Q</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> Prop}</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> x</span><span class="id"> :</span><span class="id"> T,</span><span class="id"> ~</span><span class="id"> P</span><span class="id"> x</span><span class="id"> \/</span><span class="id"> ~</span><span class="id"> Q</span><span class="id"> x</span>) (<span class="id">~~</span><span class="id"> `[&lt;exists2</span><span class="id"> x</span><span class="id"> :</span><span class="id"> T,</span><span class="id"> P</span><span class="id"> x</span><span class="id"> &amp;</span><span class="id"> Q</span><span class="id"> x&gt;]</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id">=&gt;</span><span class="id"> [/asboolPn</span><span class="id"> NP</span><span class="id"> x|NP]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move/forallPNP</span><span class="id"> :</span><span class="id"> NP</span><span class="id"> =&gt;</span><span class="id"> /</span>(_<span class="id"> x</span>)<span class="id">/and_rec/not_andP</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/asboolP=&gt;</span><span class="id"> -[x</span><span class="id"> Px</span><span class="id"> Qx];</span><span class="id"> have</span><span class="id"> /not_andP</span><span class="id"> :=</span><span class="id"> NP</span><span class="id"> x;</span><span class="id"> exact</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> bigmaxmin</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> max</span><span class="id"> :=</span><span class="id"> Order</span>.<span class="id">max</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span><span class="id"> min</span><span class="id"> :=</span><span class="id"> Order</span>.<span class="id">min</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> order_scope</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">d</span><span class="id"> :</span><span class="id"> Order</span>.<span class="id">disp_t</span>) (<span class="id">T</span><span class="id"> :</span><span class="id"> orderType</span><span class="id"> d</span>).<br/>
<span class="vernacular">Variables</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> T</span>) (<span class="id">I</span><span class="id"> :</span><span class="id"> finType</span>) (<span class="id">P</span><span class="id"> :</span><span class="id"> pred</span><span class="id"> I</span>) (<span class="id">m</span><span class="id"> :</span><span class="id"> T</span>) (<span class="id">F</span><span class="id"> :</span><span class="id"> I</span><span class="id"> -&gt;</span><span class="id"> T</span>).<br/>
<br/>
<span class="vernacular">Import</span><span class="id"> Order</span>.<span class="id">TTheory</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> bigmax_geP</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> \/</span><span class="gallina-kwd"> exists2</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> &amp;</span><span class="id"> m</span><span class="id"> &lt;=</span><span class="id"> F</span><span class="id"> i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span><span class="id"> &lt;=</span><span class="id"> \big[max/x]_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [|[mx|[i</span><span class="id"> Pi</span><span class="id"> mFi]]]</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> leNgt</span><span class="id"> =&gt;</span><span class="id"> /bigmax_ltP</span><span class="id"> /not_andP[/negP|];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -leNgt;</span><span class="id"> left</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> /existsNP[i</span><span class="id"> /not_implyP[Pi</span><span class="id"> /negP]];</span><span class="id"> rewrite</span><span class="id"> -leNgt;</span><span class="id"> right;</span><span class="gallina-kwd"> exists</span><span class="id"> i</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> bigmax_idl</span><span class="id"> le_max</span><span class="id"> mx</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">bigmaxD1</span><span class="id"> i</span>)<span class="id">//</span><span class="id"> le_max</span><span class="id"> mFi</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> bigmax_gtP</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="id">m</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> \/</span><span class="gallina-kwd"> exists2</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> &amp;</span><span class="id"> m</span><span class="id"> &lt;</span><span class="id"> F</span><span class="id"> i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">m</span><span class="id"> &lt;</span><span class="id"> \big[max/x]_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [|[mx|[i</span><span class="id"> Pi</span><span class="id"> mFi]]]</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> ltNge</span><span class="id"> =&gt;</span><span class="id"> /bigmax_leP</span><span class="id"> /not_andP[/negP|];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -ltNge;</span><span class="id"> left</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> /existsNP[i</span><span class="id"> /not_implyP[Pi</span><span class="id"> /negP]];</span><span class="id"> rewrite</span><span class="id"> -ltNge;</span><span class="id"> right;</span><span class="gallina-kwd"> exists</span><span class="id"> i</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> bigmax_idl</span><span class="id"> lt_max</span><span class="id"> mx</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">bigmaxD1</span><span class="id"> i</span>)<span class="id">//</span><span class="id"> lt_max</span><span class="id"> mFi</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> bigmin_leP</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="id">x</span><span class="id"> &lt;=</span><span class="id"> m</span><span class="id"> \/</span><span class="gallina-kwd"> exists2</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> &amp;</span><span class="id"> F</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">\big[min/x]_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> m</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [|[xm|[i</span><span class="id"> Pi</span><span class="id"> Fim]]]</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> leNgt</span><span class="id"> =&gt;</span><span class="id"> /bigmin_gtP</span><span class="id"> /not_andP[/negP|];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -leNgt;</span><span class="id"> left</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> /existsNP[i</span><span class="id"> /not_implyP[Pi</span><span class="id"> /negP]];</span><span class="id"> rewrite</span><span class="id"> -leNgt;</span><span class="id"> right;</span><span class="gallina-kwd"> exists</span><span class="id"> i</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> bigmin_idl</span><span class="id"> ge_min</span><span class="id"> xm</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">bigminD1</span><span class="id"> i</span>)<span class="id">//</span><span class="id"> ge_min</span><span class="id"> Fim</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> bigmin_ltP</span><span class="id"> :</span><span class="id"> reflect</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> m</span><span class="id"> \/</span><span class="gallina-kwd"> exists2</span><span class="id"> i,</span><span class="id"> P</span><span class="id"> i</span><span class="id"> &amp;</span><span class="id"> F</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> m</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">\big[min/x]_</span>(<span class="id">i</span><span class="id"> |</span><span class="id"> P</span><span class="id"> i</span>)<span class="id"> F</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> m</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [|[xm|[i</span><span class="id"> Pi</span><span class="id"> Fim]]]</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> ltNge</span><span class="id"> =&gt;</span><span class="id"> /bigmin_geP</span><span class="id"> /not_andP[/negP|];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -ltNge;</span><span class="id"> left</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> /existsNP[i</span><span class="id"> /not_implyP[Pi</span><span class="id"> /negP]];</span><span class="id"> rewrite</span><span class="id"> -ltNge;</span><span class="id"> right;</span><span class="gallina-kwd"> exists</span><span class="id"> i</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> bigmin_idl</span><span class="id"> gt_min</span><span class="id"> xm</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">bigminD1</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> Pi</span>)<span class="id"> gt_min</span><span class="id"> Fim</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> bigmaxmin</span>.<br/>
<br/>
<span class="vernacular">Module</span><span class="id"> FunOrder</span>.<br/>
<span class="vernacular">Section</span><span class="id"> FunOrder</span>.<br/>
<span class="vernacular">Import</span><span class="id"> Order</span>.<span class="id">TTheory</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">aT</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">d</span><span class="id"> :</span><span class="id"> Order</span>.<span class="id">disp_t</span>) (<span class="id">T</span><span class="id"> :</span><span class="id"> porderType</span><span class="id"> d</span>).<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> f</span><span class="id"> g</span><span class="id"> h</span><span class="id"> :</span><span class="id"> aT</span><span class="id"> -&gt;</span><span class="id"> T</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fun_display</span><span class="id"> :</span><span class="id"> Order</span>.<span class="id">disp_t</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> exact:</span><span class="id"> Order</span>.<span class="id">default_display</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> lef</span><span class="id"> f</span><span class="id"> g</span><span class="id"> :=</span><span class="id"> `[&lt;</span><span class="gallina-kwd"> forall</span><span class="id"> x,</span> (<span class="id">f</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> g</span><span class="id"> x</span>)<span class="id">%O</span><span class="id"> &gt;]</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;f &lt;= g&quot;</span><span class="id"> :=</span> (<span class="id">lef</span><span class="id"> f</span><span class="id"> g</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> ltf</span><span class="id"> f</span><span class="id"> g</span><span class="id"> :=</span><span class="id"> `[&lt;</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span> (<span class="id">f</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> g</span><span class="id"> x</span>)<span class="id">%O</span>)<span class="id"> /\</span><span class="gallina-kwd"> exists</span><span class="id"> x,</span><span class="id"> f</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> g</span><span class="id"> x</span><span class="id"> &gt;]</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;f &lt; g&quot;</span><span class="id"> :=</span> (<span class="id">ltf</span><span class="id"> f</span><span class="id"> g</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltf_def</span><span class="id"> f</span><span class="id"> g</span><span class="id"> :</span> (<span class="id">f</span><span class="id"> &lt;</span><span class="id"> g</span>)<span class="id"> =</span> (<span class="id">g</span><span class="id"> !=</span><span class="id"> f</span>)<span class="id"> &amp;&amp;</span> (<span class="id">f</span><span class="id"> &lt;=</span><span class="id"> g</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/idP/andP</span><span class="id"> =&gt;</span><span class="id"> [fg|[gf</span><span class="id"> fg]];</span><span class="id"> [split|apply/asboolP;</span><span class="id"> split;</span><span class="id"> [exact/asboolP|]]</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> apply/eqP</span><span class="id"> =&gt;</span><span class="id"> gf;</span><span class="id"> move:</span><span class="id"> fg</span><span class="id"> =&gt;</span><span class="id"> /asboolP[fg]</span><span class="id"> [x</span><span class="id"> /eqP];</span><span class="id"> apply;</span><span class="id"> rewrite</span><span class="id"> gf</span>.<br/>
<span class="id">-</span><span class="id"> apply/asboolP</span><span class="id"> =&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> le_eqVlt;</span><span class="id"> move/asboolP</span><span class="id"> :</span><span class="id"> fg</span><span class="id"> =&gt;</span><span class="id"> [fg</span><span class="id"> [y</span><span class="id"> gfy]]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> [//|gfx</span><span class="id"> /=]</span><span class="id"> :=</span><span class="id"> boolP</span> (<span class="id">f</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> g</span><span class="id"> x</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> lt_neqAle</span><span class="id"> gfx</span><span class="id"> /=</span><span class="id"> fg</span>.<br/>
<span class="id">-</span><span class="id"> apply/not_existsP</span><span class="id"> =&gt;</span><span class="id"> h</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> :</span><span class="id"> f</span><span class="id"> =1</span><span class="id"> g</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> have</span><span class="id"> /negP/negPn/eqP</span><span class="id"> :=</span><span class="id"> h</span><span class="id"> x</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -funeqE;</span><span class="id"> apply/nesym/eqP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> lef_refl</span><span class="id"> :</span><span class="id"> reflexive</span><span class="id"> lef</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f;</span><span class="id"> apply/asboolP</span><span class="id"> =&gt;</span><span class="id"> x</span>. Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> lef_anti</span><span class="id"> :</span><span class="id"> antisymmetric</span><span class="id"> lef</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> f</span><span class="id"> g</span><span class="id"> =&gt;</span><span class="id"> /andP[/asboolP</span><span class="id"> fg</span><span class="id"> /asboolP</span><span class="id"> gf];</span><span class="id"> rewrite</span><span class="id"> funeqE</span><span class="id"> =&gt;</span><span class="id"> x</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/eqP;</span><span class="id"> rewrite</span><span class="id"> eq_le</span><span class="id"> fg</span><span class="id"> gf</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> lef_trans</span><span class="id"> :</span><span class="id"> transitive</span><span class="id"> lef</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> g</span><span class="id"> f</span><span class="id"> h</span><span class="id"> /asboolP</span><span class="id"> fg</span><span class="id"> /asboolP</span><span class="id"> gh;</span><span class="id"> apply/asboolP</span><span class="id"> =&gt;</span><span class="id"> x</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">le_trans</span> (<span class="id">fg</span><span class="id"> x</span>)).<br/>
Qed.</div></details>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> @Order</span>.<span class="id">isPOrder</span>.<span class="id">Build</span><br/>
&nbsp;&nbsp;<span class="id">fun_display</span> (<span class="id">aT</span><span class="id"> -&gt;</span><span class="id"> T</span>)<span class="id"> lef</span><span class="id"> ltf</span><span class="id"> ltf_def</span><span class="id"> lef_refl</span><span class="id"> lef_anti</span><span class="id"> lef_trans</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> FunOrder</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> FunLattice</span>.<br/>
<span class="vernacular">Import</span><span class="id"> Order</span>.<span class="id">TTheory</span>.<br/>
<span class="vernacular">Variables</span> (<span class="id">aT</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>) (<span class="id">d</span><span class="id"> :</span><span class="id"> Order</span>.<span class="id">disp_t</span>) (<span class="id">T</span><span class="id"> :</span><span class="id"> latticeType</span><span class="id"> d</span>).<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> f</span><span class="id"> g</span><span class="id"> h</span><span class="id"> :</span><span class="id"> aT</span><span class="id"> -&gt;</span><span class="id"> T</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> meetf</span><span class="id"> f</span><span class="id"> g</span><span class="id"> :=</span><span class="gallina-kwd"> fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> Order</span>.<span class="id">meet</span> (<span class="id">f</span><span class="id"> x</span>) (<span class="id">g</span><span class="id"> x</span>).<br/>
<span class="vernacular">Definition</span><span class="id"> joinf</span><span class="id"> f</span><span class="id"> g</span><span class="id"> :=</span><span class="gallina-kwd"> fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> Order</span>.<span class="id">join</span> (<span class="id">f</span><span class="id"> x</span>) (<span class="id">g</span><span class="id"> x</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> meetfC</span><span class="id"> :</span><span class="id"> commutative</span><span class="id"> meetf</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> move=&gt;</span><span class="id"> f</span><span class="id"> g;</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> x;</span><span class="id"> exact:</span><span class="id"> meetC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> joinfC</span><span class="id"> :</span><span class="id"> commutative</span><span class="id"> joinf</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> move=&gt;</span><span class="id"> f</span><span class="id"> g;</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> x;</span><span class="id"> exact:</span><span class="id"> joinC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> meetfA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> meetf</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> move=&gt;</span><span class="id"> f</span><span class="id"> g</span><span class="id"> h;</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> x;</span><span class="id"> exact:</span><span class="id"> meetA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> joinfA</span><span class="id"> :</span><span class="id"> associative</span><span class="id"> joinf</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> move=&gt;</span><span class="id"> f</span><span class="id"> g</span><span class="id"> h;</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> x;</span><span class="id"> exact:</span><span class="id"> joinA</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> joinfKI</span><span class="id"> g</span><span class="id"> f</span><span class="id"> :</span><span class="id"> meetf</span><span class="id"> f</span> (<span class="id">joinf</span><span class="id"> f</span><span class="id"> g</span>)<span class="id"> =</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> x;</span><span class="id"> exact:</span><span class="id"> joinKI</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> meetfKU</span><span class="id"> g</span><span class="id"> f</span><span class="id"> :</span><span class="id"> joinf</span><span class="id"> f</span> (<span class="id">meetf</span><span class="id"> f</span><span class="id"> g</span>)<span class="id"> =</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> x;</span><span class="id"> exact:</span><span class="id"> meetKU</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lef_meet</span><span class="id"> f</span><span class="id"> g</span><span class="id"> :</span> (<span class="id">f</span><span class="id"> &lt;=</span><span class="id"> g</span>)<span class="id">%O</span><span class="id"> =</span> (<span class="id">meetf</span><span class="id"> f</span><span class="id"> g</span><span class="id"> ==</span><span class="id"> f</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/idP/idP</span><span class="id"> =&gt;</span><span class="id"> [/asboolP</span><span class="id"> f_le_g|/eqP</span><span class="id"> &lt;-]</span>.<br/>
<span class="id">-</span><span class="id"> apply/eqP/funext</span><span class="id"> =&gt;</span><span class="id"> x;</span><span class="id"> exact/meet_l/f_le_g</span>.<br/>
<span class="id">-</span><span class="id"> apply/asboolP</span><span class="id"> =&gt;</span><span class="id"> x;</span><span class="id"> exact:</span><span class="id"> leIr</span>.<br/>
Qed.</div></details>
<br/>
<span class="id">#[export]</span><br/>
<span class="id">HB</span>.<span class="id">instance</span><span class="vernacular"> Definition</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> Order</span>.<span class="id">POrder_isLattice</span>.<span class="id">Build</span><span class="id"> _</span> (<span class="id">aT</span><span class="id"> -&gt;</span><span class="id"> T</span>)<br/>
&nbsp;&nbsp;<span class="id">meetfC</span><span class="id"> joinfC</span><span class="id"> meetfA</span><span class="id"> joinfA</span><span class="id"> joinfKI</span><span class="id"> meetfKU</span><span class="id"> lef_meet</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> FunLattice</span>.<br/>
<span class="vernacular">Module</span><span class="vernacular"> Exports</span>.<br/>
<span class="id">HB</span>.<span class="id">reexport</span>.<br/>
<span class="vernacular">End</span><span class="vernacular"> Exports</span>.<br/>
<span class="vernacular">End</span><span class="id"> FunOrder</span>.<br/>
<span class="vernacular">Export</span><span class="id"> FunOrder</span>.<span class="vernacular">Exports</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lefP</span> (<span class="id">aT</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>)<span class="id"> d</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> porderType</span><span class="id"> d</span>) (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> aT</span><span class="id"> -&gt;</span><span class="id"> T</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">reflect</span> (<span class="gallina-kwd">forall</span><span class="id"> x,</span> (<span class="id">f</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> g</span><span class="id"> x</span>)<span class="id">%O</span>) (<span class="id">f</span><span class="id"> &lt;=</span><span class="id"> g</span>)<span class="id">%O</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span> (<span class="id">iffP</span><span class="id"> idP</span>)<span class="id"> =&gt;</span><span class="id"> [fg|fg];</span><span class="id"> [exact/asboolP</span><span class="id"> |</span><span class="id"> exact/asboolP]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> meetfE</span> (<span class="id">aT</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>)<span class="id"> d</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> latticeType</span><span class="id"> d</span>) (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> aT</span><span class="id"> -&gt;</span><span class="id"> T</span>)<span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;((<span class="id">f</span><span class="id"> `&amp;`</span><span class="id"> g</span>)<span class="id"> x</span><span class="id"> =</span><span class="id"> f</span><span class="id"> x</span><span class="id"> `&amp;`</span><span class="id"> g</span><span class="id"> x</span>)<span class="id">%O</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> joinfE</span> (<span class="id">aT</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>)<span class="id"> d</span> (<span class="id">T</span><span class="id"> :</span><span class="id"> latticeType</span><span class="id"> d</span>) (<span class="id">f</span><span class="id"> g</span><span class="id"> :</span><span class="id"> aT</span><span class="id"> -&gt;</span><span class="id"> T</span>)<span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;((<span class="id">f</span><span class="id"> `|`</span><span class="id"> g</span>)<span class="id"> x</span><span class="id"> =</span><span class="id"> f</span><span class="id"> x</span><span class="id"> `|`</span><span class="id"> g</span><span class="id"> x</span>)<span class="id">%O</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> iterfS</span><span class="id"> {T}</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> T</span>) (<span class="id">n</span><span class="id"> :</span><span class="id"> nat</span>)<span class="id"> :</span><span class="id"> iter</span><span class="id"> n</span>.<span class="id">+1</span><span class="id"> f</span><span class="id"> =</span><span class="id"> f</span><span class="id"> \o</span><span class="id"> iter</span><span class="id"> n</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> iterfSr</span><span class="id"> {T}</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> T</span>) (<span class="id">n</span><span class="id"> :</span><span class="id"> nat</span>)<span class="id"> :</span><span class="id"> iter</span><span class="id"> n</span>.<span class="id">+1</span><span class="id"> f</span><span class="id"> =</span><span class="id"> iter</span><span class="id"> n</span><span class="id"> f</span><span class="id"> \o</span><span class="id"> f</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/funeqP</span><span class="id"> =&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> iterSr</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> iter0</span><span class="id"> {T}</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> T</span>)<span class="id"> :</span><span class="id"> iter</span><span class="id"> 0</span><span class="id"> f</span><span class="id"> =</span><span class="id"> id</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Section</span><span class="id"> Inhabited</span>.<br/>
<span class="vernacular">Variable</span> (<span class="id">T</span><span class="id"> :</span><span class="gallina-kwd"> Type</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> inhabitedE:</span><span class="id"> inhabited</span><span class="id"> T</span><span class="id"> =</span><span class="gallina-kwd"> exists</span><span class="id"> x</span><span class="id"> :</span><span class="id"> T,</span><span class="id"> True</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> eqProp;</span><span class="id"> case</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> inhabited_witness:</span><span class="id"> inhabited</span><span class="id"> T</span><span class="id"> -&gt;</span><span class="id"> T</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> inhabitedE</span><span class="id"> =&gt;</span><span class="id"> /cid[]</span>. Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> Inhabited</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> uncurryK</span><span class="id"> {X</span><span class="id"> Y</span><span class="id"> Z</span><span class="id"> :</span><span class="id"> Type}</span><span class="id"> :</span><span class="id"> cancel</span> (<span class="id">@uncurry</span><span class="id"> X</span><span class="id"> Y</span><span class="id"> Z</span>)<span class="id"> curry</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f;</span><span class="id"> rewrite</span><span class="id"> funeq2E</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> curryK</span><span class="id"> {X</span><span class="id"> Y</span><span class="id"> Z</span><span class="id"> :</span><span class="id"> Type}</span><span class="id"> :</span><span class="id"> cancel</span><span class="id"> curry</span> (<span class="id">@uncurry</span><span class="id"> X</span><span class="id"> Y</span><span class="id"> Z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> f;</span><span class="id"> rewrite</span><span class="id"> funeqE=&gt;</span><span class="id"> -[]</span>. Qed.</div></details>

      <div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/">a fork of coq2html</a></div>
    </div>
  </div>
    </main>
</body>
</html>
