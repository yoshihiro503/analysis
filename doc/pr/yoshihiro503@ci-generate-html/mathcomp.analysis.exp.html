
<!DOCTYPE html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module mathcomp.analysis.exp</title>
<meta name="description" content="Documentation of Coq module mathcomp.analysis.exp" />
<link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<script src="https://cdn.jsdelivr.net/npm/markdown-it/dist/markdown-it.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/markdown-it-texmath/texmath.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="init()">

  <main>
    <div class="sidebar">
      <h2>Files</h2>
      
    </div>

  <div class="coq">

    <div class="content">
      <p><a href="./index.html">Top</a></p>
      <h1 class="title">Module mathcomp.analysis.exp</h1>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> all_ssreflect</span><span class="id"> ssralg</span><span class="id"> ssrint</span><span class="id"> ssrnum</span><span class="id"> matrix</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> interval</span><span class="id"> rat</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> boolp</span><span class="id"> classical_sets</span><span class="id"> functions</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> mathcomp_extra</span><span class="id"> reals</span><span class="id"> ereal</span><span class="id"> signed</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> topology</span><span class="id"> tvs</span><span class="id"> normedtype</span><span class="id"> landau</span><span class="id"> sequences</span><span class="id"> derive</span>.<br/>
<span class="vernacular">From</span><span class="id"> mathcomp</span><span class="vernacular"> Require</span><span class="vernacular"> Import</span><span class="id"> realfun</span><span class="id"> itv</span><span class="id"> convex</span>.<br/>
<br/>
<div class="ssrdoc md">
# Theory of exponential/logarithm functions

This file defines exponential and logarithm functions and develops their
theory.

## Differentiability of series (Section PseriesDiff)

This formalization is inspired by HOL-Light (transc.ml). This part is
temporary: it should be subsumed by a proper theory of power series.
```
        pseries f x == [series f n * x ^ n]_n
  pseries_diffs f i == (i + 1) * f (i + 1)

            expeR x == extended real number-valued exponential function
               ln x == the natural logarithm
             s `^ r == power function, in ring_scope (assumes s &gt;= 0)
             e `^ r == power function, in ereal_scope (assumes e &gt;= 0)
         riemannR a == sequence n |-&gt; 1 / (n.+1) `^ a where a has a type
                       of type realType
      e `^?(r +? s) == validity condition for the distributivity of
                       the power of the addition, in ereal_scope
```

</div>
<br/>
<span class="gallina-kwd">Set</span><span class="vernacular"> Implicit</span><span class="vernacular"> Arguments</span>.<br/>
<span class="vernacular">Unset</span><span class="vernacular"> Strict</span><span class="vernacular"> Implicit</span>.<br/>
<span class="vernacular">Unset</span><span class="vernacular"> Printing</span><span class="vernacular"> Implicit</span><span class="vernacular"> Defensive</span>.<br/>
<span class="vernacular">Import</span><span class="id"> Order</span>.<span class="id">TTheory</span><span class="id"> GRing</span>.<span class="id">Theory</span><span class="id"> Num</span>.<span class="id">Def</span><span class="id"> Num</span>.<span class="id">Theory</span>.<br/>
<span class="vernacular">Import</span><span class="id"> numFieldNormedType</span>.<span class="vernacular">Exports</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> classical_set_scope</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Reserved</span><span class="vernacular"> Notation</span> <span class="id">&quot;x '`^?' ( r +? s )&quot;</span><br/>
&nbsp;(<span class="id">format</span> <span class="id">&quot;x  '`^?' ( r  +?  s )&quot;</span><span class="id">,</span><span class="id"> r</span><span class="gallina-kwd"> at</span><span class="id"> next</span><span class="id"> level,</span><span class="gallina-kwd"> at</span><span class="id"> level</span><span class="id"> 11</span>) .<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> normr_nneg</span> (<span class="id">R</span><span class="id"> :</span><span class="id"> numDomainType</span>) (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> `|x|</span><span class="id"> \is</span><span class="id"> Num</span>.<span class="id">nneg</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> qualifE/=</span>. Qed.</div></details>
<span class="id">#[global]</span><span class="vernacular"> Hint</span><span class="id"> Extern</span><span class="id"> 0</span> (<span class="id">is_true</span> (<span class="id">@Num</span>.<span class="id">norm</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span><span class="id"> \is</span><span class="id"> Num</span>.<span class="id">nneg</span>))<span class="id"> =&gt;</span><br/>
&nbsp;&nbsp;<span class="id">solve</span><span class="id"> [apply:</span><span class="id"> normr_nneg]</span><span class="id"> :</span><span class="id"> core</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> PseriesDiff</span>.<br/>
<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> realType</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> pseries</span><span class="id"> f</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :=</span><span class="id"> [series</span><span class="id"> f</span><span class="id"> i</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> i]_i</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> is_cvg_pseries_inside_norm</span><span class="id"> f</span> (<span class="id">x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cvgn</span> (<span class="id">pseries</span><span class="id"> f</span><span class="id"> x</span>)<span class="id"> -&gt;</span><span class="id"> `|z|</span><span class="id"> &lt;</span><span class="id"> `|x|</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">cvgn</span> (<span class="id">pseries</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> `|f</span><span class="id"> i|</span>)<span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Cx</span><span class="id"> zLx;</span><span class="id"> have</span><span class="id"> [K</span><span class="id"> [Kreal</span><span class="id"> Kf]]</span><span class="id"> :=</span><span class="id"> cvg_series_bounded</span><span class="id"> Cx</span>.<br/>
<span class="id">have</span><span class="id"> Kzxn</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> `|K</span><span class="id"> +</span><span class="id"> 1|</span><span class="id"> *</span><span class="id"> `|z</span><span class="id"> ^+</span><span class="id"> n|</span><span class="id"> /</span><span class="id"> `|x</span><span class="id"> ^+</span><span class="id"> n|</span> <span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !mulr_ge0</span>.<br/>
<span class="id">apply:</span><span class="id"> normed_cvg</span>.<br/>
<span class="id">apply:</span><span class="id"> series_le_cvg</span><span class="id"> Kzxn</span><span class="id"> _</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> [//=|</span><span class="id"> /=</span><span class="id"> n|]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (_<span class="id"> :</span><span class="id"> `|_</span><span class="id"> *</span><span class="id"> _|</span><span class="id"> =</span><span class="id"> `|f</span><span class="id"> n</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n|</span><span class="id"> *</span><span class="id"> `|z</span><span class="id"> ^+</span><span class="id"> n|</span><span class="id"> /</span><span class="id"> `|x</span><span class="id"> ^+</span><span class="id"> n|</span>)<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> !normrM</span><span class="id"> normr_id</span><span class="id"> mulrAC</span><span class="id"> mulfK</span><span class="id"> //</span><span class="id"> normr_eq0</span><span class="id"> expf_eq0</span><span class="id"> andbC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> ltrgt0P</span><span class="id"> zLx;</span><span class="id"> rewrite</span><span class="id"> //=</span><span class="id"> normr_lt0</span>.<br/>
&nbsp;&nbsp;<span class="id">do!</span> (<span class="id">apply:</span><span class="id"> ler_pM</span><span class="id"> ||</span><span class="id"> apply:</span><span class="id"> mulr_ge0</span><span class="id"> ||</span><span class="id"> rewrite</span><span class="id"> invr_ge0</span>)<span class="id"> =&gt;</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply</span><span class="id"> Kf</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span> (<span class="id">lt_le_trans</span><span class="id"> _</span> (<span class="id">ler_norm</span><span class="id"> _</span>))<span class="id">//</span><span class="id"> ltrDl</span>.<br/>
<span class="id">have</span><span class="id"> F</span><span class="id"> :</span><span class="id"> `|z</span><span class="id"> /</span><span class="id"> x|</span><span class="id"> &lt;</span><span class="id"> 1</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> normrM</span><span class="id"> normfV</span><span class="id"> ltr_pdivrMr</span><span class="id"> ?mul1r</span><span class="id"> //</span> (<span class="id">le_lt_trans</span><span class="id"> _</span><span class="id"> zLx</span>).<br/>
<span class="id">rewrite</span> (_<span class="id"> :</span> (<span class="gallina-kwd">fun</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> _</span>)<span class="id"> =</span><span class="id"> geometric</span><span class="id"> `|K</span><span class="id"> +</span><span class="id"> 1|</span><span class="id"> `|z</span><span class="id"> /</span><span class="id"> x|</span>)<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> normrM</span><span class="id"> exprMn</span><span class="id"> mulrA</span><span class="id"> normfV</span><span class="id"> !normrX</span><span class="id"> exprVn</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> is_cvg_geometric_series;</span><span class="id"> rewrite</span><span class="id"> normr_id</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Fact</span><span class="id"> is_cvg_pseries_inside</span><span class="id"> f</span> (<span class="id">x</span><span class="id"> z</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">cvgn</span> (<span class="id">pseries</span><span class="id"> f</span><span class="id"> x</span>)<span class="id"> -&gt;</span><span class="id"> `|z|</span><span class="id"> &lt;</span><span class="id"> `|x|</span><span class="id"> -&gt;</span><span class="id"> cvgn</span> (<span class="id">pseries</span><span class="id"> f</span><span class="id"> z</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Cx</span><span class="id"> zLx</span>.<br/>
<span class="id">apply:</span><span class="id"> normed_cvg;</span><span class="id"> rewrite</span><span class="id"> /normed_series_of</span><span class="id"> /=</span>.<br/>
<span class="id">rewrite</span> (_<span class="id"> :</span> (<span class="gallina-kwd">fun</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> _</span>)<span class="id"> =</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> `|f</span><span class="id"> i|</span><span class="id"> *</span><span class="id"> `|z|</span><span class="id"> ^+</span><span class="id"> i</span>))<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> normrM</span><span class="id"> normrX</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> is_cvg_pseries_inside_norm</span><span class="id"> Cx</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> normr_id</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> pseries_diffs</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> i</span><span class="id"> :=</span><span class="id"> i</span>.<span class="id">+1%:R</span><span class="id"> *</span><span class="id"> f</span><span class="id"> i</span>.<span class="id">+1</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pseries_diffsN</span> (<span class="id">f</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> -&gt;</span><span class="id"> R</span>)<span class="id"> :</span> <span class="id"> pseries_diffs</span> (<span class="id">-</span><span class="id"> f</span>)<span class="id"> =</span><span class="id"> -</span>(<span class="id">pseries_diffs</span><span class="id"> f</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> /pseries_diffs</span><span class="id"> /=</span><span class="id"> -mulrN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pseries_diffs_inv_fact</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">pseries_diffs</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span> (<span class="id">n`!%:R</span>)<span class="id">^-1</span>)<span class="id"> =</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span> (<span class="id">n`!%:R</span>)<span class="id">^-1</span><span class="id"> :</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/funext</span><span class="id"> =&gt;</span><span class="id"> i</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /pseries_diffs</span><span class="id"> factS</span><span class="id"> natrM</span><span class="id"> invfM</span><span class="id"> mulrA</span><span class="id"> mulfV</span><span class="id"> ?mul1r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pseries_diffs_sumE</span><span class="id"> n</span><span class="id"> f</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>) <span class="id"> pseries_diffs</span><span class="id"> f</span><span class="id"> i</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> i</span><span class="id"> =</span><br/>
&nbsp;&nbsp;(<span class="id">\sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id"> i%:R</span><span class="id"> *</span><span class="id"> f</span><span class="id"> i</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> i</span>.<span class="id">-1</span>)<span class="id"> +</span><span class="id"> n%:R</span><span class="id"> *</span><span class="id"> f</span><span class="id"> n</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<span class="id">-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !big_nil</span><span class="id"> !mul0r</span><span class="id"> add0r</span>.<br/>
<span class="id">under</span><span class="id"> eq_bigr</span><span class="id"> do</span><span class="id"> unfold</span><span class="id"> pseries_diffs</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> big_nat_recr</span><span class="id"> //=</span><span class="id"> big_nat_recl</span><span class="id"> //=</span><span class="id"> !mul0r</span><span class="id"> add0r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pseries_diffs_equiv</span><span class="id"> f</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">let</span><span class="id"> s</span><span class="id"> i</span><span class="id"> :=</span><span class="id"> i%:R</span><span class="id"> *</span><span class="id"> f</span><span class="id"> i</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> i</span>.<span class="id">-1</span><span class="gallina-kwd"> in</span><br/>
&nbsp;&nbsp;<span class="id">cvgn</span> (<span class="id">pseries</span> (<span class="id">pseries_diffs</span><span class="id"> f</span>)<span class="id"> x</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">series</span><span class="id"> s</span><span class="id"> @</span><span class="id"> \oo</span><span class="id"> --&gt;</span><span class="id"> limn</span> (<span class="id">pseries</span> (<span class="id">pseries_diffs</span><span class="id"> f</span>)<span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> s</span><span class="id"> Cx;</span><span class="id"> rewrite</span><span class="id"> -[lim</span><span class="id"> _]subr0</span>.<br/>
<span class="id">rewrite</span><span class="id"> /pseries/=</span><span class="id"> [X</span><span class="gallina-kwd"> in</span><span class="id"> X</span><span class="id"> @</span><span class="id"> \oo</span><span class="id"> --&gt;</span><span class="id"> _]/series</span><span class="id"> /=</span>.<br/>
<span class="id">rewrite</span><span class="id"> [X</span><span class="gallina-kwd"> in</span><span class="id"> X</span><span class="id"> @</span><span class="id"> \oo</span><span class="id"> --&gt;</span><span class="id"> _]</span>(_<span class="id"> :</span><span class="id"> _</span><span class="id"> =</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> \sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pseries_diffs</span><span class="id"> f</span><span class="id"> i</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> i</span><span class="id"> -</span><span class="id"> n%:R</span><span class="id"> *</span><span class="id"> f</span><span class="id"> n</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<span class="id">-1</span>))<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> funeqE</span><span class="id"> =&gt;</span><span class="id"> n;</span><span class="id"> rewrite</span><span class="id"> pseries_diffs_sumE</span><span class="id"> addrK</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> cvgB</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> -cvg_shiftS;</span><span class="id"> exact:</span><span class="id"> cvg_series_cvg_0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> is_cvg_pseries_diffs_equiv</span><span class="id"> f</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cvgn</span> (<span class="id">pseries</span> (<span class="id">pseries_diffs</span><span class="id"> f</span>)<span class="id"> x</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">cvgn</span> (<span class="id">[series</span><span class="id"> i%:R</span><span class="id"> *</span><span class="id"> f</span><span class="id"> i</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> i</span>.<span class="id">-1]_i</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> Cx;</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> pseries_diffs_equiv</span><span class="id"> Cx;</span><span class="id"> move/</span>(<span class="id">cvg_lim</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> -&gt;</span><span class="id"> //</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> pseries_diffs_P1</span><span class="id"> m</span> (<span class="id">z</span><span class="id"> h</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> m</span>) ((<span class="id">h</span><span class="id"> +</span><span class="id"> z</span>)<span class="id"> ^+</span> (<span class="id">m</span><span class="id"> -</span><span class="id"> i</span>)<span class="id"> *</span><span class="id"> z</span><span class="id"> ^+</span><span class="id"> i</span><span class="id"> -</span><span class="id"> z</span><span class="id"> ^+</span><span class="id"> m</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> m</span>)<span class="id"> z</span><span class="id"> ^+</span><span class="id"> i</span><span class="id"> *</span> ((<span class="id">h</span><span class="id"> +</span><span class="id"> z</span>)<span class="id"> ^+</span> (<span class="id">m</span><span class="id"> -</span><span class="id"> i</span>)<span class="id"> -</span><span class="id"> z</span><span class="id"> ^+</span> (<span class="id">m</span><span class="id"> -</span><span class="id"> i</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> !big_mkord;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrDr</span><span class="id"> mulrN</span><span class="id"> -exprD</span><span class="id"> mulrC</span><span class="id"> addnC</span><span class="id"> subnK</span><span class="id"> //</span><span class="id"> ltnW</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> pseries_diffs_P2</span><span class="id"> n</span> (<span class="id">z</span><span class="id"> h</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">h</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;((<span class="id">h</span><span class="id"> +</span><span class="id"> z</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> -</span> (<span class="id">z</span><span class="id"> ^+</span><span class="id"> n</span>))<span class="id"> /</span><span class="id"> h</span><span class="id"> -</span><span class="id"> n%:R</span><span class="id"> *</span><span class="id"> z</span><span class="id"> ^+</span><span class="id"> n</span>.<span class="id">-1</span><span class="id"> =</span><br/>
&nbsp;&nbsp;<span class="id">h</span><span class="id"> *</span><span class="id"> \sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>.<span class="id">-1</span>)<span class="id"> z</span><span class="id"> ^+</span><span class="id"> i</span><span class="id"> *</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">\sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> j</span><span class="id"> &lt;</span><span class="id"> n</span>.<span class="id">-1</span><span class="id"> -</span><span class="id"> i</span>) (<span class="id">h</span><span class="id"> +</span><span class="id"> z</span>)<span class="id"> ^+</span><span class="id"> j</span><span class="id"> *</span><span class="id"> z</span><span class="id"> ^+</span> (<span class="id">n</span>.<span class="id">-2</span><span class="id"> -</span><span class="id"> i</span><span class="id"> -</span><span class="id"> j</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> hNZ;</span><span class="id"> apply:</span> (<span class="id">mulfI</span><span class="id"> hNZ</span>).<br/>
<span class="id">rewrite</span><span class="id"> mulrBr</span><span class="id"> mulrC</span><span class="id"> divfK</span><span class="id"> //</span>.<br/>
<span class="id">case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !expr0</span><span class="id"> !</span>(<span class="id">mul0r,</span><span class="id"> mulr0,</span><span class="id"> subr0,</span><span class="id"> subrr,</span><span class="id"> big_geq</span>).<br/>
<span class="id">rewrite</span><span class="id"> subrXX</span><span class="id"> addrK</span><span class="id"> -mulrBr;</span><span class="id"> congr</span> (_<span class="id"> *</span><span class="id"> _</span>).<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">big_mkord</span><span class="id"> xpredT</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span> (<span class="id">h</span><span class="id"> +</span><span class="id"> z</span>)<span class="id"> ^+</span> (<span class="id">n</span><span class="id"> -</span><span class="id"> i</span>)<span class="id"> *</span><span class="id"> z</span><span class="id"> ^+</span><span class="id"> i</span>)).<br/>
<span class="id">rewrite</span><span class="id"> big_nat_recr</span><span class="id"> //=</span><span class="id"> subnn</span><span class="id"> expr0</span><span class="id"> -addrA</span><span class="id"> -mulrBl</span>.<br/>
<span class="id">rewrite</span><span class="id"> -nat1r</span><span class="id"> opprD</span><span class="id"> addrA</span><span class="id"> subrr</span><span class="id"> sub0r</span><span class="id"> mulNr</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulr_natl</span><span class="id"> -[in</span><span class="id"> X</span><span class="gallina-kwd"> in</span><span class="id"> _</span><span class="id"> *+</span><span class="id"> X]</span>(<span class="id">subn0</span><span class="id"> n</span>)<span class="id"> -sumr_const_nat</span><span class="id"> -sumrB</span>.<br/>
<span class="id">rewrite</span><span class="id"> pseries_diffs_P1</span><span class="id"> mulr_sumr</span><span class="id"> !big_mkord;</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> _</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulrCA;</span><span class="id"> congr</span> (_<span class="id"> *</span><span class="id"> _</span>).<br/>
<span class="id">rewrite</span><span class="id"> subrXX</span><span class="id"> addrK</span><span class="id"> big_nat_rev</span><span class="id"> /=</span><span class="id"> big_mkord;</span><span class="id"> congr</span> (_<span class="id"> *</span><span class="id"> _</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> eq_bigr</span><span class="id"> =&gt;</span><span class="id"> k</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> -!predn_sub</span><span class="id"> subKn</span><span class="id"> //</span><span class="id"> -subnS</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Let</span><span class="id"> pseries_diffs_P3</span> (<span class="id">z</span><span class="id"> h</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> n</span><span class="id"> K</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">h</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> `|z|</span><span class="id"> &lt;=</span><span class="id"> K</span><span class="id"> -&gt;</span><span class="id"> `|h</span><span class="id"> +</span><span class="id"> z|</span><span class="id"> &lt;=</span><span class="id"> K</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">`|</span>((<span class="id">h</span><span class="id"> +z</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> -</span><span class="id"> z</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> /</span><span class="id"> h</span><span class="id"> -</span><span class="id"> n%:R</span><span class="id"> *</span><span class="id"> z</span><span class="id"> ^+</span><span class="id"> n</span>.<span class="id">-1|</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">&lt;=</span><span class="id"> n%:R</span><span class="id"> *</span><span class="id"> n</span>.<span class="id">-1%:R</span><span class="id"> *</span><span class="id"> K</span><span class="id"> ^+</span><span class="id"> n</span>.<span class="id">-2</span><span class="id"> *</span><span class="id"> `|h|</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> hNZ</span><span class="id"> zLK</span><span class="id"> zhLk</span>.<br/>
<span class="id">rewrite</span><span class="id"> pseries_diffs_P2//</span><span class="id"> normrM</span><span class="id"> mulrC</span>.<br/>
<span class="id">rewrite</span><span class="id"> ler_pM2r</span><span class="id"> ?normr_gt0//</span>.<br/>
<span class="id">rewrite</span> (<span class="id">le_trans</span> (<span class="id">ler_norm_sum</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>))<span class="id">//</span>.<br/>
<span class="id">rewrite</span><span class="id"> -mulrA</span><span class="id"> mulrC</span><span class="id"> -mulrA</span><span class="id"> mulr_natl</span><span class="id"> -[X</span><span class="gallina-kwd"> in</span><span class="id"> _</span><span class="id"> *+</span><span class="id"> X]subn0</span><span class="id"> -sumr_const_nat</span>.<br/>
<span class="id">apply</span><span class="id"> ler_sum_nat</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> /=</span>.<br/>
<span class="id">case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> n</span><span class="id"> ni</span>.<br/>
<span class="id">rewrite</span><span class="id"> normrM</span>.<br/>
<span class="id">pose</span><span class="id"> d</span><span class="id"> :=</span> (<span class="id">n</span>.<span class="id">-1</span><span class="id"> -</span><span class="id"> i</span>)<span class="id">%nat</span>.<br/>
<span class="id">rewrite</span><span class="id"> -[</span>(<span class="id">n</span><span class="id"> -</span><span class="id"> i</span>)<span class="id">%nat]prednK</span><span class="id"> ?subn_gt0//</span><span class="id"> predn_sub</span><span class="id"> -/d</span>.<br/>
<span class="id">rewrite</span><span class="id"> -</span>(<span class="id">subnK</span> (_<span class="id"> :</span><span class="id"> i</span><span class="id"> &lt;=</span><span class="id"> n</span>.<span class="id">-1</span>)<span class="id">%nat</span>)<span class="id"> -/d;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -ltnS</span><span class="id"> prednK//</span> (<span class="id">leq_ltn_trans</span><span class="id"> _</span><span class="id"> ni</span>).<br/>
<span class="id">rewrite</span><span class="id"> addnC</span><span class="id"> exprD</span><span class="id"> mulrAC</span><span class="id"> -mulrA</span>.<br/>
<span class="id">apply:</span><span class="id"> ler_pM</span><span class="id"> =&gt;</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> normrX</span><span class="id"> lerXn2r//</span><span class="id"> qualifE/=</span> (<span class="id">le_trans</span><span class="id"> _</span><span class="id"> zLK</span>).<br/>
<span class="id">apply:</span><span class="id"> le_trans</span> (_<span class="id"> :</span><span class="id"> d</span>.<span class="id">+1%:R</span><span class="id"> *</span><span class="id"> K</span><span class="id"> ^+</span><span class="id"> d</span><span class="id"> &lt;=</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> ler_wpM2r</span><span class="id"> //;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> exprn_ge0</span><span class="id"> //</span> (<span class="id">le_trans</span><span class="id"> _</span><span class="id"> zLK</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ler_nat</span><span class="id"> ltnS</span><span class="id"> /d</span><span class="id"> -subn1</span><span class="id"> -subnDA</span><span class="id"> leq_subr</span>.<br/>
<span class="id">rewrite</span> (<span class="id">le_trans</span> (<span class="id">ler_norm_sum</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _</span>))<span class="id">//</span>.<br/>
<span class="id">rewrite</span><span class="id"> mulr_natl</span><span class="id"> -[X</span><span class="gallina-kwd"> in</span><span class="id"> _</span><span class="id"> *+</span><span class="id"> X]subn0</span><span class="id"> -sumr_const_nat</span><span class="id"> ler_sum_nat//=</span><span class="id"> =&gt;</span><span class="id"> j</span><span class="id"> jd1</span>.<br/>
<span class="id">rewrite</span><span class="id"> -[in</span><span class="id"> leRHS]</span>(<span class="id">subnK</span> (_<span class="id"> :</span><span class="id"> j</span><span class="id"> &lt;=</span><span class="id"> d</span>)<span class="id">%nat</span>)<span class="id"> -1?ltnS</span><span class="id"> //</span><span class="id"> addnC</span><span class="id"> exprD</span><span class="id"> normrM</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ler_pM//</span><span class="id"> normrX</span><span class="id"> lerXn2r//</span><span class="id"> qualifE/=</span> (<span class="id">le_trans</span><span class="id"> _</span><span class="id"> zLK</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pseries_snd_diffs</span> (<span class="id">c</span><span class="id"> :</span><span class="id"> R^nat</span>)<span class="id"> K</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">cvgn</span> (<span class="id">pseries</span><span class="id"> c</span><span class="id"> K</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">cvgn</span> (<span class="id">pseries</span> (<span class="id">pseries_diffs</span><span class="id"> c</span>)<span class="id"> K</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">cvgn</span> (<span class="id">pseries</span> (<span class="id">pseries_diffs</span> (<span class="id">pseries_diffs</span><span class="id"> c</span>))<span class="id"> K</span>)<span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">`|x|</span><span class="id"> &lt;</span><span class="id"> `|K|</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">is_derive</span><span class="id"> x</span> (<span class="id">1</span><span class="id"> :</span><span class="id"> R</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> limn</span> (<span class="id">pseries</span><span class="id"> c</span><span class="id"> x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">limn</span> (<span class="id">pseries</span> (<span class="id">pseries_diffs</span><span class="id"> c</span>)<span class="id"> x</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> Ck</span><span class="vernacular"> CdK</span><span class="vernacular"> CddK</span><span class="id"> xLK;</span><span class="id"> rewrite</span><span class="id"> /pseries</span>.<br/>
<span class="id">set</span><span class="id"> s</span><span class="id"> :=</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> =&gt;</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> set</span> (<span class="id">f</span><span class="id"> :=</span><span class="gallina-kwd"> fun</span><span class="id"> x0</span><span class="id"> =&gt;</span><span class="id"> _</span>).<br/>
<span class="id">suff</span><span class="id"> hfxs</span><span class="id"> :</span><span class="id"> h^-1</span><span class="id"> *:</span> (<span class="id">f</span> (<span class="id">h</span><span class="id"> +</span><span class="id"> x</span>)<span class="id"> -</span><span class="id"> f</span><span class="id"> x</span>)<span class="id"> @[h</span><span class="id"> --&gt;</span><span class="id"> 0^']</span><span class="id"> --&gt;</span><span class="id"> limn</span> (<span class="id">series</span><span class="id"> s</span>).<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> F</span><span class="id"> :</span><span class="id"> f^`</span>()<span class="id"> x</span><span class="id"> =</span><span class="id"> limn</span> (<span class="id">series</span><span class="id"> s</span>)<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> cvg_lim</span><span class="id"> hfxs</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> Df</span><span class="id"> :</span><span class="id"> derivable</span><span class="id"> f</span><span class="id"> x</span><span class="id"> 1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move:</span><span class="id"> hfxs;</span><span class="id"> rewrite</span><span class="id"> /derivable</span><span class="id"> [X</span><span class="gallina-kwd"> in</span><span class="id"> X</span><span class="id"> @</span><span class="id"> 0^']</span>(_<span class="id"> :</span><span class="id"> _</span><span class="id"> =</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span><span class="id"> h</span><span class="id"> =&gt;</span><span class="id"> h^-1</span><span class="id"> *:</span> (<span class="id">f</span> (<span class="id">h%:A</span><span class="id"> +</span><span class="id"> x</span>)<span class="id"> -</span><span class="id"> f</span><span class="id"> x</span>)))<span class="id"> /=;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> i</span><span class="id"> //=;</span><span class="id"> rewrite</span><span class="id"> [i%:A]mulr1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> /</span>(<span class="id">cvg_lim</span><span class="id"> _</span>)<span class="id"> -&gt;</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> constructor;</span><span class="id"> [exact:</span><span class="id"> Df|rewrite</span><span class="id"> -derive1E]</span>.<br/>
<span class="id">pose</span><span class="id"> sx</span><span class="id"> :=</span><span class="gallina-kwd"> fun</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> =&gt;</span><span class="id"> c</span><span class="id"> n</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<span class="id">have</span><span class="id"> Csx</span><span class="id"> :</span><span class="id"> cvgn</span> (<span class="id">pseries</span><span class="id"> c</span><span class="id"> x</span>)<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> is_cvg_pseries_inside</span><span class="id"> Ck</span><span class="id"> _</span>.<br/>
<span class="id">pose</span><span class="id"> shx</span><span class="id"> :=</span><span class="gallina-kwd"> fun</span><span class="id"> h</span> (<span class="id">n</span><span class="id"> :</span><span class="id"> nat</span>)<span class="id"> =&gt;</span><span class="id"> c</span><span class="id"> n</span><span class="id"> *</span> (<span class="id">h</span><span class="id"> +</span><span class="id"> x</span>)<span class="id"> ^+</span><span class="id"> n</span>.<br/>
<span class="id">suff</span><span class="id"> Cc</span><span class="id"> :</span><span class="id"> limn</span> (<span class="id">h^-1</span><span class="id"> *:</span> (<span class="id">series</span> (<span class="id">shx</span><span class="id"> h</span><span class="id"> -</span><span class="id"> sx</span>)))<span class="id"> @[h</span><span class="id"> --&gt;</span><span class="id"> 0^']</span><span class="id"> --&gt;</span><span class="id"> limn</span> (<span class="id">series</span><span class="id"> s</span>).<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> cvg_sub0</span><span class="id"> Cc</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/cvgrPdist_lt</span><span class="id"> =&gt;</span><span class="id"> eps</span><span class="id"> eps_gt0</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">near=&gt;</span><span class="id"> h;</span><span class="id"> rewrite</span><span class="id"> sub0r</span><span class="id"> normrN</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">le_lt_trans</span><span class="id"> _</span><span class="id"> eps_gt0</span>)<span class="id">//</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> normr_le0</span><span class="id"> subr_eq0</span><span class="id"> -/sx</span><span class="id"> -/</span>(<span class="id">shx</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> apply/eqP</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> Cshx'</span><span class="id"> :</span><span class="id"> cvgn</span> (<span class="id">series</span> (<span class="id">shx</span><span class="id"> h</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> is_cvg_pseries_inside</span><span class="id"> Ck</span><span class="id"> _</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">le_lt_trans</span> (<span class="id">ler_normD</span><span class="id"> _</span><span class="id"> _</span>))<span class="id">//</span><span class="id"> -</span>(<span class="id">subrK</span> <span class="id"> `|x|</span><span class="id"> `|K|</span>)<span class="id"> ltrD2r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">near:</span><span class="id"> h</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply/nbhs_ballP</span><span class="id"> =&gt;</span><span class="id"> /=;</span><span class="gallina-kwd"> exists</span> ((<span class="id">`|K|</span><span class="id"> -</span><span class="id"> `|x|</span>)<span class="id"> /2%:R</span>)<span class="id"> =&gt;</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> divr_gt0</span><span class="id"> //</span><span class="id"> subr_gt0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> t;</span><span class="id"> rewrite</span><span class="id"> /ball</span><span class="id"> /=</span><span class="id"> sub0r</span><span class="id"> normrN</span><span class="id"> =&gt;</span><span class="id"> H</span><span class="id"> tNZ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">lt_le_trans</span><span class="id"> H</span>)<span class="id">//</span><span class="id"> ler_pdivrMr</span><span class="id"> //</span><span class="id"> mulr2n</span><span class="id"> mulrDr</span><span class="id"> mulr1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ler_wpDr</span><span class="id"> //</span><span class="id"> subr_ge0</span><span class="id"> ltW</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> limZr;</span><span class="id"> last</span><span class="id"> exact/is_cvg_seriesB/Csx</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lim_seriesB;</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> Csx</span>.<br/>
<span class="id">apply:</span><span class="id"> cvg_zero</span><span class="id"> =&gt;</span><span class="id"> /=</span>.<br/>
<span class="id">suff</span><span class="id"> Cc</span><span class="id"> :</span><span class="id"> limn</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">series</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> c</span><span class="id"> n</span><span class="id"> *</span> (((<span class="id">h</span><span class="id"> +</span><span class="id"> x</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> -</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> /</span><span class="id"> h</span><span class="id"> -</span><span class="id"> n%:R</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<span class="id">-1</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">@[h</span><span class="id"> --&gt;</span><span class="id"> 0^']</span><span class="id"> --&gt;</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> cvg_sub0</span><span class="id"> Cc</span>.<br/>
&nbsp;&nbsp;<span class="id">apply/cvgrPdist_lt</span><span class="id"> =&gt;</span><span class="id"> eps</span><span class="id"> eps_gt0</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">near=&gt;</span><span class="id"> h;</span><span class="id"> rewrite</span><span class="id"> sub0r</span><span class="id"> normrN</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">le_lt_trans</span><span class="id"> _</span><span class="id"> eps_gt0</span>)<span class="id">//</span><span class="id"> normr_le0</span><span class="id"> subr_eq0;</span><span class="id"> apply/eqP</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> Cs</span><span class="id"> :</span><span class="id"> cvgn</span> (<span class="id">series</span><span class="id"> s</span>)<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> is_cvg_pseries_inside</span><span class="vernacular"> CdK</span><span class="id"> _</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> Cs1</span><span class="id"> :=</span><span class="id"> is_cvg_pseries_diffs_equiv</span><span class="id"> Cs</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> Fs1</span><span class="id"> :=</span><span class="id"> pseries_diffs_equiv</span><span class="id"> Cs</span>.<br/>
&nbsp;&nbsp;<span class="id">set</span><span class="id"> s1</span><span class="id"> :=</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> _</span>)<span class="gallina-kwd"> in</span><span class="id"> Cs1</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> Cshx</span><span class="id"> :</span><span class="id"> cvgn</span> (<span class="id">series</span> (<span class="id">shx</span><span class="id"> h</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> is_cvg_pseries_inside</span><span class="id"> Ck</span><span class="id"> _</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">le_lt_trans</span> (<span class="id">ler_normD</span><span class="id"> _</span><span class="id"> _</span>))<span class="id">//</span><span class="id"> -</span>(<span class="id">subrK</span> <span class="id"> `|x|</span><span class="id"> `|K|</span>)<span class="id"> ltrD2r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">near:</span><span class="id"> h</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply/nbhs_ballP</span><span class="id"> =&gt;</span><span class="id"> /=;</span><span class="gallina-kwd"> exists</span> ((<span class="id">`|K|</span><span class="id"> -</span><span class="id"> `|x|</span>)<span class="id"> /</span><span class="id"> 2%:R</span>)<span class="id"> =&gt;</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> divr_gt0</span><span class="id"> //</span><span class="id"> subr_gt0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> t;</span><span class="id"> rewrite</span><span class="id"> /ball</span><span class="id"> /=</span><span class="id"> sub0r</span><span class="id"> normrN</span><span class="id"> =&gt;</span><span class="id"> H</span><span class="id"> tNZ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">lt_le_trans</span><span class="id"> H</span>)<span class="id">//</span><span class="id"> ler_pdivrMr</span><span class="id"> //</span><span class="id"> mulr2n</span><span class="id"> mulrDr</span><span class="id"> mulr1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ler_wpDr</span><span class="id"> //</span><span class="id"> subr_ge0</span><span class="id"> ltW</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> C1</span><span class="id"> :=</span><span class="id"> is_cvg_seriesB</span><span class="id"> Cshx</span><span class="id"> Csx</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> Ckf</span><span class="id"> :=</span><span class="id"> @is_cvg_seriesZ</span><span class="id"> _</span><span class="id"> _</span><span class="id"> h^-1</span><span class="id"> C1</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> Cu</span><span class="id"> :</span> (<span class="id">series</span> (<span class="id">h^-1</span><span class="id"> *:</span> (<span class="id">shx</span><span class="id"> h</span><span class="id"> -</span><span class="id"> sx</span>))<span class="id"> -</span><span class="id"> series</span><span class="id"> s1</span>)<span class="id"> x0</span><span class="id"> @[x0</span><span class="id"> --&gt;</span><span class="id"> \oo]</span><span class="id"> --&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">limn</span> (<span class="id">series</span> (<span class="id">h^-1</span><span class="id"> *:</span> (<span class="id">shx</span><span class="id"> h</span><span class="id"> -</span><span class="id"> sx</span>)))<span class="id"> -</span><span class="id"> limn</span> (<span class="id">series</span><span class="id"> s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span><span class="id"> cvgB</span><span class="id"> Ckf</span><span class="id"> Fs1</span>.<br/>
&nbsp;&nbsp;<span class="id">set</span><span class="id"> w</span><span class="id"> :=</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> :</span><span class="id"> nat</span><span class="id"> =&gt;</span><span class="id"> _</span><span class="gallina-kwd"> in</span><span class="id"> RHS</span>).<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> -&gt;</span><span class="id"> :</span><span class="id"> w</span><span class="id"> =</span><span class="id"> h^-1</span><span class="id"> *:</span> (<span class="id">shx</span><span class="id"> h</span><span class="id"> -</span><span class="id"> sx</span>) <span class="id"> -</span><span class="id"> s1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> funext</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> !fctE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> /w</span><span class="id"> /shx</span><span class="id"> /sx</span><span class="id"> /s1</span><span class="id"> /=</span><span class="id"> mulrBr;</span><span class="id"> congr</span> (_<span class="id"> -</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrCA</span><span class="id"> !mulrA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -mulrBr</span><span class="id"> [RHS]mulrCA</span><span class="id"> [_^-1</span><span class="id"> *</span><span class="id"> _]mulrC</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> [X</span><span class="gallina-kwd"> in</span><span class="id"> X</span><span class="id"> h</span><span class="id"> =</span><span class="id"> _]/+%R</span><span class="id"> /=</span><span class="id"> [X</span><span class="gallina-kwd"> in</span><span class="id"> _</span><span class="id"> +</span><span class="id"> X</span><span class="id"> h</span><span class="id"> =</span><span class="id"> _]/-%R</span><span class="id"> /=</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> -&gt;</span><span class="id"> :</span><span class="id"> series</span> (<span class="id">h^-1</span><span class="id"> *:</span> (<span class="id">shx</span><span class="id"> h</span><span class="id"> -</span><span class="id"> sx</span>)<span class="id"> -</span><span class="id"> s1</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">series</span> (<span class="id">h^-1</span><span class="id"> *:</span> (<span class="id">shx</span><span class="id"> h</span><span class="id"> -</span><span class="id"> sx</span>))<span class="id"> -</span> (<span class="id">series</span><span class="id"> s1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> /series</span><span class="id"> /=</span><span class="id"> sumrB</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> -&gt;</span><span class="id"> :</span><span class="id"> h^-1</span><span class="id"> *:</span><span class="id"> series</span> (<span class="id">shx</span><span class="id"> h</span><span class="id"> -</span><span class="id"> sx</span>)<span class="id"> =</span><span class="id"> series</span> (<span class="id">h^-1</span><span class="id"> *:</span> (<span class="id">shx</span><span class="id"> h</span><span class="id"> -</span><span class="id"> sx</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> /series</span><span class="id"> /=</span><span class="id"> -scaler_sumr</span>.<br/>
&nbsp;&nbsp;<span class="id">exact/esym/cvg_lim</span>.<br/>
<span class="id">pose</span><span class="id"> r</span><span class="id"> :=</span> (<span class="id">`|x|</span><span class="id"> +</span><span class="id"> `|K|</span>)<span class="id"> /</span><span class="id"> 2</span>.<br/>
<span class="id">have</span><span class="id"> xLr</span><span class="id"> :</span><span class="id"> `|x|</span><span class="id"> &lt;</span><span class="id"> r</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltr_pdivlMr</span><span class="id"> //</span><span class="id"> mulrDr</span><span class="id"> mulr1</span><span class="id"> ltrD2l</span>.<br/>
<span class="id">have</span><span class="id"> rLx</span><span class="id"> :</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> `|K|</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltr_pdivrMr</span><span class="id"> //</span><span class="id"> mulrDr</span><span class="id"> mulr1</span><span class="id"> ltrD2r</span>.<br/>
<span class="id">have</span><span class="id"> r_gt0</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> r</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> le_lt_trans</span><span class="id"> xLr</span>.<br/>
<span class="id">have</span><span class="id"> rNZ</span><span class="id"> :</span><span class="id"> r</span><span class="id"> !=</span><span class="id"> 0by</span><span class="id"> case:</span><span class="id"> ltrgt0P</span><span class="id"> r_gt0</span>.<br/>
<span class="id">apply:</span> (<span class="id">@lim_cvg_to_0_linear</span><span class="id"> _</span><br/>
&nbsp;&nbsp;(<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> `|c</span><span class="id"> n|</span><span class="id"> *</span><span class="id"> n%:R</span><span class="id"> *</span> (<span class="id">n</span>.<span class="id">-1</span>)<span class="id">%:R</span><span class="id"> *</span><span class="id"> r</span><span class="id"> ^+</span><span class="id"> n</span>.<span class="id">-2</span>)<br/>
&nbsp;&nbsp;(<span class="gallina-kwd">fun</span><span class="id"> h</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> c</span><span class="id"> n</span><span class="id"> *</span> (((<span class="id">h</span><span class="id"> +</span><span class="id"> x</span>)<span class="id"> ^+</span><span class="id"> n</span><span class="id"> -</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> /</span><span class="id"> h</span><span class="id"> -</span><span class="id"> n%:R</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<span class="id">-1</span>))<br/>
&nbsp;&nbsp;(<span class="id">r</span><span class="id"> -</span><span class="id"> `|x|</span>))<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> subr_gt0</span>.<br/>
<span class="id">-</span><span class="id"> have</span><span class="id"> :</span><span class="id"> cvgn</span> (<span class="id">[series</span><span class="id"> `|pseries_diffs</span> (<span class="id">pseries_diffs</span><span class="id"> c</span>)<span class="id"> n|</span><span class="id"> *</span><span class="id"> r</span><span class="id"> ^+</span><span class="id"> n]_n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply:</span><span class="id"> is_cvg_pseries_inside_norm</span><span class="vernacular"> CddK</span><span class="id"> _</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ger0_norm</span><span class="id"> //</span><span class="id"> ltW</span><span class="id"> //</span> (<span class="id">le_lt_trans</span><span class="id"> _</span><span class="id"> xLr</span>).<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> -&gt;</span><span class="id"> :</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> `|pseries_diffs</span> (<span class="id">pseries_diffs</span><span class="id"> c</span>)<span class="id"> n|</span><span class="id"> *</span><span class="id"> r</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> pseries_diffs</span> (<span class="id">pseries_diffs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span><span class="id"> m</span><span class="id"> =&gt;</span><span class="id"> `|c</span><span class="id"> m|</span>))<span class="id"> n</span><span class="id"> *</span><span class="id"> r</span><span class="id"> ^+</span><span class="id"> n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply/funext</span><span class="id"> =&gt;</span><span class="id"> i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /pseries_diffs</span><span class="id"> !normrM</span><span class="id"> !mulrA</span><span class="id"> ger0_norm</span><span class="id"> //</span><span class="id"> ger0_norm</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> /is_cvg_pseries_diffs_equiv</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> /pseries_diffs</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> -&gt;</span><span class="id"> :</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> n%:R</span><span class="id"> *</span> ((<span class="id">n</span>.<span class="id">+1</span>)<span class="id">%:R</span><span class="id"> *</span><span class="id"> `|c</span><span class="id"> n</span>.<span class="id">+1|</span>)<span class="id"> *</span><span class="id"> r</span><span class="id"> ^+</span><span class="id"> n</span>.<span class="id">-1</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> pseries_diffs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span><span class="id"> m</span><span class="id"> =&gt;</span> (<span class="id">m</span>.<span class="id">-1</span>)<span class="id">%:R</span><span class="id"> *</span><span class="id"> `|c</span><span class="id"> m|</span><span class="id"> *</span><span class="id"> r^-1</span>)<span class="id"> n</span><span class="id"> *</span><span class="id"> r</span><span class="id"> ^+</span><span class="id"> n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">apply/funext</span><span class="id"> =&gt;</span><span class="id"> n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> /pseries_diffs</span><span class="id"> /=</span><span class="id"> mulrA</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">case:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> /=];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !</span>(<span class="id">mul0r,</span><span class="id"> mulr0</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> [_%:R</span><span class="id"> *_]mulrC</span><span class="id"> !mulrA</span><span class="id"> -[RHS]mulrA</span><span class="id"> exprS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [_^-1</span><span class="id"> *</span><span class="id"> _]mulrA</span><span class="id"> mulVf</span><span class="id"> ?mul1r</span>.<br/>
&nbsp;&nbsp;<span class="id">move/is_cvg_pseries_diffs_equiv</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> -&gt;//</span><span class="id"> :</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> n%:R</span><span class="id"> *</span> (<span class="id">n</span>.<span class="id">-1%:R</span><span class="id"> *</span><span class="id"> `|c</span><span class="id"> n|</span><span class="id"> /</span><span class="id"> r</span>)<span class="id"> *</span><span class="id"> r</span><span class="id"> ^+</span><span class="id"> n</span>.<span class="id">-1</span>)<span class="id"> =</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> `|c</span><span class="id"> n|</span><span class="id"> *</span><span class="id"> n%:R</span><span class="id"> *</span><span class="id"> n</span>.<span class="id">-1%:R</span><span class="id"> *</span><span class="id"> r</span><span class="id"> ^+</span><span class="id"> n</span>.<span class="id">-2</span>).<br/>
&nbsp;&nbsp;<span class="id">apply/funext</span><span class="id"> =&gt;</span><span class="id"> []</span><span class="id"> [|[|i]];</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">mul0r,</span><span class="id"> mulr0</span>)<span class="id"> //=</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mulrA</span><span class="id"> -mulrA</span><span class="id"> exprS</span><span class="id"> [_^-1</span><span class="id"> *</span><span class="id"> _]mulrA</span><span class="id"> mulVf</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> mul1r</span><span class="id"> !mulrA;</span><span class="id"> congr</span> (_<span class="id"> *</span><span class="id"> _</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> mulrA</span>.<br/>
<span class="id">-</span><span class="id"> move=&gt;</span><span class="id"> h</span><span class="id"> /andP[h_gt0</span><span class="id"> hLrBx]</span><span class="id"> n</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> normrM</span><span class="id"> -!mulrA</span><span class="id"> ler_wpM2l</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span> (<span class="id">le_trans</span> (<span class="id">pseries_diffs_P3</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">ltW</span><span class="id"> xLr</span>)<span class="id"> _</span>))<span class="id">//</span><span class="id"> ?mulrA</span><span class="id"> -?normr_gt0//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">le_trans</span> (<span class="id">ler_normD</span><span class="id"> _</span><span class="id"> _</span>))<span class="id">//</span><span class="id"> -</span>(<span class="id">subrK</span><span class="id"> `|x|</span><span class="id"> r</span>)<span class="id"> lerD2r</span><span class="id"> ltW</span>.<br/>
<span class="id">Unshelve</span>.<span class="id"> all:</span><span class="gallina-kwd"> by</span><span class="id"> end_near</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> PseriesDiff</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> expR</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> realType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expR0</span><span class="id"> :</span><span class="id"> expR</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> :&gt;</span><span class="id"> R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span><span class="id"> lim_near_cst</span><span class="id"> =&gt;</span><span class="id"> //</span>.<br/>
<span class="id">near=&gt;</span><span class="id"> m;</span><span class="id"> rewrite</span><span class="id"> -[m]prednK;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> near:</span><span class="id"> m</span>.<br/>
<span class="id">rewrite</span><span class="id"> -addn1</span><span class="id"> series_addn</span><span class="id"> series_exp_coeff0</span><span class="id"> big_add1</span><span class="id"> big1</span><span class="id"> ?addr0//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> i</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> /exp_coeff</span><span class="id"> /=</span><span class="id"> expr0n</span><span class="id"> mul0r</span>.<br/>
<span class="id">Unshelve</span>.<span class="id"> all:</span><span class="gallina-kwd"> by</span><span class="id"> end_near</span>. Qed.</div></details>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Lemma</span><span class="id"> expR_ge1Dx_subproof</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 1</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> expR</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x_ge0;</span><span class="id"> rewrite</span><span class="id"> /expR</span>.<br/>
<span class="id">pose</span><span class="id"> f</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> i</span><span class="id"> :=</span> (<span class="id">i</span><span class="id"> ==</span><span class="id"> 0%nat</span>)<span class="id">%:R</span><span class="id"> +</span><span class="id"> x</span><span class="id"> *+</span> (<span class="id">i</span><span class="id"> ==</span><span class="id"> 1%nat</span>).<br/>
<span class="id">have</span><span class="id"> F</span><span class="id"> n</span><span class="id"> :</span> (<span class="id">1</span><span class="id"> &lt;</span><span class="id"> n</span>)<span class="id">%nat</span><span class="id"> -&gt;</span><span class="id"> \sum_</span>(<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> i</span><span class="id"> &lt;</span><span class="id"> n</span>) (<span class="id">f</span><span class="id"> x</span><span class="id"> i</span>)<span class="id"> =</span><span class="id"> 1</span><span class="id"> +</span><span class="id"> x</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> /subnK&lt;-</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> addn2</span><span class="id"> !big_nat_recl</span><span class="id"> //=</span><span class="id"> /f</span><span class="id"> /=</span><span class="id"> mulr1n</span><span class="id"> !mulr0n</span><span class="id"> big1</span><span class="id"> ?add0r</span><span class="id"> ?addr0</span>.<br/>
<span class="id">have</span><span class="id"> -&gt;</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> +</span><span class="id"> x</span><span class="id"> =</span><span class="id"> limn</span> (<span class="id">series</span> (<span class="id">f</span><span class="id"> x</span>)).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/esym/lim_near_cst</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> near=&gt;</span><span class="id"> n;</span><span class="id"> apply:</span><span class="id"> F;</span><span class="id"> near:</span><span class="id"> n</span>.<br/>
<span class="id">apply:</span><span class="id"> ler_lim;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> is_cvg_near_cst;</span><span class="id"> near=&gt;</span><span class="id"> n;</span><span class="id"> apply:</span><span class="id"> F;</span><span class="id"> near:</span><span class="id"> n</span>.<br/>
&nbsp;&nbsp;<span class="id">exact:</span><span class="id"> is_cvg_series_exp_coeff</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> near=&gt;</span><span class="id"> n;</span><span class="id"> apply:</span><span class="id"> ler_sum</span><span class="id"> =&gt;</span><span class="id"> -[|[|i]]</span><span class="id"> _;</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> /f</span><span class="id"> /exp_coeff</span><span class="id"> /=</span><span class="id"> !</span>(<span class="id">mulr0n,</span><span class="id"> mulr1n,</span><span class="id"> expr0,</span><span class="id"> expr1,</span><span class="id"> divr1,</span><span class="id"> addr0,</span><span class="id"> add0r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">//</span><span class="id"> exp_coeff_ge0</span>.<br/>
<span class="id">Unshelve</span>.<span class="id"> all:</span><span class="gallina-kwd"> by</span><span class="id"> end_near</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> exp_coeffE</span><span class="id"> x</span><span class="id"> :</span><span class="id"> exp_coeff</span><span class="id"> x</span><span class="id"> =</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span> (<span class="id">n`!%:R</span>)<span class="id">^-1</span>)<span class="id"> n</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> /exp_coeff</span><span class="id"> /=</span><span class="id"> mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Import</span><span class="id"> GRing</span>.<span class="id">Theory</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expRE</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">expR</span><span class="id"> =</span><span class="gallina-kwd"> fun</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> limn</span> (<span class="id">pseries</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span> (<span class="id">n`!%:R</span>)<span class="id">^-1</span>)<span class="id"> n</span>)<span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> /pseries</span><span class="id"> -exp_coeffE</span>. Qed.</div></details>
<br/>
<span class="id">Global</span><span class="vernacular"> Instance</span><span class="id"> is_derive_expR</span><span class="id"> x</span><span class="id"> :</span><span class="id"> is_derive</span><span class="id"> x</span><span class="id"> 1</span><span class="id"> expR</span> (<span class="id">expR</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">pose</span><span class="id"> s1</span><span class="id"> n</span><span class="id"> :=</span><span class="id"> pseries_diffs</span> (<span class="gallina-kwd">fun</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> n`!%:R^-1</span>)<span class="id"> n</span><span class="id"> *</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<span class="id">rewrite</span><span class="id"> expRE</span><span class="id"> /=</span><span class="id"> /pseries</span> (_<span class="id"> :</span> (<span class="gallina-kwd">fun</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> _</span>)<span class="id"> =</span><span class="id"> s1</span>)<span class="id">;</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> /s1</span><span class="id"> pseries_diffs_inv_fact</span>.<br/>
<span class="id">apply:</span> (<span class="id">@pseries_snd_diffs</span><span class="id"> _</span><span class="id"> _</span> (<span class="id">`|x|</span><span class="id"> +</span><span class="id"> 1</span>))<span class="id">;</span><span class="id"> rewrite</span><span class="id"> /pseries</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -exp_coeffE;</span><span class="id"> apply:</span><span class="id"> is_cvg_series_exp_coeff</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span> (_<span class="id"> :</span> (<span class="gallina-kwd">fun</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> _</span>)<span class="id"> =</span><span class="id"> exp_coeff</span> (<span class="id">`|x|</span><span class="id"> +</span><span class="id"> 1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span><span class="id"> is_cvg_series_exp_coeff</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> pseries_diffs_inv_fact</span><span class="id"> exp_coeffE</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span> (_<span class="id"> :</span> (<span class="gallina-kwd">fun</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> _</span>)<span class="id"> =</span><span class="id"> exp_coeff</span> (<span class="id">`|x|</span><span class="id"> +</span><span class="id"> 1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact:</span><span class="id"> is_cvg_series_exp_coeff</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> i;</span><span class="id"> rewrite</span><span class="id"> !pseries_diffs_inv_fact</span><span class="id"> exp_coeffE</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> [ltRHS]ger0_norm//</span><span class="id"> addrC</span><span class="id"> -subr_gt0</span><span class="id"> addrK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> derivable_expR</span><span class="id"> x</span><span class="id"> :</span><span class="id"> derivable</span><span class="id"> expR</span><span class="id"> x</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> ex_derive;</span><span class="id"> apply:</span><span class="id"> is_derive_exp</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> derive_expR</span><span class="id"> :</span><span class="id"> 'D_1</span><span class="id"> expR</span><span class="id"> =</span><span class="id"> expR</span><span class="id"> :&gt;</span> (<span class="id">R</span><span class="id"> -&gt;</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> r</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> derive_val</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> continuous_expR</span><span class="id"> :</span><span class="id"> continuous</span> (<span class="id">@expR</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> exact/differentiable_continuous/derivable1_diffP/derivable_expR</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expRxDyMexpx</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> expR</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> *</span><span class="id"> expR</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> expR</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">set</span><span class="id"> v</span><span class="id"> :=</span><span class="id"> LHS;</span><span class="id"> pattern</span><span class="id"> x</span><span class="gallina-kwd"> in</span><span class="id"> v;</span><span class="id"> move:</span><span class="id"> @v;</span><span class="id"> set</span><span class="id"> f</span><span class="id"> :=</span> (<span class="id">X</span><span class="gallina-kwd"> in</span><span class="gallina-kwd"> let</span><span class="id"> _</span><span class="id"> :=</span><span class="id"> X</span><span class="id"> x</span><span class="gallina-kwd"> in</span><span class="id"> _</span>)<span class="id"> =&gt;</span><span class="id"> /=</span>.<br/>
<span class="id">apply:</span><span class="id"> etrans</span> (_<span class="id"> :</span><span class="id"> f</span><span class="id"> x</span><span class="id"> =</span><span class="id"> f</span><span class="id"> 0</span>)<span class="id"> _;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /f</span><span class="id"> add0r</span><span class="id"> oppr0</span><span class="id"> expR0</span><span class="id"> mulr1</span>.<br/>
<span class="id">apply:</span><span class="id"> is_derive_0_is_cst</span><span class="id"> =&gt;</span><span class="id"> x1</span>.<br/>
<span class="id">apply:</span><span class="id"> trigger_derive</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /GRing</span>.<span class="id">scale</span><span class="id"> /=</span><span class="id"> mulrN1</span><span class="id"> addr0</span><span class="id"> mulr1</span><span class="id"> mulrN</span><span class="id"> addrC</span><span class="id"> mulrC</span><span class="id"> subrr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expRxMexpNx_1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> expR</span><span class="id"> x</span><span class="id"> *</span><span class="id"> expR</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[X</span><span class="gallina-kwd"> in</span><span class="id"> _</span><span class="id"> X</span><span class="id"> *</span><span class="id"> _</span><span class="id"> =</span><span class="id"> _]addr0</span><span class="id"> expRxDyMexpx</span><span class="id"> expR0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> pexpR_gt1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 1</span><span class="id"> &lt;</span><span class="id"> expR</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x0;</span><span class="id"> rewrite</span> (<span class="id">lt_le_trans</span><span class="id"> _</span> (<span class="id">expR_ge1Dx_subproof</span> (<span class="id">ltW</span><span class="id"> x0</span>)))<span class="id">//</span><span class="id"> ltrDl</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expR_gt0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> expR</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">ltrgt0P</span><span class="id"> x</span>)<span class="id"> =&gt;</span><span class="id"> [x_gt0|x_gt0|-&gt;];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> expR0</span>.<br/>
<span class="id">-</span><span class="id"> exact:</span><span class="id"> lt_trans</span> (<span class="id">pexpR_gt1</span><span class="id"> x_gt0</span>).<br/>
<span class="id">-</span><span class="id"> have</span><span class="id"> F</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> expR</span> (<span class="id">-</span><span class="id"> x</span>)<span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">lt_trans</span><span class="id"> _</span> (<span class="id">pexpR_gt1</span><span class="id"> _</span>))<span class="id">//</span><span class="id"> oppr_gt0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -</span>(<span class="id">pmulr_lgt0</span><span class="id"> _</span><span class="id"> F</span>)<span class="id"> expRxMexpNx_1</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expR_ge0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> expR</span><span class="id"> x</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltW//</span><span class="id"> expR_gt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expR_eq0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">expR</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span><span class="id"> false</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> gt_eqF</span><span class="id"> ?expR_gt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expRN</span><span class="id"> x</span><span class="id"> :</span><span class="id"> expR</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">expR</span><span class="id"> x</span>)<span class="id">^-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">mulfI</span> (<span class="id">lt0r_neq0</span> (<span class="id">expR_gt0</span><span class="id"> x</span>))).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> expRxMexpNx_1</span><span class="id"> mulfV</span><span class="id"> //</span> (<span class="id">lt0r_neq0</span> (<span class="id">expR_gt0</span><span class="id"> x</span>)).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expRD</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> expR</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> expR</span><span class="id"> x</span><span class="id"> *</span><span class="id"> expR</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply:</span> (<span class="id">mulIf</span> (<span class="id">lt0r_neq0</span> (<span class="id">expR_gt0</span> (<span class="id">-</span><span class="id"> x</span>)))).<br/>
<span class="id">rewrite</span><span class="id"> expRxDyMexpx</span><span class="id"> expRN</span><span class="id"> [_</span><span class="id"> *</span><span class="id"> expR</span><span class="id"> y]mulrC</span><span class="id"> mulfK</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> ltrgt0P</span> (<span class="id">expR_gt0</span><span class="id"> x</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expRM_natl</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> expR</span> (<span class="id">n%:R</span><span class="id"> *</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> expR</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">elim:</span><span class="id"> n</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|n</span><span class="id"> IH</span><span class="id"> x]</span><span class="id"> /=;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> expr0</span><span class="id"> expR0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> exprS</span><span class="id"> -nat1r</span><span class="id"> mulrDl</span><span class="id"> mul1r</span><span class="id"> expRD</span><span class="id"> IH</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expRM_natr</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> expR</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> n%:R</span>)<span class="id"> =</span><span class="id"> expR</span><span class="id"> x</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrC</span><span class="id"> expRM_natl</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expR_gt1</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">1</span><span class="id"> &lt;</span><span class="id"> expR</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> ltrgt0P</span><span class="id"> =&gt;</span><span class="id"> [x_gt0|</span><span class="id"> xN|-&gt;];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> expR0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">pexpR_gt1</span><span class="id"> x_gt0</span>).<br/>
<span class="id">-</span><span class="id"> apply/idP/negP</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -[x]opprK</span><span class="id"> expRN</span><span class="id"> -leNgt</span><span class="id"> invf_cp1</span><span class="id"> ?expR_gt0</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ltW</span><span class="id"> //</span><span class="id"> pexpR_gt1</span><span class="id"> //</span><span class="id"> lterNE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expR_lt1</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">expR</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 1</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> &lt;</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> ltrgt0P</span><span class="id"> =&gt;</span><span class="id"> [x_gt0|xN|-&gt;];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> expR0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> apply/idP/negP;</span><span class="id"> rewrite</span><span class="id"> -leNgt</span><span class="id"> ltW</span><span class="id"> //</span><span class="id"> expR_gt1</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -[x]opprK</span><span class="id"> expRN</span><span class="id"> invf_cp1</span><span class="id"> ?expR_gt0</span><span class="id"> //</span><span class="id"> expR_gt1</span><span class="id"> lterNE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expRB</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> expR</span> (<span class="id">x</span><span class="id"> -</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> expR</span><span class="id"> x</span><span class="id"> /</span><span class="id"> expR</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> expRD</span><span class="id"> expRN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_expR</span><span class="id"> :</span><span class="id"> {mono</span> (<span class="id">@expR</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span>.<br/>
<span class="gallina-kwd">by</span> <span class="id"> rewrite</span><span class="id"> -[in</span><span class="id"> LHS]</span>(<span class="id">subrK</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> expRD</span><span class="id"> ltr_pMl</span><span class="id"> ?expR_gt0</span><span class="id"> //</span><span class="id"> expR_gt1</span><span class="id"> subr_gt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_expR</span><span class="id"> :</span><span class="id"> {mono</span> (<span class="id">@expR</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span>.<br/>
<span class="id">case:</span> (<span class="id">ltrgtP</span><span class="id"> x</span><span class="id"> y</span>)<span class="id"> =&gt;</span><span class="id"> [xLy|yLx|&lt;-];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lexx</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltW</span><span class="id"> //</span><span class="id"> ltr_expR</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> leNgt</span><span class="id"> ltr_expR</span><span class="id"> yLx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expR_gt1Dx</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> 1</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> expR</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> neq_lt</span><span class="id"> =&gt;</span><span class="id"> /orP[x0|x0]</span>.<br/>
<span class="id">-</span><span class="id"> have</span><span class="id"> [?|_]</span><span class="id"> :=</span><span class="id"> leP</span><span class="id"> x</span> (<span class="id">-1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">@le_lt_trans</span><span class="id"> _</span><span class="id"> _</span><span class="id"> 0</span>)<span class="id"> ?expR_gt0//</span><span class="id"> -lerBrDl</span><span class="id"> sub0r</span>.<br/>
&nbsp;&nbsp;<span class="id">have</span><span class="id"> []</span><span class="id"> :=</span><span class="id"> @MVT</span><span class="id"> R</span><span class="id"> expR</span><span class="id"> expR</span><span class="id"> _</span><span class="id"> _</span><span class="id"> x0</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> is_derive_expR</span><span class="id"> x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact/continuous_subspaceT/continuous_expR</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> c;</span><span class="id"> rewrite</span><span class="id"> in_itv/=</span><span class="id"> =&gt;</span><span class="id"> /andP[xc</span><span class="id"> c0]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> expR0</span><span class="id"> sub0r</span><span class="id"> =&gt;</span><span class="id"> /eqP;</span><span class="id"> rewrite</span><span class="id"> subr_eq</span><span class="id"> addrC</span><span class="id"> -subr_eq</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> &lt;-</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulrN</span><span class="id"> opprK</span><span class="id"> ltrD2l</span><span class="id"> ltr_nMl//</span><span class="id"> -expR0</span><span class="id"> ltr_expR</span>.<br/>
<span class="id">-</span><span class="id"> have</span><span class="id"> []</span><span class="id"> :=</span><span class="id"> @MVT</span><span class="id"> R</span><span class="id"> expR</span><span class="id"> expR</span><span class="id"> _</span><span class="id"> _</span><span class="id"> x0</span> (<span class="gallina-kwd">fun</span><span class="id"> x</span><span class="id"> _</span><span class="id"> =&gt;</span><span class="id"> is_derive_expR</span><span class="id"> x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exact/continuous_subspaceT/continuous_expR</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> c;</span><span class="id"> rewrite</span><span class="id"> in_itv/=</span><span class="id"> =&gt;</span><span class="id"> /andP[c0</span><span class="id"> cx]</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> subr0</span><span class="id"> expR0</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> /[!subr_eq]</span><span class="id"> /eqP</span><span class="id"> -&gt;</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> addrC</span><span class="id"> ltrD2r</span><span class="id"> ltr_pMl//</span><span class="id"> -expR0</span><span class="id"> ltr_expR</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expR_ge1Dx</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> expR</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> [-&gt;|/expR_gt1Dx/ltW//]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> x</span><span class="id"> 0;</span><span class="id"> rewrite</span><span class="id"> expR0</span><span class="id"> addr0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cvgr_expR</span><span class="id"> :</span><span class="id"> @expR</span><span class="id"> R</span> (<span class="id">-</span><span class="id"> x</span>)<span class="id"> @[x</span><span class="id"> --&gt;</span><span class="id"> +oo]</span><span class="id"> --&gt;</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">apply/cvgrPdist_le</span><span class="id"> =&gt;</span><span class="id"> e</span><span class="id"> e0;</span><span class="id"> near=&gt;</span><span class="id"> x</span>.<br/>
<span class="id">rewrite</span><span class="id"> sub0r</span><span class="id"> normrN</span><span class="id"> ger0_norm;</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> expR_ge0</span>.<br/>
<span class="id">rewrite</span><span class="id"> expRN</span><span class="id"> -[leRHS]invrK</span><span class="id"> lef_pV2</span><span class="id"> ?posrE</span><span class="id"> ?expR_gt0</span><span class="id"> ?invr_gt0//</span>.<br/>
<span class="id">rewrite</span> (<span class="id">le_trans</span><span class="id"> _</span> (<span class="id">expR_ge1Dx</span><span class="id"> _</span>))<span class="id">//</span><span class="id"> -lerBlDl</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> near:</span><span class="id"> x;</span><span class="id"> apply:</span><span class="id"> nbhs_pinfty_ge;</span><span class="id"> exact:</span><span class="id"> num_real</span>.<br/>
<span class="id">Unshelve</span>.<span class="id"> end_near</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> cvgn_expR</span><span class="id"> :</span><span class="id"> @expR</span><span class="id"> R</span> (<span class="id">-</span><span class="id"> n%:R</span>)<span class="id"> @[n</span><span class="id"> --&gt;</span><span class="id"> \oo]</span><span class="id"> --&gt;</span><span class="id"> 0%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">under</span><span class="id"> eq_cvg</span><span class="id"> do</span><span class="id"> rewrite</span><span class="id"> -mulNrn</span><span class="id"> -mulr_natr</span><span class="id"> expRM_natr;</span><span class="id"> apply:</span><span class="id"> cvg_expr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ger0_norm</span><span class="id"> ?expR_ge0//</span><span class="id"> expRN</span><span class="id"> invf_lt1</span><span class="id"> ?expR_gt1//</span><span class="id"> expR_gt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expR_inj</span><span class="id"> :</span><span class="id"> injective</span> (<span class="id">@expR</span><span class="id"> R</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> exE</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> []</span><span class="id"> :=</span> (<span class="id">ltr_expR</span><span class="id"> x</span><span class="id"> y,</span><span class="id"> ltr_expR</span><span class="id"> y</span><span class="id"> x</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> exE</span><span class="id"> ltxx;</span><span class="id"> case:</span><span class="id"> ltrgtP</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expR_total_gt1</span><span class="id"> x</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="gallina-kwd"> exists</span><span class="id"> y,</span><span class="id"> [/\</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y,</span><span class="id"> 1</span><span class="id"> +</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> &amp;</span><span class="id"> expR</span><span class="id"> y</span><span class="id"> =</span><span class="id"> x]</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x_ge1;</span><span class="id"> have</span><span class="id"> x_ge0</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="gallina-kwd"> by</span><span class="id"> apply:</span><span class="id"> le_trans</span><span class="id"> x_ge1</span>.<br/>
<span class="id">have</span><span class="id"> [x1</span><span class="id"> x1Ix|</span><span class="id"> |x1</span><span class="id"> _</span><span class="id"> /eqP]</span><span class="id"> :=</span><span class="id"> @IVT</span><span class="id"> _</span> (<span class="gallina-kwd">fun</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> expR</span><span class="id"> y</span><span class="id"> -</span><span class="id"> x</span>)<span class="id"> _</span><span class="id"> _</span><span class="id"> 0</span><span class="id"> x_ge0</span>.<br/>
<span class="id">-</span><span class="id"> apply:</span><span class="id"> continuousB</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> y1;</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> cst_continuous</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> apply/continuous_subspaceT=&gt;</span><span class="id"> ?;</span><span class="id"> exact:</span><span class="id"> continuous_expR</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> expR0;</span><span class="id"> have</span><span class="id"> [_|</span><span class="id"> |]</span><span class="id"> :=</span><span class="id"> ltrgtP</span> (<span class="id">1</span><span class="id"> -</span><span class="id"> x</span>) (<span class="id">expR</span><span class="id"> x</span><span class="id"> -</span><span class="id"> x</span>).<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> subr_le0</span><span class="id"> x_ge1</span><span class="id"> subr_ge0</span> (<span class="id">le_trans</span><span class="id"> _</span> (<span class="id">expR_ge1Dx</span><span class="id"> _</span>))<span class="id"> ?lerDr</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltrD2r</span><span class="id"> expR_lt1</span><span class="id"> ltNge</span><span class="id"> x_ge0</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="id"> rewrite</span><span class="id"> subr_le0</span><span class="id"> x_ge1</span><span class="id"> =&gt;</span><span class="id"> -&gt;</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> subr_ge0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">le_trans</span><span class="id"> _</span> (<span class="id">expR_ge1Dx</span><span class="id"> _</span>))<span class="id"> ?lerDr</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> subr_eq0</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> x1_x;</span><span class="gallina-kwd"> exists</span><span class="id"> x1;</span><span class="id"> split</span><span class="id"> =&gt;</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -ler_expR</span><span class="id"> expR0</span><span class="id"> x1_x</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -x1_x</span><span class="id"> expR_ge1Dx</span><span class="id"> //</span><span class="id"> -ler_expR</span><span class="id"> x1_x</span><span class="id"> expR0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expR_total</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="gallina-kwd"> exists</span><span class="id"> y,</span><span class="id"> expR</span><span class="id"> y</span><span class="id"> =</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span> (<span class="id">lerP</span><span class="id"> 1</span><span class="id"> x</span>)<span class="id"> =&gt;</span><span class="id"> [/expR_total_gt1[y</span><span class="id"> [_</span><span class="id"> _</span><span class="id"> Hy]]|x_lt1</span><span class="id"> x_gt0]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span><span class="id"> y</span>.<br/>
<span class="id">have</span><span class="id"> /expR_total_gt1[y</span><span class="id"> [H1y</span><span class="id"> H2y</span><span class="id"> H3y]]</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> x^-1</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ltW</span><span class="id"> //</span><span class="id"> !invf_cp1</span>.<br/>
<span class="gallina-kwd">by</span><span class="gallina-kwd"> exists</span> (<span class="id">-y</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> expRN</span><span class="id"> H3y</span><span class="id"> invrK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> convex_scope</span>.<br/>
<span class="vernacular">Lemma</span><span class="id"> convex_expR</span> (<span class="id">t</span><span class="id"> :</span><span class="id"> {i01</span><span class="id"> R}</span>) (<span class="id">a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> R^o</span>)<span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">expR</span> (<span class="id">a</span><span class="id"> &lt;|</span><span class="id"> t</span><span class="id"> |&gt;</span><span class="id"> b</span>)<span class="id"> &lt;=</span> (<span class="id">expR</span><span class="id"> a</span><span class="id"> :</span><span class="id"> R^o</span>)<span class="id"> &lt;|</span><span class="id"> t</span><span class="id"> |&gt;</span> (<span class="id">expR</span><span class="id"> b</span><span class="id"> :</span><span class="id"> R^o</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [ab|/ltW</span><span class="id"> ba]</span><span class="id"> :=</span><span class="id"> leP</span><span class="id"> a</span><span class="id"> b</span>.<br/>
<span class="id">-</span><span class="id"> apply:</span><span class="id"> second_derivative_convex</span><span class="id"> =&gt;</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> axb;</span><span class="id"> rewrite</span><span class="id"> derive_expR</span><span class="id"> derive_val</span><span class="id"> expR_ge0</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="id"> exact/cvg_at_left_filter/continuous_expR</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="id"> exact/cvg_at_right_filter/continuous_expR</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> z</span><span class="id"> zab;</span><span class="id"> rewrite</span><span class="id"> derive_expR;</span><span class="id"> exact:</span><span class="id"> derivable_expR</span>.<br/>
<span class="id">-</span><span class="id"> rewrite</span><span class="id"> convC</span><span class="id"> [leRHS]convC;</span><span class="id"> apply:</span><span class="id"> second_derivative_convex</span><span class="id"> =&gt;</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> axb;</span><span class="id"> rewrite</span><span class="id"> derive_expR</span><span class="id"> derive_val</span><span class="id"> expR_ge0</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="id"> exact/cvg_at_left_filter/continuous_expR</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="id"> exact/cvg_at_right_filter/continuous_expR</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> z</span><span class="id"> zab;</span><span class="id"> rewrite</span><span class="id"> derive_expR;</span><span class="id"> exact:</span><span class="id"> derivable_expR</span>.<br/>
Qed.</div></details>
<span class="vernacular">Local</span><span class="vernacular"> Close</span><span class="vernacular"> Scope</span><span class="id"> convex_scope</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> expR</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 1.1.0&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `expRM_natl`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> expRMm</span><span class="id"> :=</span><span class="id"> expRM_natl</span> (<span class="id">only</span><span class="id"> parsing</span>).<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> expeR</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> realType}</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>) (<span class="id">r</span><span class="id"> s</span><span class="id"> :</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> ereal_scope</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> expeR</span><span class="id"> x</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> x</span><span class="gallina-kwd"> with</span><span class="id"> |</span><span class="id"> r%:E</span><span class="id"> =&gt;</span> (<span class="id">expR</span><span class="id"> r</span>)<span class="id">%:E</span><span class="id"> |</span><span class="id"> +oo</span><span class="id"> =&gt;</span><span class="id"> +oo</span><span class="id"> |</span><span class="id"> -oo</span><span class="id"> =&gt;</span><span class="id"> 0</span><span class="gallina-kwd"> end</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expeR0</span><span class="id"> :</span><span class="id"> expeR</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 1</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> expR0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expeR_ge0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> expeR</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> r;</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> expR_ge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expeR_gt0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -oo</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> expeR</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> r;</span><span class="id"> rewrite</span><span class="id"> lte_fin</span><span class="id"> expR_gt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expeR_eq0</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">expeR</span><span class="id"> x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> -oo</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> [r|];</span><span class="id"> rewrite</span><span class="id"> ?eqxx//</span><span class="id"> eqe</span><span class="id"> expR_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expeRD</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> expeR</span> (<span class="id">x</span><span class="id"> +</span><span class="id"> y</span>)<span class="id"> =</span><span class="id"> expeR</span><span class="id"> x</span><span class="id"> *</span><span class="id"> expeR</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> [r|</span><span class="id"> |];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul0e</span>.<br/>
<span class="id">-</span><span class="id"> case:</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> [s|</span><span class="id"> |];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mule0</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> expRD</span><span class="id"> EFinM</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulry</span><span class="id"> gtr0_sg</span><span class="id"> ?mul1e//</span><span class="id"> expR_gt0</span>.<br/>
<span class="id">-</span><span class="id"> case:</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> [s|</span><span class="id"> |];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mule0</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulyr</span><span class="id"> gtr0_sg</span><span class="id"> ?mul1e//</span><span class="id"> expR_gt0</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulyy</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expeR_ge1Dx</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> +</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> expeR</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">case</span><span class="id"> :</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> [r|];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> addeNy</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -EFinD</span><span class="id"> !lee_fin;</span><span class="id"> exact:</span><span class="id"> expR_ge1Dx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_expeR</span><span class="id"> :</span><span class="id"> {mono</span><span class="id"> expeR</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> [r|</span><span class="id"> |]</span><span class="id"> [s|</span><span class="id"> |]//=;</span><span class="id"> rewrite</span><span class="id"> ?ltry//</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !lte_fin</span><span class="id"> ltr_expR</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !ltNge</span><span class="id"> lee_fin</span><span class="id"> expR_ge0</span><span class="id"> leNye</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lte_fin</span><span class="id"> expR_gt0</span><span class="id"> ltNye</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_expeR</span><span class="id"> :</span><span class="id"> {mono</span><span class="id"> expeR</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> [r|</span><span class="id"> |]</span><span class="id"> [s|</span><span class="id"> |]//=;</span><span class="id"> rewrite</span><span class="id"> ?leey</span><span class="id"> ?lexx//</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !lee_fin</span><span class="id"> ler_expR</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !leNgt</span><span class="id"> lte_fin</span><span class="id"> expR_gt0</span><span class="id"> ltNye</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> expR_ge0</span><span class="id"> leNye</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expeR_inj</span><span class="id"> :</span><span class="id"> injective</span><span class="id"> expeR</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> [r|</span><span class="id"> |]</span><span class="id"> [s|</span><span class="id"> |]</span><span class="id"> =&gt;</span><span class="id"> //=</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> []</span><span class="id"> /expR_inj</span><span class="id"> -&gt;</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> case</span><span class="id"> =&gt;</span><span class="id"> /eqP;</span><span class="id"> rewrite</span><span class="id"> expR_eq0</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> case</span><span class="id"> =&gt;</span><span class="id"> /esym/eqP;</span><span class="id"> rewrite</span><span class="id"> expR_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expeR_total</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="gallina-kwd"> exists</span><span class="id"> y,</span><span class="id"> expeR</span><span class="id"> y</span><span class="id"> =</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [r|_|//];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="gallina-kwd"> exists</span><span class="id"> +oo</span>.<br/>
<span class="id">rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-|];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="gallina-kwd"> exists</span><span class="id"> -oo</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lte_fin</span><span class="id"> =&gt;</span><span class="id"> /expR_total[y</span><span class="id"> &lt;-];</span><span class="gallina-kwd"> exists</span><span class="id"> y%:E</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> expeR</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> Ln</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> realType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Notation</span><span class="id"> exp</span><span class="id"> :=</span> (<span class="id">@expR</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> ln</span><span class="id"> x</span><span class="id"> :</span><span class="id"> R</span><span class="id"> :=</span><span class="id"> [get</span><span class="id"> y</span><span class="id"> |</span><span class="id"> exp</span><span class="id"> y</span><span class="id"> ==</span><span class="id"> x</span><span class="id"> ]</span>.<br/>
<br/>
<span class="vernacular">Fact</span><span class="id"> ln0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> ln</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /ln;</span><span class="id"> case:</span><span class="id"> xgetP</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> y</span><span class="id"> _</span><span class="id"> /eqP</span><span class="id"> yx</span><span class="id"> x0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> expR_gt0</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> yx</span><span class="id"> =&gt;</span><span class="id"> /</span>(<span class="id">le_lt_trans</span><span class="id"> x0</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ltxx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expRK</span><span class="id"> :</span><span class="id"> cancel</span><span class="id"> exp</span><span class="id"> ln</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> /ln;</span><span class="id"> case:</span><span class="id"> xgetP</span><span class="id"> =&gt;</span><span class="id"> [x1</span><span class="id"> _</span><span class="id"> /eqP/expR_inj</span><span class="id"> //|/</span>(_<span class="id"> x</span>)<span class="id">[]/=]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lnK</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> Num</span>.<span class="id">pos,</span><span class="id"> cancel</span><span class="id"> ln</span><span class="id"> exp}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> qualifE</span><span class="id"> =&gt;</span><span class="id"> x_gt0</span>.<br/>
<span class="id">rewrite</span><span class="id"> /ln;</span><span class="id"> case:</span><span class="id"> xgetP=&gt;</span><span class="id"> [x1</span><span class="id"> _</span><span class="id"> /eqP//</span><span class="id"> |H]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">expR_total</span><span class="id"> x_gt0</span>)<span class="id"> =&gt;</span><span class="id"> y</span><span class="id"> /eqP</span><span class="id"> Hy;</span><span class="id"> case:</span> (<span class="id">H</span><span class="id"> y</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lnK_eq</span><span class="id"> x</span><span class="id"> :</span> (<span class="id">exp</span> (<span class="id">ln</span><span class="id"> x</span>)<span class="id"> ==</span><span class="id"> x</span>)<span class="id"> =</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> x</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> apply/eqP/idP=&gt;</span><span class="id"> [&lt;-|x0];</span><span class="id"> [exact:</span><span class="id"> expR_gt0|rewrite</span><span class="id"> lnK//</span><span class="id"> in_itv/=</span><span class="id"> x0]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ln1</span><span class="id"> :</span><span class="id"> ln</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/expR_inj;</span><span class="id"> rewrite</span><span class="id"> lnK//</span><span class="id"> ?expR0//</span><span class="id"> qualifE/=</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lnM</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> Num</span>.<span class="id">pos</span><span class="id"> &amp;,</span><span class="id"> {morph</span><span class="id"> ln</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> *</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span><span class="id"> x</span><span class="id"> +</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> x0</span><span class="id"> y0;</span><span class="id"> apply:</span><span class="id"> expR_inj;</span><span class="id"> rewrite</span><span class="id"> expRD</span><span class="id"> !lnK//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x0</span><span class="id"> y0;</span><span class="id"> rewrite</span><span class="id"> !qualifE;</span><span class="id"> exact:</span><span class="id"> mulr_gt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ln_inj</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> Num</span>.<span class="id">pos</span><span class="id"> &amp;,</span><span class="id"> injective</span><span class="id"> ln}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /lnK</span><span class="id"> {2}&lt;-</span><span class="id"> /lnK</span><span class="id"> {2}&lt;-</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lnV</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> Num</span>.<span class="id">pos,</span><span class="id"> {morph</span><span class="id"> ln</span><span class="id"> :</span><span class="id"> x</span><span class="id"> /</span><span class="id"> x</span><span class="id"> ^-1</span><span class="id"> &gt;-&gt;</span><span class="id"> -</span><span class="id"> x}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> x0;</span><span class="id"> apply:</span><span class="id"> expR_inj;</span><span class="id"> rewrite</span><span class="id"> lnK//</span><span class="id"> ?expRN</span><span class="id"> ?lnK//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x0;</span><span class="id"> rewrite</span><span class="id"> !qualifE/=</span><span class="id"> invr_gt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ln_div</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> Num</span>.<span class="id">pos</span><span class="id"> &amp;,</span><span class="id"> {morph</span><span class="id"> ln</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> /</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span><span class="id"> x</span><span class="id"> -</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> x0</span><span class="id"> y0;</span><span class="id"> rewrite</span> (<span class="id">lnM</span><span class="id"> x0</span>)<span class="id"> ?lnV//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> y0;</span><span class="id"> rewrite</span><span class="id"> !qualifE/=</span><span class="id"> invr_gt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ltr_ln</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> Num</span>.<span class="id">pos</span><span class="id"> &amp;,</span><span class="id"> {mono</span><span class="id"> ln</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> x_gt0</span><span class="id"> y_gt0;</span><span class="id"> rewrite</span><span class="id"> -ltr_expR</span><span class="id"> !lnK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_ln</span><span class="id"> :</span><span class="id"> {in</span><span class="id"> Num</span>.<span class="id">pos</span><span class="id"> &amp;,</span><span class="id"> {mono</span><span class="id"> ln</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x</span><span class="id"> y</span><span class="id"> x_gt0</span><span class="id"> y_gt0;</span><span class="id"> rewrite</span><span class="id"> -ler_expR</span><span class="id"> !lnK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lnXn</span><span class="id"> n</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> ln</span> (<span class="id">x</span><span class="id"> ^+</span><span class="id"> n</span>)<span class="id"> =</span><span class="id"> ln</span><span class="id"> x</span><span class="id"> *+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x_gt0;</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> ih]</span><span class="id"> /=;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> expr0</span><span class="id"> ln1</span><span class="id"> mulr0n</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !exprS</span><span class="id"> lnM</span><span class="id"> ?qualifE//=</span><span class="id"> ?exprn_gt0//</span><span class="id"> mulrS</span><span class="id"> ih</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> le_ln1Dx</span><span class="id"> x</span><span class="id"> :</span><span class="id"> -1</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> ln</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> x</span>)<span class="id"> &lt;=</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> N1x;</span><span class="id"> rewrite</span><span class="id"> -ler_expR</span><span class="id"> lnK</span><span class="id"> ?expR_ge1Dx</span><span class="id"> //</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> posrE</span><span class="id"> addrC</span><span class="id"> -ltrBlDr</span><span class="id"> sub0r</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ln_sublinear</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> ln</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x_gt0;</span><span class="id"> apply:</span><span class="id"> lt_le_trans</span> (_<span class="id"> :</span><span class="id"> ln</span> (<span class="id">1</span><span class="id"> +</span><span class="id"> x</span>)<span class="id"> &lt;=</span><span class="id"> _</span>).<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -ltr_expR</span><span class="id"> !lnK</span><span class="id"> ?qualifE/=</span><span class="id"> ?addr_gt0</span><span class="id"> //</span><span class="id"> ltrDr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -ler_expR</span><span class="id"> lnK</span><span class="id"> ?qualifE/=</span><span class="id"> ?addr_gt0//</span><span class="id"> expR_ge1Dx</span><span class="id"> //</span><span class="id"> ltW</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ln_ge0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> ln</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x_ge1;</span><span class="id"> rewrite</span><span class="id"> -ler_expR</span><span class="id"> expR0</span><span class="id"> lnK//</span><span class="id"> qualifE/=</span> (<span class="id">lt_le_trans</span><span class="id"> _</span><span class="id"> x_ge1</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ln_lt0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> ln</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /andP[x_gt0</span><span class="id"> x_lt1];</span><span class="id"> rewrite</span><span class="id"> -ltr_expR</span><span class="id"> expR0</span><span class="id"> lnK</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ln_gt0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> ln</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> x_gt1;</span><span class="id"> rewrite</span><span class="id"> -ltr_expR</span><span class="id"> expR0</span><span class="id"> lnK</span><span class="id"> //</span><span class="id"> qualifE/=</span> (<span class="id">lt_trans</span><span class="id"> _</span><span class="id"> x_gt1</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ln_le0</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> ln</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [x0|x0</span><span class="id"> x1]</span><span class="id"> :=</span><span class="id"> leP</span><span class="id"> x</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> ln0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -ler_expR</span><span class="id"> expR0</span><span class="id"> lnK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> continuous_ln</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> {for</span><span class="id"> x,</span><span class="id"> continuous</span><span class="id"> ln}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x_gt0;</span><span class="id"> rewrite</span><span class="id"> -[x]lnK//</span>.<br/>
<span class="id">apply:</span><span class="id"> nbhs_singleton</span> (<span class="id">near_can_continuous</span><span class="id"> _</span><span class="id"> _</span>)<span class="id">;</span><span class="id"> near=&gt;</span><span class="id"> z;</span><span class="id"> first</span><span class="id"> exact:</span><span class="id"> expRK</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply:</span><span class="id"> continuous_expR</span>.<br/>
<span class="id">Unshelve</span>.<span class="id"> all:</span><span class="gallina-kwd"> by</span><span class="id"> end_near</span>. Qed.</div></details>
<br/>
<span class="id">Global</span><span class="vernacular"> Instance</span><span class="id"> is_derive1_ln</span> (<span class="id">x</span><span class="id"> :</span><span class="id"> R</span>)<span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> is_derive</span><span class="id"> x</span><span class="id"> 1</span><span class="id"> ln</span><span class="id"> x^-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x_gt0;</span><span class="id"> rewrite</span><span class="id"> -[x]lnK//</span>.<br/>
<span class="id">apply:</span> (<span class="id">@is_derive_inverse</span><span class="id"> R</span><span class="id"> expR</span>)<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> near=&gt;</span><span class="id"> z;</span><span class="id"> apply:</span><span class="id"> expRK</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> near=&gt;z;</span><span class="id"> apply:</span><span class="id"> continuous_expR</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lnK</span><span class="id"> //</span><span class="id"> lt0r_neq0</span>.<br/>
<span class="id">Unshelve</span>.<span class="id"> all:</span><span class="gallina-kwd"> by</span><span class="id"> end_near</span>. Qed.</div></details>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> convex_scope</span>.<br/>
<span class="vernacular">Lemma</span><span class="id"> concave_ln</span> (<span class="id">t</span><span class="id"> :</span><span class="id"> {i01</span><span class="id"> R}</span>) (<span class="id">a</span><span class="id"> b</span><span class="id"> :</span><span class="id"> R^o</span>)<span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> a</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> b</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">ln</span><span class="id"> a</span><span class="id"> :</span><span class="id"> R^o</span>)<span class="id"> &lt;|</span><span class="id"> t</span><span class="id"> |&gt;</span> (<span class="id">ln</span><span class="id"> b</span><span class="id"> :</span><span class="id"> R^o</span>)<span class="id"> &lt;=</span><span class="id"> ln</span> (<span class="id">a</span><span class="id"> &lt;|</span><span class="id"> t</span><span class="id"> |&gt;</span><span class="id"> b</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> a0</span><span class="id"> b0;</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> convex_expR</span><span class="id"> t</span> (<span class="id">ln</span><span class="id"> a</span>) (<span class="id">ln</span><span class="id"> b</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !lnK//</span><span class="id"> -</span>(<span class="id">@ler_ln</span>)<span class="id"> ?posrE</span><span class="id"> ?expR_gt0</span><span class="id"> ?conv_gt0//</span><span class="id"> expRK</span>.<br/>
Qed.</div></details>
<span class="vernacular">Local</span><span class="vernacular"> Close</span><span class="vernacular"> Scope</span><span class="id"> convex_scope</span>.<br/>
<br/>
<span class="vernacular">End</span><span class="id"> Ln</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> PowR</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> realType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> a</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> r</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> powR</span><span class="id"> a</span><span class="id"> x</span><span class="id"> :=</span><span class="gallina-kwd"> if</span><span class="id"> a</span><span class="id"> ==</span><span class="id"> 0</span><span class="gallina-kwd"> then</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">%:R</span><span class="gallina-kwd"> else</span><span class="id"> expR</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> ln</span><span class="id"> a</span>).<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;a `^ x&quot;</span><span class="id"> :=</span> (<span class="id">powR</span><span class="id"> a</span><span class="id"> x</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> expRM</span><span class="id"> x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> expR</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> =</span> (<span class="id">expR</span><span class="id"> x</span>)<span class="id"> `^</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /powR</span><span class="id"> gt_eqF</span><span class="id"> ?expR_gt0//</span><span class="id"> expRK</span><span class="id"> mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> powR_ge0</span><span class="id"> a</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> `^</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /powR;</span><span class="id"> case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> _;</span><span class="id"> exact:</span><span class="id"> expR_ge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> powR_gt0</span><span class="id"> a</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> a</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> a</span><span class="id"> `^</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a0;</span><span class="id"> rewrite</span><span class="id"> /powR</span><span class="id"> gt_eqF//</span><span class="id"> expR_gt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gt0_powR</span><span class="id"> a</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> a</span><span class="id"> `^</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x0</span><span class="id"> a0;</span><span class="id"> rewrite</span><span class="id"> /powR;</span><span class="id"> case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> [_|a_neq0</span><span class="id"> _]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> gt_eqF//=</span><span class="id"> ltxx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lt_neqAle</span><span class="id"> a0</span><span class="id"> andbT</span><span class="id"> eq_sym</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> powR0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> `^</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> x0;</span><span class="id"> rewrite</span><span class="id"> /powR</span><span class="id"> eqxx</span> (<span class="id">negbTE</span><span class="id"> x0</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> powRr1</span><span class="id"> a</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> `^</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-|a0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> powR0//</span><span class="id"> oner_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /powR</span><span class="id"> gt_eqF//</span><span class="id"> mul1r</span><span class="id"> lnK//</span><span class="id"> posrE</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> powRr0</span><span class="id"> a</span><span class="id"> :</span><span class="id"> a</span><span class="id"> `^</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /powR;</span><span class="id"> case:</span><span class="id"> ifPn;</span><span class="id"> rewrite</span><span class="id"> ?eqxx//</span><span class="id"> mul0r</span><span class="id"> expR0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> powR1</span><span class="id"> :</span><span class="id"> powR</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> fun=&gt;</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> apply/funext</span><span class="id"> =&gt;</span><span class="id"> x;</span><span class="id"> rewrite</span><span class="id"> /powR</span><span class="id"> oner_eq0</span><span class="id"> ln1</span><span class="id"> mulr0</span><span class="id"> expR0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> powR_eq0</span><span class="id"> x</span><span class="id"> p</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> `^</span><span class="id"> p</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">p</span><span class="id"> !=</span><span class="id"> 0</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /powR;</span><span class="id"> have</span><span class="id"> [_|x_neq0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> x</span><span class="id"> 0</span><span class="id"> =&gt;</span><span class="id"> //</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">p</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">;</span><span class="id"> rewrite</span> (<span class="id">oner_eq0,</span><span class="id"> eqxx</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> expR_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> powR_eq0_eq0</span><span class="id"> x</span><span class="id"> p</span><span class="id"> :</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> p</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /eqP;</span><span class="id"> rewrite</span><span class="id"> powR_eq0</span><span class="id"> =&gt;</span><span class="id"> /andP[/eqP]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ger_powR</span><span class="id"> a</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> {homo</span><span class="id"> powR</span><span class="id"> a</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /~</span><span class="id"> y</span><span class="id"> &lt;=</span><span class="id"> x}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /andP[a0</span><span class="id"> a1]</span><span class="id"> x</span><span class="id"> y</span><span class="id"> xy</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /powR</span><span class="id"> gt_eqF//</span><span class="id"> ler_expR</span><span class="id"> ler_wnM2r//</span><span class="id"> ln_le0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler_powR</span><span class="id"> a</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> -&gt;</span><span class="id"> {homo</span><span class="id"> powR</span><span class="id"> a</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> a1</span><span class="id"> x</span><span class="id"> y</span><span class="id"> xy</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /powR</span><span class="id"> gt_eqF</span><span class="id"> ?</span>(<span class="id">lt_le_trans</span><span class="id"> _</span><span class="id"> a1</span>)<span class="id">//</span><span class="id"> ler_expR</span><span class="id"> ler_wpM2r</span><span class="id"> ?ln_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> powR_injective</span><span class="id"> r</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> r</span><span class="id"> -&gt;</span><span class="id"> {in</span><span class="id"> Num</span>.<span class="id">nneg</span><span class="id"> &amp;,</span><span class="id"> injective</span> (<span class="id">powR</span><span class="id"> ^~</span><span class="id"> r</span>)<span class="id">}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> r0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> x0</span><span class="id"> y0;</span><span class="id"> rewrite</span><span class="id"> /powR;</span><span class="id"> case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> [/eqP</span><span class="id"> -&gt;|xneq0]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> [/eqP</span><span class="id"> -&gt;//|_</span><span class="id"> /eqP];</span><span class="id"> rewrite</span> (<span class="id">gt_eqF</span><span class="id"> r0</span>)<span class="id"> eq_sym</span><span class="id"> expR_eq0</span>.<br/>
<span class="id">case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> [/eqP</span><span class="id"> -&gt;</span><span class="id"> /eqP|yneq0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span> (<span class="id">gt_eqF</span><span class="id"> r0</span>)<span class="id"> expR_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> move/expR_inj/mulfI</span><span class="id"> =&gt;</span><span class="id"> /</span>(_ (<span class="id">negbT</span> (<span class="id">gt_eqF</span><span class="id"> r0</span>)))<span class="id">;</span><span class="id"> apply:</span><span class="id"> ln_inj;</span><br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> posrE</span><span class="id"> lt_neqAle</span><span class="id"> eq_sym</span> (<span class="id">xneq0,yneq0</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ler1_powR</span><span class="id"> a</span><span class="id"> r</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> -&gt;</span><span class="id"> r</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> &gt;=</span><span class="id"> a</span><span class="id"> `^</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> a1</span><span class="id"> r1;</span><span class="id"> rewrite</span> (<span class="id">le_trans</span> (<span class="id">ler_powR</span><span class="id"> _</span><span class="id"> r1</span>))<span class="id"> ?powRr1//</span> (<span class="id">le_trans</span><span class="id"> _</span><span class="id"> a1</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> le1r_powR</span><span class="id"> a</span><span class="id"> r</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> -&gt;</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> r</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> `^</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> a1</span><span class="id"> r1;</span><span class="id"> rewrite</span> (<span class="id">le_trans</span><span class="id"> _</span> (<span class="id">ler_powR</span><span class="id"> _</span><span class="id"> r1</span>))<span class="id"> ?powRr1//</span> (<span class="id">le_trans</span><span class="id"> _</span><span class="id"> a1</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ger1_powR</span><span class="id"> a</span><span class="id"> r</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> r</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> `^</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /andP[a0</span><span class="id"> _a1]</span><span class="id"> r1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">le_trans</span><span class="id"> _</span> (<span class="id">ger_powR</span><span class="id"> _</span><span class="id"> r1</span>))<span class="id"> ?powRr1</span><span class="id"> ?a0//</span><span class="id"> ltW</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ge1r_powR</span><span class="id"> a</span><span class="id"> r</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> r</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> &gt;=</span><span class="id"> a</span><span class="id"> `^</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /andP[a0</span><span class="id"> a1]</span><span class="id"> r1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">le_trans</span> (<span class="id">ger_powR</span><span class="id"> _</span><span class="id"> r1</span>))<span class="id"> ?powRr1</span><span class="id"> ?a0//</span><span class="id"> ltW</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ge0_ler_powR</span><span class="id"> r</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> r</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> Num</span>.<span class="id">nneg</span><span class="id"> &amp;,</span><span class="id"> {homo</span><span class="id"> powR</span><span class="id"> ^~</span><span class="id"> r</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-</span><span class="id"> x</span><span class="id"> y</span><span class="id"> _</span><span class="id"> _</span><span class="id"> _|];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !powRr0</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> a0</span><span class="id"> x</span><span class="id"> y;</span><span class="id"> rewrite</span><span class="id"> 2!nnegrE</span><span class="id"> !le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-|x0]</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> /predU1P[&lt;-</span><span class="id"> _|y0</span><span class="id"> _];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqxx</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !powR0</span><span class="id"> ?</span>(<span class="id">gt_eqF</span><span class="id"> a0</span>)<span class="id">//</span><span class="id"> powR_gt0</span><span class="id"> ?orbT</span>.<br/>
<span class="id">move=&gt;</span><span class="id"> /predU1P[&lt;-|y0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> gt_eqF//=</span><span class="id"> ltNge</span> (<span class="id">ltW</span><span class="id"> x0</span>).<br/>
<span class="id">move=&gt;</span><span class="id"> /predU1P[-&gt;//|xy];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> eqxx</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> apply/orP;</span><span class="id"> right;</span><span class="id"> rewrite</span><span class="id"> /powR</span><span class="id"> !gt_eqF//</span><span class="id"> ltr_expR</span><span class="id"> ltr_pM2l//</span><span class="id"> ltr_ln</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gt0_ltr_powR</span><span class="id"> r</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> r</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> Num</span>.<span class="id">nneg</span><span class="id"> &amp;,</span><span class="id"> {homo</span><span class="id"> powR</span><span class="id"> ^~</span><span class="id"> r</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> r0</span><span class="id"> x</span><span class="id"> y</span><span class="id"> x0</span><span class="id"> y0</span><span class="id"> xy;</span><span class="id"> have</span><span class="id"> :=</span><span class="id"> ge0_ler_powR</span> (<span class="id">ltW</span><span class="id"> r0</span>)<span class="id"> x0</span><span class="id"> y0</span> (<span class="id">ltW</span><span class="id"> xy</span>).<br/>
<span class="id">rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /orP[/eqP/</span>(<span class="id">powR_injective</span><span class="id"> r0</span><span class="id"> x0</span><span class="id"> y0</span>)<span class="id">/eqP|//]</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lt_eqF</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> powRM</span><span class="id"> x</span><span class="id"> y</span><span class="id"> r</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> `^</span><span class="id"> r</span><span class="id"> =</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> r</span><span class="id"> *</span><span class="id"> y</span><span class="id"> `^</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /powR</span><span class="id"> mulf_eq0</span>.<br/>
<span class="id">case:</span> (<span class="id">ltgtP</span><span class="id"> x</span><span class="id"> 0</span>)<span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> x0</span><span class="id"> _;</span><span class="id"> case:</span> (<span class="id">ltgtP</span><span class="id"> y</span><span class="id"> 0</span>)<span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> y0</span><span class="id"> _;</span><span class="id"> do</span><span class="id"> ?</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> eqVneq</span><span class="id"> =&gt;</span><span class="id"> [r0|];</span><span class="id"> rewrite</span><span class="id"> ?r0</span><span class="id"> ?mul0r</span><span class="id"> ?expR0</span><span class="id"> ?mulr0</span><span class="id"> ?mul1r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lnM//</span><span class="id"> mulrDr</span><span class="id"> expRD</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ge1r_powRZ</span><span class="id"> x</span><span class="id"> y</span><span class="id"> r</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> r</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> `^</span><span class="id"> r</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> *</span> (<span class="id">y</span><span class="id"> `^</span><span class="id"> r</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /andP[x0</span><span class="id"> x1]</span><span class="id"> y0</span><span class="id"> r1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">powRM</span><span class="id"> _</span> (<span class="id">ltW</span><span class="id"> _</span>))<span class="id">//</span><span class="id"> ler_wpM2r</span><span class="id"> ?powR_ge0//</span><span class="id"> ge1r_powR//</span><span class="id"> x0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> le1r_powRZ</span><span class="id"> x</span><span class="id"> y</span><span class="id"> r</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &gt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span><span class="id"> 1</span><span class="id"> &lt;=</span><span class="id"> r</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;(<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> `^</span><span class="id"> r</span><span class="id"> &gt;=</span><span class="id"> x</span><span class="id"> *</span> (<span class="id">y</span><span class="id"> `^</span><span class="id"> r</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> x1</span><span class="id"> y0</span><span class="id"> r1</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">powRM</span><span class="id"> _</span> (<span class="id">le_trans</span><span class="id"> _</span><span class="id"> x1</span>))<span class="id">//</span><span class="id"> ler_wpM2r</span><span class="id"> ?powR_ge0//</span><span class="id"> le1r_powR//</span><span class="id"> x0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> powRrM</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span><span class="id"> x</span><span class="id"> `^</span> (<span class="id">y</span><span class="id"> *</span><span class="id"> z</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> `^</span><span class="id"> y</span>)<span class="id"> `^</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /powR</span><span class="id"> mulf_eq0;</span><span class="id"> have</span><span class="id"> [_|xN0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> x</span><span class="id"> 0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> case:</span> (<span class="id">y</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">;</span><span class="id"> rewrite</span><span class="id"> ?eqxx//=</span><span class="id"> oner_eq0</span><span class="id"> ln1</span><span class="id"> mulr0</span><span class="id"> expR0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> expR_eq0</span><span class="id"> expRK</span><span class="id"> mulrCA</span><span class="id"> mulrA</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> powRAC</span><span class="id"> x</span><span class="id"> y</span><span class="id"> z</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> `^</span><span class="id"> y</span>)<span class="id"> `^</span><span class="id"> z</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> `^</span><span class="id"> z</span>)<span class="id"> `^</span><span class="id"> y</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -!powRrM</span><span class="id"> mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> powRD</span><span class="id"> x</span><span class="id"> r</span><span class="id"> s</span><span class="id"> :</span> (<span class="id">r</span><span class="id"> +</span><span class="id"> s</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> ==&gt;</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> `^</span> (<span class="id">r</span><span class="id"> +</span><span class="id"> s</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> r</span><span class="id"> *</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> s</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /powR;</span><span class="id"> case:</span> (<span class="id">eqVneq</span><span class="id"> x</span><span class="id"> 0</span>)<span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> [_|x_neq0</span><span class="id"> _];</span><br/>
&nbsp;&nbsp;<span class="id">last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulrDl</span><span class="id"> expRD</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> r</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul1r</span><span class="id"> add0r</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> implybF</span><span class="id"> mul0r</span><span class="id"> =&gt;</span><span class="id"> _</span><span class="id"> /negPf</span><span class="id"> -&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> mulr_powRB1</span><span class="id"> x</span><span class="id"> p</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> *</span><span class="id"> x</span><span class="id"> `^</span> (<span class="id">p</span><span class="id"> -</span><span class="id"> 1</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> p</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-</span><span class="id"> p0|x0</span><span class="id"> p0];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> powR0</span><span class="id"> ?gt_eqF</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -{1}</span>(<span class="id">powRr1</span> (<span class="id">ltW</span><span class="id"> x0</span>))<span class="id">//</span><span class="id"> -powRD</span><span class="id"> addrCA</span><span class="id"> subrr</span><span class="id"> addr0//</span><span class="id"> gt_eqF</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> powRN</span><span class="id"> x</span><span class="id"> r</span><span class="id"> :</span><span class="id"> x</span><span class="id"> `^</span> (<span class="id">-</span><span class="id"> r</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> `^</span><span class="id"> r</span>)<span class="id">^-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [r0|r0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> r</span><span class="id"> 0%R;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> r0</span><span class="id"> oppr0</span><span class="id"> powRr0</span><span class="id"> invr1</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|xN0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> x</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !powR0</span><span class="id"> ?oppr_eq0//</span><span class="id"> invr0</span>.<br/>
<span class="id">rewrite</span><span class="id"> -div1r;</span><span class="id"> apply:</span> (<span class="id">canRL</span> (<span class="id">mulfK</span><span class="id"> _</span>))<span class="id">;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> powR_eq0</span> (<span class="id">negPf</span><span class="id"> xN0</span>).<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -powRD</span><span class="id"> ?addNr</span><span class="id"> ?powRr0//</span><span class="id"> xN0</span><span class="id"> eqxx</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> powRB</span><span class="id"> x</span><span class="id"> r</span><span class="id"> s</span><span class="id"> :</span> (<span class="id">r</span><span class="id"> ==</span><span class="id"> s</span>)<span class="id"> ==&gt;</span> (<span class="id">x</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> `^</span> (<span class="id">r</span><span class="id"> -</span><span class="id"> s</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> r</span><span class="id"> /</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> s</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> powRD</span><span class="id"> ?subr_eq0//</span><span class="id"> powRN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> powR_mulrn</span><span class="id"> a</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> `^</span><span class="id"> n%:R</span><span class="id"> =</span><span class="id"> a</span><span class="id"> ^+</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> a_ge0;</span><span class="id"> elim:</span><span class="id"> n</span><span class="id"> =&gt;</span><span class="id"> [|n</span><span class="id"> IHn];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> powRr0</span><span class="id"> expr0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> -natr1</span><span class="id"> powRD</span><span class="id"> ?natr1</span><span class="id"> ?pnatr_eq0//</span><span class="id"> powRr1//</span><span class="id"> IHn</span><span class="id"> exprSr</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> powR_inv1</span><span class="id"> a</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> `^</span> (<span class="id">-1</span>)<span class="id"> =</span><span class="id"> a</span><span class="id"> ^-1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a_ge0;</span><span class="id"> rewrite</span><span class="id"> powRN</span><span class="id"> powRr1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> powR_invn</span><span class="id"> a</span><span class="id"> n</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> `^</span> (<span class="id">-</span><span class="id"> n%:R</span>)<span class="id"> =</span><span class="id"> a</span><span class="id"> ^-</span><span class="id"> n</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a_ge0;</span><span class="id"> rewrite</span><span class="id"> powRN</span><span class="id"> powR_mulrn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> powR_intmul</span><span class="id"> a</span> (<span class="id">z</span><span class="id"> :</span><span class="id"> int</span>)<span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> `^</span><span class="id"> z%:~R</span><span class="id"> =</span><span class="id"> a</span><span class="id"> ^</span><span class="id"> z</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> a0;</span><span class="id"> case:</span><span class="id"> z</span><span class="id"> =&gt;</span><span class="id"> n;</span><span class="id"> [exact:</span><span class="id"> powR_mulrn</span><span class="id"> |</span><span class="id"> exact:</span><span class="id"> powR_invn]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> ln_powR</span><span class="id"> a</span><span class="id"> x</span><span class="id"> :</span><span class="id"> ln</span> (<span class="id">a</span><span class="id"> `^</span><span class="id"> x</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> *</span><span class="id"> ln</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;|x0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> x</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> powRr0</span><span class="id"> ln1//</span><span class="id"> mul0r</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|a0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> a</span><span class="id"> 0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> powR0//</span><span class="id"> ln0//</span><span class="id"> mulr0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /powR</span> (<span class="id">negbTE</span><span class="id"> a0</span>)<span class="id"> expRK</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> powR12_sqrt</span><span class="id"> a</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> -&gt;</span><span class="id"> a</span><span class="id"> `^</span> (<span class="id">2^-1</span>)<span class="id"> =</span><span class="id"> Num</span>.<span class="id">sqrt</span><span class="id"> a</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-|a0]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> powR0</span><span class="id"> ?invr_eq0</span><span class="id"> ?pnatr_eq0//</span><span class="id"> sqrtr0</span>.<br/>
<span class="id">have</span><span class="id"> /eqP</span><span class="id"> :</span> (<span class="id">a</span><span class="id"> `^</span> (<span class="id">2^-1</span>))<span class="id"> ^+</span><span class="id"> 2</span><span class="id"> =</span> (<span class="id">Num</span>.<span class="id">sqrt</span><span class="id"> a</span>)<span class="id"> ^+</span><span class="id"> 2</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> sqr_sqrtr;</span><span class="id"> last</span><span class="id"> exact:</span><span class="id"> ltW</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> /powR</span><span class="id"> gt_eqF//</span><span class="id"> -expRM_natl</span><span class="id"> mulrA</span><span class="id"> divrr</span><span class="id"> ?mul1r</span><span class="id"> ?unitfE//</span><span class="id"> lnK</span>.<br/>
<span class="id">rewrite</span><span class="id"> eqf_sqr</span><span class="id"> =&gt;</span><span class="id"> /predU1P[//|/eqP</span><span class="id"> h]</span>.<br/>
<span class="id">have</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> a</span><span class="id"> `^</span><span class="id"> 2^-1</span><span class="gallina-kwd"> by</span><span class="id"> exact:</span><span class="id"> powR_gt0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> h</span><span class="id"> oppr_gt0</span><span class="id"> ltNge</span><span class="id"> sqrtr_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> norm_powR</span><span class="id"> a</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> -&gt;</span><span class="id"> `|a</span><span class="id"> `^</span><span class="id"> x|</span><span class="id"> =</span><span class="id"> `|a|</span><span class="id"> `^</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> a0;</span><span class="id"> rewrite</span><span class="id"> /powR;</span><span class="id"> case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> [/eqP</span><span class="id"> -&gt;|]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> normr0</span><span class="id"> eqxx</span><span class="id"> normr_nat</span>.<br/>
<span class="id">rewrite</span><span class="id"> neq_lt</span><span class="id"> ltNge</span><span class="id"> a0/=</span><span class="id"> =&gt;</span><span class="id"> {}a0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> gtr0_norm</span><span class="id"> ?expR_gt0//</span><span class="id"> gtr0_norm//</span><span class="id"> gt_eqF</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lt0_norm_powR</span><span class="id"> a</span><span class="id"> x</span><span class="id"> :</span><span class="id"> a</span><span class="id"> &lt;</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> `|a</span><span class="id"> `^</span><span class="id"> x|</span><span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> a0;</span><span class="id"> rewrite</span><span class="id"> /powR</span><span class="id"> lt_eqF//</span><span class="id"> gtr0_norm</span><span class="id"> ?expR_gt0//</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> ln0</span><span class="id"> ?mulr0</span><span class="id"> ?expR0//</span><span class="id"> ltW</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> conjugate_powR</span><span class="id"> a</span><span class="id"> b</span><span class="id"> p</span><span class="id"> q</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> b</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">0</span><span class="id"> &lt;</span><span class="id"> p</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> q</span><span class="id"> -&gt;</span><span class="id"> p^-1</span><span class="id"> +</span><span class="id"> q^-1</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">a</span><span class="id"> *</span><span class="id"> b</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> `^</span><span class="id"> p</span><span class="id"> /</span><span class="id"> p</span><span class="id"> +</span><span class="id"> b</span><span class="id"> `^</span><span class="id"> q</span><span class="id"> /</span><span class="id"> q</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-</span><span class="id"> b0</span><span class="id"> p0</span><span class="id"> q0</span><span class="id"> _|a0]</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> powR0</span><span class="id"> ?gt_eqF//</span><span class="id"> mul0r</span><span class="id"> add0r</span><span class="id"> divr_ge0</span><span class="id"> ?powR_ge0</span><span class="id"> ?ltW</span>.<br/>
<span class="id">rewrite</span><span class="id"> le_eqVlt</span><span class="id"> =&gt;</span><span class="id"> /predU1P[&lt;-|b0]</span><span class="id"> p0</span><span class="id"> q0</span><span class="id"> pq</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mulr0</span><span class="id"> powR0</span><span class="id"> ?gt_eqF//</span><span class="id"> mul0r</span><span class="id"> addr0</span><span class="id"> divr_ge0</span><span class="id"> ?powR_ge0</span><span class="id"> ?ltW</span>.<br/>
<span class="id">have</span><span class="id"> q01</span><span class="id"> :</span> (<span class="id">q^-1</span><span class="id"> \in</span><span class="id"> `[0,</span><span class="id"> 1]</span>)<span class="id">%R</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> in_itv/=</span><span class="id"> invr_ge0</span> (<span class="id">ltW</span><span class="id"> q0</span>)<span class="id">/=</span><span class="id"> -pq</span><span class="id"> ler_wpDl//</span><span class="id"> invr_ge0</span><span class="id"> ltW</span>.<br/>
<span class="id">have</span><span class="id"> ap0</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> a</span><span class="id"> `^</span><span class="id"> p</span>)<span class="id">%R</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> powR_gt0</span>.<br/>
<span class="id">have</span><span class="id"> bq0</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> b</span><span class="id"> `^</span><span class="id"> q</span>)<span class="id">%R</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> powR_gt0</span>.<br/>
<span class="id">have</span><span class="id"> :=</span><span class="id"> @concave_ln</span><span class="id"> _</span> (<span class="id">@Itv</span>.<span class="id">mk</span><span class="id"> _</span><span class="id"> `[0,</span><span class="id"> 1]</span><span class="id"> _</span><span class="id"> q01</span>)<span class="id">%R</span><span class="id"> _</span><span class="id"> _</span><span class="id"> ap0</span><span class="id"> bq0</span>.<br/>
<span class="id">have</span><span class="id"> pq'</span><span class="id"> :</span> (<span class="id">p^-1</span><span class="id"> =</span><span class="id"> 1</span><span class="id"> -</span><span class="id"> q^-1</span>)<span class="id">%R</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -pq</span><span class="id"> addrK</span>.<br/>
<span class="id">rewrite</span><span class="id"> !convRE/=</span><span class="id"> /onem</span><span class="id"> -pq'</span><span class="id"> -[_</span><span class="id"> &lt;=</span><span class="id"> ln</span><span class="id"> _]ler_expR</span><span class="id"> expRD</span> (<span class="id">mulrC</span><span class="id"> p^-1</span>).<br/>
<span class="id">rewrite</span><span class="id"> ln_powR</span><span class="id"> mulrAC</span><span class="id"> divff</span><span class="id"> ?mul1r</span><span class="id"> ?gt_eqF//</span> (<span class="id">mulrC</span><span class="id"> q^-1</span>).<br/>
<span class="id">rewrite</span><span class="id"> ln_powR</span><span class="id"> mulrAC</span><span class="id"> divff</span><span class="id"> ?mul1r</span><span class="id"> ?gt_eqF//</span>.<br/>
<span class="id">rewrite</span><span class="id"> lnK</span><span class="id"> ?posrE//</span><span class="id"> lnK</span><span class="id"> ?posrE//</span><span class="id"> =&gt;</span><span class="id"> /le_trans;</span><span class="id"> apply</span>.<br/>
<span class="id">rewrite</span><span class="id"> lnK//;</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> posrE</span><span class="id"> addr_gt0//</span><span class="id"> mulr_gt0//</span><span class="id"> ?invr_gt0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span> (<span class="id">mulrC</span><span class="id"> _</span><span class="id"> p^-1</span>) (<span class="id">mulrC</span><span class="id"> _</span><span class="id"> q^-1</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> PowR</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;a `^ x&quot;</span><span class="id"> :=</span> (<span class="id">powR</span><span class="id"> a</span><span class="id"> x</span>)<span class="id"> :</span><span class="id"> ring_scope</span>.<br/>
<br/>
<span class="id">#[deprecated</span>(<span class="id">since=</span><span class="id">&quot;mathcomp-analysis 0.6.5&quot;</span><span class="id">,</span><span class="id"> note=</span><span class="id">&quot;renamed `ge0_ler_powR`&quot;</span>)<span class="id">]</span><br/>
<span class="vernacular">Notation</span><span class="id"> gt0_ler_powR</span><span class="id"> :=</span><span class="id"> ge0_ler_powR</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> poweR</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> ereal_scope</span>.<br/>
<span class="vernacular">Context</span><span class="id"> {R</span><span class="id"> :</span><span class="id"> realType}</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span> (<span class="id">s</span><span class="id"> r</span><span class="id"> :</span><span class="id"> R</span>) (<span class="id">x</span><span class="id"> y</span><span class="id"> :</span><span class="id"> \bar</span><span class="id"> R</span>).<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> poweR</span><span class="id"> x</span><span class="id"> r</span><span class="id"> :=</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">match</span><span class="id"> x</span><span class="gallina-kwd"> with</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> x'%:E</span><span class="id"> =&gt;</span> (<span class="id">x'</span><span class="id"> `^</span><span class="id"> r</span>)<span class="id">%:E</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> +oo</span><span class="id"> =&gt;</span><span class="gallina-kwd"> if</span><span class="id"> r</span><span class="id"> ==</span><span class="id"> 0%R</span><span class="gallina-kwd"> then</span><span class="id"> 1%E</span><span class="gallina-kwd"> else</span><span class="id"> +oo</span><br/>
&nbsp;&nbsp;<span class="id">|</span><span class="id"> -oo</span><span class="id"> =&gt;</span><span class="gallina-kwd"> if</span><span class="id"> r</span><span class="id"> ==</span><span class="id"> 0%R</span><span class="gallina-kwd"> then</span><span class="id"> 1%E</span><span class="gallina-kwd"> else</span><span class="id"> 0%E</span><br/>
&nbsp;&nbsp;<span class="gallina-kwd">end</span>.<br/>
<br/>
<span class="vernacular">Local</span><span class="vernacular"> Notation</span> <span class="id">&quot;x `^ r&quot;</span><span class="id"> :=</span> (<span class="id">poweR</span><span class="id"> x</span><span class="id"> r</span>).<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poweR_EFin</span><span class="id"> s</span><span class="id"> r</span><span class="id"> :</span><span class="id"> s%:E</span><span class="id"> `^</span><span class="id"> r</span><span class="id"> =</span> (<span class="id">s</span><span class="id"> `^</span><span class="id"> r</span>)<span class="id">%:E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poweRyr</span><span class="id"> r</span><span class="id"> :</span><span class="id"> r</span><span class="id"> !=</span><span class="id"> 0%R</span><span class="id"> -&gt;</span><span class="id"> +oo</span><span class="id"> `^</span><span class="id"> r</span><span class="id"> =</span><span class="id"> +oo</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move/negbTE</span><span class="id"> =&gt;</span><span class="id"> /=</span><span class="id"> -&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poweRe0</span><span class="id"> x</span><span class="id"> :</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> 0</span><span class="id"> =</span><span class="id"> 1</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x'|</span><span class="id"> |]/=;</span><span class="id"> rewrite</span><span class="id"> ?powRr0//</span><span class="id"> eqxx</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poweRe1</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> 1</span><span class="id"> =</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x'|</span><span class="id"> |]//=</span><span class="id"> x0;</span><span class="id"> rewrite</span><span class="id"> ?powRr1//</span> (<span class="id">negbTE</span> (<span class="id">oner_neq0</span><span class="id"> _</span>)).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poweRN</span><span class="id"> x</span><span class="id"> r</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> `^</span> (<span class="id">-</span><span class="id"> r</span>)<span class="id"> =</span> (<span class="id">fine</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> r</span>)<span class="id">^-1%:E</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> x</span><span class="id"> xf;</span><span class="id"> rewrite</span><span class="id"> poweR_EFin</span><span class="id"> powRN</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poweRNyr</span><span class="id"> r</span><span class="id"> :</span><span class="id"> r</span><span class="id"> !=</span><span class="id"> 0%R</span><span class="id"> -&gt;</span><span class="id"> -oo</span><span class="id"> `^</span><span class="id"> r</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> r0</span><span class="id"> /=;</span><span class="id"> rewrite</span> (<span class="id">negbTE</span><span class="id"> r0</span>). Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poweR_eqy</span><span class="id"> x</span><span class="id"> r</span><span class="id"> :</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> r</span><span class="id"> =</span><span class="id"> +oo</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> +oo</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> //=;</span><span class="id"> case:</span><span class="id"> ifP</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> eqy_poweR</span><span class="id"> x</span><span class="id"> r</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> r</span>)<span class="id">%R</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> +oo</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> r</span><span class="id"> =</span><span class="id"> +oo</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [|</span><span class="id"> |]//=</span><span class="id"> r0</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> gt_eqF</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poweR_lty</span><span class="id"> x</span><span class="id"> r</span><span class="id"> :</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> +oo</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> +oo</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]//=;</span><span class="id"> rewrite</span><span class="id"> ?ltry//;</span><span class="id"> case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> _;</span><span class="id"> rewrite</span><span class="id"> ltry</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> lty_poweRy</span><span class="id"> x</span><span class="id"> r</span><span class="id"> :</span><span class="id"> r</span><span class="id"> !=</span><span class="id"> 0%R</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> r</span><span class="id"> &lt;</span><span class="id"> +oo</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> &lt;</span><span class="id"> +oo</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> r0;</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |</span><span class="id"> _]//=;</span><span class="id"> rewrite</span><span class="id"> ?ltry//</span> (<span class="id">negbTE</span><span class="id"> r0</span>).<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poweR0r</span><span class="id"> r</span><span class="id"> :</span><span class="id"> r</span><span class="id"> !=</span><span class="id"> 0%R</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> `^</span><span class="id"> r</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> r0;</span><span class="id"> rewrite</span><span class="id"> poweR_EFin</span><span class="id"> powR0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poweR1r</span><span class="id"> r</span><span class="id"> :</span><span class="id"> 1</span><span class="id"> `^</span><span class="id"> r</span><span class="id"> =</span><span class="id"> 1</span><br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> poweR_EFin</span><span class="id"> powR1</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fine_poweR</span><span class="id"> x</span><span class="id"> r</span><span class="id"> :</span><span class="id"> fine</span> (<span class="id">x</span><span class="id"> `^</span><span class="id"> r</span>)<span class="id"> =</span> ((<span class="id">fine</span><span class="id"> x</span>)<span class="id"> `^</span><span class="id"> r</span>)<span class="id">%R</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]//=;</span><span class="id"> case:</span><span class="id"> ifPn</span><span class="id"> =&gt;</span><span class="id"> [/eqP</span><span class="id"> -&gt;|?];</span><span class="id"> rewrite</span><span class="id"> ?powRr0</span><span class="id"> ?powR0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poweR_ge0</span><span class="id"> x</span><span class="id"> r</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]/=;</span><span class="id"> rewrite</span><span class="id"> ?lee_fin</span><span class="id"> ?powR_ge0//;</span><span class="id"> case:</span><span class="id"> ifPn</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poweR_gt0</span><span class="id"> x</span><span class="id"> r</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|_|]//=;</span><span class="id"> [rewrite</span><span class="id"> lte_fin;</span><span class="id"> exact:</span><span class="id"> powR_gt0|case:</span><span class="id"> ifPn]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gt0_poweR</span><span class="id"> x</span><span class="id"> r</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;</span><span class="id"> r</span>)<span class="id">%R</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> r</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> r0;</span><span class="id"> move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|//|];</span><span class="id"> rewrite</span><span class="id"> ?leeNe_eq//</span><span class="id"> lee_fin</span><span class="id"> !lte_fin</span>.<br/>
<span class="id">exact:</span><span class="id"> gt0_powR</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poweR_eq0</span><span class="id"> x</span><span class="id"> r</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> `^</span><span class="id"> r</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> =</span> ((<span class="id">x</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> (<span class="id">r</span><span class="id"> !=</span><span class="id"> 0%R</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x</span><span class="id"> _|_/=|//];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> poweR_EFin</span><span class="id"> eqe</span><span class="id"> powR_eq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> ifP</span><span class="id"> =&gt;</span><span class="id"> //;</span><span class="id"> rewrite</span><span class="id"> onee_eq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poweR_eq0_eq0</span><span class="id"> x</span><span class="id"> r</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> r</span><span class="id"> =</span><span class="id"> 0</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> =</span><span class="id"> 0</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> +</span><span class="id"> /eqP</span><span class="id"> =&gt;</span><span class="id"> /poweR_eq0-&gt;</span><span class="id"> /andP[/eqP]</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> gt0_ler_poweR</span><span class="id"> r</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> r</span>)<span class="id">%R</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">{in</span><span class="id"> `[0,</span><span class="id"> +oo]</span><span class="id"> &amp;,</span><span class="id"> {homo</span><span class="id"> poweR</span><span class="id"> ^~</span><span class="id"> r</span><span class="id"> :</span><span class="id"> x</span><span class="id"> y</span><span class="id"> /</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> &gt;-&gt;</span><span class="id"> x</span><span class="id"> &lt;=</span><span class="id"> y}}</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> r0</span><span class="id"> +</span><span class="id"> y;</span><span class="id"> case=&gt;</span><span class="id"> //=</span><span class="id"> [x</span><span class="id"> /[1!in_itv]/=</span><span class="id"> /andP[xint</span><span class="id"> _]|</span><span class="id"> _</span><span class="id"> _]</span>.<br/>
<span class="id">-</span><span class="id"> case:</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> //=</span><span class="id"> [y</span><span class="id"> /[1!in_itv]/=</span><span class="id"> /andP[yint</span><span class="id"> _]</span><span class="id"> xy|</span><span class="id"> _</span><span class="id"> _]</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !lee_fin</span><span class="id"> ge0_ler_powR</span>.<br/>
&nbsp;&nbsp;<span class="id">+</span><span class="gallina-kwd"> by</span><span class="id"> case:</span><span class="id"> eqP</span><span class="id"> =&gt;</span><span class="id"> [-&gt;|];</span><span class="id"> rewrite</span><span class="id"> ?powRr0</span><span class="id"> ?leey</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> leye_eq</span><span class="id"> =&gt;</span><span class="id"> /eqP</span><span class="id"> -&gt;</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> fin_num_poweR</span><span class="id"> x</span><span class="id"> r</span><span class="id"> :</span><span class="id"> x</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> r</span><span class="id"> \is</span><span class="id"> a</span><span class="id"> fin_num</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd">by</span><span class="id"> move=&gt;</span><span class="id"> xfin;</span><span class="id"> rewrite</span><span class="id"> ge0_fin_numE</span><span class="id"> ?poweR_lty</span><span class="id"> ?ltey_eq</span><span class="id"> ?xfin//</span><span class="id"> poweR_ge0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poweRM</span><span class="id"> x</span><span class="id"> y</span><span class="id"> r</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> y</span><span class="id"> -&gt;</span> (<span class="id">x</span><span class="id"> *</span><span class="id"> y</span>)<span class="id"> `^</span><span class="id"> r</span><span class="id"> =</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> r</span><span class="id"> *</span><span class="id"> y</span><span class="id"> `^</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;|rN0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> r</span><span class="id"> 0%R;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> !poweRe0</span><span class="id"> mule1</span>.<br/>
<span class="id">have</span><span class="id"> powyrM</span><span class="id"> s</span><span class="id"> :</span> (<span class="id">0</span><span class="id"> &lt;=</span><span class="id"> s</span>)<span class="id">%R</span><span class="id"> -&gt;</span> (<span class="id">+oo</span><span class="id"> *</span><span class="id"> s%:E</span>)<span class="id"> `^</span><span class="id"> r</span><span class="id"> =</span><span class="id"> +oo</span><span class="id"> `^</span><span class="id"> r</span><span class="id"> *</span><span class="id"> s%:E</span><span class="id"> `^</span><span class="id"> r</span>.<br/>
&nbsp;&nbsp;<span class="id">case:</span><span class="id"> ltgtP</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> [s_gt0</span><span class="id"> _|&lt;-</span><span class="id"> _];</span><span class="id"> last</span><span class="id"> first</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mule0</span><span class="id"> poweRyr//</span><span class="id"> !poweR0r//</span><span class="id"> mule0</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> gt0_mulye//</span><span class="id"> poweRyr//</span><span class="id"> gt0_mulye//</span><span class="id"> poweR_gt0</span>.<br/>
<span class="id">case:</span><span class="id"> x</span><span class="id"> y</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]</span><span class="id"> [y|</span><span class="id"> |]//</span><span class="id"> x0</span><span class="id"> y0;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> -EFinM</span><span class="id"> powRM</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> muleC</span><span class="id"> powyrM//</span><span class="id"> muleC</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> powyrM</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulyy</span><span class="id"> !poweRyr//</span><span class="id"> mulyy</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poweRrM</span><span class="id"> x</span><span class="id"> r</span><span class="id"> s</span><span class="id"> :</span><span class="id"> x</span><span class="id"> `^</span> (<span class="id">r</span><span class="id"> *</span><span class="id"> s</span>)<span class="id"> =</span> (<span class="id">x</span><span class="id"> `^</span><span class="id"> r</span>)<span class="id"> `^</span><span class="id"> s</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">have</span><span class="id"> [-&gt;|s0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> s</span><span class="id"> 0%R;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mulr0</span><span class="id"> !poweRe0</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|r0]</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> r</span><span class="id"> 0%R;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> mul0r</span><span class="id"> poweRe0</span><span class="id"> poweR1r</span>.<br/>
<span class="id">case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|</span><span class="id"> |]//;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> /=</span><span class="id"> powRrM</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !poweRyr//</span><span class="id"> mulf_neq0</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> !poweRNyr</span><span class="id"> ?poweR0r</span><span class="id"> ?</span>(<span class="id">negPf</span><span class="id"> s0</span>)<span class="id">//</span><span class="id"> mulf_neq0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poweRAC</span><span class="id"> x</span><span class="id"> r</span><span class="id"> s</span><span class="id"> :</span> (<span class="id">x</span><span class="id"> `^</span><span class="id"> r</span>)<span class="id"> `^</span><span class="id"> s</span><span class="id"> =</span> (<span class="id">x</span><span class="id"> `^</span><span class="id"> s</span>)<span class="id"> `^</span><span class="id"> r</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> -!poweRrM</span><span class="id"> mulrC</span>. Qed.</div></details>
<br/>
<span class="vernacular">Definition</span><span class="id"> poweRD_def</span><span class="id"> x</span><span class="id"> r</span><span class="id"> s</span><span class="id"> :=</span> ((<span class="id">r</span><span class="id"> +</span><span class="id"> s</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> ==&gt;</span><br/>
&nbsp;&nbsp;((<span class="id">x</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> ((<span class="id">x</span><span class="id"> \isn't</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> ==&gt;</span> (<span class="id">r</span><span class="id"> ==</span><span class="id"> 0%R</span>)<span class="id"> &amp;&amp;</span> (<span class="id">s</span><span class="id"> ==</span><span class="id"> 0%R</span>)))).<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;x '`^?' ( r +? s )&quot;</span><span class="id"> :=</span> (<span class="id">poweRD_def</span><span class="id"> x</span><span class="id"> r</span><span class="id"> s</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poweRD_defE</span><span class="id"> x</span><span class="id"> r</span><span class="id"> s</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> `^?</span>(<span class="id">r</span><span class="id"> +?</span><span class="id"> s</span>)<span class="id"> =</span> ((<span class="id">r</span><span class="id"> +</span><span class="id"> s</span><span class="id"> ==</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> ==&gt;</span><br/>
&nbsp;&nbsp;((<span class="id">x</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> ((<span class="id">x</span><span class="id"> \isn't</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> ==&gt;</span> (<span class="id">r</span><span class="id"> ==</span><span class="id"> 0%R</span>)<span class="id"> &amp;&amp;</span> (<span class="id">s</span><span class="id"> ==</span><span class="id"> 0%R</span>)))).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> []</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poweRB_defE</span><span class="id"> x</span><span class="id"> r</span><span class="id"> s</span><span class="id"> :</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> `^?</span>(<span class="id">r</span><span class="id"> +?</span><span class="id"> -</span><span class="id"> s</span>)<span class="id"> =</span> ((<span class="id">r</span><span class="id"> ==</span><span class="id"> s</span>)<span class="id">%R</span><span class="id"> ==&gt;</span><br/>
&nbsp;&nbsp;((<span class="id">x</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id"> &amp;&amp;</span> ((<span class="id">x</span><span class="id"> \isn't</span><span class="id"> a</span><span class="id"> fin_num</span>)<span class="id"> ==&gt;</span> (<span class="id">r</span><span class="id"> ==</span><span class="id"> 0%R</span>)<span class="id"> &amp;&amp;</span> (<span class="id">s</span><span class="id"> ==</span><span class="id"> 0%R</span>)))).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> poweRD_defE</span><span class="id"> subr_eq0</span><span class="id"> oppr_eq0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> add_neq0_poweRD_def</span><span class="id"> x</span><span class="id"> r</span><span class="id"> s</span><span class="id"> :</span> (<span class="id">r</span><span class="id"> +</span><span class="id"> s</span><span class="id"> !=</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> `^?</span>(<span class="id">r</span><span class="id"> +?</span><span class="id"> s</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> poweRD_defE</span><span class="id"> =&gt;</span><span class="id"> /negPf-&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> add_neq0_poweRB_def</span><span class="id"> x</span><span class="id"> r</span><span class="id"> s</span><span class="id"> :</span> (<span class="id">r</span><span class="id"> !=</span><span class="id"> s</span>)<span class="id">%R</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> `^?</span>(<span class="id">r</span><span class="id"> +?</span><span class="id"> -</span><span class="id"> s</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> poweRB_defE</span><span class="id"> =&gt;</span><span class="id"> /negPf-&gt;</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nneg_neq0_poweRD_def</span><span class="id"> x</span><span class="id"> r</span><span class="id"> s</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">r</span><span class="id"> &gt;=</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> -&gt;</span> (<span class="id">s</span><span class="id"> &gt;=</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> `^?</span>(<span class="id">r</span><span class="id"> +?</span><span class="id"> s</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> xN0</span><span class="id"> rge0</span><span class="id"> sge0;</span><span class="id"> rewrite</span><span class="id"> /poweRD_def</span><span class="id"> xN0/=</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> case:</span><span class="id"> ltgtP</span><span class="id"> rge0</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> [r_gt0|&lt;-];</span><span class="id"> case:</span><span class="id"> ltgtP</span><span class="id"> sge0</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> [s_gt0|&lt;-]//=;</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> ?addr0</span><span class="id"> ?add0r</span><span class="id"> ?implybT//</span><span class="id"> gt_eqF//=</span><span class="id"> ?addr_gt0</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> nneg_neq0_poweRB_def</span><span class="id"> x</span><span class="id"> r</span><span class="id"> s</span><span class="id"> :</span><span class="id"> x</span><span class="id"> !=</span><span class="id"> 0</span><span class="id"> -&gt;</span> (<span class="id">r</span><span class="id"> &gt;=</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> -&gt;</span> (<span class="id">s</span><span class="id"> &lt;=</span><span class="id"> 0</span>)<span class="id">%R</span><span class="id"> -&gt;</span><br/>
&nbsp;&nbsp;<span class="id">x</span><span class="id"> `^?</span>(<span class="id">r</span><span class="id"> +?</span><span class="id"> -</span><span class="id"> s</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> *;</span><span class="id"> rewrite</span><span class="id"> nneg_neq0_poweRD_def//</span><span class="id"> oppr_ge0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poweRD</span><span class="id"> x</span><span class="id"> r</span><span class="id"> s</span><span class="id"> :</span><span class="id"> x</span><span class="id"> `^?</span>(<span class="id">r</span><span class="id"> +?</span><span class="id"> s</span>)<span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> `^</span> (<span class="id">r</span><span class="id"> +</span><span class="id"> s</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> r</span><span class="id"> *</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> s</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">rewrite</span><span class="id"> /poweRD_def</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|r0]/=</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> r</span><span class="id"> 0%R;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> add0r</span><span class="id"> poweRe0</span><span class="id"> mul1e</span>.<br/>
<span class="id">have</span><span class="id"> [-&gt;|s0]/=</span><span class="id"> :=</span><span class="id"> eqVneq</span><span class="id"> s</span><span class="id"> 0%R;</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> addr0</span><span class="id"> poweRe0</span><span class="id"> mule1</span>.<br/>
<span class="id">case:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> //</span><span class="id"> [t|/=|/=];</span><span class="id"> rewrite</span><span class="id"> ?</span>(<span class="id">negPf</span><span class="id"> r0,</span><span class="id"> negPf</span><span class="id"> s0,</span><span class="id"> implybF</span>)<span class="id">;</span><span class="id"> last</span><span class="id"> 2</span><span class="id"> first</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /negPf-&gt;;</span><span class="id"> rewrite</span><span class="id"> mulyy</span>.<br/>
<span class="id">-</span><span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> /negPf-&gt;;</span><span class="id"> rewrite</span><span class="id"> mule0</span>.<br/>
<span class="id">rewrite</span><span class="id"> !poweR_EFin</span><span class="id"> eqe</span><span class="id"> =&gt;</span><span class="id"> /implyP/</span>(_<span class="id"> _</span>)<span class="id">/andP</span><span class="id"> cnd</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> powRD//;</span><span class="id"> apply/implyP</span><span class="id"> =&gt;</span><span class="id"> /cnd[]</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poweRB</span><span class="id"> x</span><span class="id"> r</span><span class="id"> s</span><span class="id"> :</span><span class="id"> x</span><span class="id"> `^?</span>(<span class="id">r</span><span class="id"> +?</span><span class="id"> -</span><span class="id"> s</span>)<span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> `^</span> (<span class="id">r</span><span class="id"> -</span><span class="id"> s</span>)<span class="id"> =</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> r</span><span class="id"> *</span><span class="id"> x</span><span class="id"> `^</span> (<span class="id">-</span><span class="id"> s</span>).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> rs;</span><span class="id"> rewrite</span><span class="id"> poweRD</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> poweR12_sqrt</span><span class="id"> x</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> x</span><span class="id"> -&gt;</span><span class="id"> x</span><span class="id"> `^</span><span class="id"> 2^-1</span><span class="id"> =</span><span class="id"> sqrte</span><span class="id"> x</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move:</span><span class="id"> x</span><span class="id"> =&gt;</span><span class="id"> [x|_|//];</span><span class="id"> last</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> poweRyr</span>.<br/>
<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> lee_fin</span><span class="id"> =&gt;</span><span class="id"> x0</span><span class="id"> /=;</span><span class="id"> rewrite</span><span class="id"> powR12_sqrt</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> poweR</span>.<br/>
<span class="vernacular">Notation</span> <span class="id">&quot;a `^ x&quot;</span><span class="id"> :=</span> (<span class="id">poweR</span><span class="id"> a</span><span class="id"> x</span>)<span class="id"> :</span><span class="id"> ereal_scope</span>.<br/>
<br/>
<span class="vernacular">Section</span><span class="id"> riemannR_series</span>.<br/>
<span class="vernacular">Variable</span><span class="id"> R</span><span class="id"> :</span><span class="id"> realType</span>.<br/>
<span class="vernacular">Implicit</span><span class="id"> Types</span><span class="id"> a</span><span class="id"> :</span><span class="id"> R</span>.<br/>
<span class="vernacular">Local</span><span class="vernacular"> Open</span><span class="vernacular"> Scope</span><span class="id"> real_scope</span>.<br/>
<br/>
<span class="vernacular">Definition</span><span class="id"> riemannR</span><span class="id"> a</span><span class="id"> :</span><span class="id"> R</span><span class="id"> ^nat</span><span class="id"> :=</span><span class="gallina-kwd"> fun</span><span class="id"> n</span><span class="id"> =&gt;</span> (<span class="id">n</span>.<span class="id">+1%:R</span><span class="id"> `^</span><span class="id"> a</span>)<span class="id">^-1</span>.<br/>
<span class="vernacular">Arguments</span><span class="id"> riemannR</span><span class="id"> a</span><span class="id"> n</span><span class="id"> /</span>.<br/>
<br/>
<span class="vernacular">Lemma</span><span class="id"> riemannR_gt0</span><span class="id"> a</span><span class="id"> i</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> -&gt;</span><span class="id"> 0</span><span class="id"> &lt;</span><span class="id"> riemannR</span><span class="id"> a</span><span class="id"> i</span>.<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="gallina-kwd"> by</span><span class="id"> move=&gt;</span><span class="id"> ?;</span><span class="id"> rewrite</span><span class="id"> /riemannR</span><span class="id"> invr_gt0</span><span class="id"> powR_gt0</span>. Qed.</div></details>
<br/>
<span class="vernacular">Lemma</span><span class="id"> dvg_riemannR</span><span class="id"> a</span><span class="id"> :</span><span class="id"> 0</span><span class="id"> &lt;=</span><span class="id"> a</span><span class="id"> &lt;=</span><span class="id"> 1</span><span class="id"> -&gt;</span><span class="id"> ~</span><span class="id"> cvgn</span> (<span class="id">series</span> (<span class="id">riemannR</span><span class="id"> a</span>)).<br/>
<details>
<summary class="toggleproof">Proof.</summary>
<div class="proofscript">
<span class="id">move=&gt;</span><span class="id"> /andP[a0</span><span class="id"> a1]</span>.<br/>
<span class="id">have</span><span class="id"> :</span><span class="gallina-kwd"> forall</span><span class="id"> n,</span><span class="id"> harmonic</span><span class="id"> n</span><span class="id"> &lt;=</span><span class="id"> riemannR</span><span class="id"> a</span><span class="id"> n</span>.<br/>
&nbsp;&nbsp;<span class="id">move=&gt;</span><span class="id"> [/=|n];</span><span class="id"> first</span><span class="gallina-kwd"> by</span><span class="id"> rewrite</span><span class="id"> powR1</span><span class="id"> invr1</span>.<br/>
&nbsp;&nbsp;<span class="id">rewrite</span><span class="id"> -[leRHS]div1r</span><span class="id"> ler_pdivlMr</span><span class="id"> ?powR_gt0//</span><span class="id"> mulrC</span><span class="id"> ler_pdivrMr//</span>.<br/>
&nbsp;&nbsp;<span class="gallina-kwd">by</span><span class="id"> rewrite</span><span class="id"> mul1r</span><span class="id"> -[leRHS]powRr1//</span> (<span class="id">ler_powR</span>)<span class="id">//</span><span class="id"> ler1n</span>.<br/>
<span class="id">move/</span>(<span class="id">series_le_cvg</span><span class="id"> harmonic_ge0</span> (<span class="gallina-kwd">fun</span><span class="id"> i</span><span class="id"> =&gt;</span><span class="id"> ltW</span> (<span class="id">riemannR_gt0</span><span class="id"> i</span><span class="id"> a0</span>))).<br/>
<span class="gallina-kwd">by</span><span class="id"> move/contra_not;</span><span class="id"> apply;</span><span class="id"> exact:</span><span class="id"> dvg_harmonic</span>.<br/>
Qed.</div></details>
<br/>
<span class="vernacular">End</span><span class="id"> riemannR_series</span>.<br/>

      <div class="footer"><hr/>Generated by <a href="https://github.com/yoshihiro503/coq2html/">a fork of coq2html</a></div>
    </div>
  </div>
    </main>
</body>
</html>
